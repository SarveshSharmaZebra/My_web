/*
 *+------------------------------------------------------------------------+
 *| Licensed Materials - Property of IBM
 *| IBM Cognos Products: Viewer
 *| (C) Copyright IBM Corp. 2014
 *|
 *| US Government Users Restricted Rights - Use, duplication or
 *| disclosure restricted by GSA ADP Schedule Contract with IBM Corp.
 *|
 *+------------------------------------------------------------------------+
 */
 /*
 *+------------------------------------------------------------------------+
 *| Licensed Materials - Property of IBM
 *| IBM Cognos Products: Viewer
 *| (C) Copyright IBM Corp. 2013
 *|
 *| US Government Users Restricted Rights - Use, duplication or
 *| disclosure restricted by GSA ADP Schedule Contract with IBM Corp.
 *|
 *+------------------------------------------------------------------------+
 */
if (!RV_RES) {
var RV_RES = {};
}
RV_RES.RV_BROWSER_POPUP_IS_ENABLED =  "Your software to block pop-up windows is enabled. Change the settings in your web browser to allow pop-up windows from this website to be displayed.";
RV_RES.RV_RUNNING =  "Your report is running.";
RV_RES.RV_PLEASE_WAIT =  "Please wait...";
RV_RES.CANCEL =  "Cancel";
RV_RES.IDS_JS_OK =  "OK";
RV_RES.IDS_JS_RETRY =  "Retry";
RV_RES.IDS_JS_DETAILS =  "Details";
RV_RES.RV_BUSY_OPTIONS_SELECTED =  "";
RV_RES.RV_BUSY_OPTIONS_UNSELECTED =  "";
RV_RES.RV_BUSY_OPTIONS_LINK =  "";
RV_RES.PRINT_AS_PDF =  "Print as PDF";
RV_RES.COPY =  "Copy Widget";
RV_RES.CUT =  "Cut Widget";
RV_RES.IDS_PRINT_AS_PDF =  "Print as PDF";
RV_RES.RV_EMAIL_REPORT =  "Email Report...";
RV_RES.IDS_JS_EMAIL_REPORT_IFRAME_TITLE =  "Set the email options dialog";
RV_RES.RV_SAVE_REPORT =  "Save Report";
RV_RES.RV_SAVE_AS_REPORT_VIEW =  "Save as Report View...";
RV_RES.IDS_JS_SAVE_AS_REPORT_VIEW_IFRAME_TITLE =  "Save as report view dialog";
RV_RES.RV_RUN =  "Run Report";
RV_RES.RV_VIEW =  "View";
RV_RES.RV_VIEW_HTML =  "View in HTML Format";
RV_RES.RV_VIEW_PDF =  "View in PDF Format";
RV_RES.RV_VIEW_CSV =  "View in CSV Format";
RV_RES.RV_PDF =  "PDF";
RV_RES.RV_CSV =  "CSV";
RV_RES.RV_XML =  "XML";
RV_RES.RV_EXCEL_2000 =  "Excel 2000";
RV_RES.RV_EXCEL_2000SF =  "Excel 2000 Single Sheet";
RV_RES.RV_EXCEL_2002 =  "Excel 2002";
RV_RES.RV_EXCEL_2007 =  "Excel 2007";
RV_RES.RV_EXCEL_2007_DATA =  "Excel 2007 Data";
RV_RES.RV_VIEW_OPTIONS =  "View in Excel Options";
RV_RES.RV_VIEW_EXCEL =  "View in Excel 2000 Format";
RV_RES.RV_VIEW_XML =  "View in XML Format";
RV_RES.RV_VIEW_XLWA =  "View in Excel 2002 Format";
RV_RES.RV_VIEW_SINGLE_EXCEL =  "View in Excel 2000 Single Sheet Format";
RV_RES.RV_VIEW_SPREADSHEETML =  "View in Excel 2007 Format";
RV_RES.RV_VIEW_SPREADSHEETML_DATA =  "View in Excel 2007 Data";
RV_RES.RV_PREVIOUS_REPORT =  "Previous Report";
RV_RES.RV_DRILL_UP =  "Drill Up";
RV_RES.RV_DRILL_DOWN =  "Drill Down";
RV_RES.RV_DRILL_DEFAULT =  "Default";
RV_RES.RV_NEW =  "New";
RV_RES.RV_GO_TO =  "Go To";
RV_RES.RV_MORE =  "Related Links...";
RV_RES.RV_SEARCH =  "Search...";
RV_RES.RV_DOWNLOAD_CHART =  "Download Chart";
RV_RES.RV_ALERT_NEW_VERSION =  "Alert Me About New Versions";
RV_RES.RV_DO_NOT_ALERT_NEW_VERSION =  "Do Not Alert Me About New Versions";
RV_RES.RV_DO_NOT_ALERT_NEW_VERSION_CONFIRM =  "You will no longer be alerted when new versions of this report become available.";
RV_RES.RV_NEW_WATCH_RULE =  "Alert Using New Watch Rule...";
RV_RES.RV_NO_WATCH_RULES =  "No entries";
RV_RES.RV_MODIFY_WATCH_RULE =  "Modify...";
RV_RES.RV_DELETE_WATCH_RULE =  "Delete";
RV_RES.RV_CONFIRM_DELETE_WATCH_RULE =  "Are you sure you want to delete this entry?";
RV_RES.GOTO_LOADING =  "Loading...";
RV_RES.GOTO_WORKING =  "Working.";
RV_RES.IDS_JS_ADD_TO_MY_FOLDERS_IFRAME_TITLE =  "Add to My Folders dialog";
RV_RES.RV_VIEW_RECENT_REPORT =  "View the most recent report";
RV_RES.RV_RUN_REPORT =  "Run the report";
RV_RES.RV_VIEW_REPORT =  "View the report version";
RV_RES.RV_NEW_COMMENT =  "Add a comment...";
RV_RES.RV_VIEW_COMMENT_NAME =  "Name:";
RV_RES.RV_VIEW_COMMENT_CONTENTS =  "Comment:";
RV_RES.RV_VIEW_COMMENT_MODTIME =  "Modification Time:";
RV_RES.RV_VIEW_COMMENT_OWNER =  "Owner:";
RV_RES.RV_VIEW_COMMENT =  "View";
RV_RES.RV_ABOUT_DESCRIPTION =  "About IBM Cognos Viewer";
RV_RES.RV_LINEAGE =  "Lineage";
RV_RES.RV_GLOSSARY =  "Glossary";
RV_RES.IDS_JS_CALCULATE =  "Calculate";
RV_RES.IDS_JS_CALCULATION =  "Calculation";
RV_RES.IDS_JS_CALCULATE_PERCENT_DIFFERENCE =  "% Difference";
RV_RES.IDS_JS_CALCULATE_NUMBER =  "number";
RV_RES.IDS_JS_CALCULATE_ENTER_NUMBER_TITLE =  "Enter the number";
RV_RES.IDS_JS_CALCULATE_ENTER_NUMBER_DESCRIPTION =  "Specify the number to use in the calculation '{0}'";
RV_RES.IDS_JS_CALCULATE_ENTER_NUMBER =  "Number:";
RV_RES.IDS_JS_SORT =  "Sort";
RV_RES.IDS_JS_DONT_SORT =  "Don't Sort";
RV_RES.IDS_JS_NOT_SORTED =  "Not Sorted";
RV_RES.IDS_JS_SORT_ASCENDING =  "Sort Ascending";
RV_RES.IDS_JS_SORT_DESCENDING =  "Sort Descending";
RV_RES.IDS_JS_SORT_BY_ASCENDING =  "Ascending";
RV_RES.IDS_JS_SORT_BY_DESCENDING =  "Descending";
RV_RES.IDS_JS_SORT_BY_LABEL =  "Sort By Label";
RV_RES.IDS_JS_SORT_BY_VALUE =  "Sort By Value";
RV_RES.IDS_JS_SORT_APPLIED =  "Sort applied";
RV_RES.IDS_JS_SORTED_BY_LABEL =  "Sorted by label";
RV_RES.IDS_JS_SORTED_BY_VALUE =  "Sorted by value";
RV_RES.IDS_JS_SORT_ASCENDING_ORDER =  "ascending";
RV_RES.IDS_JS_SORT_DESCENDING_ORDER =  "descending";
RV_RES.IDS_JS_FILTER =  "Filter";
RV_RES.IDS_JS_REMOVE_FILTER =  "Remove Filter";
RV_RES.IDS_JS_FILTER_INCLUDE =  "Include {0}";
RV_RES.IDS_JS_FILTER_EXCLUDE =  "Exclude {0}";
RV_RES.IDS_JS_FILTER_GREATER_THAN =  ">";
RV_RES.IDS_JS_FILTER_LESS_THAN =  "<";
RV_RES.IDS_JS_FILTER_GREATER_THAN_EQUAL =  "≥";
RV_RES.IDS_JS_FILTER_LESS_THAN_EQUAL =  "≤";
RV_RES.IDS_JS_FILTER_BETWEEN =  "Between {0} and {1}";
RV_RES.IDS_JS_FILTER_NOT_BETWEEN =  "Not between {0} and {1}";
RV_RES.IDS_JS_FILTER_ENDS_WITH =  "ends with";
RV_RES.IDS_JS_FILTER_BEGINS_WITH =  "starts with";
RV_RES.IDS_JS_FILTER_CONTAINS =  "contains";
RV_RES.IDS_JS_FILTER_IS_MATCHES_SQLPATTERNFILTER =  "matches SQL pattern";
RV_RES.IDS_JS_FILTER_IS_NOT =  "not";
RV_RES.IDS_JS_FILTER_APPLIED =  "Filter applied";
RV_RES.IDS_JS_REMOVE_FILTER_FOR =  "Remove filter for";
RV_RES.IDS_JS_REMOVE_ALL_FILTERS =  "Remove all filters";
RV_RES.IDS_JS_REMOVE_ALL_FILTERS_FOR_WIDGET =  "Remove all filters for this widget";
RV_RES.IDS_JS_DELETE =  "Delete";
RV_RES.IDS_JS_CHANGE_DISPLAY_TYPE =  "Change Display Type";
RV_RES.IDS_JS_ANNOTATIONS =  "Comments";
RV_RES.IDS_JS_ANNOTATION =  "Comment";
RV_RES.IDS_JS_ANNOTATION_WIDGET =  "Comment Widget";
RV_RES.IDS_JS_ANNOTATION_NEW =  "Add";
RV_RES.IDS_JS_ANNOTATION_EDIT =  "Edit Last";
RV_RES.IDS_JS_ANNOTATION_DELETE =  "Delete Last";
RV_RES.IDS_JS_WIDGET_ANNOTATION_NEW =  "Add";
RV_RES.IDS_JS_WIDGET_ANNOTATION_EDIT =  "Edit Last";
RV_RES.IDS_JS_WIDGET_ANNOTATION_DELETE =  "Delete Last";
RV_RES.IDS_JS_GROUP_UNGROUP =  "Group / Ungroup";
RV_RES.IDS_JS_SWAP_ROWS_AND_COLUMNS =  "Swap Rows and Columns";
RV_RES.IDS_JS_MODAL_BACK_IFRAME =  "Empty frame";
RV_RES.IDS_JS_EMPTY_CELL =  "Empty cell";
RV_RES.IDS_JS_NO_ENABLED_MENU_ITEMS =  "No active links in the opened menu.";
RV_RES.IDS_JS_CHANGE_PALETTE =  "Change Color Palette";
RV_RES.IDS_JS_SELECTION_FILTER_SWITCH =  "Turn on Master filter";
RV_RES.IDS_JS_SELECTION_FILTER_SWITCH_DISABLE =  "Turn off Master filter";
RV_RES.IDS_JS_UNDO =  "Undo";
RV_RES.IDS_JS_REDO =  "Redo";
RV_RES.IDS_JS_CHANGE_DISPLAY_TYPE_BAR =  "Bar Chart";
RV_RES.IDS_JS_CHANGE_DISPLAY_TYPE_COLUMN =  "Column Chart";
RV_RES.IDS_JS_CHANGE_DISPLAY_TYPE_LINE =  "Line Chart";
RV_RES.IDS_JS_CHANGE_DISPLAY_TYPE_PIE =  "Pie Chart";
RV_RES.IDS_JS_CHANGE_DISPLAY_TYPE_CROSSTAB =  "Crosstab";
RV_RES.IDS_JS_CHANGE_DISPLAY_TYPE_LIST =  "List Table";
RV_RES.IDS_JS_CHANGE_DISPLAY_TYPE_MORE =  "More...";
RV_RES.IDS_JS_CHANGE_DISPLAY_RECOMMENDED =  "Recommended";
RV_RES.IDS_JS_INFOBAR_INCLUDE_TEXT =  "includes {0}";
RV_RES.IDS_JS_INFOBAR_EXCLUDE_TEXT =  "excludes {0}";
RV_RES.IDS_JS_INFOBAR_AND_TEXT =  "and";
RV_RES.IDS_JS_INFOBAR_BETWEEN_TEXT =  "between {0} and {1}";
RV_RES.IDS_JS_INFOBAR_NOT_BETWEEN_TEXT =  "not between {0} and {1}";
RV_RES.IDS_JS_INFOBAR_EXPAND =  "Expand";
RV_RES.IDS_JS_INFOBAR_COLLAPSE =  "Collapse";
RV_RES.IDS_JS_INFOBAR_ITEM_COUNT =  "{0} of {1}";
RV_RES.IDS_JS_INFOBAR_EXPLANATION =  "Use the up and down arrow keys to review the filters and sorts applied to the report. You can remove sorts and filters with the delete key.";
RV_RES.IDS_JS_INFOBAR_LOCKED =  "cannot be deleted";
RV_RES.IDS_JS_INFOBAR_PROMPT =  "Prompt details";
RV_RES.IDS_JS_INFOBAR_SLIDER =  "Slider filter";
RV_RES.IDS_JS_ANNO_INFOBAR_SHOW =  "Show";
RV_RES.IDS_JS_ANNO_INFOBAR_HIDE =  "Hide";
RV_RES.IDS_JS_ANNO_INFOBAR_BUTTON_EXPLANATION =  "Filter was applied. Hit tab to focus show/hide button.";
RV_RES.IDS_JS_COMMENT_DLG_TITLE =  "Add Comment";
RV_RES.IDS_JS_COMMENT_DLG_MESSAGE =  "Do you want to save this workspace?";
RV_RES.IDS_JS_COMMENT_DLG_DETAILS =  "You must save the workspace to add comments.";
RV_RES.IDS_JS_CHANGE_DISPLAY =  "Change Display";
RV_RES.IDS_JS_CHANGE_DISPLAY_SELECT_DATA =  "Select data first before changing display";
RV_RES.IDS_JS_ADVANCED_EDITING =  "Do More";
RV_RES.IDS_JS_RENAME =  "Rename";
RV_RES.IDS_JS_FREEZEROWHEADINGS =  "Freeze Row Headings";
RV_RES.IDS_JS_UNFREEZEROWHEADINGS =  "Unfreeze Row Headings";
RV_RES.IDS_JS_FREEZECOLUMNHEADINGS =  "Freeze Column Headings";
RV_RES.IDS_JS_UNFREEZECOLUMNHEADINGS =  "Unfreeze Column Headings";
RV_RES.IDS_JS_EXPAND_MEMBER =  "Expand";
RV_RES.IDS_JS_COLLAPSE_MEMBER =  "Collapse";
RV_RES.IDS_JS_RENAMED_ITEM =  "Renamed item";
RV_RES.IDS_JS_RENAMED_ITEM_ORIGINAL_LABEL =  "Original label :";
RV_RES.IDS_JS_MOVE =  "Move";
RV_RES.IDS_JS_LEFT =  "Left";
RV_RES.IDS_JS_RIGHT =  "Right";
RV_RES.IDS_JS_CROSSTAB_CORNER =  "Crosstab Corner";
RV_RES.IDS_JS_RENAME_LABEL =  "Rename type and text";
RV_RES.IDS_JS_LOADING_EDITING_TOOLS =  "Loading additional actions";
RV_RES.IDS_JS_DRILL_DOWN_JAWS =  "Drill down available.";
RV_RES.IDS_JS_DRILL_UP_JAWS =  "Drill up available.";
RV_RES.IDS_JS_DRILL_DOWN_UP_JAWS =  "Drill down and up available.";
RV_RES.IDS_JS_DRILL_THROUGH_JAWS =  "Drill through available.";
RV_RES.IDS_JS_RESET_TO_ORIGINAL =  "Reset";
RV_RES.IDS_JS_WIDGET_PROPERTIES =  "Set Properties";
RV_RES.IDS_JS_REPORT_INFO_TITLE =  "Info";
RV_RES.IDS_JS_REPORT_INFO_TEXT =  "A new version of this report is available.";
RV_RES.IDS_JS_REPORT_INFO_LINK_TEXT =  "Get new version";
RV_RES.IDS_JS_VIEW_ALL_SNAPSHOTS =  "More...";
RV_RES.IDS_JS_SELECT_SNAPSHOT_DIALOG_TITLE =  "Report Versions";
RV_RES.IDS_JS_SNAPSHOTS_LIVE =  "Live";
RV_RES.IDS_JS_SELECT_SNAPSHOT_DIALOG_DESC =  "Select a different version of this report.";
RV_RES.IDS_JS_MOST_RECENT_SNAPSHOT =  "Most Recent";
RV_RES.IDS_JS_LIST_SEPARATOR =  ",";
RV_RES.IDS_JS_CHART_IMAGE =  "Chart image";
RV_RES.IDS_JS_PROPERTY_ROWS_PER_PAGE =  "Maximum number of rows to show per page (maximum: 1000):";
RV_RES.IDS_JS_PROPERTY_ROWS_PER_PAGE_ERROR =  "This value is out of range.";
RV_RES.IDS_JS_PROPERTY_PROMPT_ON_LOAD =  "Prompt when workspace is opened (prompted reports only)";
RV_RES.IDS_JS_PROPERTY_SHOW_EXPAND_COLLAPSE_ICON =  "Enable expand and collapse controls";
RV_RES.IDS_JS_PROPERTY_RETRIEVE_ENTIRE_REPORT =  "Retrieve entire report (saved output only)";
RV_RES.IDS_JS_PROPERTY_DRILL_OPTIONS_LABEL =  "Drill options:";
RV_RES.IDS_JS_PROPERTY_ADD_SUMMARY_MEMBERS =  "Add summary members";
RV_RES.IDS_JS_PROPERTY_BACKWARDS_COMPATIBLE =  "Backwards compatible";
RV_RES.IDS_JS_PROPERTY_ORIGINAL_REPORT_LOCATION =  "Location:";
RV_RES.IDS_JS_PROPERTY_ORIGINAL_REPORT_LOCATION_UNAVAILABLE =  "Unavailable";
RV_RES.IDS_JS_PROPERTY_ACTIVEREPORT_OUTPUT_VERSION =  "Output Version:";
RV_RES.IDS_JS_PROPERTY_ACTIVEREPORT_OUTPUT_VERSION_UNAVAILABLE =  "Unavailable";
RV_RES.IDS_JS_CALCULATION_SELECT_DATA =  "Select data first before calculating";
RV_RES.IDS_JS_PROPERTY_FLASHCHARTS =  "Enable chart animation for applicable charts";
RV_RES.IDS_JS_SHOW_REPORT_SPEC =  "View report specification";
RV_RES.IDS_JS_ANNOTATION_JAWS =  "Comments are available";
RV_RES.IDS_JS_LABEL_HAS_BEEN_RENAMED =  "Label has been renamed";
RV_RES.IDS_JS_RESET_TO_ORIGINAL_WARNING =  "Do you want to reset the widget to the most recent available version?";
RV_RES.IDS_JS_RESET_TO_ORIGINAL_WARNING_DESC =  "Reset replaces the widget content and any changes are lost.";
RV_RES.IDS_JS_CHART_TABLE =  "Table";
RV_RES.IDS_JS_CHART_CROSSTAB =  "Crosstab";
RV_RES.IDS_JS_CHART_LIST_TABLE =  "List Table";
RV_RES.IDS_JS_CHART_COLUMN =  "Column";
RV_RES.IDS_JS_CHART_COLUMN_3D =  "Column with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_STACKED_COLUMN =  "Stacked Column";
RV_RES.IDS_JS_CHART_STACKED_COLUMN_3D =  "Stacked Column with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_PERCENT_STACKED_COLUMN =  "100% Stacked Column";
RV_RES.IDS_JS_CHART_PERCENT_STACKED_COLUMN_3D =  "100% Stacked Column with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_3D_AXIS_COLUMN =  "3-D Axis Column";
RV_RES.IDS_JS_CHART_BAR =  "Bar";
RV_RES.IDS_JS_CHART_BAR_3D =  "Bar with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_STACKED_BAR =  "Stacked Bar";
RV_RES.IDS_JS_CHART_STACKED_BAR_3D =  "Stacked Bar with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_PERCENT_STACKED_BAR =  "100% Stacked Bar";
RV_RES.IDS_JS_CHART_PERCENT_STACKED_BAR_3D =  "100% Stacked Bar with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_LINE =  "Line";
RV_RES.IDS_JS_CHART_LINE_WITH_MARKERS =  "Line with Markers";
RV_RES.IDS_JS_CHART_LINE_3D =  "Line with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_LINE_WITH_3D_MARKERS =  "Line with 3-D Visual Effect Markers";
RV_RES.IDS_JS_CHART_STEP_LINE_MARKERS =  "Step Line with Markers";
RV_RES.IDS_JS_CHART_STEP_LINE =  "Step Line";
RV_RES.IDS_JS_CHART_STEP_LINE_3D =  "Step Line with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_STACKED_LINE_MARKERS =  "Stacked Line with Markers";
RV_RES.IDS_JS_CHART_STACKED_LINE =  "Stacked Line";
RV_RES.IDS_JS_CHART_STACKED_LINE_3D =  "Stacked Line with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_PERCENT_STACKED_LINE_MARKERS =  "100% Stacked Line with Markers";
RV_RES.IDS_JS_CHART_PERCENT_STACKED_LINE =  "100% Stacked Line";
RV_RES.IDS_JS_CHART_PERCENT_STACKED_LINE__3D =  "100% Stacked Line with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_3D_AXIS_LINE =  "3-D Axis Line";
RV_RES.IDS_JS_CHART_PIE_DONUT =  "Pie, Donut";
RV_RES.IDS_JS_CHART_PIE =  "Pie";
RV_RES.IDS_JS_CHART_DONUT =  "Donut";
RV_RES.IDS_JS_CHART_PIE_3D =  "Pie with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_DONUT_3D =  "Donut with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_AREA =  "Area";
RV_RES.IDS_JS_CHART_AREA_3D =  "Area with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_STACKED_AREA =  "Stacked Area";
RV_RES.IDS_JS_CHART_STACKED_AREA_3D =  "Stacked Area with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_PERCENT_AREA =  "100% Stacked Area";
RV_RES.IDS_JS_CHART_PERCENT_AREA_3D =  "100% Stacked Area with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_3D_AXIS_AREA =  "3-D Axis Area";
RV_RES.IDS_JS_CHART_SCATTER_BUBBLE_POINT =  "Scatter, Bubble, Point";
RV_RES.IDS_JS_CHART_SCATTER =  "Scatter";
RV_RES.IDS_JS_CHART_BUBBLE =  "Bubble";
RV_RES.IDS_JS_CHART_BUBBLE_3D =  "Bubble with 3-D Visual Effect";
RV_RES.IDS_JS_CHART_BUBBLE_WITH_EXCEL_BUBBLE_SIZING =  "Bubble with Excel Bubble Sizing";
RV_RES.IDS_JS_CHART_POINT =  "Point";
RV_RES.IDS_JS_CHART_POINT_3D =  "Point with 3-D Markers";
RV_RES.IDS_JS_CHART_3D_SCATTER =  "3-D Scatter";
RV_RES.IDS_JS_CHART_GAUGE =  "Gauge";
RV_RES.IDS_JS_CHART_DIAL_GAUGE =  "Dial Gauge";
RV_RES.IDS_BROWSER_SUPPORT_ERROR =  "The content cannot be displayed in the current web browser. Try using another web browser.";
RV_RES.IDS_CANNOT_SAVE_CONTENT_ERROR =  "The content cannot be saved. You do not have sufficient privileges.";
RV_RES.IDS_ANNOTATION_WIDGET_DELETED_ERROR =  "Cannot load annotations. The widget or workspace was deleted after this workspace was opened.";
RV_RES.IDS_JS_NULL =  "Null";
RV_RES.IDS_JS_GLOBAL_PROMPTS_NOT_RESPONDING_WARNING =  "To prevent unexpected results, this widget is not currently responding to prompts.\n\nSet the prompts you want this widget to respond to using the Listen for Widget Events.";
RV_RES.IDS_JS_WAIT_PAGE_LOADING =  "Loading...";
RV_RES.IDS_JS_ERROR =  "Error";
RV_RES.IDS_JS_READY =  "Ready";
RV_RES.IDS_REPORT_WIDGET_PROPERTY_TAB_TITLE =  "Report";
RV_RES.IDS_ACTIVE_REPORT_WIDGET_PROPERTY_TAB_TITLE =  "Active Report";
RV_RES.IDS_CONV_CANCELED_ERROR =  "Cannot complete your request.";
RV_RES.IDS_JS_CLIPBOARD =  "Clipboard";
RV_RES.IDS_JS_NO_SAVED_OUTPUTS =  "There are no available saved report output versions.";
RV_RES.UNAVAILABLE =  "Unavailable";
RV_RES.IDS_PROP_LEGAL =  "Licensed Materials - Property of IBM Corp. © Copyright IBM Corporation and other(s) 2001, 2016. IBM, the IBM logo, ibm.com and Cognos are trademarks or registered trademarks of International Business Machines Corp., registered in many jurisdictions worldwide. A current list of IBM trademarks is available on the Web at www.ibm.com/legal/copytrade.shtml. Java and all Java-based trademarks and logos are trademarks or registered trademarks of Oracle and/or its affiliates. Other product and service names might be trademarks of IBM or other companies. This Program is licensed under the terms of the license agreement accompanying the Program. This license agreement may be either located in a Program directory folder or library identified as \"License\" or \"Non_IBM_License\", if applicable, or provided as a printed license agreement. Please read the agreement carefully before using the Program. By using the Program you agree to these terms.";
RV_RES.IDS_JS_BUSINESS_PROCESS_SELECT_DIALOG_TITLE =  "Business Processes";
RV_RES.IDS_JS_BUSINESS_PROCESS_SELECT_DIALOG_DESC =  "Select a process:";
RV_RES.IDS_JS_BUSINESS_PROCESS_SELECT_DIALOG_TABLE_HEADER =  "Process";
RV_RES.IDS_JS_BUSINESS_PROCESS_SELECT_DIALOG_START_BUTTON_LABEL =  "Start";
RV_RES.IDS_JS_BUSINESS_PROCESS_SELECT_DIALOG_NO_PROCESS =  "None";
RV_RES.IDS_JS_BUSINESS_PROCESS_SELECT_DIALOG_NO_PROCESS_A11Y =  "No process is available";
RV_RES.IDS_JS_BUSINESS_PROCESS_VIEW_INPUT_VALUES_LINK_LABEL =  "View input values";
RV_RES.IDS_JS_BUSINESS_PROCESS_VIEW_INPUT_VALUES_TABLE_DESCRIPTION =  "Input values:";
RV_RES.IDS_JS_BUSINESS_PROCESS_VIEW_INPUT_VALUES_TABLE_COLUMN_HEADER_DATA_ITEM =  "Data item";
RV_RES.IDS_JS_BUSINESS_PROCESS_VIEW_INPUT_VALUES_TABLE_COLUMN_HEADER_DISPLAY_VALUE_HEADER =  "Display value";
RV_RES.IDS_JS_BUSINESS_PROCESS_VIEW_INPUT_VALUES_TABLE_NO_INPUT_VALUE_MSG =  "No input value selected";
RV_RES.IDS_JS_BUSINESS_PROCESS_START_PROCESS_FAILED_MSG =  "The process, {0}, failed to start.";
RV_RES.IDS_JS_BUSINESS_PROCESS_START_PROCESS_SUCCEED_MSG =  "The process, {0}, started successfully.";
RV_RES.IDS_JS_BUSINESS_PROCESS_START_PROCESS_SUCCEED_MSG_DETAIL =  "To view the status of the process, open your business process application.";
RV_RES.IDS_JS_BUSINESS_PROCESS_GET_PROCESSES_FAIL_MSG =  "An error had occured while trying to get processes.";
RV_RES.IDS_JS_BUSINESS_PROCESS_START_PROCESS_SUCCEED_MSG_TITLE =  "Start process";
RV_RES.IDS_JS_BUSINESS_PROCESS_START_PROCESS_A11Y_DESC_VALUE =  "value";
RV_RES.IDS_JS_MISSING_MEMBER_ERROR_MSG_WITH_NO_BUA =  "Some data referenced in the report no longer exists. Contact the report author.";
RV_RES.IDS_JS_MISSING_MEMBER_ERROR_MSG_FOR_SPEC_PARAM =  "Some data referenced in the report no longer exists. The affected report areas are report specification and parameter value. Click Edit to update the referenced data now. You can also click Close to dismiss this message.";
RV_RES.IDS_JS_EDIT =  "Edit";
RV_RES.IDS_JS_CLOSE =  "Close";
RV_RES.IDS_JS_ERROR_INVALID_INT =  "Page number provided is not a positive integer.";
RV_RES.IDS_JS_ERROR_REPORT_NOT_COMPLETE =  "Report status is not complete.";
RV_RES.IDS_JS_ERROR_INVALID_PAGE_RANGE =  "Page range is invalid.";
RV_RES.IDS_JS_CWA_DIALOG_TITLE =  "Report - Design";
RV_RES.IDS_JS_SAVE_AS_FDG_TITLE =  "Save As";
RV_RES.IDS_JS_SELECTION_FILTER_INFO_JAWS =  "Filter applied to related widgets.";
RV_RES.IDS_JS_A11Y_DYNAMIC_MENU =  "Dynamic menu";
function CViewerHelper(){
this.m_oCV=null;
};
CViewerHelper.prototype.getCVObjectRef=function(){
return this.getCV().getObjectId();
};
CViewerHelper.prototype.getCV=function(){
if(this.m_oCV){
return this.m_oCV;
}
return window;
};
CViewerHelper.prototype.getCVId=function(){
var _1="";
if(this.m_oCV){
_1=this.m_oCV.getId();
}
return _1;
};
CViewerHelper.prototype.setCV=function(_2){
this.m_oCV=_2;
};
function CObserver(_3){
this.m_subject=_3;
this.m_observers=[];
};
function CObserver_attach(_4,_5,_6){
if(_4==null||typeof _4.update!="function"){
alert("Notification Frame Work Error : attach failed");
return false;
}
var _7=new CState(this.m_subject,_4,_5?_5:null,_6?_6:null);
this.m_observers[this.m_observers.length]=_7;
return true;
};
function CObserver_detach(_8){
};
function CObserver_hasObserver(_9){
var _a=false;
for(var _b=0;_b<this.m_observers.length;_b++){
if(this.m_observers[_b].getObserver()==_9){
_a=true;
break;
}
}
return _a;
};
function CObserver_notify(_c){
var i=0;
if(typeof _c!="undefined"&&_c!=null){
for(i=0;i<this.m_observers.length;++i){
if(this.m_observers[i].getEvt()==_c){
var _e=this.m_observers[i].getObserver();
var _f=this.m_observers[i].getCallback();
var _10=_e.update;
_e.update=_f;
_e.update(this.m_observers[i]);
_e.update=_10;
}
}
}else{
for(i=0;i<this.m_observers.length;++i){
this.m_observers[i].getObserver().update(this.m_observers[i].getSubject());
}
}
};
CObserver.prototype.attach=CObserver_attach;
CObserver.prototype.detach=CObserver_detach;
CObserver.prototype.notify=CObserver_notify;
CObserver.prototype.hasObserver=CObserver_hasObserver;
function CState(_11,_12,_13,evt){
this.m_subject=_11;
this.m_observer=_12;
this.m_callback=_13;
this.m_evt=evt;
};
function CState_getObserver(){
return this.m_observer;
};
function CState_getCallback(){
return this.m_callback;
};
function CState_getSubject(){
return this.m_subject;
};
function CState_getEvt(){
return this.m_evt;
};
CState.prototype.getObserver=CState_getObserver;
CState.prototype.getCallback=CState_getCallback;
CState.prototype.getSubject=CState_getSubject;
CState.prototype.getEvt=CState_getEvt;
function CParameterValueStringOperators(_15,_16,_17,_18){
this.m_sBetween=_15;
this.m_sNotBetween=_16;
this.m_sLessThan=_17;
this.m_sGreaterThan=_18;
};
function CParameterValues(){
this.m_parameterValues=new CDictionary();
};
CParameterValues.prototype.length=function(){
var _19=this.m_parameterValues.keys();
if(typeof _19=="undefined"||_19==null){
return 0;
}
return _19.length;
};
CParameterValues.prototype.getParameterValue=function(_1a){
if(typeof _1a!="string"||_1a==""){
return null;
}
if(this.m_parameterValues.exists(_1a)){
return this.m_parameterValues.get(_1a);
}
return null;
};
CParameterValues.prototype.getAt=function(_1b){
if(_1b<this.length()){
var _1c=this.m_parameterValues.keys();
if(this.m_parameterValues.exists(_1c[_1b])){
return this.m_parameterValues.get(_1c[_1b]);
}
}
return null;
};
CParameterValues.prototype.addParameterValue=function(_1d,_1e){
var _1f=this.getParameterValue(_1d);
if(_1f==null){
_1f=new CParameterValue();
_1f.setName(_1d);
}
_1f.addParmValueItem(_1e);
this.m_parameterValues.add(_1d,_1f);
};
CParameterValues.prototype.removeParameterValue=function(_20){
return (this.m_parameterValues.remove(_20)!=null);
};
CParameterValues.prototype.removeSimpleParmValueItem=function(_21,_22){
var _23=this.getParameterValue(_21);
if(_23==null){
return false;
}
return _23.removeSimpleParmValueItem(_22);
};
CParameterValues.prototype.addSimpleParmValueItem=function(_24,_25,_26,_27){
if(typeof _24!="string"||_24==""){
return null;
}
if(typeof _25!="string"||_25==""){
return null;
}
if(typeof _26!="string"){
return null;
}
if(typeof _27!="string"||(_27!="false"&&_27!="true")){
return null;
}
var _28=null;
if(this.m_parameterValues.exists(_24)==false){
_28=new CParameterValue(_24);
this.m_parameterValues.add(_24,_28);
}
_28=this.m_parameterValues.get(_24);
if(typeof _28=="undefined"||_28==null){
return null;
}
var _29=_28.getParmValueItems();
for(var _2a=0;_2a<_29.length;++_2a){
var _2b=_29[_2a];
if(_2b.getDisplayValue()==_26&&_2b.getUseValue()==_25){
return;
}
}
return _28.addSimpleParmValueItem(_25,_26,_27);
};
CParameterValues.prototype.getSimpleParmValueItem=function(_2c,_2d){
var _2e=this.getParameterValue(_2c);
if(_2e!=null){
return _2e.getSimpleParmValueItem(_2d);
}
return null;
};
CParameterValues.prototype.load=function(_2f){
return this.loadWithOptions(_2f,true);
};
CParameterValues.prototype.loadWithOptions=function(_30,_31){
try{
var _32=_30.childNodes;
for(var _33=0;_33<_32.length;++_33){
var _34=_32[_33];
if(_34.nodeType==3){
continue;
}
var _35=new CParameterValue();
if(_35.load(_34)){
var _36=_35.name();
if(_36!=""){
if(_31==true||_36.indexOf("credential:")!=0){
this.m_parameterValues.add(_36,_35);
}
}
}else{
delete _35;
}
}
}
catch(e){
return false;
}
return true;
};
CParameterValues.prototype.buildXML=function(_37,_38,_39){
var _3a=_38.createElement(_39);
_37.XMLBuilderSetAttributeNodeNS(_3a,"xmlns:xs","http://www.w3.org/2001/XMLSchema");
_37.XMLBuilderSetAttributeNodeNS(_3a,"xmlns:bus","http://developer.cognos.com/schemas/bibus/3/");
_37.XMLBuilderSetAttributeNodeNS(_3a,"xmlns:xsd","http://www.w3.org/2001/XMLSchema");
_37.XMLBuilderSetAttributeNodeNS(_3a,"xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");
_37.XMLBuilderSetAttributeNodeNS(_3a,"SOAP-ENC:arrayType","bus:parameterValue[]","http://schemas.xmlsoap.org/soap/encoding/");
_37.XMLBuilderSetAttributeNodeNS(_3a,"xsi:type","SOAP-ENC:Array","http://www.w3.org/2001/XMLSchema-instance");
_38.documentElement.appendChild(_3a);
var _3b=this.m_parameterValues.keys();
for(var _3c=0;_3c<_3b.length;++_3c){
if(this.m_parameterValues.exists(_3b[_3c])){
var _3d=this.m_parameterValues.get(_3b[_3c]);
_3d.generateXML(_37,_3a);
}
}
return _3a;
};
CParameterValues.prototype.generateXML=function(_3e,_3f,_40){
var _41="parameterValues";
if(typeof _40!="undefined"&&_40!=null){
_41=_40;
}
XMLBuilderSerializeNode(this.buildXML(_3e,_3f,_41));
return XMLBuilderSerializeNode(_3f);
};
function CParameterValue(_42){
this.m_name=_42;
this.m_parmValueItems=[];
};
CParameterValue.prototype.name=function(){
return this.m_name;
};
CParameterValue.prototype.setName=function(_43){
this.m_name=_43;
};
CParameterValue.prototype.getParmValueItems=function(){
return this.m_parmValueItems;
};
CParameterValue.prototype.length=function(){
return this.m_parmValueItems.length;
};
CParameterValue.prototype.addParmValueItem=function(_44){
this.m_parmValueItems.push(_44);
};
CParameterValue.prototype.addSimpleParmValueItem=function(_45,_46,_47){
if(typeof _45!="string"||_45==""){
return null;
}
if(typeof _46!="string"){
return null;
}
if(typeof _47!="string"||(_47!="false"&&_47!="true")){
return null;
}
var _48=new CSimpleParmValueItem(_45,_46,_47);
this.m_parmValueItems.push(_48);
return _48;
};
CParameterValue.prototype.removeSimpleParmValueItem=function(_49){
if(typeof _49!="string"||_49==""){
return false;
}
var _4a=[];
var _4b=false;
for(var _4c=0;_4c<this.length();++_4c){
var _4d=this.m_parmValueItems[_4c];
if(_4d instanceof CSimpleParmValueItem){
if(_4d.getUseValue()==_49){
_4b=true;
continue;
}
}
_4a.push(_4d);
}
this.m_parmValueItems=_4a;
return _4b;
};
CParameterValue.prototype.getSimpleParmValueItem=function(_4e){
if(typeof _4e!="string"||_4e==""){
return null;
}
for(var _4f=0;_4f<this.length();++_4f){
var _50=this.m_parmValueItems[_4f];
if(_50 instanceof CSimpleParmValueItem){
if(_50.getUseValue()==_4e){
return _50;
}
}
}
return null;
};
CParameterValue.prototype.load=function(_51){
var _52=_51.getAttributeNode("xsi:type");
if(_52==null||_52.nodeValue!="bus:parameterValue"){
return false;
}
var _53=XMLHelper_FindChildByTagName(_51,"name",false);
if(_53==null){
return false;
}
this.m_name=XMLHelper_GetText(_53);
if(this.m_name==""){
return false;
}
var _54=XMLHelper_FindChildByTagName(_51,"value",false);
if(_54==null){
return false;
}
var _55=_54.getAttributeNode("xsi:type");
if(_55==null||_55.nodeValue!="SOAP-ENC:Array"){
return false;
}
var _56=_54.getAttributeNode("SOAP-ENC:arrayType");
if(_56==null||_56.nodeValue.indexOf("bus:parmValueItem[")==-1){
return false;
}
var _57=_54.childNodes;
for(var _58=0;_58<_57.length;++_58){
var _59=_57[_58];
if(_59.nodeType==3){
continue;
}
var _5a=_59.getAttributeNode("xsi:type");
if(_5a!=null){
var _5b;
var _5c;
switch(_5a.nodeValue){
case "bus:simpleParmValueItem":
_5b=new CSimpleParmValueItem("","","");
break;
case "bus:boundRangeParmValueItem":
_5b=new CBoundRangeParmValueItem();
break;
case "bus:unboundedEndRangeParmValueItem":
_5b=new CUnboundedEndRangeParmValueItem();
break;
case "bus:unboundedStartRangeParmValueItem":
_5b=new CUnboundedStartRangeParmValueItem();
break;
case "bus:hierarchicalParmValueItem":
_5b=new CHierarchicalParmValueItem();
break;
default:
return false;
}
_5c=_5b.load(_59);
if(_5c){
this.m_parmValueItems.push(_5b);
}else{
delete _5b;
}
}
}
return true;
};
CParameterValue.prototype.generateXML=function(_5d,_5e){
var _5f=_5e.ownerDocument;
var _60=_5f.createElement("item");
_5d.XMLBuilderSetAttributeNodeNS(_60,"xsi:type","bus:parameterValue","http://www.w3.org/2001/XMLSchema-instance");
_5e.appendChild(_60);
var _61=_5d.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:name",_5f);
_5d.XMLBuilderSetAttributeNodeNS(_61,"xsi:type","xs:string","http://www.w3.org/2001/XMLSchema-instance");
_61.appendChild(_5f.createTextNode(this.m_name));
_60.appendChild(_61);
var _62=_5d.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:value",_5f);
_5d.XMLBuilderSetAttributeNodeNS(_62,"SOAP-ENC:arrayType","bus:parmValueItem[]","http://schemas.xmlsoap.org/soap/encoding/");
_5d.XMLBuilderSetAttributeNodeNS(_62,"xsi:type","SOAP-ENC:Array","http://www.w3.org/2001/XMLSchema-instance");
_60.appendChild(_62);
for(var _63=0;_63<this.m_parmValueItems.length;++_63){
if(typeof this.m_parmValueItems[_63].generateXML!="undefined"){
this.m_parmValueItems[_63].generateXML(_5d,_62);
}
}
};
CParameterValue.prototype.toString=function(_64){
var _65="";
for(var _66=0;_66<this.m_parmValueItems.length;++_66){
if(_65!=""){
_65+=", ";
}
if(typeof this.m_parmValueItems[_66].toString!="undefined"){
_65+=this.m_parmValueItems[_66].toString(_64);
}
}
return _65;
};
function CParmValueItem(){
this.initialize("true");
};
CParmValueItem.prototype.getInclusiveValue=function(){
return this.m_inclusiveValue;
};
CParmValueItem.prototype.setInclusiveValue=function(_67){
this.m_inclusiveValue=_67;
};
CParmValueItem.prototype.initialize=function(_68){
this.m_inclusiveValue=_68;
};
CParmValueItem.prototype.load=function(_69){
this.m_inclusiveValue="true";
var _6a=XMLHelper_FindChildByTagName(_69,"inclusive",false);
if(_6a!=null){
var _6b=XMLHelper_GetText(_6a);
if(_6b=="true"||_6b=="false"){
this.m_inclusiveValue=_6b;
}
}
};
CParmValueItem.prototype.generateXML=function(_6c,_6d){
var _6e=_6d.ownerDocument;
var _6f=_6c.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:inclusive",_6e);
_6c.XMLBuilderSetAttributeNodeNS(_6f,"xsi:type","xs:boolean","http://www.w3.org/2001/XMLSchema-instance");
_6f.appendChild(_6e.createTextNode(this.m_inclusiveValue));
_6d.appendChild(_6f);
};
function CSimpleParmValueItem(_70,_71,_72){
CSimpleParmValueItem.baseclass.initialize.call(this,_72);
this.m_useValue=_70;
this.m_displayValue=_71;
};
CSimpleParmValueItem.prototype=new CParmValueItem();
CSimpleParmValueItem.prototype.constructor=CSimpleParmValueItem;
CSimpleParmValueItem.baseclass=CParmValueItem.prototype;
CSimpleParmValueItem.prototype.getUseValue=function(){
return this.m_useValue;
};
CSimpleParmValueItem.prototype.getDisplayValue=function(){
return this.m_displayValue;
};
CSimpleParmValueItem.prototype.getParmValueItem=function(){
return this.m_parmValueItem;
};
CSimpleParmValueItem.prototype.setDisplayValue=function(_73){
this.m_displayValue=_73;
};
CSimpleParmValueItem.prototype.setUseValue=function(_74){
this.m_useValue=_74;
};
CSimpleParmValueItem.prototype.toString=function(_75){
return this.getDisplayValue();
};
CSimpleParmValueItem.prototype.load=function(_76){
CSimpleParmValueItem.baseclass.load.call(this,_76);
var _77=XMLHelper_FindChildByTagName(_76,"use",false);
if(_77==null){
return false;
}
var _78=XMLHelper_GetText(_77);
if(_78==""){
return false;
}
this.m_useValue=_78;
var _79=XMLHelper_FindChildByTagName(_76,"display",false);
if(_79!=null){
this.m_displayValue=XMLHelper_GetText(_79);
}
return true;
};
CSimpleParmValueItem.prototype.generateXML=function(_7a,_7b){
var _7c=_7b.ownerDocument;
var _7d=_7c.createElement("item");
_7a.XMLBuilderSetAttributeNodeNS(_7d,"xsi:type","bus:simpleParmValueItem","http://www.w3.org/2001/XMLSchema-instance");
_7b.appendChild(_7d);
CSimpleParmValueItem.baseclass.generateXML.call(this,_7a,_7d);
var _7e=_7a.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:use",_7c);
_7a.XMLBuilderSetAttributeNodeNS(_7e,"xsi:type","xs:string","http://www.w3.org/2001/XMLSchema-instance");
_7e.appendChild(_7c.createTextNode(this.m_useValue));
_7d.appendChild(_7e);
var _7f=_7a.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:display",_7c);
_7a.XMLBuilderSetAttributeNodeNS(_7f,"xsi:type","xs:string","http://www.w3.org/2001/XMLSchema-instance");
_7f.appendChild(_7c.createTextNode(this.m_displayValue));
_7d.appendChild(_7f);
};
function CBoundRangeParmValueItem(){
CBoundRangeParmValueItem.baseclass.initialize.call(this,"true");
this.m_start=null;
this.m_end=null;
};
CBoundRangeParmValueItem.prototype=new CParmValueItem();
CBoundRangeParmValueItem.prototype.constructor=CBoundRangeParmValueItem;
CBoundRangeParmValueItem.baseclass=CParmValueItem.prototype;
CBoundRangeParmValueItem.prototype.setStart=function(_80){
this.m_start=_80;
};
CBoundRangeParmValueItem.prototype.getStart=function(){
return this.m_start;
};
CBoundRangeParmValueItem.prototype.setEnd=function(end){
this.m_end=end;
};
CBoundRangeParmValueItem.prototype.getEnd=function(){
return this.m_end;
};
CBoundRangeParmValueItem.prototype.toString=function(_82){
return CViewerCommon.getMessage(_82.m_sBetween,[this.m_start.getDisplayValue(),this.m_end.getDisplayValue()]);
};
CBoundRangeParmValueItem.prototype.load=function(_83){
CBoundRangeParmValueItem.baseclass.load.call(this,_83);
this.m_start=new CSimpleParmValueItem("","","");
this.m_start.load(XMLHelper_FindChildByTagName(_83,"start",false));
this.m_end=new CSimpleParmValueItem("","","");
this.m_end.load(XMLHelper_FindChildByTagName(_83,"end",false));
return true;
};
CBoundRangeParmValueItem.prototype.generateXML=function(_84,_85){
var _86=_85.ownerDocument;
var _87=_86.createElement("item");
_84.XMLBuilderSetAttributeNodeNS(_87,"xsi:type","bus:boundRangeParmValueItem","http://www.w3.org/2001/XMLSchema-instance");
_85.appendChild(_87);
CBoundRangeParmValueItem.baseclass.generateXML.call(this,_84,_87);
var _88=_84.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:start",_86);
_87.appendChild(_88);
this.m_start.generateXML(_84,_88);
var _89=_84.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:end",_86);
_87.appendChild(_89);
this.m_end.generateXML(_84,_89);
};
function CUnboundedStartRangeParmValueItem(){
CUnboundedStartRangeParmValueItem.baseclass.initialize.call(this,"true");
this.m_end=null;
};
CUnboundedStartRangeParmValueItem.prototype=new CParmValueItem();
CUnboundedStartRangeParmValueItem.prototype.constructor=CUnboundedStartRangeParmValueItem;
CUnboundedStartRangeParmValueItem.baseclass=CParmValueItem.prototype;
CUnboundedStartRangeParmValueItem.prototype.setEnd=function(end){
this.m_end=end;
};
CUnboundedStartRangeParmValueItem.prototype.getEnd=function(){
return this.m_end;
};
CUnboundedStartRangeParmValueItem.prototype.load=function(_8b){
CUnboundedStartRangeParmValueItem.baseclass.load.call(this,_8b);
this.m_end=new CSimpleParmValueItem("","","");
this.m_end.load(XMLHelper_FindChildByTagName(_8b,"end",false));
return true;
};
CUnboundedStartRangeParmValueItem.prototype.generateXML=function(_8c,_8d){
var _8e=_8d.ownerDocument;
var _8f=_8e.createElement("item");
_8c.XMLBuilderSetAttributeNodeNS(_8f,"xsi:type","bus:unboundedStartRangeParmValueItem","http://www.w3.org/2001/XMLSchema-instance");
_8d.appendChild(_8f);
CUnboundedStartRangeParmValueItem.baseclass.generateXML.call(this,_8c,_8f);
var _90=_8c.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:end",_8e);
_8f.appendChild(_90);
this.m_end.generateXML(_8c,_90);
};
CUnboundedStartRangeParmValueItem.prototype.toString=function(_91){
return _91.m_sLessThan+" "+this.m_end.getDisplayValue();
};
function CUnboundedEndRangeParmValueItem(){
CUnboundedEndRangeParmValueItem.baseclass.initialize.call(this,"true");
this.m_start=null;
};
CUnboundedEndRangeParmValueItem.prototype=new CParmValueItem();
CUnboundedEndRangeParmValueItem.prototype.constructor=CUnboundedEndRangeParmValueItem;
CUnboundedEndRangeParmValueItem.baseclass=CParmValueItem.prototype;
CUnboundedEndRangeParmValueItem.prototype.setStart=function(_92){
this.m_start=_92;
};
CUnboundedEndRangeParmValueItem.prototype.getStart=function(){
return this.m_start;
};
CUnboundedEndRangeParmValueItem.prototype.load=function(_93){
CUnboundedEndRangeParmValueItem.baseclass.load.call(this,_93);
this.m_start=new CSimpleParmValueItem("","","");
this.m_start.load(XMLHelper_FindChildByTagName(_93,"start",false));
return true;
};
CUnboundedEndRangeParmValueItem.prototype.generateXML=function(_94,_95){
var _96=_95.ownerDocument;
var _97=_96.createElement("item");
_94.XMLBuilderSetAttributeNodeNS(_97,"xsi:type","bus:unboundedEndRangeParmValueItem","http://www.w3.org/2001/XMLSchema-instance");
_95.appendChild(_97);
CUnboundedEndRangeParmValueItem.baseclass.generateXML.call(this,_94,_97);
var _98=_94.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:start",_96);
_97.appendChild(_98);
this.m_start.generateXML(_94,_98);
};
CUnboundedEndRangeParmValueItem.prototype.toString=function(_99){
return _99.m_sGreaterThan+" "+this.m_start.getDisplayValue();
};
function CHierarchicalParmValueItem(){
CHierarchicalParmValueItem.baseclass.initialize.call(this,"true");
this.m_value=null;
this.m_subNodes=[];
};
CHierarchicalParmValueItem.prototype=new CParmValueItem();
CHierarchicalParmValueItem.prototype.constructor=CHierarchicalParmValueItem;
CHierarchicalParmValueItem.baseclass=CParmValueItem.prototype;
CHierarchicalParmValueItem.prototype.getValue=function(){
return this.m_value;
};
CHierarchicalParmValueItem.prototype.getSubNodes=function(){
return this.m_subNodes;
};
CHierarchicalParmValueItem.prototype.setValue=function(_9a){
this.m_value=_9a;
};
CHierarchicalParmValueItem.prototype.setSubNodes=function(_9b){
this.m_subNodes=_9b;
};
CHierarchicalParmValueItem.prototype.load=function(_9c){
CHierarchicalParmValueItem.baseclass.load.call(this,_9c);
this.m_value=new CSimpleParmValueItem("","","");
this.m_value.load(XMLHelper_FindChildByTagName(_9c,"value",false));
var _9d=XMLHelper_FindChildByTagName(_9c,"subNodes",false);
if(_9d==null){
return false;
}
var _9e=_9d.getAttributeNode("xsi:type");
if(_9e==null||_9e.nodeValue!="SOAP-ENC:Array"){
return false;
}
var _9f=_9d.getAttributeNode("SOAP-ENC:arrayType");
if(_9f==null||_9f.nodeValue!="bus:hierarchicalParmValueItem[]"){
return false;
}
var _a0=_9d.childNodes;
for(var _a1=0;_a1<_a0.length;++_a1){
var _a2=new CHierarchicalParmValueItem();
_a2.load(_a0[_a1]);
this.m_subNodes.push(_a2);
}
return true;
};
CHierarchicalParmValueItem.prototype.generateXML=function(_a3,_a4){
var _a5=_a4.ownerDocument;
var _a6=_a5.createElement("item");
_a3.XMLBuilderSetAttributeNodeNS(_a6,"xsi:type","bus:hierarchicalParmValueItem","http://www.w3.org/2001/XMLSchema-instance");
_a4.appendChild(_a6);
CHierarchicalParmValueItem.baseclass.generateXML.call(this,_a3,_a6);
var _a7=_a3.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:value",_a5);
_a6.appendChild(_a7);
this.m_value.generateXML(_a3,_a7);
var _a8=_a3.XMLBuilderCreateElementNS("http://developer.cognos.com/schemas/bibus/3/","bus:subNodes",_a5);
_a3.XMLBuilderSetAttributeNodeNS(_a8,"SOAP-ENC:arrayType","bus:hierarchicalParmValueItem[]","http://schemas.xmlsoap.org/soap/encoding/");
_a3.XMLBuilderSetAttributeNodeNS(_a8,"xsi:type","SOAP-ENC:Array","http://www.w3.org/2001/XMLSchema-instance");
_a6.appendChild(_a8);
for(var _a9=0;_a9<this.m_subNodes.length;++_a9){
this.m_subNodes[_a9].generateXML(_a3,_a8);
}
};
CHierarchicalParmValueItem.prototype.toString=function(){
return "";
};
function XMLParser(s,_ab){
if(s==null){
return null;
}
if(/^\s*</.test(s)){
s=s.replace(/^\s*/,"");
if(s.charAt(1)=="/"){
var _ac=new RegExp("^</"+_ab.getName()+"\\s*>","gi");
if(!_ac.test(s)){
alert("invalid XML "+_ab.getName()+"\n"+s);
return null;
}
return XMLParser(s.replace(RegExp.lastMatch,""),_ab.parentNode);
}else{
var _ad=/^\s*<([\w:\-_\.]+)/;
if(_ad.test(s)){
var _ae=RegExp.$1;
var e=new XMLElement(_ae,_ab);
var _b0=new RegExp("^<"+_ae+"[^>]*>");
s=s.replace(_b0,"");
var _b1=RegExp.lastMatch;
var _b2=/([\w:\-_\.]+)="([^"]*)"/gi;
var _b3=_b1.match(_b2);
if(_b3!=null){
for(var i=0;i<_b3.length;i++){
var _b5=_b3[i];
(/([\w:\-_\.]+)\s*=\s*"(.*)"/).test(_b5);
e.setAttribute(RegExp.$1,RegExp.$2);
}
}
if(!(/\/>$/).test(_b1)){
XMLParser(s,e);
return e;
}else{
XMLParser(s,_ab);
return e;
}
}
}
}else{
if(s&&_ab){
var _b6=new RegExp("([^<]*)</"+_ab.getName()+"\\s*[^>]*>","gi");
_b6.test(s);
var _b7=RegExp.$1;
_ab.setValue(_b7);
return (XMLParser(s.replace(_b7,""),_ab));
}
}
return null;
};
function XMLElement(s,_b9){
this.nodeName=s;
this.nodeValue="";
this.attributes=[];
this.childNodes=[];
this.parentNode=_b9;
if(this.parentNode){
this.parentNode.appendChild(this);
}
};
XMLElement.prototype.appendChild=function(e){
this.childNodes[this.childNodes.length]=e;
};
XMLElement.prototype.hasChildNodes=function(){
if(this.childNodes.length>0){
return true;
}else{
return false;
}
};
XMLElement.prototype.findChildByName=function(n,_bc){
if(this.getName()==n){
return (this);
}
for(var i=0;i<this.childNodes.length;i++){
if(this.childNodes[i].getName()==n){
return this.childNodes[i];
}
}
if(_bc!=false){
for(i=0;i<this.childNodes.length;i++){
var _be=this.childNodes[i].findChildByName(n,_bc);
if(_be){
return _be;
}
}
}
return null;
};
XMLElement.prototype.findChildWithAttribute=function(_bf,val){
for(var i=0;i<this.childNodes.length;i++){
if(this.childNodes[i].getAttribute(_bf)==val){
return this.childNodes[i];
}
}
return null;
};
XMLElement.prototype.getElementsByTagName=function(s,_c3){
var a=[];
for(var i=0;i<this.childNodes.length;i++){
if(this.childNodes[i].getName()==s){
a[a.length]=this.childNodes[i];
}
}
if(_c3!=false){
for(i=0;i<this.childNodes.length;i++){
var _c6=this.childNodes[i].getElementsByTagName(s);
for(var j=0;j<_c6.length;j++){
a[a.length]=_c6[j];
}
}
}
return a;
};
XMLElement.prototype.getName=function(){
return this.nodeName;
};
XMLElement.prototype.getValue=function(){
return this.nodeValue;
};
XMLElement.prototype.setAttribute=function(a,v){
this.attributes["_"+a]=v;
};
XMLElement.prototype.setValue=function(v){
this.nodeValue=v;
};
XMLElement.prototype.getAttribute=function(a){
var _cc="";
if(typeof sXmlDecode=="function"){
_cc=sXmlDecode(this.attributes["_"+a]);
}else{
_cc=this.attributes["_"+a];
}
return (_cc==null?"":_cc);
};
XMLElement.prototype.toString=function(){
var s="<"+this.getName();
for(var i in this.attributes){
s+=" "+i.substring(1)+"=\""+this.attributes[i]+"\"";
}
s+=">"+this.getValue();
for(var j=0;j<this.childNodes.length;j++){
s+=this.childNodes[j].toString();
}
s+="</"+this.getName()+">";
return s;
};
function XMLBuilderLoadXMLFromString(_d0,_d1){
var _d2=null;
if(typeof DOMParser!="undefined"){
_d2=new DOMParser().parseFromString(_d0,"application/xml");
}else{
if(typeof ActiveXObject!="undefined"){
try{
_d2=new ActiveXObject("Microsoft.XMLDOM");
_d2.loadXML(_d0);
}
catch(e){
}
}
}
return _d2;
};
function XMLBuilderCreateXMLDocument(_d3,_d4,_d5){
var _d6=null;
_d4=_d4||"";
_d5=_d5||null;
if(document.implementation&&document.implementation.createDocument){
if(typeof _d4=="undefined"){
_d4="http://www.w3.org/2000/xmlns/";
}
_d6=document.implementation.createDocument(_d4,_d3,_d5);
}else{
if(typeof ActiveXObject!="undefined"){
try{
_d6=new ActiveXObject("Microsoft.XMLDOM");
var _d7=_d6.createNode(1,_d3,_d4);
_d6.appendChild(_d7);
}
catch(e){
}
}
}
return _d6;
};
function XMLBuilderCreateElementNS(_d8,_d9,_da){
var _db=null;
if(typeof _da.createElementNS!="undefined"){
if(typeof _d8=="undefined"){
_d8="http://www.w3.org/2000/xmlns/";
}
_db=_da.createElementNS(_d8,_d9);
}else{
if(typeof _da.createNode!="undefined"){
_db=_da.createNode(1,_d9,_d8);
}
}
return _db;
};
function XMLBuilderSetAttributeNodeNS(_dc,_dd,_de,_df){
if(typeof _dc.setAttributeNS!="undefined"){
if(typeof _df=="undefined"){
_df="http://www.w3.org/2000/xmlns/";
}
_dc.setAttributeNS(_df,_dd,_de);
}else{
if(typeof _dc.ownerDocument!="undefined"&&typeof _dc.ownerDocument.createNode!="undefined"){
var _e0=_dc.ownerDocument.createNode(2,_dd,_df);
_e0.nodeValue=_de;
_dc.setAttributeNode(_e0);
}
}
};
function XMLBuilderSerializeNode(_e1){
var _e2="";
if(typeof XMLSerializer!="undefined"){
try{
_e2=new XMLSerializer().serializeToString(_e1);
}
catch(e){
}
}else{
if(typeof _e1=="object"&&typeof _e1.xml!="undefined"){
_e2=_e1.xml;
}
}
return _e2.replace(/^\s+/g,"").replace(/\s+$/g,"");
};
function XMLHelper_GetText(_e3,_e4){
var _e5="";
var _e6=_e3.childNodes;
for(var i=0;i<_e6.length;++i){
if(_e6[i].nodeType==3){
_e5+=_e6[i].nodeValue;
}else{
if(_e6[i].nodeName=="Value"){
_e5+=_e6[i].getAttribute("display");
}else{
if(_e4){
_e5+=XMLHelper_GetText(_e6[i],true);
}
}
}
}
return _e5;
};
function XMLHelper_GetLocalName(_e8){
if(typeof _e8.baseName!="undefined"){
return _e8.baseName;
}
return _e8.localName;
};
function XMLHelper_FindChildByTagName(_e9,_ea,_eb){
if(typeof _eb=="undefined"||(_eb!=true&&_eb!=false)){
_eb=true;
}
if(XMLHelper_GetLocalName(_e9)==_ea){
return (_e9);
}
var i;
for(i=0;i<_e9.childNodes.length;i++){
if(XMLHelper_GetLocalName(_e9.childNodes[i])==_ea){
return _e9.childNodes[i];
}
}
if(_eb!=false){
for(i=0;i<_e9.childNodes.length;i++){
var _ed=XMLHelper_FindChildByTagName(_e9.childNodes[i],_ea,_eb);
if(_ed){
return _ed;
}
}
}
return null;
};
function XMLHelper_FindChildrenByTagName(_ee,_ef,_f0){
if(typeof _f0=="undefined"||(_f0!=true&&_f0!=false)){
_f0=true;
}
var _f1=[];
var _f2=_ee.childNodes;
for(var _f3=0;_f3<_f2.length;_f3++){
if(XMLHelper_GetLocalName(_f2[_f3])==_ef){
_f1[_f1.length]=_f2[_f3];
}
if(_f0===true){
var _f4=XMLHelper_FindChildrenByTagName(_f2[_f3],_ef,_f0);
if(_f4.length>0){
_f1=_f1.concat(_f4);
}
}
}
return _f1;
};
function XMLHelper_GetFirstChildElement(oEl){
var _f6=null;
if(oEl&&oEl.childNodes&&oEl.childNodes.length){
for(var i=0;i<oEl.childNodes.length;i++){
if(oEl.childNodes[i].nodeType==1){
_f6=oEl.childNodes[i];
break;
}
}
}
return _f6;
};
function XMLHelper_FindChildrenByAttribute(_f8,_f9,_fa,_fb,_fc){
if(typeof _fb=="undefined"||(_fb!=true&&_fb!=false)){
_fb=true;
}
if(typeof _fa!="string"&&typeof _fa!="number"){
_fa=null;
}else{
_fa=_fa.toString();
}
var _fd=[];
var _fe=_f8.childNodes;
for(var _ff=0;_ff<_fe.length;_ff++){
var _100=_fe[_ff];
if(_100.nodeType==1){
var _101=_100.getAttribute(_f9);
if(_101!==null){
if(_fa===null||_101==_fa){
if(_fc){
return [_100];
}else{
_fd[_fd.length]=_100;
}
}
}
if(_fb===true){
var _102=XMLHelper_FindChildrenByAttribute(_100,_f9,_fa,_fb,_fc);
if(_102.length>0){
if(_fc){
if(_102.length==1){
return _102;
}else{
return [_102[0]];
}
}else{
_fd=_fd.concat(_102);
}
}
}
}
}
return _fd;
};
var DICTIONARY_INVALID_KEY=-1;
var DICTIONARY_SUCCESS=1;
function CDictionary(){
this.m_aValues={};
};
function CDictionary_add(sKey,_104){
if(typeof sKey!="string"&&typeof sKey!="number"){
return DICTIONARY_INVALID_KEY;
}
this.m_aValues[sKey]=_104;
return DICTIONARY_SUCCESS;
};
function CDictionary_exists(sKey){
if(typeof sKey!="string"&&typeof sKey!="number"){
return false;
}
return (typeof this.m_aValues[sKey]!="undefined");
};
function CDictionary_get(sKey){
if(typeof sKey!="string"&&typeof sKey!="number"){
return null;
}
if(this.exists(sKey)===true){
return this.m_aValues[sKey];
}else{
return null;
}
};
function CDictionary_keys(){
var _107=[];
for(var _108 in this.m_aValues){
_107.push(_108);
}
return _107.sort();
};
function CDictionary_remove(sKey){
if(typeof sKey!="string"&&typeof sKey!="number"){
return DICTIONARY_INVALID_KEY;
}
var _10a=this.get(sKey);
delete this.m_aValues[sKey];
return _10a;
};
function CDictionary_removeAll(){
this.m_aValues=[];
return DICTIONARY_SUCCESS;
};
function CDictionary_append(_10b){
if(_10b instanceof CDictionary&&_10b.keys().length>0){
var _10c=_10b.keys();
for(var _10d=0;_10d<_10c.length;_10d++){
this.add(_10c[_10d],_10b.get(_10c[_10d]));
}
}
};
CDictionary.prototype.add=CDictionary_add;
CDictionary.prototype.exists=CDictionary_exists;
CDictionary.prototype.get=CDictionary_get;
CDictionary.prototype.keys=CDictionary_keys;
CDictionary.prototype.remove=CDictionary_remove;
CDictionary.prototype.removeAll=CDictionary_removeAll;
CDictionary.prototype.append=CDictionary_append;
function CognosTabControl(_10e,_10f){
this._init();
this._outsideContainer=_10e;
this._callback=_10f;
};
CognosTabControl.prototype._init=function(){
this._tabs=null;
this._tabControlNode=null;
this._scrollButtonsVisible=false;
this._scrollLeftButton=null;
this._scrollRightButton=null;
this._selectedTab=null;
this._wrapperDiv=null;
this._topContainer=null;
this._seperator=null;
this._isSavedOutput=false;
this._isHighContrast=false;
};
CognosTabControl.prototype.destroy=function(){
if(this._wrapperDiv){
this._wrapperDiv.parentNode.removeChild(this._wrapperDiv);
delete this._wrapperDiv;
this._wrapperDiv=null;
}
};
CognosTabControl.prototype.setHighContrast=function(_110){
this._isHighContrast=_110;
};
CognosTabControl.prototype.isHighContrast=function(){
return this._isHighContrast;
};
CognosTabControl.prototype.setSpaceSaverContainer=function(node){
this._spaceSaverContainer=node;
};
CognosTabControl.prototype.useAbsolutePosition=function(_112){
this._useAbsolutePosition=_112;
};
CognosTabControl.prototype.setScrollAttachNode=function(node){
this._scrollAttachNode=node;
};
CognosTabControl.prototype.setIsSavedOutput=function(_114){
this._isSavedOutput=_114;
};
CognosTabControl.prototype.isSavedOutput=function(){
return this._isSavedOutput;
};
CognosTabControl.prototype.getSelectedTabId=function(){
if(this._selectedTab){
return this._selectedTab.getId();
}
return null;
};
CognosTabControl.prototype.getSelectedTab=function(){
return this._selectedTab?this._selectedTab:null;
};
CognosTabControl.prototype.isTopAligned=function(){
return this._isTopAligned;
};
CognosTabControl.prototype.getWrapperDiv=function(){
return this._wrapperDiv;
};
CognosTabControl.prototype.getVisibleWidth=function(){
var _115=this._scrollRightButton?this._scrollRightButton.getWidth()+11:0;
return this._wrapperDiv.clientWidth-_115;
};
CognosTabControl.prototype.getMaxRightScroll=function(){
var _116=this._scrollRightButton?this._scrollRightButton.getWidth()+11:0;
return this._totalWrapperWidth+_116+8-this._wrapperDiv.clientWidth;
};
CognosTabControl.prototype.hide=function(){
this._topContainer.style.display="none";
};
CognosTabControl.prototype.resetPosition=function(){
if(this._useAbsolutePosition===true){
this._outsideContainer.srollLeft="0px";
this._outsideContainer.scrollTop="0px";
this._topContainer.style.top="";
this._topContainer.style.bottom="";
this._topContainer.style.left="0px";
if(this._isTopAligned){
this._topContainer.style.top="0px";
}else{
this._topContainer.style.bottom="0px";
}
}
};
CognosTabControl.prototype.render=function(_117){
this._updateTabInfo(_117);
if(!this._tabControlNode){
var _118=this;
var _119=this._scrollAttachNode?this._scrollAttachNode:this._outsideContainer;
if(window.attachEvent){
window.attachEvent("onresize",function(){
_118.onResize();
});
if(this._useAbsolutePosition===true){
_119.attachEvent("onscroll",function(){
_118.onContainerScroll();
});
}
}else{
window.addEventListener("resize",function(){
_118.onResize();
},false);
if(this._useAbsolutePosition===true){
_119.addEventListener("scroll",function(){
_118.onContainerScroll();
},false);
}
}
this._outsideContainer.originalClassName=this._outsideContainer.className;
this._outsideContainer.className=this._outsideContainer.className+(this._isTopAligned?" ct_controlTop":" ct_controlBottom");
this._topContainer=document.createElement("div");
this._topContainer.className="ct_wrapperDiv";
if(this._useAbsolutePosition===true){
this._topContainer.style.width="100%";
this._topContainer.style.position="absolute";
this._topContainer.style.left="0px";
if(this._isTopAligned){
this._topContainer.style.top="0px";
}else{
this._topContainer.style.bottom="0px";
}
}
if(this._isTopAligned&&this._outsideContainer.firstChild){
this._outsideContainer.insertBefore(this._topContainer,this._outsideContainer.firstChild);
}else{
this._outsideContainer.appendChild(this._topContainer);
}
this._wrapperDiv=document.createElement("div");
this._wrapperDiv.setAttribute("role","presentation");
this._wrapperDiv.className="ct_wrapperDiv";
this._topContainer.appendChild(this._wrapperDiv);
this._tabControlNode=document.createElement("div");
this._tabControlNode.setAttribute("role","tablist");
this._tabControlNode.className="ct_control";
this._wrapperDiv.appendChild(this._tabControlNode);
this._totalWrapperWidth=0;
for(var i=0;i<this._tabs.length;i++){
var tab=this._tabs[i];
tab.render(this._tabControlNode);
this._totalWrapperWidth+=this._tabs[i].getWidth();
}
var _11c=0;
if(this._tabs[0]){
_11c=this._tabs[0].getHeight();
}
this._wrapperDiv.style.height=_11c+5+"px";
if(this._spaceSaverContainer){
this.spaceSaverDiv=document.createElement("div");
this.spaceSaverDiv.style.height=_11c+5+"px";
this.spaceSaverDiv.style.position="relative";
this.spaceSaverDiv.style.display="block";
this._spaceSaverContainer.appendChild(this.spaceSaverDiv);
}
this._createSeperator();
}else{
this.resetPosition();
}
this._topContainer.style.display="";
this.onResize();
this.selectTab(_117.currentTabId,false);
if(this._selectedTab){
this._selectedTab.scrollIntoView();
this.updateScrollButtons();
}
};
CognosTabControl.prototype.onContainerScroll=function(){
var _11d=this._scrollAttachNode?this._scrollAttachNode:this._topContainer;
this._topContainer.style.left=_11d.scrollLeft+"px";
if(this._isTopAligned){
this._topContainer.style.top=_11d.scrollTop+"px";
}else{
this._topContainer.style.bottom=(-_11d.scrollTop)+"px";
}
};
CognosTabControl.prototype._resetTabControl=function(){
if(this._outsideContainer.originalClassName){
this._outsideContainer.className=this._outsideContainer.originalClassName;
}else{
this._outsideContainer.className="";
}
if(this._topContainer){
var node=this._outsideContainer.removeChild(this._topContainer);
node=null;
}
this._init();
};
CognosTabControl.prototype._updateTabInfo=function(_11f){
this._isTopAligned=_11f.position=="topLeft"?true:false;
var tabs=_11f.tabs;
if(this._tabs){
if(this._tabs.length!=tabs.length){
this._resetTabControl();
}else{
for(var i=0;i<this._tabs.length;i++){
if(tabs[i].id!=this._tabs[i].getId()){
this._resetTabControl();
break;
}
}
}
}
if(!this._tabs){
this._tabs=[];
if(!tabs){
return;
}
for(var ii=0;ii<tabs.length;ii++){
var tab=new CognosTab(tabs[ii],this,ii);
this._tabs.push(tab);
}
}
};
CognosTabControl.prototype.getScrollPos=function(){
return this._wrapperDiv.scrollLeft;
};
CognosTabControl.prototype.scrollTo=function(_124){
this._wrapperDiv.scrollLeft=_124;
this.updateScrollButtons();
};
CognosTabControl.prototype.onResize=function(evt){
if(this._wrapperDiv.offsetWidth<this._totalWrapperWidth){
this._showScrollButtons();
this.updateScrollButtons();
if(this._selectedTab){
this._selectedTab.scrollIntoView();
}
if(this._scrollRightButton.isDisabled()){
this.scrollTo(this.getMaxRightScroll());
}
}else{
this._hideScrollButtons();
this.scrollTo(0);
}
};
CognosTabControl.prototype._showScrollButtons=function(){
if(this._scrollButtonsVisible){
return;
}
if(!this._scrollLeftButton){
var _126=0;
if(this._tabs[0]){
_126=this._tabs[0].getHeight();
}
this._scrollLeftButton=new CognosScrollButton("left",_126,this);
this._scrollLeftButton.render(this._topContainer);
this._scrollRightButton=new CognosScrollButton("right",_126,this);
this._scrollRightButton.render(this._topContainer);
}
this._scrollButtonsVisible=true;
this._scrollLeftButton.show();
this._scrollRightButton.show();
this._tabControlNode.style.left=this._scrollLeftButton.getWidth()-2+"px";
};
CognosTabControl.prototype.updateScrollButtons=function(){
if(this._scrollLeftButton){
this._scrollLeftButton.update();
}
if(this._scrollRightButton){
this._scrollRightButton.update();
}
};
CognosTabControl.prototype._hideScrollButtons=function(){
if(!this._scrollButtonsVisible){
return;
}
this._scrollButtonsVisible=false;
this._tabControlNode.style.left="0px";
this._scrollLeftButton.hide();
this._scrollRightButton.hide();
};
CognosTabControl.prototype._createSeperator=function(){
this._seperator=document.createElement("div");
this._seperator.setAttribute("role","presendation");
this._seperator.setAttribute("style","");
this._seperator.className="ct_verticalLine";
this._seperator.setAttribute("role","presentation");
this._tabControlNode.appendChild(this._seperator);
};
CognosTabControl.prototype.selectTab=function(_127,_128,evt){
if(!evt){
evt=window.event;
}
for(var i=0;i<this._tabs.length;i++){
var tab=this._tabs[i];
var _12c=tab.getId()==_127;
tab.select(_12c);
if(_12c){
this._selectedTab=tab;
if(_128&&this._callback){
this._callback(_127);
}
}
if(_128){
tab.focus(_12c);
}
}
if(evt&&window.stopEventBubble){
window.stopEventBubble(evt);
}
return false;
};
CognosTabControl.prototype.handleKeyDown=function(evt,_12e){
if(!evt){
evt=window.event;
}
if(!evt){
return;
}
if(evt.keyCode=="39"||evt.keyCode=="37"){
if(evt.keyCode=="39"){
_12e++;
if(_12e>=this._tabs.length){
_12e=0;
}
}else{
_12e--;
if(_12e<0){
_12e=this._tabs.length-1;
}
}
this._tabs[_12e].focus();
this._tabs[_12e].scrollIntoView();
}else{
if(evt.keyCode=="32"||evt.keyCode=="13"){
var _12f=this._tabs[_12e].getId();
this.selectTab(_12f,true);
}
}
};
function CognosTab(_130,_131,_132){
if(!_130){
return;
}
this._id=_130.id;
this._label=_130.label;
this._position=_132;
this._contentClassName=_130.className;
this._imgURL=_130.img;
this._selected=false;
this._tabControl=_131;
this._outerTabDiv=null;
this._focusDiv=null;
};
CognosTab.prototype.getWidth=function(){
return this._outerTabDiv.offsetWidth+1;
};
CognosTab.prototype.getHeight=function(){
return this._outerTabDiv.clientHeight;
};
CognosTab.prototype.getId=function(){
return this._id;
};
CognosTab.prototype.select=function(_133){
if(_133!=this._selected){
this._selected=_133;
if(_133){
this.scrollIntoView();
}
if(this._outerTabDiv){
this._updateSelectedClass();
this._updateAriaSelected();
}
}
};
CognosTab.prototype.scrollIntoView=function(){
var _134=this._outerTabDiv.offsetLeft+this._outerTabDiv.clientWidth;
var _135=this._tabControl.getVisibleWidth();
var _136=this._tabControl.getScrollPos();
var _137=this._outerTabDiv.offsetLeft;
if(_137===0){
this._tabControl.scrollTo(0);
}else{
if((_137>=_136)&&(_134<=(_136+_135))){
}else{
if(_137<_136){
var _138=_137<3?0:_137-3;
this._tabControl.scrollTo(_138);
}else{
if(_134-_135>0||_134<_136){
this._tabControl.scrollTo(_134-_135+10);
}
}
}
}
};
CognosTab.prototype.render=function(_139){
if(!this._outerTabDiv){
var _13a=this._id;
var _13b=this._tabControl;
var tab=this;
this._outerTabDiv=document.createElement("div");
this._outerTabDiv.onmousedown=function(_13d){
_13b.selectTab(_13a,true,_13d);
};
this._outerTabDiv.onmouseover=function(){
this.className=this.className+" ct_highlight";
};
this._outerTabDiv.onmouseout=function(){
tab._updateSelectedClass();
};
this._outerTabDiv.setAttribute("style","");
this._outerTabDiv.setAttribute("role","presentation");
this._updateSelectedClass();
_139.appendChild(this._outerTabDiv);
var _13e=document.createElement("div");
_13e.className="ct_content";
_13e.setAttribute("role","presentation");
this._outerTabDiv.appendChild(_13e);
this._focusDiv=document.createElement("span");
this._focusDiv.innerHTML=this._label?this._label:"&nbsp;";
this._focusDiv.className="ct_text";
this._focusDiv.setAttribute("tabIndex",this._position===0?"0":"-1");
this._focusDiv.setAttribute("role","tab");
this._focusDiv.onkeydown=function(_13f){
_13b.handleKeyDown(_13f,tab._position);
};
this._updateAriaSelected();
_13e.appendChild(this._focusDiv);
if(this.isIE()&&this.getWidth()<75){
this._outerTabDiv.style.width="75px";
}
}else{
this._updateSelectedClass();
this._updateAriaSelected();
}
};
CognosTab.prototype.isIE=function(){
return (navigator.userAgent.indexOf("MSIE")!=-1||navigator.userAgent.indexOf("Trident")!=-1);
};
CognosTab.prototype.getFocusableDiv=function(){
return this._focusDiv;
};
CognosTab.prototype.focus=function(_140){
if(typeof _140==="undefined"){
_140=true;
}
this._focusDiv.setAttribute("tabIndex",_140?"0":"-1");
if(_140&&this._focusDiv.focus){
this._focusDiv.focus();
}
};
CognosTab.prototype._updateSelectedClass=function(){
this._outerTabDiv.className=this._selected?"ct_outerDiv ct_highlight ct_selected":"ct_outerDiv";
};
CognosTab.prototype._updateAriaSelected=function(){
this._focusDiv.setAttribute("aria-selected",this._selected?"true":"false");
};
function CognosScrollButton(_141,_142,_143){
this._direction=_141;
this._height=_142;
this._tabControl=_143;
this._disabled=true;
this._scrolling=false;
};
CognosScrollButton.prototype.getWidth=function(){
return this._scrollButtonDiv.offsetWidth+1;
};
CognosScrollButton.prototype.show=function(){
this._wrapperDiv.style.display="block";
};
CognosScrollButton.prototype.hide=function(){
this._wrapperDiv.style.display="none";
};
CognosScrollButton.prototype.update=function(){
var _144=this._tabControl.getWrapperDiv();
var _145=false;
if(this._direction=="left"){
if(_144.scrollLeft===0){
_145=true;
}
}else{
if(_144.scrollLeft>=(this._tabControl.getMaxRightScroll()-2)){
_145=true;
}
}
if(_145){
this._disable();
}else{
this._enable();
}
};
CognosScrollButton.prototype.isDisabled=function(){
return this._disabled;
};
CognosScrollButton.prototype._disable=function(){
this._disabled=true;
this._outerDiv.className="ct_outerDiv ct_scrollDisabled";
};
CognosScrollButton.prototype._enable=function(){
this._disabled=false;
this._outerDiv.className="ct_outerDiv ct_scrollEnabled";
};
CognosScrollButton.prototype.scroll=function(){
if(!this._scrolling){
this._scrolling=true;
var _146=this._tabControl.getWrapperDiv().clientWidth;
this._doAnimateScroll(_146,this._tabControl.getMaxRightScroll());
}
};
CognosScrollButton.prototype._doAnimateScroll=function(_147,_148){
if(_147>0){
var _149=10;
var _14a=this._tabControl.getWrapperDiv();
if(this._direction=="left"){
if(_14a.scrollLeft>_149){
this._tabControl.scrollTo(_14a.scrollLeft-_149);
}else{
this._tabControl.scrollTo(0);
this._scrolling=false;
return;
}
}else{
if(_14a.scrollLeft+_149<_148){
this._tabControl.scrollTo(_14a.scrollLeft+_149);
}else{
this._scrolling=false;
this._tabControl.scrollTo(_148);
this._tabControl.updateScrollButtons();
return;
}
}
_147-=_149;
var _14b=this;
setTimeout(function(){
_14b._doAnimateScroll(_147,_148);
},3);
}else{
this._scrolling=false;
this._tabControl.updateScrollButtons();
}
};
CognosScrollButton.prototype.isIE=function(){
return (navigator.userAgent.indexOf("MSIE")!=-1||navigator.userAgent.indexOf("Trident")!=-1);
};
CognosScrollButton.prototype.render=function(_14c){
this._scrollButtonDiv=document.createElement("div");
this._scrollButtonDiv.className="ct_scrollButton";
var _14d=-1;
if(this.isIE()&&document.compatMode!="CSS1Compat"){
_14d=1;
}
this._scrollButtonDiv.style.height=this._height+_14d+"px";
if(this._tabControl.isHighContrast()){
this._scrollButtonDiv.innerHTML=this._direction=="left"?"&laquo;":"&raquo;";
}
this._outerDiv=document.createElement("div");
this._outerDiv.className="ct_scrollDisabled";
this._outerDiv.appendChild(this._scrollButtonDiv);
this._outerDiv.style.height=this._height+"px";
var _14e=this;
this._outerDiv.onclick=function(){
_14e.scroll();
};
this._wrapperDiv=document.createElement("div");
this._wrapperDiv.style.height=this._height+"px";
this._wrapperDiv.className="ct_scroll "+(this._direction=="left"?"ct_left":"ct_right")+(this._tabControl.isHighContrast()?" a11y":"");
this._wrapperDiv.appendChild(this._outerDiv);
if(this._direction=="left"){
_14c.insertBefore(this._wrapperDiv,_14c.firstChild);
this._wrapperDiv.style.left="0px";
}else{
_14c.appendChild(this._wrapperDiv);
this._wrapperDiv.style.right="0px";
}
};
function ActionFactory(_14f){
this.m_cognosViewer=_14f;
};
ActionFactory.prototype.load=function(_150){
this.m_cognosViewer.loadExtra();
var _151=null;
try{
var _152=_150+"Action";
_151=eval("(typeof "+_152+"=='function'? new "+_152+"():null);");
if(_151){
_151.setCognosViewer(this.m_cognosViewer);
}
}
catch(exception){
_151=null;
}
return _151;
};
function ActionFactory_loadActionHandler(evt,_154){
var _155=getCtxNodeFromEvent(evt);
var _156=_154.getSelectionController();
var _157=null;
if(_155!==null){
var _158=_155.getAttribute("ctx");
_158=_158.split("::")[0].split(":")[0];
var _159=_155.getAttribute("type")!=null?_155:_155.parentNode;
var type=_159.getAttribute("type");
switch(type){
case "columnTitle":
var _15b=(_155.getAttribute("dttargets")!=null);
var _15c=(_159.getAttribute("CTNM")!=null&&_156.getMun(_158)!=""&&_156.getUsageInfo(_158)!="2");
if(_15b||_15c){
_157=_154.getAction("DrillUpDownOrThrough");
_157.init(_15b,_15c);
_157.updateDrillabilityInfo(_154,_155);
}else{
_157=_154.getAction("RenameDataItem");
}
break;
case "datavalue":
case "chartElement":
case "ordinalAxisLabel":
case "legendLabel":
case "legendTitle":
case "ordinalAxisTitle":
var _15b=(_155.getAttribute("dttargets")!=null);
var _15c=(_156.getHun(_158)!="");
if(_15b||_15c){
_157=_154.getAction("DrillUpDownOrThrough");
_157.init(_15b,_15c);
_157.updateDrillabilityInfo(_154,_155);
}
break;
}
}
if(_157===null){
_157=_154.getAction("Selection");
}
_157.setCognosViewer(_154);
return _157;
};
ActionFactory.prototype.destroy=function(){
delete this.m_cognosViewer;
};
function CSelectionDefaultStyles(_15d){
this.m_primarySelectionColor=null;
this.m_highContrastBorderStyle="solid";
this.m_secondarySelectionIsDisabled=false;
if(_15d){
this.m_selectionController=_15d;
this.m_oCognosViewer=_15d.m_oCognosViewer;
if(this.m_oCognosViewer){
var _15e=this.m_oCognosViewer.getUIConfig();
if(_15e){
if(_15e.getPrimarySelectionColor()){
this.m_primarySelectionColor=_15e.getPrimarySelectionColor();
}
if(!_15e.getShowSecondarySelection()){
this.m_secondarySelectionIsDisabledConfig=true;
}else{
if(_15e.getSeondarySelectionColor()){
this.m_secondarySelectionColor=_15e.getSeondarySelectionColor();
}
}
}
}
}
};
CSelectionDefaultStyles.prototype.getPrimarySelectionColor=function(_15f){
return this.m_primarySelectionColor;
};
CSelectionDefaultStyles.prototype.getSecondarySelectionColor=function(){
return this.m_secondarySelectionColor;
};
CSelectionDefaultStyles.prototype.getHighContrastBorderStyle=function(){
return this.m_highContrastBorderStyle;
};
CSelectionDefaultStyles.prototype.canApplyToSelection=function(_160){
return true;
};
CSelectionDefaultStyles.prototype.secondarySelectionIsDisabled=function(){
return this.m_secondarySelectionIsDisabled;
};
CSelectionDefaultStyles.prototype.setStyleForSelection=function(){
};
function CSelectionFilterStyles(_161){
this.m_selectionController=_161;
this.m_primarySelectionColor=this.m_primarySelectionFilterColor="#44BFDD";
this.m_primarySelectionFilterColorForMeasure=null;
this.m_secondarySelectionColor=null;
this.m_highContrastBorderStyle="dotted";
this.m_secondarySelectionIsDisabled=true;
};
CSelectionFilterStyles.prototype=new CSelectionDefaultStyles();
CSelectionFilterStyles.prototype.getPrimarySelectionColor=function(_162){
return this.m_primarySelectionColor;
};
CSelectionFilterStyles.prototype.getSecondarySelectionColor=function(){
return this.m_secondarySelectionColor;
};
CSelectionFilterStyles.prototype.getHighContrastBorderStyle=function(){
return this.m_highContrastBorderStyle;
};
CSelectionFilterStyles.prototype.secondarySelectionIsDisabled=function(){
return this.m_secondarySelectionIsDisabled;
};
CSelectionFilterStyles.prototype.canApplyToSelection=function(_163){
return !this.selectionHasOnlyMeasure(_163);
};
CSelectionFilterStyles.prototype.selectionHasOnlyMeasure=function(_164){
return (_164.length===1&&_164[0].length===1&&this.m_selectionController.isMeasure(_164[0][0]));
};
CSelectionFilterStyles.prototype.setStyleForSelection=function(_165){
this.m_primarySelectionColor=(this.selectionHasOnlyMeasure(_165))?null:this.m_primarySelectionFilterColor;
};
function CSelectionFilterContextMenuStyles(_166){
CSelectionDefaultStyles.call(this,_166);
this.m_secondarySelectionIsDisabled=true;
};
CSelectionFilterContextMenuStyles.prototype=new CSelectionDefaultStyles();
function CSelectionObject(){
this.initialize();
};
CSelectionObject.prototype.initialize=function(){
this.m_oCellRef={};
this.m_sColumnRef="";
this.m_sColumnName="";
this.m_aDataItems=[];
this.m_aUseValues=[];
this.m_aDisplayValues=[];
this.m_sCellTypeId="";
this.m_sLayoutType="";
this.m_sTag="";
this.m_aMuns=[];
this.m_aRefQueries=[];
this.m_aMetadataItems=[];
this.m_aDrillOptions=[];
this.m_selectionController={};
this.m_contextIds=[];
this.m_ctxAttributeString="";
this.m_fetchedContextIds=false;
this.m_selectedClass=[];
this.m_cutClass=[];
this.m_dataContainerType="";
this.m_oJsonContext=null;
};
CSelectionObject.prototype.isSelectionOnVizChart=function(){
return false;
};
CSelectionObject.prototype.getCellRef=function(){
return this.m_oCellRef;
};
CSelectionObject.prototype.getColumnRP_Name=function(){
if(this.m_oCellRef!=null){
return this.m_oCellRef.getAttribute("rp_name");
}
};
CSelectionObject.prototype.getColumnRef=function(){
return this.m_sColumnRef;
};
CSelectionObject.prototype.getColumnName=function(){
if(this.m_sColumnName==""){
if(this.m_selectionController.hasContextData()&&this.m_contextIds.length){
this.m_sColumnName=this.m_selectionController.getRefDataItem(this.m_contextIds[0][0]);
}
}
return this.m_sColumnName;
};
CSelectionObject.prototype.getDataItemDisplayValue=function(_167){
var _168=this.getDataItems();
var item="";
if(_168&&_168[0]&&_168[0][0]){
item=this.getDataItems()[0][0];
if(_167&&_167.itemInfo&&_167.itemInfo.length){
var _16a=_167.itemInfo;
for(var i=0;i<_16a.length;i++){
if(_16a[i].item===item&&_16a[i].itemLabel){
return _16a[i].itemLabel;
}
}
}
}
return item;
};
CSelectionObject.prototype.getDataItems=function(){
if(!this.m_aDataItems.length){
this.fetchContextIds();
for(var i=0;i<this.m_contextIds.length;++i){
this.m_aDataItems[this.m_aDataItems.length]=[];
for(var j=0;j<this.m_contextIds[i].length;++j){
var _16e=this.m_contextIds[i][j];
this.m_aDataItems[this.m_aDataItems.length-1].push(this.m_selectionController.isContextId(_16e)?this.m_selectionController.getRefDataItem(_16e):"");
}
}
}
return this.m_aDataItems;
};
CSelectionObject.prototype.getUseValues=function(){
if(!this.m_aUseValues.length){
this.fetchContextIds();
for(var i=0;i<this.m_contextIds.length;++i){
this.m_aUseValues[this.m_aUseValues.length]=[];
for(var j=0;j<this.m_contextIds[i].length;++j){
var _171=this.m_contextIds[i][j];
this.m_aUseValues[this.m_aUseValues.length-1].push(this.m_selectionController.isContextId(_171)?this.m_selectionController.getUseValue(_171):"");
}
}
}
return this.m_aUseValues;
};
CSelectionObject.prototype.getCellTypeId=function(){
return this.m_sCellTypeId;
};
CSelectionObject.prototype.getDisplayValues=function(){
return this.m_aDisplayValues;
};
CSelectionObject.prototype.getLayoutType=function(){
return this.m_sLayoutType;
};
CSelectionObject.prototype.getTag=function(){
return this.m_sTag;
};
CSelectionObject.prototype.getMuns=function(){
if(!this.m_aMuns.length){
this.fetchContextIds();
for(var i=0;i<this.m_contextIds.length;++i){
this.m_aMuns[this.m_aMuns.length]=[];
for(var j=0;j<this.m_contextIds[i].length;++j){
var _174=this.m_contextIds[i][j];
this.m_aMuns[this.m_aMuns.length-1].push(this.m_selectionController.isContextId(_174)?this.m_selectionController.getMun(_174):"");
}
}
}
return this.m_aMuns;
};
CSelectionObject.prototype.getRefQueries=function(){
if(!this.m_aRefQueries.length){
this.fetchContextIds();
for(var i=0;i<this.m_contextIds.length;++i){
this.m_aRefQueries[this.m_aRefQueries.length]=[];
for(var j=0;j<this.m_contextIds[i].length;++j){
var _177=this.m_contextIds[i][j];
this.m_aRefQueries[this.m_aRefQueries.length-1].push(this.m_selectionController.isContextId(_177)?this.m_selectionController.getRefQuery(_177):"");
}
}
}
return this.m_aRefQueries;
};
CSelectionObject.prototype.getDimensionalItems=function(_178){
var _179=[];
this.fetchContextIds();
for(var i=0;i<this.m_contextIds.length;++i){
_179[_179.length]=[];
for(var j=0;j<this.m_contextIds[i].length;++j){
var _17c=this.m_contextIds[i][j];
var _17d="";
if(this.m_selectionController.isContextId(_17c)){
switch(_178){
case "hun":
_17d=this.m_selectionController.getHun(_17c);
break;
case "lun":
_17d=this.m_selectionController.getLun(_17c);
break;
case "dun":
_17d=this.m_selectionController.getDun(_17c);
break;
}
}
_179[_179.length-1].push(_17d);
}
}
return _179;
};
CSelectionObject.prototype.getMetadataItems=function(){
if(!this.m_aMetadataItems.length){
this.fetchContextIds();
for(var i=0;i<this.m_contextIds.length;++i){
this.m_aMetadataItems[this.m_aMetadataItems.length]=[];
for(var j=0;j<this.m_contextIds[i].length;++j){
var _180=this.m_contextIds[i][j];
var _181="";
if(this.m_selectionController.isContextId(_180)){
var sLun=this.m_selectionController.getLun(_180);
var sHun=this.m_selectionController.getHun(_180);
if(sLun&&sLun!=""){
_181=sLun;
}else{
if(sHun&&sHun!=""){
_181=sHun;
}else{
_181=this.m_selectionController.getQueryModelId(_180);
}
}
}
this.m_aMetadataItems[this.m_aMetadataItems.length-1].push(_181);
}
}
}
return this.m_aMetadataItems;
};
CSelectionObject.prototype.getDrillOptions=function(){
if(!this.m_aDrillOptions.length){
this.fetchContextIds();
for(var i=0;i<this.m_contextIds.length;++i){
this.m_aDrillOptions[this.m_aDrillOptions.length]=[];
for(var j=0;j<this.m_contextIds[i].length;++j){
var _186=this.m_contextIds[i][j];
this.m_aDrillOptions[this.m_aDrillOptions.length-1].push(this.m_selectionController.isContextId(_186)?this.m_selectionController.getDrillFlag(_186):0);
}
}
}
return this.m_aDrillOptions;
};
CSelectionObject.prototype.getSelectedContextIds=function(){
return this.m_contextIds;
};
CSelectionObject.prototype.fetchContextIds=function(){
if(!this.m_fetchedContextIds&&this.m_contextIds.length&&this.m_selectionController.hasContextData()){
var _187=[];
for(var i=0;i<this.m_contextIds.length;i++){
for(var j=0;j<this.m_contextIds[i].length;j++){
_187.push(this.m_contextIds[i][j]);
}
}
this.m_selectionController.fetchContextData(_187);
this.m_fetchedContextIds=true;
}
};
CSelectionObject.prototype.setSelectionController=function(sc){
if(sc){
this.m_selectionController=sc;
}
};
CSelectionObject.prototype.getLayoutElementId=function(){
return this.m_layoutElementId;
};
CSelectionObject.prototype.hasContextInformation=function(){
for(var i=0;i<this.m_contextIds.length;i++){
for(var j=0;j<this.m_contextIds[i].length;j++){
if(this.m_contextIds[i][j].length>0){
return true;
}
}
}
return false;
};
CSelectionObject.prototype.isHomeCell=function(){
var _18d=this.getCellRef().className;
if(_18d&&(_18d=="xm"||_18d.indexOf("xm ")!=-1||_18d.indexOf(" xm")!=-1)){
return true;
}
return false;
};
CSelectionObject.prototype.getDataContainerType=function(){
return this.m_dataContainerType;
};
CSelectionObject.prototype.getContextJsonObject=function(_18e,_18f){
if(this.m_oJsonContext===null){
var _190={};
var _191=[];
var _192=null;
this.getDataItems();
this.getUseValues();
if(this.m_contextIds.length==0){
return null;
}
var i=0,j=0;
var _195=this._getBestPossibleItemName(this.m_aDataItems[i][j],this.m_contextIds[i][j],_18e);
_192=_195;
this._populateJsonContextObj(_195,this.m_aUseValues[i][j],_18e.getDisplayValue(this.m_contextIds[i][j]),_18e.getMun(this.m_contextIds[i][j]),_190,_191);
j++;
for(;i<this.m_aDataItems.length;i++,j=0){
for(;j<this.m_aDataItems[i].length;j++){
_195=this._getBestPossibleItemName(this.m_aDataItems[i][j],this.m_contextIds[i][j],_18e);
if(!_192){
_192=_195;
}
this._populateJsonContextObj(_195,this.m_aUseValues[i][j],_18e.getDisplayValue(this.m_contextIds[i][j]),_18e.getMun(this.m_contextIds[i][j]),_190,_191);
}
}
this.m_oJsonContext=this._createGenericPayloadStructureJson(_192,_190,_191,_18f);
}
return this.m_oJsonContext;
};
CSelectionObject.prototype._getBestPossibleItemName=function(_196,_197,_198){
var _199=null;
if(_198.isMeasure(_197)){
if(!_198.isValidColumnTitle(this.m_oCellRef)){
if(!_198.isRelational([_197])){
_199=_198.getCCDManager().GetBestPossibleDimensionMeasureName(_197);
}
return (_199)?_199:_196;
}
}
_199=_198.getCCDManager().GetBestPossibleItemName(_197);
return (_199)?_199:_196;
};
CSelectionObject.prototype._isTypeColumnTitle=function(){
if(this.m_oCellRef&&typeof this.m_oCellRef.getAttribute=="function"){
return (this.m_oCellRef.getAttribute("type")==="columnTitle");
}
return false;
};
CSelectionObject.prototype._populateJsonContextObj=function(_19a,_19b,_19c,mun,_19e,_19f){
if(_19e&&_19f&&_19a&&typeof _19e[_19a]=="undefined"){
var _1a0=_19c?_19c:_19b;
_19e[_19a]=[_1a0];
var _1a1={};
if(_19c){
_1a1["caption"]=_19c;
}
if(mun){
_1a1["mun"]=mun;
}
if(_19b){
_1a1["use"]=_19b;
}
_19f.push(_1a1);
}
};
CSelectionObject.prototype._createGenericPayloadStructureJson=function(_1a2,_1a3,_1a4,_1a5){
if(_1a2&&_1a3&&_1a4){
var _1a6=(_1a5)?_1a5:".";
var _1a7={};
_1a7[_1a6]={"values":_1a4};
var obj={"com.ibm.widget.context":{"values":_1a3},"com.ibm.widget.context.report.select":{"select":{"selectedItem":_1a2,"itemSpecification":_1a7}}};
return obj;
}
return null;
};
CSelectionObject.prototype.populateSelectionPayload=function(_1a9,_1aa,_1ab){
this.getDataItems();
this.getUseValues();
if(this.m_contextIds.length==0){
return false;
}
_1ab=((_1ab===undefined)?false:_1ab);
var _1ac=this.m_selectionController;
for(var i=0,j=0;i<this.m_aDataItems.length;i++,j=0){
var _1af=(_1ab?1:this.m_aDataItems[i].length);
for(;j<_1af;j++){
if(!_1ac.isMeasure(this.m_contextIds[i][j])){
var _1b0=this.m_aDataItems[i][j];
this._populateItemInSelectionPayload(_1b0,this.m_aUseValues[i][j],_1ac.getDisplayValue(this.m_contextIds[i][j]),_1ac.getMun(this.m_contextIds[i][j]),_1a9,_1aa);
}
}
}
return true;
};
CSelectionObject.prototype._populateItemInSelectionPayload=function(_1b1,_1b2,_1b3,mun,_1b5,_1b6){
if(_1b5&&_1b1){
var _1b7=_1b2?_1b2:_1b3;
if(_1b5[_1b1]){
_1b5[_1b1].push(_1b7);
}else{
_1b5[_1b1]=[_1b7];
}
var _1b8={};
_1b8["caption"]=_1b7;
if(mun){
_1b8["mun"]=mun;
}
var _1b9=_1b6[_1b1];
if(!_1b9){
_1b9={"values":[]};
_1b6[_1b1]=_1b9;
}
_1b9.values.push(_1b8);
}
};
CSelectionObject.prototype.getCtxAttributeString=function(){
return this.m_ctxAttributeString;
};
CSelectionObject.prototype.isDataValueOrChartElement=function(){
return (this.m_sLayoutType==="datavalue"||this.m_sLayoutType==="chartElement");
};
CSelectionObject.prototype.marshal=function(_1ba,_1bb){
if(!this.m_oJsonForMarshal){
var _1bc={};
var _1bd=[];
var _1be=null;
this.getDataItems();
this.getUseValues();
if(this.m_contextIds.length==0){
return null;
}
var i=0,j=0;
if(this.m_contextIds[i][j].length==0){
var _1c1=false;
do{
for(;j<this.m_contextIds[i].length;j++){
if(this.m_contextIds[i][j].length>0){
_1c1=true;
break;
}
}
if(!_1c1){
j=0;
i++;
}
}while(!_1c1);
}
var _1c2=this._getBestPossibleItemName(this.m_aDataItems[i][j],this.m_contextIds[i][j],_1ba);
var _1c3=_1ba.isMeasure(this.m_contextIds[i][j]);
var _1c4=this._getBestPossibleItemReference(this.m_contextIds[i][j],_1c3,_1ba.getCCDManager());
var _1c5=_1ba.getCCDManager().GetQuery(this.m_contextIds[i][j]);
var _1c6=this.isDataValueOrChartElement();
var _1c7=this._populateJsonForMarshal(_1c2,_1c4,_1c3,this.m_aUseValues[i][j],_1ba.getDisplayValue(this.m_contextIds[i][j]),_1ba.getMun(this.m_contextIds[i][j]),_1c6);
j++;
var _1c8=[];
for(;i<this.m_aDataItems.length;i++,j=0){
for(;j<this.m_aDataItems[i].length;j++){
_1c2=this._getBestPossibleItemName(this.m_aDataItems[i][j],this.m_contextIds[i][j],_1ba);
_1c3=_1ba.isMeasure(this.m_contextIds[i][j]);
_1c4=this._getBestPossibleItemReference(this.m_contextIds[i][j],_1c3,_1ba.getCCDManager());
var _1c9=this._populateJsonForMarshal(_1c2,_1c4,_1c3,this.m_aUseValues[i][j],_1ba.getDisplayValue(this.m_contextIds[i][j]),_1ba.getMun(this.m_contextIds[i][j]));
if(_1c9){
_1c8.push(_1c9);
}
}
}
var lid=(typeof this.getArea=="function")?getImmediateLayoutContainerId(this.getArea()):getImmediateLayoutContainerId(this.getCellRef());
if(lid&&lid.indexOf(_1bb)>0){
lid=lid.substring(0,lid.indexOf(_1bb)-1);
}
this.m_oJsonForMarshal={"lid":lid,"query":_1c5,"selectedItem":_1c7,"context":_1c8};
}
return this.m_oJsonForMarshal;
};
CSelectionObject.prototype._populateJsonForMarshal=function(_1cb,_1cc,_1cd,_1ce,_1cf,mun,_1d1){
if(_1cb){
var _1d2={};
_1d2["itemName"]=_1cb;
_1d2["isMeasure"]=_1cd?"true":"false";
_1d2["mdProperty"]=_1cc.mdProperty;
_1d2["mdValue"]=_1cc.mdValue;
_1d2["isDataValueOrChartElement"]=_1d1?"true":"false";
if(mun){
_1d2["mun"]=mun;
}
if(_1ce){
_1d2["use"]=_1ce;
}
return _1d2;
}
return null;
};
CSelectionObject.prototype._getBestPossibleItemReference=function(_1d3,_1d4,_1d5){
var _1d6=null;
var _1d7=null;
if(_1d4){
_1d7="i";
_1d6=_1d5.GetQMID(_1d3);
if(_1d6==null){
_1d7="m";
_1d6=_1d5.GetMUN(_1d3);
}
if(_1d6==null){
_1d7="r";
_1d6=_1d5.GetRDIValue(_1d3);
}
}else{
_1d7="l";
_1d6=_1d5.GetLUN(_1d3);
if(_1d6==null){
_1d7="h";
_1d6=_1d5.GetHUN(_1d3);
}
if(_1d6==null){
_1d7="i";
_1d6=_1d5.GetQMID(_1d3);
}
if(_1d6==null){
_1d7="r";
_1d6=_1d5.GetRDIValue(_1d3);
}
}
return {"mdProperty":_1d7,"mdValue":_1d6};
};
CSelectionChartObject.prototype=new CSelectionObject();
CSelectionChartObject.prototype.constructor=CSelectionChartObject;
CSelectionChartObject.baseclass=CSelectionObject.prototype;
function CSelectionChartObject(){
CSelectionChartObject.baseclass.initialize.call(this);
this.m_chartArea=null;
this.m_context="";
this.m_chartCtxAreas=[];
this.m_selectedVizChart=false;
};
CSelectionChartObject.prototype.isSelectionOnVizChart=function(){
return this.m_selectedVizChart;
};
CSelectionChartObject.prototype.setSelectionOnVizChart=function(_1d8){
var _1d9=this.m_selectionController.getSelectedChartImageFromChartArea(_1d8);
if(_1d9){
this.m_selectedVizChart=_1d9.parentNode.getAttribute("vizchart")=="true"?true:false;
}
};
CSelectionChartObject.prototype.getArea=function(){
return this.m_chartArea;
};
CSelectionChartObject.prototype.getContext=function(){
return this.m_context;
};
CSelectionChartObject.prototype.getCtxAreas=function(){
return this.m_chartCtxAreas;
};
CSelectionChartObject.prototype.setCtxAreas=function(_1da){
this.m_chartCtxAreas=_1da;
};
CSelectionChartObject.prototype.getCtxAttributeString=function(){
return this.m_context;
};
function CChartHelper(_1db,_1dc,_1dd){
var _1de=_1db.parentNode;
this.m_selectionObjectFactory=_1dc;
this.m_map=_1de;
_1dd.loadExtra();
this.imageMapHighlighter=new CImageMapHighlight(_1de,_1dd.sWebContentRoot);
this.initialize();
};
CChartHelper.prototype.initialize=function(){
this.buildMapCtxAreas();
this.m_chartCtxNodes={};
};
CChartHelper.prototype.buildMapCtxAreas=function(){
var _1df={};
var _1e0=this.m_map.childNodes;
var _1e1=_1e0.length;
var _1e2=null;
for(var i=0;i<_1e1;i++){
var a=_1e0[i];
_1e2=a.getAttribute("ctx");
if(_1e2){
if(_1df[_1e2]){
_1df[_1e2].push(a);
}else{
_1df[_1e2]=[a];
}
}
}
this.m_ctxAreas=_1df;
};
CChartHelper.prototype.getChartNode=function(_1e5){
if(!this.isAreaInitialized(_1e5)){
var _1e6=_1e5.parentNode;
this.m_map=_1e6;
this.initialize();
this.imageMapHighlighter.initialize(_1e6);
}
var _1e7=_1e5.getAttribute("ctx");
if(!this.m_chartCtxNodes[_1e7]){
this.m_chartCtxNodes[_1e7]=this.m_selectionObjectFactory.getSelectionChartObject(_1e5);
this.m_chartCtxNodes[_1e7].setCtxAreas(this.m_ctxAreas[_1e7]);
}
return this.m_chartCtxNodes[_1e7];
};
CChartHelper.prototype.isAreaInitialized=function(_1e8){
return this.imageMapHighlighter.isAreaInitialized(_1e8);
};
CChartHelper.prototype.getImageMapHighlighter=function(){
return this.imageMapHighlighter;
};
function CSelectionObjectFactory(_1e9){
this.m_selectionController=_1e9;
};
CSelectionObjectFactory.prototype.getSelectionController=function(){
return this.m_selectionController;
};
CSelectionObjectFactory.prototype.getChildSpans=function(_1ea){
var _1eb=[];
for(var i=0;i<_1ea.childNodes.length;i++){
var _1ed=_1ea.childNodes[i];
if(!_1ed.getAttribute||_1ed.getAttribute("skipSelection")!="true"){
_1eb.push(_1ea.childNodes[i]);
}
}
var _1ee=_1ea;
var _1ef="";
while(!_1ef&&_1ee){
_1ef=_1ee.attributes?_1ee.attributes["LID"]:"";
_1ee=_1ee.parentNode;
}
_1ef=_1ef?_1ef.value:"";
var _1f0=[];
while(_1eb.length>0){
var _1ed=_1eb.pop();
var lid=_1ed.attributes?_1ed.attributes["LID"]:"";
lid=lid?lid.value:"";
if(!lid||lid==_1ef){
if(_1ed.nodeName.toLowerCase()=="span"){
_1f0.push(_1ed);
}else{
for(i=0;i<_1ed.childNodes.length;i++){
_1eb.push(_1ed.childNodes[i]);
}
}
}
}
return _1f0;
};
CSelectionObjectFactory.prototype.getSelectionObject=function(_1f2,_1f3){
var _1f4=new CSelectionObject();
try{
_1f4.setSelectionController(this.getSelectionController());
_1f4.m_oCellRef=_1f2;
_1f4.m_sColumnRef=_1f2.getAttribute("cid");
_1f4.m_sCellTypeId=_1f2.getAttribute("uid");
_1f4.m_sLayoutType=_1f2.getAttribute("type");
_1f4.m_sTag=_1f2.getAttribute("tag");
_1f4.m_layoutElementId=this.getLayoutElementId(_1f2);
_1f4.m_dataContainerType=this.getContainerType(_1f2);
if(typeof cf!="undefined"){
var _1f5=cf.cfgGet("MiniQueryObj");
if(_1f5){
var _1f6=_1f5.findChildWithAttribute("tag",_1f4.m_sTag);
if(_1f6&&_1f6.getAttribute("id")!=null){
_1f4.m_sColumnName=_1f6.getAttribute("id");
}
}
}
var _1f7=this.getChildSpans(_1f2);
if(_1f7.length>0){
for(var i=0;i<_1f7.length;i++){
var _1f9=_1f7[i];
if(_1f9.nodeType==1&&_1f9.nodeName.toLowerCase()=="span"&&_1f9.style.visibility!="hidden"){
var _1fa=null;
if(_1f2.getAttribute("ctx")!=null&&_1f2.getAttribute("ctx")!=""){
_1fa=_1f2;
}else{
if(_1f9.getAttribute("ctx")!=null&&_1f9.getAttribute("ctx")!=""){
_1fa=_1f9;
}else{
if(_1f9.getAttribute("dtTargets")&&_1f9.childNodes&&_1f9.childNodes.length){
for(var _1fb=0;_1fb<_1f9.childNodes.length;_1fb++){
if(_1f9.childNodes[_1fb].nodeType==1&&_1f9.childNodes[_1fb].style.visibility!="hidden"){
_1fa=_1f9.childNodes[_1fb];
}
}
}else{
for(var _1fc=0;_1fc<_1f9.childNodes.length;_1fc++){
var _1fd=_1f9.childNodes[_1fc];
if(typeof _1fd.getAttribute!="undefined"&&_1fd.getAttribute("ctx")!=null&&_1fd.getAttribute("ctx")!=""){
_1fa=_1fd;
break;
}
}
}
}
}
var _1fe="";
if(_1fa&&_1fa.getAttribute("ctx")){
_1fe=_1fa.getAttribute("ctx");
}
_1f4.m_aDisplayValues[_1f4.m_aDisplayValues.length]=this.getSelectionController().getDisplayValue(_1fe,_1f2.parentNode);
if(typeof _1f3!="undefined"&&_1f3!=_1fe){
continue;
}
_1f4=this.processCTX(_1f4,_1fe);
}
}
}else{
if(_1f2.getAttribute("ctx")!=null&&_1f2.getAttribute("ctx")!=""&&_1f4.m_sLayoutType=="datavalue"){
_1f4=this.processCTX(_1f4,_1f2.getAttribute("ctx"));
}
}
this.getSelectionController().processColumnTitleNode(_1f4);
}
catch(ex){
}
return _1f4;
};
CSelectionObjectFactory.prototype.processCTX=function(_1ff,_200){
if(typeof _200!="string"||_200.length==0){
return _1ff;
}
var ctx;
if(typeof _1ff.m_contextIds=="object"&&_1ff.m_contextIds!==null&&_1ff.m_contextIds.length>0){
var _202=_200.split("::");
for(ctx=0;ctx<_1ff.m_contextIds.length;++ctx){
try{
if(_202[ctx]){
_1ff.m_contextIds[ctx]=_1ff.m_contextIds[ctx].concat(_202[ctx].split(":"));
}
}
catch(e){
}
}
}else{
_1ff.m_contextIds=this.m_selectionController.m_oCognosViewer.getReportContextHelper().processCtx(_200);
}
_1ff.m_ctxAttributeString=_200;
return _1ff;
};
CSelectionObjectFactory.prototype.getSecondarySelectionObject=function(tag,_204,_205){
if(!_205){
_205=document;
}
var _206=new CSelectionObject();
_206.setSelectionController(this.getSelectionController());
_206.m_oCellRef=null;
_206.m_sColumnRef=null;
_206.m_sCellTypeId=null;
_206.refQuery="";
var _207=_205.getElementsByTagName("td");
for(var i=0;i<_207.length;i++){
var _209=_207[i].getAttribute("tag");
if(_209!=null&&_209!=""){
if(tag==_209){
var _20a=_207[i].className;
if(_20a!=null&&_209!=""){
if((_204=="columnTitle"&&_20a=="lt")||(_204=="datavalue"&&_20a=="lc")){
_206.m_sColumnRef=_207[i].getAttribute("cid");
_206.m_sCellTypeId=_207[i].getAttribute("uid");
break;
}
}
}
}
}
if(_206.m_sCellTypeId==null){
return null;
}
return _206;
};
CSelectionObjectFactory.prototype.getSelectionChartObject=function(_20b){
var _20c="";
if(_20b.getAttribute("flashChart")!=null){
if(typeof _20b.getCtx!="undefined"){
try{
_20c=_20b.getCtx();
}
catch(e){
_20c="";
}
}
}else{
_20c=_20b.getAttribute("ctx");
}
var _20d=new CSelectionChartObject();
_20d.setSelectionController(this.getSelectionController());
if(_20c!=null){
_20d.m_contextIds=_20c.split("::");
for(var ctx=0;ctx<_20d.m_contextIds.length;++ctx){
_20d.m_contextIds[ctx]=_20d.m_contextIds[ctx].split(":");
}
}
_20d.m_layoutElementId=this.getLayoutElementId(_20b);
_20d.m_sLayoutType=_20b.getAttribute("type");
_20d.m_chartArea=_20b;
_20d.m_context=_20c;
_20d.setSelectionOnVizChart(_20b);
return _20d;
};
CSelectionObjectFactory.prototype.getContainerTypeFromClass=function(_20f){
var _210="";
switch(_20f){
case "ls":
_210="list";
break;
case "xt":
_210="crosstab";
break;
case "rt":
_210="repeaterTable";
break;
}
return _210;
};
CSelectionObjectFactory.prototype.getContainerType=function(el){
var type="";
if(el){
if(el.className){
type=this.getContainerTypeFromClass(el.className);
}
if(!type){
var _213=el.parentNode;
if(_213){
type=this.getContainerType(_213);
}
}
}
return type;
};
CSelectionObjectFactory.prototype.getLayoutElementId=function(el){
var id="";
var _216=this.getSelectionController().getNamespace();
if(el){
if(el.getAttribute&&el.getAttribute("chartcontainer")=="true"){
for(var _217=0;_217<el.childNodes.length;_217++){
var _218=el.childNodes[_217];
if(_218.nodeName.toLowerCase()=="img"&&_218.getAttribute("lid")!=null){
return _218.getAttribute("lid");
}
}
}
id=(el.getAttribute&&el.getAttribute("LID"))||"";
if(!id){
var _219=el.parentNode;
if(_219){
id=this.getLayoutElementId(_219);
}
}else{
if(el.tagName.toUpperCase()=="MAP"){
id=id.replace(_216,"");
id=_216+id;
var _21a="#"+id;
var _21b=getElementsByAttribute(el.parentNode,"IMG","usemap",_21a);
if(_21b.length>0){
id=_21b[0].getAttribute("LID");
}
}
}
}
return id;
};
function CSelectionController(_21c,_21d){
this.m_bSelectionBasedFeaturesEnabled=false;
this.m_bDrillUpDownEnabled=false;
this.m_bModelDrillThroughEnabled=false;
this.m_oCognosViewer=null;
this.m_bSavedSelections=false;
if(_21d){
this.m_oCognosViewer=_21d;
}
this.initialize(_21c);
this.FILTER_SELECTION_STYLE=0;
this.FILTER_SELECTION_CONTEXT_MENU_STYLE=1;
};
CSelectionController.prototype.initialize=function(_21e){
this.m_sNamespace=_21e;
this.m_aCutColumns=[];
this.m_aSelectedObjects=[];
this.m_selectedClass=[];
this.m_cutClass=[];
this.m_oObserver=new CObserver(this);
this.m_bSelectionArraysSetup=false;
this.m_aSelectionHoverNodes=[];
this.m_bUsingCCDManager=false;
this.m_aReportMetadataArray=[];
this.m_aReportContextDataArray=[];
this.m_oCDManager=new CCDManager();
this.m_oSelectionObjectFactory=new CSelectionObjectFactory(this);
this.m_selectedChartArea=null;
this.m_selectedChartNodes=[];
this.m_selectionContainerMap=null;
this.m_chartHelpers={};
if(this.m_oCognosViewer!=null){
this.m_oCDManager.SetCognosViewer(this.m_oCognosViewer);
}
this.m_maxSecondarySelection=-1;
this.c_usageMeasure="2";
this.m_ccl_dateTypes={59:"dateTime",60:"interval"};
this.m_selectionStyles=new CSelectionDefaultStyles(this);
this.m_originalSelectionStyles=this.m_selectionStyles;
this.m_bAllowHorizontalDataValueSelection=false;
};
CSelectionController.prototype.secondarySelectionIsDisabled=function(){
return this.m_selectionStyles.secondarySelectionIsDisabled();
};
CSelectionController.prototype.getPrimarySelectionColor=function(){
return this.m_selectionStyles.getPrimarySelectionColor();
};
CSelectionController.prototype.getHighContrastBorderStyle=function(){
return this.m_selectionStyles.getHighContrastBorderStyle();
};
CSelectionController.prototype.getSecondarySelectionColor=function(){
return this.m_selectionStyles.getSecondarySelectionColor();
};
CSelectionController.prototype.resetSelectionStyles=function(){
this.setSelectionStyles();
};
CSelectionController.prototype.setSelectionStyles=function(_21f){
switch(_21f){
case this.FILTER_SELECTION_STYLE:
if(!this.m_selectionFilterStyles){
this.m_selectionFilterStyles=new CSelectionFilterStyles(this);
}
this.m_selectionStyles=this.m_selectionFilterStyles;
break;
case this.FILTER_SELECTION_CONTEXT_MENU_STYLE:
if(!this.m_selectionFilterContextMenuStyles){
this.m_selectionFilterContextMenuStyles=new CSelectionFilterContextMenuStyles(this);
}
this.m_selectionStyles=this.m_selectionFilterContextMenuStyles;
break;
default:
this.m_selectionStyles=this.m_originalSelectionStyles;
}
};
CSelectionController.prototype.resetAllowHorizontalDataValueSelection=function(){
this.m_bAllowHorizontalDataValueSelection=false;
};
CSelectionController.prototype.setAllowHorizontalDataValueSelection=function(_220){
this.m_bAllowHorizontalDataValueSelection=_220;
};
CSelectionController.prototype.allowHorizontalDataValueSelection=function(){
return this.m_bAllowHorizontalDataValueSelection;
};
CSelectionController.prototype.clearSelectionData=function(){
this.m_aSelectedObjects=[];
this.m_selectedChartNodes=[];
this.m_oSelectedDrillThroughImage=null;
this.m_oSelectedDrillThroughSingleton=null;
};
CSelectionController.prototype.getCCDManager=function(){
return this.m_oCDManager;
};
CSelectionController.prototype.getCtxIdFromDisplayValue=function(_221){
if(!this.m_bUsingCCDManager){
var _222=this.getReportContextDataArray();
var _223=1;
for(var _224 in _222){
var _225=_222[_224];
if(_225[_223]==_221){
return _224;
}
}
return "";
}else{
var sId=this.m_oCDManager.GetContextIdForDisplayValue(_221);
return (sId==null)?"":sId;
}
};
CSelectionController.prototype.getCtxIdFromMetaData=function(sLun,sHun,_229){
return this.m_oCDManager.getContextIdForMetaData(sLun,sHun,_229);
};
CSelectionController.prototype.replaceNamespaceForSharedTM1DimensionOnly=function(lun,hun,mun){
var sLun=lun;
var sHun=hun;
if(mun&&mun.indexOf("->:[TM].")>0){
sLun=this.m_oCDManager._replaceNamespaceForSharedTM1DimensionOnly(lun);
sHun=this.m_oCDManager._replaceNamespaceForSharedTM1DimensionOnly(hun);
}
return {"lun":sLun,"hun":sHun};
};
CSelectionController.prototype.getCtxIdFromMun=function(sMun){
if(!this.m_bUsingCCDManager){
var _230=this.getReportMetadataArray();
var _231=0;
for(var sKey in _230){
var _233=_230[sKey];
if(_233[_231]==sMun){
var _234=2;
var _235=this.getReportContextDataArray();
for(var _236 in _235){
var _237=_235[_236];
if(_237[_234]==sKey){
return _236;
}
}
}
}
return "";
}else{
var sId=this.m_oCDManager.GetContextIdForMUN(sMun);
return (sId==null)?"":sId;
}
};
CSelectionController.prototype.canDrillDown=function(_239){
var _23a=this.getDrillFlagForMember(_239);
return (_23a==3||_23a==2);
};
CSelectionController.prototype.canDrillUp=function(_23b){
var _23c=this.getDrillFlagForMember(_23b);
return (_23c==3||_23c==1);
};
CSelectionController.prototype.getQueryModelId=function(_23d){
var qmid="";
if(!this.m_bUsingCCDManager){
var _23f=this.m_aReportContextDataArray[_23d];
if(_23f&&typeof _23f[3]!="undefined"){
var _240=_23f[3];
var _241=this.m_aReportMetadataArray[_240];
if(typeof _241!="undefined"&&typeof _241[1]!="undefined"&&_241[1]=="I"){
qmid=_241[0];
}
}
}else{
qmid=this.m_oCDManager.GetQMID(_23d);
}
return qmid;
};
CSelectionController.prototype.getRefQuery=function(_242){
if(!this.m_bUsingCCDManager){
return this.getMetaDataItemUseValue(4,_242);
}else{
var _243=this.m_oCDManager.GetQuery(_242);
return (_243==null)?"":_243;
}
};
CSelectionController.prototype.getRefDataItem=function(_244){
return this.m_oCognosViewer.getReportContextHelper().getRefDataItem(_244);
};
CSelectionController.prototype.getMun=function(_245){
return this.m_oCognosViewer.getReportContextHelper().getMun(_245);
};
CSelectionController.prototype.getHun=function(_246){
if(!this.m_bUsingCCDManager){
var sHun=null;
var _248=this.getRDI(_246);
if(_248&&_248.length>4&&_248[1]=="R"){
var _249=_248[4];
var _24a=this.getReportMetadataArray();
_248=_24a[_249];
}
if(_248&&_248.length>1&&_248[1]=="H"){
sHun=_248[0];
}
return sHun;
}else{
return this.m_oCDManager.GetHUN(_246);
}
};
CSelectionController.prototype.fetchContextData=function(_24b,_24c){
var _24d=0;
if(this.m_bUsingCCDManager){
_24d=this.m_oCDManager.FetchContextData(_24b,_24c);
}
return _24d;
};
CSelectionController.prototype.getMetaDataItem=function(sKey){
var _24f=this.getReportMetadataArray();
if(typeof _24f[sKey]!="undefined"){
return _24f[sKey];
}
return null;
};
CSelectionController.prototype.getContextDataItem=function(_250){
var _251=this.getReportContextDataArray();
if(typeof _251[_250]!="undefined"){
return _251[_250];
}
return null;
};
CSelectionController.prototype.getMetaDataItemUseValue=function(_252,_253){
var _254=this.getContextDataItem(_253);
if(_254!=null){
var _255=_254[_252];
if(_255!=""){
var _256=this.getMetaDataItem(_255);
if(_256!=null){
return _256[0];
}
}
}
return "";
};
CSelectionController.prototype.getRDI=function(_257){
var _258=this.getContextDataItem(_257);
if(_258!=null){
var _259=_258[0];
if(_259!=""){
var _25a=this.getMetaDataItem(_259);
if(_25a!=null){
return _25a;
}
}
}
};
CSelectionController.prototype.getNamespace=function(){
return this.m_sNamespace;
};
CSelectionController.prototype.setSelectionBasedFeaturesEnabled=function(_25b){
this.m_bSelectionBasedFeaturesEnabled=_25b;
};
CSelectionController.prototype.getSelectionBasedFeaturesEnabled=function(){
return this.m_bSelectionBasedFeaturesEnabled;
};
CSelectionController.prototype.setDrillUpDownEnabled=function(_25c){
this.m_bDrillUpDownEnabled=_25c;
};
CSelectionController.prototype.getDrillUpDownEnabled=function(){
return this.m_bDrillUpDownEnabled;
};
CSelectionController.prototype.setModelDrillThroughEnabled=function(_25d){
this.m_bModelDrillThroughEnabled=_25d;
};
CSelectionController.prototype.getBookletItemForCurrentSelection=function(){
var _25e=this.getAllSelectedObjects();
if(_25e&&_25e.length>0){
var _25f=_25e[0];
if(_25f.hasContextInformation()){
var _260=this.m_oCDManager.GetBIValue(_25f.m_contextIds[0][0]);
if(!_260){
return null;
}
return _260;
}
}
return null;
};
CSelectionController.prototype.getModelPathForCurrentSelection=function(){
var _261=null;
var _262=this.getBookletItemForCurrentSelection();
if(_262){
var _261=this.m_oCDManager.getModelPathFromBookletItem(_262);
}
return _261;
};
CSelectionController.prototype.getModelDrillThroughEnabled=function(){
var _263=this.getBookletItemForCurrentSelection();
if(_263){
var _264=this.m_oCDManager.GetBookletModelBasedDrillThru(_263);
return _264==1?true:false;
}else{
return this.m_bModelDrillThroughEnabled;
}
};
CSelectionController.prototype.clearSelectedObjects=function(_265){
try{
if(!_265){
_265=document;
}
this.updateUI(_265,this.getSelections(),true,false);
this.m_aSelectedObjects=[];
if(typeof this.onSelectionChange=="function"){
this.onSelectionChange();
}
return true;
}
catch(e){
return false;
}
};
CSelectionController.prototype.resetSelections=function(_266){
try{
if(!_266){
_266=document;
}
if(this.hasSelectedChartNodes()){
this.resetChartSelections(_266);
}
this.m_oSelectedDrillThroughImage=null;
this.m_oSelectedDrillThroughSingleton=null;
if(this.getSelections()){
this.updateUI(_266,this.getSelections(),true,false);
this.updateUI(_266,this.getCutColumns(),true,false);
this.m_aCutColumns=[];
this.m_aSelectedObjects=[];
this.m_selectedClass=[];
this.m_cutClass=[];
if(typeof this.onSelectionChange=="function"){
this.onSelectionChange();
}
}
return true;
}
catch(e){
return false;
}
};
CSelectionController.prototype.resetChartSelections=function(_267){
var _268=this.m_chartHelpers;
for(var _269 in _268){
if(_268[_269]){
var _26a=_268[_269].getImageMapHighlighter();
if(_26a.hideAllAreas){
_26a.hideAllAreas();
}
}
}
this.m_selectedChartNodes=[];
this.m_selectionContainerMap=null;
};
CSelectionController.prototype.addSelectionObject=function(_26b,_26c){
try{
if(!_26c){
_26c=document;
}
var _26d=_26b.getCellRef();
if(this.isCellSelected(_26d)!==true||(typeof _26d!="object"||_26d===null)){
if(this.isColumnCut(_26b.getTag())!==true){
this.m_aSelectedObjects[this.m_aSelectedObjects.length]=_26b;
if(typeof this.onSelectionChange=="function"){
this.onSelectionChange();
}
this.updateUI(_26c,this.getSelections(),false,false);
}
}
return true;
}
catch(e){
return false;
}
};
CSelectionController.prototype.removeSelectionObject=function(_26e,_26f){
try{
if(!_26f){
_26f=document;
}
var _270=[];
var _271;
for(_271=0;_271<this.m_aSelectedObjects.length;_271++){
var _272=this.m_aSelectedObjects[_271].getCellRef();
var _273=_26e.getCellRef();
if(typeof _272=="object"&&typeof _273=="object"&&_272!==null&&_273!==null){
if(_272==_273){
_270[_270.length]=_271;
}
}
}
if(_270.length>0){
this.updateUI(_26f,this.getSelections(),true,false);
var _274=[];
for(_271=0;_271<this.m_aSelectedObjects.length;_271++){
var _275=true;
for(var j=0;j<_270.length;j++){
if(_271==_270[j]){
_275=false;
}
}
if(_275){
_274[_274.length]=this.m_aSelectedObjects[_271];
}
}
this.m_aSelectedObjects=_274;
this.updateUI(_26f,this.getSelections(),false,false);
}
if(typeof this.onSelectionChange=="function"){
this.onSelectionChange();
}
return true;
}
catch(e){
return false;
}
};
CSelectionController.prototype.isSavedCellSelected=function(_277){
return this.isCellSelectedHelper(_277,this.getSavedSelectedObjects());
};
CSelectionController.prototype.isCellSelected=function(_278){
return this.isCellSelectedHelper(_278,this.getSelections());
};
CSelectionController.prototype.isCellSelectedHelper=function(_279,_27a){
try{
for(var i=0;i<_27a.length;i++){
var _27c=_27a[i].getCellRef();
if(typeof _27c=="object"&&_27c!==null){
if(_27c==_279){
return true;
}
}
}
}
catch(e){
}
return false;
};
CSelectionController.prototype.isColumnSelected=function(_27d){
try{
for(var i=0;i<this.m_aSelectedObjects.length;i++){
if(this.m_aSelectedObjects[i].getTag()==_27d){
return true;
}
}
}
catch(e){
}
return false;
};
CSelectionController.prototype.isColumnCut=function(_27f){
try{
for(var i=0;i<this.m_aCutColumns.length;i++){
if(this.m_aCutColumns[i].getTag()==_27f){
return true;
}
}
}
catch(e){
}
return false;
};
CSelectionController.prototype.getSelections=function(){
return this.m_aSelectedObjects;
};
CSelectionController.prototype.selectSingleDomNode=function(_281){
this.clearSelectedObjects();
var _282=this.getSelectionObjectFactory().getSelectionObject(_281);
var _283=null;
if(isIE()){
_283=_281.document;
}else{
_283=_281.ownerDocument;
}
this.addSelectionObject(_282,_283);
};
CSelectionController.prototype.hasCutColumns=function(){
if(this.m_aCutColumns.length===0){
return false;
}else{
return true;
}
};
CSelectionController.prototype.setCutColumns=function(_284,_285){
try{
if(!_285){
_285=document;
}
this.updateUI(_285,this.getSelections(),true,false);
this.updateUI(_285,this.getCutColumns(),true,1);
this.m_aCutColumns=[];
if(_284===true){
for(var i=0;i<this.m_aSelectedObjects.length;i++){
this.m_aCutColumns[i]=this.m_aSelectedObjects[i];
}
this.m_aSelectedObjects=[];
}
this.updateUI(_285,this.getCutColumns(),false,2);
return true;
}
catch(e){
return false;
}
};
CSelectionController.prototype.getCutColumns=function(){
return this.m_aCutColumns;
};
CSelectionController.prototype.getObservers=function(){
return this.m_oObserver;
};
CSelectionController.prototype.attachObserver=function(_287){
this.m_oObserver.attach(_287);
};
CSelectionController.prototype.onSelectionChange=function(){
this.getObservers().notify();
};
CSelectionController.prototype.getSelectedColumns=function(_288){
var _289=[];
if(typeof _288=="undefined"){
_288=this.getSelections();
}
var _28a=_288.length;
for(var i=0;i<_28a;i++){
var _28c=_288[i];
var _28d=true;
for(var j=0;j<_289.length;j++){
if(_289[j][0]==_28c.getColumnRef()&&_289[j][1]==_28c.getCellTypeId()){
_28d=false;
break;
}
}
if(_28d){
_289[_289.length]=[_28c.getColumnRef(),_28c.getCellTypeId(),_28c.getLayoutType(),_28c.getTag(),_28c.getColumnName()];
}
}
return _289;
};
CSelectionController.prototype.getAllSelectedObjectsWithUniqueCTXIDs=function(){
var _28f=[];
var _290=this.getAllSelectedObjects();
for(var i=0;i<_290.length;i++){
var _292=false;
var _293=_290[i];
for(var ii=0;ii<_28f.length;ii++){
if(_293.m_contextIds[0][0]==_28f[ii].m_contextIds[0][0]){
_292=true;
break;
}
}
if(!_292){
_28f.push(_293);
}
}
return _28f;
};
CSelectionController.prototype.getAllSelectedObjects=function(){
var _295=this.getSelections();
if(this.hasSelectedChartNodes()){
_295=_295.concat(this.getSelectedChartNodes());
}
return _295;
};
CSelectionController.prototype.getSelectedColumnIds=function(_296){
var _297=[];
if(typeof _296=="undefined"){
_296=this.getSelections();
}
var _298=this.getSelectedColumns(_296);
for(var _299=0;_299<_298.length;_299++){
var _29a=true;
for(var _29b=0;_29b<_297.length;_29b++){
if(_297[_29b]==_298[_299][4]){
_29a=false;
break;
}
}
if(_29a){
_297[_297.length]=_298[_299][4];
}
}
return _297;
};
var STYLE_SELECTION={};
CSelectionController.prototype.selecting=function(c,_29d){
var _29e="."+c+_29d;
var doc=document;
var _2a0=document.getElementById("CVIFrame"+this.m_sNamespace);
if(_2a0){
doc=_2a0.contentWindow.document;
}
var _2a1=doc.createElement("style");
_2a1.setAttribute("type","text/css");
if(_2a1.styleSheet){
_2a1.styleSheet.cssText=_29e;
}else{
_2a1.appendChild(doc.createTextNode(_29e));
}
doc.getElementsByTagName("head").item(0).appendChild(_2a1);
STYLE_SELECTION[c]=_2a1;
};
CSelectionController.prototype.deselecting=function(_2a2){
for(var i=0;i<_2a2.length;++i){
if(STYLE_SELECTION[_2a2[i]]){
var node=STYLE_SELECTION[_2a2[i]];
node.parentNode.removeChild(node);
STYLE_SELECTION[_2a2[i]]=null;
}
}
if(isIE()&&typeof this.m_oCognosViewer.m_viewerFragment!="undefined"){
var _2a5=document.getElementById("CVReport"+this.m_oCognosViewer.getId());
if(_2a5!=null){
var _2a6=_2a5.style.display;
_2a5.style.display="none";
_2a5.style.display=_2a6;
}
}
};
CSelectionController.prototype.showViewerContextMenu=function(){
if(this.hasSelectedChartNodes()){
return true;
}
if(this.m_aSelectedObjects&&this.m_aSelectedObjects.length>0){
return true;
}
return false;
};
function getStyleFromClass(c){
for(var i=0;i<document.styleSheets.length;i++){
var ss=document.styleSheets[i];
var _2aa=(ss.cssRules?ss.cssRules:ss.rules);
for(var j=0;j<_2aa.length;j++){
var cr=_2aa[j];
var _2ad=new RegExp("\\b"+c+"\\b","g");
if(cr.selectorText&&cr.selectorText.match(_2ad)){
return cr;
}
}
}
return 0;
};
CSelectionController.prototype.canUpdateSelection=function(_2ae){
return this.m_selectionStyles.canApplyToSelection(_2ae);
};
CSelectionController.prototype.setStyleForSelection=function(_2af){
return this.m_selectionStyles.setStyleForSelection(_2af);
};
CSelectionController.prototype.updateUI=function(_2b0,_2b1,_2b2,_2b3){
if(!_2b0){
_2b0=document;
}
try{
if(_2b1&&_2b1.length>0){
var _2b4,_2b5,_2b6;
if(_2b3==1||_2b3==2){
if(_2b2){
this.deselecting(this.m_cutClass);
}else{
var _2b7=getStyleFromClass("cutSelection").style.color;
var _2b8=getStyleFromClass("cutSelection").style.backgroundColor;
_2b4=_2b1.length;
for(_2b5=0;_2b5<_2b4;_2b5++){
_2b6=_2b1[_2b5].getCellRef();
var _2b9="cutQS"+_2b6.getAttribute("cid");
this.selecting(_2b9,"\n{ background-color: "+_2b8+"; color: "+_2b7+";}\n");
this.m_cutClass.push(_2b9);
}
}
}else{
if(this.m_oCognosViewer){
this.findSelectionURLs();
_2b6="";
_2b4=_2b1.length;
for(_2b5=0;_2b5<_2b4;_2b5++){
_2b6=_2b1[_2b5].getCellRef();
if(_2b6.getAttribute("oldClassName")!=null){
_2b6.className=_2b6.getAttribute("oldClassName");
_2b6.removeAttribute("oldClassName");
}
this.setStyleForSelection(_2b1[_2b5].m_contextIds);
if(!this.secondarySelectionIsDisabled()||_2b2){
var _2ba=document.getElementById("CVReport"+this.getNamespace());
var _2bb=getElementsByAttribute(_2ba,["td","th"],"name",_2b6.getAttribute("name"),this.m_maxSecondarySelection);
for(var _2bc=0;_2bc<_2bb.length;_2bc++){
var cell=_2bb[_2bc];
if(_2b2){
this.restoreOldBackgroundImage(cell);
}else{
if(cell.getAttribute("oldBackgroundImageStyle")==null){
this.saveOldCellStyles(cell);
this.setSecondarySelectionStyles(cell);
}
}
}
}
this.saveOldCellStyles(_2b6);
if(_2b2){
this.restoreOldBackgroundImage(_2b6);
if(this.m_oCognosViewer.isHighContrast()){
this.restoreOldBorder(_2b6);
this.restoreOldPadding(_2b6);
}
}else{
this.setPrimarySelectionStyles(_2b6);
if(this.m_oCognosViewer.isHighContrast()){
var size=getBoxInfo(_2b6,true);
this.saveOldBorder(_2b6);
this.saveOldPadding(_2b6,size);
var _2bf=3;
var _2c0=size.borderTopWidth+size.paddingTop-_2bf;
var _2c1=size.borderBottomWidth+size.paddingBottom-_2bf;
var _2c2=size.borderLeftWidth+size.paddingLeft-_2bf;
var _2c3=size.borderRightWidth+size.paddingRight-_2bf;
_2b6.style.border=_2bf+"px "+this.getHighContrastBorderStyle()+" black";
_2b6.style.padding=_2c0+"px "+_2c3+"px "+_2c1+"px "+_2c2+"px";
}
}
}
}
}
}
return true;
}
catch(e){
return false;
}
};
CSelectionController.prototype.findSelectionURLs=function(){
if(!(this.sS_backgroundImageURL&&this.pS_backgroundImageURL)){
if(this.m_oCognosViewer.isBux||isSafari()||this.m_oCognosViewer.isMobile()){
this.pS_backgroundImageURL="url(../common/images/selection_primary.png)";
this.sS_backgroundImageURL="url(../common/images/selection_secondary.png)";
}else{
this.pS_backgroundImageURL=this.getBackgroundImage(getStyleFromClass("primarySelection"));
this.sS_backgroundImageURL=this.getBackgroundImage(getStyleFromClass("secondarySelection"));
}
}
};
CSelectionController.prototype.setSelectedChartImgArea=function(_2c4){
var _2c5=true;
var _2c6=_2c4.getAttribute("rsvpChart");
var _2c7=_2c4.parentNode.getAttribute("chartContainer");
if(_2c6!="true"&&_2c7!="true"){
this.m_selectedChartNodes=[];
_2c5=false;
}else{
var _2c8=this.getSelectionObjectFactory().getSelectionChartObject(_2c4);
this.m_selectedChartNodes=[_2c8];
}
return _2c5;
};
CSelectionController.prototype.setSelectedChartArea=function(_2c9,e){
var _2cb=typeof this.m_oCognosViewer.isBux!=="undefined";
var _2cc=false;
if(_2c9!==null){
if(_2c9.tagName=="IMG"){
_2cc=this.setSelectedChartImgArea(_2c9);
}else{
if(_2c9.nodeName=="AREA"&&_2c9.attributes["ctx"]){
_2cc=true;
if(_2cb){
this.setBuxSelectedChartArea(_2c9,e);
}else{
this.m_selectedChartNodes=[this.getSelectionObjectFactory().getSelectionChartObject(_2c9)];
}
}
}
if(_2cc){
this.getObservers().notify();
}
}
return _2cc;
};
CSelectionController.prototype.setBuxSelectedChartArea=function(_2cd,e){
var _2cf=this.getChartHelper(_2cd);
var _2d0=_2cf.getChartNode(_2cd);
this.setStyleForSelection(_2d0.m_contextIds);
var _2d1=_2cf.getImageMapHighlighter();
_2d1.setFillColour(this.getPrimarySelectionColor());
_2d1.setStrokeColour(this.getPrimarySelectionColor());
if(typeof e=="undefined"){
e={};
}
if(this.ctrlKeyPressed(e)||this.shiftKeyPressed(e)){
if(_2d1.isAreaHighlighted(_2cd)){
_2d1.hideAreas(_2d0.getCtxAreas());
var _2d2=_2cd.getAttribute("ctx");
var _2d3=this.m_selectedChartNodes.length;
for(var i=0;i<_2d3;i++){
var _2d5=this.m_selectedChartNodes[i];
if(_2d2==_2d5.getContext()){
this.m_selectedChartNodes.splice(i,1);
break;
}
}
}else{
this.updateSelectionContainer(_2cd);
_2d1.highlightAreas(_2d0.getCtxAreas(),true);
this.m_selectedChartNodes.push(_2d0);
}
}else{
if(this.hasSavedSelectedChartNodes()){
var _2d6=this.m_savedSelectedChartNodes.length;
var _2d7=this.m_savedSelectedChartNodes;
for(var i=0;i<_2d6;i++){
var area=_2d7[i].getArea();
var _2d9=this.getSavedChartHelper(area);
var _2da=_2d9.getImageMapHighlighter();
var _2db=_2da.getAreaId(area);
if(_2d1.getAreaId(_2cd)===_2db){
_2da.hideAreaById(_2db+this.m_savedPrimarySelectionColor);
break;
}
}
}
this.updateSelectionContainer(_2cd);
_2d1.highlightAreas(_2d0.getCtxAreas());
this.m_selectedChartNodes=[_2d0];
}
};
CSelectionController.prototype.updateSelectionContainer=function(_2dc){
var _2dd=_2dc.parentNode;
if(this.m_selectionContainerMap&&this.m_selectionContainerMap.name!=_2dd.name){
var _2de=this.getChartHelper(_2dc).getImageMapHighlighter();
_2de.hideAllAreas();
}
this.m_selectionContainerMap=_2dd;
};
CSelectionController.prototype.getChartHelper=function(_2df){
var _2e0=_2df.parentNode;
var _2e1=_2e0.name;
if(!this.m_chartHelpers[_2e1]){
this.m_chartHelpers[_2e1]=new CChartHelper(_2df,this.getSelectionObjectFactory(),this.m_oCognosViewer);
}
return this.m_chartHelpers[_2e1];
};
CSelectionController.prototype.getSavedChartHelper=function(_2e2){
var _2e3=_2e2.parentNode;
var _2e4=_2e3.name;
return this.m_savedChartHelpers[_2e4];
};
CSelectionController.prototype.getSelectedChartArea=function(){
return this.m_selectedChartArea;
};
CSelectionController.prototype.getSelectedChartNodes=function(){
return this.m_selectedChartNodes;
};
CSelectionController.prototype.hasSelectedChartNodes=function(){
return this.m_selectedChartNodes&&this.m_selectedChartNodes.length&&this.m_selectedChartNodes.length>0;
};
CSelectionController.prototype.getSelectedChartImage=function(){
var _2e5=null;
if(this.hasSelectedChartNodes()){
var _2e6=this.m_selectedChartNodes[0];
_2e5=_2e6.getArea();
}
if(_2e5===null){
return null;
}
if(_2e5.tagName=="IMG"){
return _2e5;
}
return this.getSelectedChartImageFromChartArea(_2e5);
};
CSelectionController.prototype.getSelectedChartImageFromChartArea=function(_2e7){
var _2e8=_2e7.parentNode;
var _2e9="#"+_2e8.getAttribute("name");
return this.checkChildrenForChart(_2e8.parentNode,_2e9);
};
CSelectionController.prototype.checkChildrenForChart=function(_2ea,_2eb){
var _2ec=_2ea.firstChild;
while(_2ec!==null){
if(!_2ec.tagName){
return null;
}else{
if(_2ec.tagName=="IMG"&&_2ec.getAttribute("usemap")==_2eb){
return _2ec;
}else{
if(_2ec.tagName==="DIV"||_2ec.tagName==="SPAN"){
var _2ed=this.checkChildrenForChart(_2ec,_2eb);
if(_2ed){
return _2ed;
}
}
}
}
_2ec=_2ec.nextSibling;
}
return null;
};
CSelectionController.prototype.downloadSelectedChartImage=function(_2ee){
var _2ef=this.getSelectedChartImage();
if(_2ef!==null){
var _2f0=this.getDocumentFromImage(_2ef);
var _2f1=_2ef.name.replace(".","_");
var _2f2=_2f1.substr(5);
var _2f3="?m_name=";
_2f3+=_2f2;
_2f3+="&format=png&b_action=xts.run&m=portal/download.xts&m_obj=";
if(isIE()){
_2f1=_2f0.parentWindow.eval("graphicSrc"+_2f2);
}else{
_2f1=_2f0.defaultView.eval("graphicSrc"+_2f2);
}
var _2f4="";
if(typeof _2f1!="undefined"&&_2f1!==null){
var _2f5=_2f1.split("&");
if(_2f5.length===0){
return;
}
if(_2f1.indexOf("/repository/")<0){
for(var i=0;i<_2f5.length;++i){
var _2f7=_2f5[i];
var _2f8=_2f7.indexOf("=");
if(_2f8!=-1){
var _2f9=_2f7.substr(0,_2f8);
var _2fa=_2f7.slice(_2f8+1);
if(_2f9=="search"){
_2f4+=_2fa;
break;
}
}
}
}
if(_2f4==""){
_2f3=_2ef.getAttribute("src");
if(_2f3.indexOf("?")!=-1){
_2f3+="&download=true";
}else{
_2f3+="?download=true";
}
}
if(typeof getConfigFrame=="function"){
_2f3+=_2f4;
_2f3=getConfigFrame().constructGETRequestParamsString(_2f3);
window.open(_2f3,"_blank","width=0,height=0");
}else{
_2f3=constructGETRequestParamsString(_2f3);
_2f3+=_2f4;
var _2fb=this.m_oCognosViewer.getGateway();
var _2fc=document.getElementById("CVIFrame"+this.m_sNamespace);
if(_2fc){
var _2fd=_2fc.src;
if(_2fd.indexOf("repository")>=0&&_2f3.indexOf("repository")<0){
var _2fe=_2fd.indexOf("content");
_2f3=_2fd.substring(0,_2fe)+_2f3;
}
}
if(_2f3.indexOf(_2fb)==-1){
var _2ff=document.forms["formWarpRequest"+_2ee];
_2f3=_2ff.action+_2f3;
}
if(typeof window.detachLeavingRV=="function"){
window.detachLeavingRV();
}
location.href=_2f3;
if(typeof window.attachLeavingRV=="function"){
setTimeout(window.attachLeavingRV,100);
}
}
}
}
};
CSelectionController.prototype.getDocumentFromImage=function(_300){
var _301=null;
if(_300.ownerDocument){
_301=_300.ownerDocument;
}else{
_301=_300.document;
}
return _301;
};
CSelectionController.prototype.shouldExecutePageClickedOnMouseDown=function(e){
var _303=this.getSelections();
if(_303.length>1){
if(this.m_oCognosViewer.envParams["ui.action"]!=="view"){
var node=getNodeFromEvent(e);
try{
while(node&&(node.nodeType==3||(node.getAttribute&&node.getAttribute("uid")===null))){
node=node.parentNode;
}
}
catch(ex){
}
var _305=this.getSelectionObjectFactory().getContainerType(node);
if(_305==="list"){
for(var i=0;i<_303.length;i++){
if(_303[i].m_oCellRef==node){
return false;
}
}
}
}
}
return true;
};
CSelectionController.prototype.getContainerType=function(){
var _307="";
if(this.hasSelectedChartNodes()){
_307="chart";
}else{
if(this.getDataContainerType()==="list"){
_307="list";
}else{
_307="crosstab";
}
}
return _307;
};
CSelectionController.prototype.getDisplayValues=function(){
var _308={};
var _309=this.getAllSelectedObjects()[0];
if(_309){
var _30a=_309.getSelectedContextIds();
if(_30a){
for(var axis=0;axis<_30a.length;axis++){
var _30c=[];
var _30d=_30a[axis];
for(var _30e=0;_30e<_30d.length;_30e++){
var _30f=_30d[_30e];
var _310=this.getDisplayValue(_30f);
_30c.push(_310);
if(axis===0){
break;
}
}
var _311="";
switch(axis){
case 0:
_311="selected";
break;
case 1:
_311="rows";
break;
default:
_311="columns";
}
_308[_311]=_30c;
}
}
}
return _308;
};
CSelectionController.prototype.getChartTooltip=function(){
var _312=this.getAllSelectedObjects()[0];
if(_312){
var area=_312.getArea();
if(area){
var _314=area.getAttribute("title");
if(_314&&_314.length>0){
return area.getAttribute("title");
}
}
}
return "";
};
CSelectionController.prototype.pageClickedForMobile=function(e){
this.pageClicked(e);
var _316=this.getAllSelectedObjects().length;
if(_316==0){
var node=getNodeFromEvent(e,true);
if(!node){
return false;
}
if(node.nodeName.toLowerCase()=="img"&&node.getAttribute("dttargets")){
this.selectDrillThroughImage(node);
return true;
}else{
if(node.getAttribute("dttargets")){
this.selectDrillThroughSingleton(node);
return true;
}else{
if(node.parentNode&&node.parentNode.getAttribute("dttargets")){
this.selectDrillThroughSingleton(node.parentNode);
return true;
}
}
}
return false;
}
return true;
};
CSelectionController.prototype.clearSavedSelections=function(){
this.m_bSavedSelections=false;
if(this.hasSavedSelectedObjects()){
this.updateUI(null,this.getSavedSelectedObjects(),true,false);
delete (this.m_aSavedSelectedObjects);
}
if(this.hasSavedSelectedChartNodes()){
var _318=this.m_savedChartHelpers;
for(var _319 in _318){
if(_318[_319]){
var _31a=_318[_319].getImageMapHighlighter();
if(_31a.hideAllAreas){
_31a.hideAllAreas();
}
}
}
delete this.m_savedChartHelpers;
delete this.m_savedSelectedChartNodes;
}
};
CSelectionController.prototype.hasSavedSelectedChartNodes=function(){
return (this.m_savedSelectedChartNodes&&this.m_savedSelectedChartNodes.length>0);
};
CSelectionController.prototype.getSavedSelectedChartNodes=function(){
return this.m_savedSelectedChartNodes;
};
CSelectionController.prototype.saveSelections=function(){
this.m_savedSelectionStyles=this.m_selectionStyles;
if(this.m_aSelectedObjects.length>0){
this.m_aSavedSelectedObjects=[];
var _31b=this.m_aSelectedObjects.length;
var temp=[];
for(var i=0;i<_31b;i++){
if(this.isMeasure(this.m_aSelectedObjects[i].m_contextIds[0][0])){
temp.push(this.m_aSelectedObjects[i]);
}else{
this.m_aSavedSelectedObjects.push(this.m_aSelectedObjects[i]);
}
}
this.m_aSelectedObjects=temp;
}
if(this.hasSelectedChartNodes()){
this.m_savedChartHelpers=this.m_chartHelpers;
this.m_chartHelpers={};
this.m_savedSelectedChartNodes=[];
var _31e=this.m_selectedChartNodes.length;
var temp=[];
for(var i=0;i<_31e;i++){
if(this.isMeasure(this.m_selectedChartNodes[i].m_contextIds[0][0])){
var _31f=this.m_selectedChartNodes[i].getArea();
var _320=this.getImageMapName(_31f);
this.m_chartHelpers[_320]=this.m_savedChartHelpers[_320];
delete this.m_savedChartHelpers[_320];
temp.push(this.m_selectedChartNodes[i]);
}else{
this.m_savedSelectedChartNodes.push(this.m_selectedChartNodes[i]);
}
}
this.m_selectedChartNodes=temp;
}
this.m_bSavedSelections=true;
};
CSelectionController.prototype.hasSavedSelections=function(){
return this.m_bSavedSelections;
};
CSelectionController.prototype.hasSavedSelectedObjects=function(){
return (this.m_aSavedSelectedObjects&&this.m_aSavedSelectedObjects.length>0)||this.hasSavedSelectedChartNodes();
};
CSelectionController.prototype.getSavedSelectedObjects=function(){
return this.m_aSavedSelectedObjects;
};
CSelectionController.prototype.getImageMapName=function(_321){
var _322=_321.parentNode;
return _322.name;
};
CSelectionController.prototype.repaintBUXSelectedChartArea=function(_323,_324,_325){
var _326={};
var _327=_323.length;
for(var i=0;i<_327;i++){
var _329=_323[i].getArea();
var _32a=this.getImageMapName(_329);
var _32b;
if(!_326[_32a]){
_32b=(_324)?this.getSavedChartHelper(_329):this.getChartHelper(_329);
_326[_32a]=_32b;
var _32c=_32b.getImageMapHighlighter();
_32c.hideAllAreas();
_32c.setFillColour(this.getPrimarySelectionColor());
_32c.setStrokeColour(this.getPrimarySelectionColor());
}else{
_32b=_326[_32a];
}
var _32d=_323[i].m_contextIds;
if(_325&&_32d.length===1&&_32d[0].length===1&&this.isMeasure(_32d[0][0])){
continue;
}
_32c.highlightAreas(_323[i].getCtxAreas(),1);
}
};
CSelectionController.prototype.repaintSavedSelections=function(){
var _32e=this.m_selectionStyles;
this.m_selectionStyles=this.m_savedSelectionStyles;
var _32f=this.getSavedSelectedChartNodes();
var _330=false;
if(_32f&&_32f.length>0){
bIsChart=true;
}else{
_32f=this.getSavedSelectedObjects();
}
this.repaintSelectionsHelper(_32f,true,_330);
this.resetSelectionStyles();
this.m_selectionStyles=_32e;
};
CSelectionController.prototype.repaintSelections=function(){
var _331=this.getSelectedChartNodes();
var _332=false;
if(_331&&_331.length>0){
_332=true;
}else{
_331=this.getSelections();
}
this.repaintSelectionsHelper(_331,false,_332);
};
CSelectionController.prototype.repaintSelectionsHelper=function(_333,_334,_335){
try{
if(_335){
this.repaintBUXSelectedChartArea(_333,_334);
}else{
this.updateUI(document,_333,true,false);
this.updateUI(document,_333,false,false);
}
}
catch(e){
return false;
}
};
CSelectionController.prototype.resetAll=function(){
this.resetSelectionStyles();
this.clearSavedSelections();
this.resetSelections();
this.resetAllowHorizontalDataValueSelection();
};
CSelectionController.prototype.pageClicked=function(e){
try{
var node=getNodeFromEvent(e);
if(this.m_aSelectedObjects.length>0&&!this.shiftKeyPressed(e)&&!this.ctrlKeyPressed(e)){
var _338=node;
if(!_338.getAttribute("uid")){
var _339=_338.parentNode;
if(_339&&_339.nodeType==1&&typeof _339.getAttribute!="undefined"&&_339.getAttribute("uid")!=null){
_338=_339;
}
}
if(this.isCellSelected(_338)){
if(typeof this.m_oCognosViewer.isBux!=="undefined"){
this.repaintSelections();
}
if(e.button!==0){
return false;
}
}
}
if(node.tagName&&node.tagName.toUpperCase()=="INPUT"){
return true;
}
if((e.keyCode!=null)&&(e.keyCode!=13)&&(e.keyCode!=32)&&(e.keyCode!=27)&&(e.keyCode!=0)&&(e.keyCode!=121)&&(e.keyCode!=93)){
return false;
}
var _33a=getDocumentFromEvent(e);
if(!this.hasContextData()||!this.hasMetadata()){
if(node.nodeName=="AREA"||node.nodeName=="IMG"||(typeof node.getAttribute=="function"&&node.getAttribute("flashChart")!=null)){
this.setSelectedChartArea(node,e);
}
this.getObservers().notify();
return false;
}
if(typeof node.selectedCell!="undefined"){
var _33b=node;
node=node.selectedCell;
_33b.removeAttribute("selectedCell");
}
if(typeof cf!="undefined"&&typeof cf.hidePickers=="function"){
cf.hidePickers();
}
if(e.keyCode==27){
if(typeof g_reportSelectionController!="undefined"){
g_reportSelectionController.clearSelections();
}
this.resetSelections(_33a);
}else{
if(node.nodeName=="AREA"||node.nodeName=="IMG"||(typeof node.getAttribute!="undefined"&&node.getAttribute("flashChart")!=null)){
if(e.button!==2||this.getAllSelectedObjects().length<=1||typeof this.m_oCognosViewer.isBux==="undefined"){
this.selectNode(node,e);
this.setSelectedChartArea(node,e);
}
}else{
if(!(node.firstChild==null&&node.cellIndex==0&&node.parentNode.rowIndex==0&&node.getAttribute("cid")==null)){
var _33c=this.m_oCognosViewer.getViewerWidget();
this.selectNode(node,e);
}
}
}
if(window.gViewerLogger){
window.gViewerLogger.addContextInfo(this);
}
}
catch(e){
}
};
CSelectionController.prototype.getSelectionObjectFactory=function(){
return this.m_oSelectionObjectFactory;
};
CSelectionController.prototype.isDrillLinkOnCrosstabCell=function(node){
return (node.getAttribute("ctx")==null&&node.parentNode.getAttribute("dtTargets")!=null);
};
CSelectionController.prototype.selectObject=function(sMun,sLun,sHun,_341){
var _342=this.getCtxIdFromMun(sMun);
if(_342==""){
_342=this.getCtxIdFromMetaData(sLun,sHun,_341);
}
if(_342!=null&&this.m_oCDManager.GetUsage(_342)!="2"){
var _343=document.getElementById("rt"+this.getNamespace());
if(_343!=null){
var _344=getElementsByAttribute(_343,"*","ctx",_342);
if(_344&&_344.length===0){
var _345=new RegExp("(^|:)"+_342+"(:|$)","i");
_344=getElementsByAttribute(_343,"*","ctx",_342,-1,_345);
}
var _346=null;
if(_344!=null&&_344.length>0){
_346=new CSelectionObject();
_346.setSelectionController(this);
_346.m_sColumnRef=_344[0].getAttribute("cid");
_346.m_sCellTypeId=_344[0].getAttribute("uid");
_346.m_sLayoutType=_344[0].getAttribute("type");
_346.m_sTag=_344[0].getAttribute("tag");
_346.m_layoutElementId=this.m_oSelectionObjectFactory.getLayoutElementId(_344[0]);
_346.m_dataContainerType=this.m_oSelectionObjectFactory.getContainerType(_344[0]);
_346.m_contextIds=[[_342]];
this.m_aSelectedObjects[this.m_aSelectedObjects.length]=_346;
}else{
var _347=getElementsByAttribute(_343,"*","flashChart","true");
if(_347!=null){
for(var _348=0;_348<_347.length;++_348){
var ldx=_347[_348].getLDX();
if(ldx.indexOf("<ctx>"+_342+"</ctx>")!=-1){
_346=new CSelectionObject();
_346.setSelectionController(this);
var lid=_347[_348].getAttribute("lid");
_346.m_layoutElementId=lid.replace(this.m_oCognosViewer.getId(),"");
_346.m_dataContainerType="chart";
_346.m_contextIds=[[_342]];
this.m_aSelectedObjects[this.m_aSelectedObjects.length]=_346;
}
}
}
}
}
}
};
CSelectionController.prototype.buildSelectionObject=function(node,e){
var _34d=null;
try{
while(node.nodeType==3){
node=node.parentNode;
}
if(this.isDrillLinkOnCrosstabCell(node)){
node=node.parentNode;
}
var ctx=node.getAttribute("ctx");
var uid=node.getAttribute("uid");
if((uid==null)&&((ctx!=null)||(node.parentNode&&node.parentNode.nodeType==1&&typeof node.parentNode.getAttribute!="undefined"&&node.parentNode.getAttribute("uid")!=null))){
if(node.nodeName=="IMG"&&(node.src.indexOf("SM=")>-1||(isIE()>-1&&node.src.indexOf("space.gif")>-1))){
return null;
}
node=node.parentNode;
if((node.className.toUpperCase()=="BLOCK"&&node.nodeName.toUpperCase()=="DIV")||(node.getAttribute("dtTargets")!=null)){
node=node.parentNode;
}
uid=node.getAttribute("uid");
}
if(uid!=null){
var _350=node.childNodes;
for(var i=0;i<_350.length;i++){
if(_350[i].nodeName.toUpperCase()=="TABLE"&&(_350[i].className=="ls"||_350[i].className=="xt")){
var trs=_350[i].rows;
for(var j=0;j<trs.length;j++){
var tds=trs[j].cells;
for(var k=0;k<tds.length;k++){
if(tds[k].getAttribute("uid")!=null){
return null;
}
}
}
}
}
if(node.className.toUpperCase()=="REPEATERTABLECELL"&&ctx!=null){
_34d=this.getSelectionObjectFactory().getSelectionObject(node,ctx);
}else{
_34d=this.getSelectionObjectFactory().getSelectionObject(node);
}
}
}
catch(e){
}
return _34d;
};
CSelectionController.prototype.shiftKeyPressed=function(e){
if(e.keyCode=="121"){
return false;
}
if(isSafari()){
if(e.button!=2){
return e.shiftKey?e.shiftKey:false;
}else{
return false;
}
}
return e.shiftKey?e.shiftKey:false;
};
CSelectionController.prototype.ctrlKeyPressed=function(e){
if(isSafari()){
if(e.button!=2){
return e.ctrlKey?e.ctrlKey:false;
}else{
return false;
}
}
return e.ctrlKey?e.ctrlKey:false;
};
CSelectionController.prototype.isSelectionsPreviouslySaved=function(_358){
var _359=false;
if(!this.m_aSavedSelectedObjects||!this.m_aSavedSelectedObjects.length||!_358||!_358.length){
return false;
}
for(var i=0;i<_358.length;i++){
if(this.isSavedCellSelected(_358[i].getCellRef())){
return true;
}
}
return false;
};
CSelectionController.prototype.selectNode=function(node,e){
try{
while(node.nodeType==3){
node=node.parentNode;
}
if(this.isDrillLinkOnCrosstabCell(node)){
node=node.parentNode;
}
var _35d=null;
if(isIE()){
_35d=node.document;
}else{
_35d=node.ownerDocument;
}
var ctx=node.getAttribute("ctx");
var uid=node.getAttribute("uid");
var _360=false;
if(typeof e=="undefined"){
e={};
}
var _361=false;
if(typeof g_reportSelectionController!="undefined"){
_361=this.checkForReportElementNode(node);
}
if((ctx==null&&uid==null&&node.parentNode.nodeType==1&&node.parentNode.getAttribute("uid")==null&&_361==false)||(!this.ctrlKeyPressed(e)&&!this.shiftKeyPressed(e))){
if(this.getSelections().length>0){
_360=true;
}
if(this.hasCutColumns()==true){
this.clearSelectedObjects(_35d);
}else{
this.resetSelections(_35d);
this.repaintSavedSelections();
if(typeof cf!="undefined"&&typeof cf.removeAllSelectionsFromCfgVariables=="function"){
cf.removeAllSelectionsFromCfgVariables();
}
this.m_oCognosViewer.setCurrentNodeFocus(null);
}
if(this.ctrlKeyPressed(e)||this.shiftKeyPressed(e)){
clearTextSelection(_35d);
}
if(typeof g_reportSelectionController!="undefined"&&_361==false){
if(g_reportSelectionController.getSelections().length>0){
_360=true;
}
g_reportSelectionController.clearSelections();
}
}
var _362=node.getAttribute("dtTargets")?node:null;
var _363=(node.nodeName.toLowerCase()==="area");
if((uid==null)&&((ctx!=null)||(node.parentNode&&node.parentNode.nodeType==1&&typeof node.parentNode.getAttribute!="undefined"))){
if(node.nodeName=="IMG"&&(node.src.indexOf("SM=")>-1||(isIE()>-1&&node.src.indexOf("space.gif")>-1))){
return false;
}
var _364;
var _365=3;
do{
node=node.parentNode;
if(node){
_362=(!_362&&typeof node.getAttribute!="undefined"&&node.getAttribute("dtTargets"))?node:_362;
uid=(typeof node.getAttribute!="undefined")?node.getAttribute("uid"):null;
_364=node.nodeName.toLowerCase();
}
}while((uid==null)&&node&&(--_365>0)&&(_364=="span"||_364=="div"));
}
if(uid!=null){
var _366=node.childNodes;
for(var i=0;i<_366.length;i++){
if(_366[i].nodeName.toUpperCase()=="TABLE"&&(_366[i].className=="ls"||_366[i].className=="xt")){
var trs=_366[i].rows;
for(var j=0;j<trs.length;j++){
var tds=trs[j].cells;
for(var k=0;k<tds.length;k++){
if(tds[k].getAttribute("uid")!=null){
return false;
}
}
}
}
}
var _36c;
if(node.className.toUpperCase()=="REPEATERTABLECELL"&&ctx!=null){
_36c=this.getSelectionObjectFactory().getSelectionObject(node,ctx);
}else{
_36c=this.getSelectionObjectFactory().getSelectionObject(node);
}
if(this.isCellSelected(node)==false){
if(this.shiftKeyPressed(e)){
var _36d=this.getSelections();
if(_36d.length>0){
var _36e=_36d[_36d.length-1];
if(_36e.getLayoutType()==_36c.getLayoutType()&&(_36e.getCellRef().parentNode.parentNode==_36c.getCellRef().parentNode.parentNode)){
if(this.cellsAreInSameColumn(_36e.getCellRef(),_36c.getCellRef())){
this.selectVertical(_36e,_36c,_35d);
}else{
if(_36e.getCellRef().parentNode.rowIndex==_36c.getCellRef().parentNode.rowIndex){
this.selectHorizontal(_36e,_36c,_35d);
}
}
}
}
clearTextSelection(_35d);
}else{
if(this.ctrlKeyPressed(e)){
clearTextSelection(_35d);
}
}
this.addSelectionObject(_36c,_35d);
if(typeof cf!="undefined"&&typeof cf.addSelectionToCfgVariables=="function"){
cf.addSelectionToCfgVariables(_36c.getColumnName());
}
this.m_oCognosViewer.setCurrentNodeFocus(node);
}else{
if(this.ctrlKeyPressed(e)){
this.removeSelectionObject(_36c,_35d);
if(typeof cf!="undefined"&&typeof cf.removeSelectionFromCfgVariables=="function"){
if(!this.isColumnSelected(_36c.getTag())){
cf.removeSelectionFromCfgVariables(_36c.getTag());
}
}
clearTextSelection(_35d);
}else{
if(this.shiftKeyPressed(e)){
clearTextSelection(_35d);
}
}
}
_360=true;
}else{
if(_361){
var _36f=null;
while((typeof node.id=="undefined"||node.id==null||node.id=="")&&node.parentNode!=null){
node=node.parentNode;
}
if(node.id=="reportTitle"){
_36f="TitleStyle";
}else{
if(node.id=="reportSubtitle"){
_36f="SubtitleStyle";
}else{
if(node.id.indexOf("reportFilter")==0){
_36f="FilterStyle";
}
}
}
if(_36f!=null){
selectReportElement(e,node.id,_36f);
_360=true;
}
}else{
if(_362!=null&&this.m_oCognosViewer&&this.m_oCognosViewer.isMobile()&&!_363){
var _36c=this.getSelectionObjectFactory().getSelectionObject(_362);
this.addSelectionObject(_36c,_35d);
}
}
}
if(_360==true&&(typeof cf!="undefined"&&typeof cf.refreshDialog=="function")){
cf.refreshDialog();
}
}
catch(ex){
}
};
CSelectionController.prototype.selectDrillThroughImage=function(node){
this.m_oSelectedDrillThroughImage=node;
};
CSelectionController.prototype.getSelectedDrillThroughImage=function(){
return this.m_oSelectedDrillThroughImage?this.m_oSelectedDrillThroughImage:null;
};
CSelectionController.prototype.selectDrillThroughSingleton=function(node){
this.m_oSelectedDrillThroughSingleton=node;
};
CSelectionController.prototype.getSelectDrillThroughSingleton=function(){
return this.m_oSelectedDrillThroughSingleton?this.m_oSelectedDrillThroughSingleton:null;
};
CSelectionController.prototype.getReportContextDataArray=function(){
return this.m_aReportContextDataArray;
};
CSelectionController.prototype.getReportMetadataArray=function(){
return this.m_aReportMetadataArray;
};
CSelectionController.prototype.setupContextDataArray=function(_372){
this.m_aReportContextDataArray=_372;
};
CSelectionController.prototype.setupMetaDataArray=function(_373){
this.m_aReportMetadataArray=_373;
};
CSelectionController.prototype.addContextData=function(_374){
this.m_aSelectedObjects=[];
this.m_oCDManager.SetContextData(_374);
if(!this.m_bUsingCCDManager){
this.m_bUsingCCDManager=true;
}
for(var i=0;i<this.m_selectedClass.length;++i){
this.deselecting(this.m_selectedClass);
}
};
CSelectionController.prototype.addMetaData=function(_376){
this.m_aSelectedObjects=[];
this.m_oCDManager.SetMetadata(_376);
if(!this.m_bUsingCCDManager){
this.m_bUsingCCDManager=true;
}
};
CSelectionController.prototype.getDrillFlag=function(_377){
var _378="";
if(!this.m_bUsingCCDManager){
var _379=this.m_aReportContextDataArray[_377];
var _37a=_379[0];
var _37b=this.m_aReportMetadataArray[_37a];
if(typeof _37b!="undefined"&&typeof _37b[3]!="undefined"){
_378=_37b[3];
}
}else{
_378=this.m_oCDManager.GetDrillFlag(_377);
}
return _378;
};
CSelectionController.prototype.getDrillFlagForMember=function(_37c){
var _37d="0";
if(!this.m_bUsingCCDManager){
var _37e=this.getContextDataItem(_37c);
if(_37e!=null){
var _37f=_37e[2];
if(_37f!=""){
var _380=_37e[0];
var _381=this.getMetaDataItem(_380);
if(_381!=null){
_37d=_381[3];
}
}
}
}else{
_37d=this.m_oCDManager.GetDrillFlagForMember(_37c);
}
return (_37d==null)?0:_37d;
};
CSelectionController.prototype.getDataType=function(_382){
var _383=null;
if(!this.m_bUsingCCDManager){
var _384=this.getRDI(_382);
if(_384&&_384.length>2){
_383=parseInt(_384[2],10);
}
}else{
_383=parseInt(this.m_oCDManager.GetDataType(_382),10);
}
return _383;
};
CSelectionController.prototype.getUsageInfo=function(_385){
if(this.m_bUsingCCDManager){
return this.m_oCDManager.GetUsage(_385);
}
};
CSelectionController.prototype.isMeasure=function(_386){
return (this.getUsageInfo(_386)==this.c_usageMeasure);
};
CSelectionController.prototype.getDepth=function(_387){
var _388=null;
if(!this.m_bUsingCCDManager){
var _389=this.getRDI(_387);
if(_389&&_389.length>5&&_389[1]=="R"){
_388=_389[5];
}
}else{
_388=this.m_oCDManager.GetDepth(_387);
}
return _388;
};
CSelectionController.prototype.getUseValue=function(_38a){
var _38b="";
if(!this.m_bUsingCCDManager){
var _38c=this.m_aReportContextDataArray[_38a];
if(typeof _38c[1]!="undefined"){
_38b=_38c[1];
}
}else{
_38b=this.m_oCDManager.GetDisplayValue(_38a);
}
return _38b;
};
CSelectionController.prototype.getTextValue=function(_38d){
var _38e=null;
for(var _38f=0;_38f<_38d.length;_38f++){
if(_38d[_38f].style.visisbility!="hidden"){
if(isIE()){
_38e=_38d[_38f].innerText;
}else{
_38e=_38d[_38f].textContent;
}
var _390=_38d[_38f].nextSibling;
while(_390!=null){
if(_390.nodeName.toUpperCase()=="SPAN"&&_390.style.visibility!="hidden"){
if(isIE()){
_38e+=_390.innerText;
}else{
_38e+=_390.textContent;
}
}
_390=_390.nextSibling;
}
break;
}
}
return _38e;
};
CSelectionController.prototype.getDisplayValueFromDOM=function(_391,_392){
var _393=null;
var _394;
var _395=new RegExp("(^|\\s)"+_391+"(\\s|$|:)","i");
if(typeof _392!="undefined"){
_394=getElementsByAttribute(_392,["span","td","th"],"ctx",_391,1,_395);
}else{
var _396=document.getElementById("CVIFrame"+this.m_sNamespace);
if(typeof _396=="undefined"||_396==null){
var _397=document.getElementById("RVContent"+this.m_sNamespace);
if(typeof _397=="undefined"||_397==null){
_394=getElementsByAttribute(document.body,["span","td","th"],"ctx",_391,1,_395);
}else{
_394=getElementsByAttribute(_397,["span","td","th"],"ctx",_391,1,_395);
}
}else{
_394=getElementsByAttribute(_396.contentWindow.document.body,["span","td","th"],"ctx",_391,1,_395);
}
}
var _398;
if(_394.length>0&&(_394[0].nodeName.toUpperCase()=="TD"||_394[0].nodeName.toUpperCase()=="TH")){
_398=_394[0].childNodes;
}else{
_398=_394;
}
if(_398.length==0||(_398[0].className.indexOf("chart_area")==-1&&_398[0].className.indexOf("bux-comment")==-1)){
_393=this.getTextValue(_398);
}
return _393;
};
CSelectionController.prototype.getDisplayValue=function(_399,_39a){
var _39b=this.getDisplayValueFromDOM(_399,_39a);
if(_39b==null){
_39b=this.getUseValue(_399);
}
return _39b;
};
CSelectionController.prototype.getDun=function(_39c){
if(this.m_bUsingCCDManager){
return this.m_oCDManager.GetDUN(_39c);
}else{
var _39d=this.m_aReportContextDataArray[_39c];
if(_39d&&typeof _39d[5]!="undefined"){
var _39e=_39d[5];
var _39f=this.m_aReportMetadataArray[_39e];
if(typeof _39f!="undefined"&&typeof _39f[1]!="undefined"&&_39f[1]=="D"){
return _39f[0];
}
}
}
};
CSelectionController.prototype.getPun=function(_3a0){
if(this.m_bUsingCCDManager){
return this.m_oCDManager.GetPUN(_3a0);
}
};
CSelectionController.prototype.getLun=function(_3a1){
var lun="";
if(!this.m_bUsingCCDManager){
var _3a3=this.m_aReportContextDataArray[_3a1];
if(_3a3&&typeof _3a3[3]!="undefined"){
var _3a4=_3a3[3];
var _3a5=this.m_aReportMetadataArray[_3a4];
if(typeof _3a5!="undefined"&&typeof _3a5[1]!="undefined"&&_3a5[1]=="L"){
lun=_3a5[0];
}
}
}else{
lun=this.m_oCDManager.GetLUN(_3a1);
}
return lun;
};
CSelectionController.prototype.isContextId=function(_3a6){
var _3a7=false;
if(!this.m_bUsingCCDManager){
var _3a8=this.m_aReportContextDataArray[_3a6];
_3a7=(typeof _3a8=="object");
}else{
this.m_oCDManager.FetchContextData([_3a6]);
_3a7=this.m_oCDManager.ContextIdExists(_3a6);
}
return _3a7;
};
CSelectionController.prototype.hasContextData=function(){
var _3a9=false;
if(!this.m_bUsingCCDManager){
if(this.m_aReportContextDataArray&&this.m_aReportContextDataArray.length&&this.m_aReportContextDataArray.length()>0){
return true;
}
}else{
_3a9=this.m_oCDManager.HasContextData();
}
return _3a9;
};
CSelectionController.prototype.hasMetadata=function(){
var _3aa=false;
if(!this.m_bUsingCCDManager){
if(this.m_aReportMetadataArray&&this.m_aReportMetadataArray.length&&this.m_aReportMetadataArray.length()>0){
return true;
}
}else{
_3aa=this.m_oCDManager.HasMetadata();
}
return _3aa;
};
CSelectionController.prototype.getDifferentCellIndex=function(_3ab,_3ac,_3ad){
for(var i=0;i<_3ab.cells.length;i++){
if(this.getSelectionObjectFactory().getSelectionObject(_3ab.cells[i]).getLayoutType()=="datavalue"){
break;
}
}
if(_3ad=="relative"){
return (_3ac-i);
}else{
if(_3ad=="actual"){
return (_3ac+i);
}
}
};
CSelectionController.prototype.cellsAreInSameColumn=function(_3af,_3b0){
if(_3af.parentNode.rowIndex==_3b0.parentNode.rowIndex){
return false;
}
if(_3af.getAttribute("cid")===null){
if(_3af.getAttribute("uid")===_3b0.getAttribute("uid")){
if(_3af.getAttribute("type")!="datavalue"){
return true;
}else{
if(this.getDifferentCellIndex(_3af.parentNode,_3af.cellIndex,"relative")==this.getDifferentCellIndex(_3b0.parentNode,_3b0.cellIndex,"relative")){
return true;
}
}
}else{
return false;
}
}else{
if(_3af.getAttribute("cid")===_3b0.getAttribute("cid")){
return true;
}else{
return false;
}
}
};
CSelectionController.prototype.selectVertical=function(_3b1,_3b2,_3b3){
if(!_3b3){
_3b3=document;
}
var _3b4=_3b1.getCellRef().parentNode;
var _3b5,i;
var _3b7=(_3b1.getCellRef().parentNode.rowIndex<_3b2.getCellRef().parentNode.rowIndex);
var _3b8=(_3b1.getCellRef().parentNode.cells.length-_3b1.getCellRef().cellIndex);
while(_3b4.rowIndex!=_3b2.getCellRef().parentNode.rowIndex){
if(_3b7){
_3b4=_3b4.nextSibling;
}else{
_3b4=_3b4.previousSibling;
}
if(_3b4==null){
break;
}
if(_3b4.cells.length>=_3b8){
for(i=0;i<_3b4.cells.length;i++){
if((_3b4.cells[i].getAttribute("type")==_3b1.getLayoutType())&&this.cellsAreInSameColumn(_3b1.getCellRef(),_3b4.cells[i])){
_3b5=this.getSelectionObjectFactory().getSelectionObject(_3b4.cells[i]);
if(this.addSelectionObject(_3b5,_3b3)){
if(typeof cf!="undefined"&&typeof cf.addSelectionToCfgVariables=="function"){
cf.addSelectionToCfgVariables(_3b5.getColumnName());
}
}
break;
}
}
}
}
};
CSelectionController.prototype.selectHorizontal=function(_3b9,_3ba,_3bb){
var _3bc="";
if(_3b9.getColumnRef()==null){
if(_3b9.getCellRef().getAttribute("uid")==_3ba.getCellRef().getAttribute("uid")){
_3bc=_3b9.getCellRef().getAttribute("uid");
}else{
return;
}
}
var _3bd,_3be;
var _3bf=_3ba.getCellRef().parentNode;
var _3c0;
if(_3ba.getCellRef().cellIndex<_3b9.getCellRef().cellIndex){
_3bd=_3ba.getCellRef().cellIndex;
_3be=_3b9.getCellRef().cellIndex;
}else{
_3be=_3ba.getCellRef().cellIndex;
_3bd=_3b9.getCellRef().cellIndex;
}
for(var i=_3bd+1;i<_3be;i++){
if(((_3b9.getColumnRef()!=null)&&(_3b9.getLayoutType()==_3ba.getLayoutType())&&(_3b9.getLayoutType()!="datavalue")||this.allowHorizontalDataValueSelection())||((_3b9.getColumnRef()==null)&&(_3bf.cells[i].getAttribute("uid")==_3bc))){
_3c0=this.getSelectionObjectFactory().getSelectionObject(_3bf.cells[i]);
if(this.addSelectionObject(_3c0,_3bb)){
if(typeof cf!="undefined"&&typeof cf.addSelectionToCfgVariables=="function"){
cf.addSelectionToCfgVariables(_3c0.getColumnName());
}
}
}
}
};
CSelectionController.prototype.pageDoubleClicked=function(e){
try{
var node=getNodeFromEvent(e);
if(typeof node.selectedCell!="undefined"){
var _3c4=node;
node=node.selectedCell;
_3c4.removeAttribute("selectedCell");
}
while(node.nodeType==3){
node=node.parentNode;
}
var ctx=node.getAttribute("ctx");
var uid=node.getAttribute("uid");
if((ctx!=null)||(node.parentNode.nodeType==1&&node.parentNode.getAttribute("uid")!=null)){
node=node.parentNode;
if(node.className.toUpperCase()=="BLOCK"&&node.nodeName.toUpperCase()=="DIV"){
node=node.parentNode;
}
uid=node.getAttribute("uid");
}
if(uid!=null&&node.firstChild!=null&&(node.getAttribute("type")=="columnTitle"||node.getAttribute("type")=="section")){
if(typeof goWindowManager!="undefined"&&goWindowManager&&typeof goWindowManager.getApplicationFrame=="function"){
goWindowManager.getFeatureManager().launchFeature("Rename");
}
}
if(typeof g_reportSelectionController!="undefined"){
g_reportSelectionController.clearSelections();
}
}
catch(ex){
}
};
CSelectionController.prototype.getSelectionHoverNodes=function(){
return this.m_aSelectionHoverNodes;
};
CSelectionController.prototype.setSelectionHoverNodes=function(_3c7){
this.m_aSelectionHoverNodes=_3c7;
};
CSelectionController.prototype.addSelectionHoverNode=function(node){
this.m_aSelectionHoverNodes[this.m_aSelectionHoverNodes.length]=node;
};
CSelectionController.prototype.pageHover=function(e){
try{
var node=getNodeFromEvent(e);
while(node.nodeType==3){
node=node.parentNode;
}
if((node.getAttribute("ctx")!=null)||(node.parentNode.nodeType==1&&node.parentNode.getAttribute("uid")!=null)){
if(node.parentNode.nodeName.toLowerCase()!="tr"){
node=node.parentNode;
}
}
var _3cb=this.getSelectionHoverNodes();
var _3cc=this.getAllSelectedObjects().length;
if(!(_3cb.length==1&&_3cb[0]==node)){
for(var i=0;i<_3cb.length;i++){
this.sortIconHover(_3cb[i],true);
if(_3cc==0){
this.pageChangeHover(_3cb[i],true);
}
}
this.setSelectionHoverNodes([]);
if(_3cc==0){
this.sortIconHover(node,false);
if(this.pageChangeHover(node,false)){
this.addSelectionHoverNode(node);
}
}else{
if(this.sortIconHover(node,false)){
this.addSelectionHoverNode(node);
}
}
}
}
catch(ex){
}
};
CSelectionController.prototype.sortIconHover=function(node,_3cf){
if(!this.isValidColumnTitle(node)){
return false;
}
var _3d0=this.getSortImgNode(node);
if(_3d0!=null&&_3d0!="undefined"){
if(_3d0.getAttribute("sortOrder")==="nosort"){
if(_3cf){
_3d0.style.visibility="hidden";
}else{
_3d0.style.visibility="visible";
}
}
return true;
}
return false;
};
CSelectionController.prototype.isValidColumnTitle=function(node){
if(node&&node.parentNode){
var uid=node.getAttribute("uid");
if(uid!=null&&(!(node.firstChild==null&&node.cellIndex==0&&node.parentNode.rowIndex==0&&node.getAttribute("cid")==null))&&(node.getAttribute("type")=="columnTitle"||node.getAttribute("type")=="section")){
return true;
}
}
return false;
};
CSelectionController.prototype.pageChangeHover=function(node,_3d4){
try{
if((node.getAttribute("ctx")!=null)||(node.parentNode&&node.parentNode.nodeType==1&&node.parentNode.getAttribute("uid")!=null)){
if(node.parentNode.nodeName.toLowerCase()!="tr"){
node=node.parentNode;
}
}
if(this.isValidColumnTitle(node)){
var _3d5=this.isColumnSelected(node.getAttribute("tag"));
if(!_3d5){
_3d5=this.isColumnCut(node.getAttribute("tag"));
}
if(!_3d5){
if(_3d4){
if(node.getAttribute("oldClassName")!=null){
node.className=node.getAttribute("oldClassName");
node.removeAttribute("oldClassName");
}
this.restoreOldBackgroundImage(node);
}else{
if(node.getAttribute("oldClassName")!=null){
node.className=node.getAttribute("oldClassName");
}else{
node.setAttribute("oldClassName",node.className);
}
if(node.getAttribute("oldBackgroundImageStyle")!=null){
node.style.backgroundImage=node.getAttribute("oldBackgroundImageStyle");
}else{
this.saveOldCellStyles(node);
}
node.className+=" hoverSelection";
return true;
}
}
}
}
catch(ex){
}
return false;
};
CSelectionController.prototype.getSortImgNode=function(node){
var _3d7=node.getElementsByTagName("img");
for(var i=0;i<_3d7.length;i++){
var sId=_3d7[i].id.toString();
if(sId!=null&&sId.length>0&&sId.indexOf("sortimg")>=0){
node=_3d7[i];
return node;
}
}
return null;
};
CSelectionController.prototype.restoreOldPadding=function(node){
if(node&&node.style&&node.getAttribute("oldPaddingStyle")!=null){
if(node.getAttribute("oldPaddingStyle").length>0){
node.style.padding=node.getAttribute("oldPaddingStyle");
}
node.removeAttribute("oldPaddingStyle");
}
};
CSelectionController.prototype.saveOldPadding=function(node,size){
if(node&&node.getAttribute("oldPaddingStyle")==null){
node.setAttribute("oldPaddingStyle",size.paddingTop+"px "+size.paddingRight+"px "+size.paddingBottom+"px "+size.paddingLeft+"px");
}
};
CSelectionController.prototype.saveOldBorder=function(node){
if(node&&node.getAttribute("oldBorderStyle")==null){
node.setAttribute("oldBorderStyle",node.style.border);
}
};
CSelectionController.prototype.restoreOldBorder=function(node){
if(node&&node.style&&node.getAttribute("oldBorderStyle")!=null){
if(node.getAttribute("oldBorderStyle").length>0){
node.style.border=node.getAttribute("oldBorderStyle");
}else{
node.style.borderColor=node.style.borderWidth=node.style.borderStyle="";
}
node.removeAttribute("oldBorderStyle");
}
};
CSelectionController.prototype.setPrimarySelectionStyles=function(cell){
if(this.getPrimarySelectionColor()){
cell.style.backgroundColor=this.getPrimarySelectionColor();
}else{
cell.style.backgroundImage=this.pS_backgroundImageURL;
cell.style.backgroundRepeat="repeat";
}
};
CSelectionController.prototype.setSecondarySelectionStyles=function(cell){
if(this.getSecondarySelectionColor()){
cell.style.backgroundColor=this.getSecondarySelectionColor();
}else{
cell.style.backgroundImage=this.sS_backgroundImageURL;
cell.style.backgroundRepeat="repeat";
}
};
CSelectionController.prototype.saveOldCellStyles=function(node){
if(node&&node.getAttribute("oldBackgroundImageStyle")==null){
node.setAttribute("oldBackgroundColor",this.getStyleProperty(node,"backgroundColor"));
node.setAttribute("oldBackgroundImageStyle",this.getBackgroundImage(node));
node.setAttribute("oldBackgroundRepeat",this.getStyleProperty(node,"backgroundRepeat"));
node.style.backgroundImage="";
node.style.backgroundRepeat="";
}
};
CSelectionController.prototype.restoreOldBackgroundImage=function(node){
if(node&&node.style&&node.getAttribute("oldBackgroundImageStyle")!=null){
node.style.backgroundImage=node.getAttribute("oldBackgroundImageStyle");
node.removeAttribute("oldBackgroundImageStyle");
node.style.backgroundRepeat=node.getAttribute("oldBackgroundRepeat");
node.removeAttribute("oldBackgroundRepeat");
node.style.backgroundColor=node.getAttribute("oldBackgroundColor");
node.removeAttribute("oldBackgroundColor");
}
};
CSelectionController.prototype.getStyleProperty=function(node,_3e4){
if(node&&node.style&&node.style[_3e4]){
return node.style[_3e4];
}
return "";
};
CSelectionController.prototype.getBackgroundImage=function(node){
if(node&&node.style){
return node.style.backgroundImage;
}
return "";
};
CSelectionController.prototype.pageContextClicked=function(e){
var node=getNodeFromEvent(e);
if(typeof node.selectedCell!="undefined"){
var _3e8=node;
node=node.selectedCell;
_3e8.removeAttribute("selectedCell");
}
while(node!=null&&node.tagName!="TD"){
node=node.parentNode;
}
if(node!=null){
var _3e9=this.getBackgroundImage(node);
this.findSelectionURLs();
if(this.getSelections().length==0||_3e9!=this.pS_backgroundImageURL){
this.pageClicked(e);
}
}
if(typeof populateContextMenu!="undefined"){
populateContextMenu();
moveContextMenu(e);
}
var _3ea=false;
if(this.showViewerContextMenu()){
if(typeof e.preventDefault=="function"){
e.preventDefault();
}
_3ea=true;
}
return _3ea;
};
CSelectionController.prototype.chartContextMenu=function(e){
if(!this.hasSelectedChartNodes()){
return;
}
if(typeof populateContextMenu!="undefined"){
populateContextMenu();
moveContextMenu(e);
}
if(typeof e.preventDefault=="function"){
e.preventDefault();
}
return false;
};
CSelectionController.prototype.titleAreaContextMenu=function(e,_3ed,sId){
if(typeof populateContextMenu!="undefined"){
goWindowManager.getApplicationFrame().cfgSet("contextMenuType",_3ed);
goWindowManager.getApplicationFrame().cfgSet("contextMenuId",sId);
populateContextMenu(_3ed.toUpperCase());
moveContextMenu(e,_3ed.toUpperCase());
}
if(typeof e.preventDefault=="function"){
e.preventDefault();
}
return false;
};
CSelectionController.prototype.selectionsAreAllSameType=function(){
var _3ef=this.getSelections();
if(_3ef.length>0){
var _3f0=_3ef[0].getLayoutType();
for(var i=1;i<_3ef.length;i++){
if(_3f0!=_3ef[i].getLayoutType()){
return 0;
}
}
return 1;
}
return -1;
};
CSelectionController.prototype.selectionsAreAllOnSameColumn=function(){
var _3f2=this.getSelections();
var i=0;
if(_3f2.length>0){
var _3f4=_3f2[0].getColumnRef();
if(_3f4!=null&&_3f4!=""){
for(i=1;i<_3f2.length;i++){
if(_3f4!=_3f2[i].getColumnRef()){
return false;
}
}
}else{
var _3f5=_3f2[0].getCellTypeId();
for(i=1;i<_3f2.length;i++){
if(_3f5!=_3f2[i].getCellTypeId()){
return false;
}
}
}
return true;
}
return false;
};
CSelectionController.prototype.checkForReportElementNode=function(node){
if(typeof node!="undefined"&&node!=null&&typeof node.className!="undefined"&&node.className!=null){
if(node.className=="tt"){
if(typeof node.parentNode!="undefined"&&node.parentNode!=null&&typeof node.parentNode.parentNode!="undefined"&&node.parentNode.parentNode!=null&&(node.parentNode.className=="reportSubtitleStyle"||node.parentNode.id=="reportTitleLink")){
node=node.parentNode.parentNode;
}else{
return false;
}
}else{
if(typeof node.parentNode!="undefined"&&node.parentNode!=null){
var _3f7=node.parentNode;
while(typeof _3f7!="undefined"&&_3f7!=null){
if(typeof _3f7.className!="undefined"&&_3f7.className!=null&&_3f7.className.substr(0,2)=="ft"){
node=_3f7;
break;
}else{
_3f7=_3f7.parentNode;
}
}
}else{
return false;
}
}
var _3f8=node.className.substr(0,2);
if(_3f8=="ta"||_3f8=="ts"||_3f8=="ft"){
return true;
}
}
return false;
};
CSelectionController.prototype.chartClicked=function(_3f9){
this.setSelectedChartArea(_3f9);
};
CSelectionController.prototype.processColumnTitleNode=function(_3fa){
if(!_3fa||!this.m_oCognosViewer.isBux){
return;
}
var _3fb=_3fa.getCellRef();
if(_3fb.getAttribute("contextAugmented")=="true"||"list"!=_3fa.getDataContainerType()||"columnTitle"!=_3fa.getLayoutType()){
return;
}
var _3fc=_3fa.getSelectedContextIds();
var _3fd=false;
if(typeof _3fc=="object"&&_3fc!=null&&_3fc.length>0){
if(this.isRelational(_3fc)&&this.getQueryModelId(_3fc[0][0])==null){
_3fd=true;
}else{
return;
}
}
var lid=_3fb.parentNode.parentNode.parentNode.getAttribute("lid");
var _3ff=_3fb.parentNode.nextSibling;
var _400=getChildElementsByAttribute(_3ff,"td","cid",_3fb.getAttribute("cid"));
var _401=null;
var _402=true;
var _403;
if(_400.length>0){
var _404=_400[0];
var _405=_404.childNodes.length;
for(var _406=0;_406<_405;_406++){
var _407=_404.childNodes[_406];
if(_407.getAttribute&&((_407.nodeName.toLowerCase()=="table"&&typeof _407.getAttribute("lid")=="string")||_407.nodeName.toLowerCase()=="map"||_407.nodeName.toLowerCase()=="img"||_407.getAttribute("chartcontainer")=="true")){
if(_406==0){
_402=false;
}
}else{
_403=[];
if(_407.nodeName.toLowerCase()=="span"){
_403.push(_407);
}
var _408=_407.getElementsByTagName?_407.getElementsByTagName("span"):[];
for(var _409=0;_409<_408.length;++_409){
if(lid==getImmediateLayoutContainerId(_408[_409])){
_403.push(_408[_409]);
}
}
for(var _40a=0;_40a<_403.length;++_40a){
var _40b=_403[_40a];
if(_40b.nodeType==1&&_40b.nodeName.toLowerCase()=="span"&&_40b.style.visibility!="hidden"){
if(_40b.getAttribute("ctx")!=null&&_40b.getAttribute("ctx")!=""){
_401=_40b.getAttribute("ctx");
break;
}
}
}
}
}
}
if(_401!=null){
var _40c=_401.split("::")[0].split(":")[0];
if(!_3fd){
_403=_3fb.getElementsByTagName("span");
if(_403.length!=0){
var _40d=this.m_oCDManager.m_cd[_40c];
var _40e=this.getTextValue(_403);
var _40f={"u":_40e===null?"":_40e};
if(typeof _40d!="undefined"){
if(typeof _40d["r"]!="undefined"){
_40f.r=_40d["r"];
}
if(typeof _40d["q"]!="undefined"){
_40f.q=_40d["q"];
}
if(typeof _40d["i"]!="undefined"){
_40f.i=_40d["i"];
}
}
var _410="cloned"+_40c;
this.m_oCDManager.m_cd[_410]=_40f;
_403[0].setAttribute("ctx",_410);
_3fa=this.getSelectionObjectFactory().processCTX(_3fa,_410);
}
}else{
var qmid=this.getQueryModelId(_40c);
if(qmid==null){
}
if(qmid!=null){
var _412=_3fc[0][0];
this.m_oCDManager.m_cd[_412].i=this.m_oCDManager.m_cd[_40c].i;
return false;
}
}
}else{
_402=false;
}
if(!_402){
_3fb.setAttribute("canSort","false");
}
_3fb.setAttribute("contextAugmented","true");
};
CSelectionController.prototype.selectionsInSameDataContainer=function(){
try{
var _413=this.getAllSelectedObjects();
var _414=_413[0].getLayoutElementId();
for(var _415=1;_415<_413.length;_415++){
if(_414!=_413[_415].getLayoutElementId()){
return false;
}
}
}
catch(e){
return false;
}
return true;
};
CSelectionController.prototype.selectionsFromSameDataItem=function(){
try{
var _416=this.getAllSelectedObjects();
var _417=_416[0].getDataItems()[0][0];
for(var _418=1;_418<_416.length;_418++){
if(_417!=_416[_418].getDataItems()[0][0]){
return false;
}
}
}
catch(e){
return false;
}
return true;
};
CSelectionController.prototype.isRelational=function(_419){
try{
if(!_419){
var _41a=this.getAllSelectedObjects()[0];
_419=_41a.getSelectedContextIds();
}
for(var _41b=0;_41b<_419.length;_41b++){
for(var _41c=0;_41c<_419[_41b].length;_41c++){
var ctx=_419[_41b][_41c];
var mun=this.getMun(ctx);
var lun=this.getLun(ctx);
var hun=this.getHun(ctx);
if(mun!=null&&typeof mun!="undefined"&&mun.length>0){
return false;
}
if(lun!=null&&typeof lun!="undefined"&&lun.length>0){
return false;
}
if(hun!=null&&typeof hun!="undefined"&&hun.length>0){
return false;
}
}
}
return true;
}
catch(e){
return true;
}
return true;
};
CSelectionController.prototype.getDataContainerType=function(){
try{
if(!this.getAllSelectedObjects()[0]){
return "";
}
return this.getAllSelectedObjects()[0].m_dataContainerType;
}
catch(e){
return "";
}
};
CSelectionController.prototype.areSelectionsColumnRowTitles=function(){
try{
var _421=this.getAllSelectedObjects();
for(var _422=0;_422<_421.length;_422++){
var _423=_421[_422];
if(_423.getLayoutType()!="columnTitle"||_423.isHomeCell()){
return false;
}
}
}
catch(e){
return false;
}
return true;
};
CSelectionController.prototype.selectionsAreMeasures=function(){
try{
var _424=this.getAllSelectedObjects();
for(var _425=0;_425<_424.length;_425++){
var _426=_424[_425];
if(this.getUsageInfo(_426.getSelectedContextIds()[0][0])!=this.c_usageMeasure){
return false;
}
}
}
catch(e){
return false;
}
return true;
};
CSelectionController.prototype.selectionsNonMeasureWithMUN=function(){
var _427=this.getAllSelectedObjects();
if(_427.length==0){
return false;
}
for(var _428=0;_428<_427.length;_428++){
var _429=_427[0];
if(_429.getSelectedContextIds().length==0){
return false;
}
var _42a=_429.getSelectedContextIds()[0][0];
var mun=this.getMun(_42a);
var _42c=this.getUsageInfo(_42a);
if(mun==null||typeof mun=="undefined"||mun.length==0||_42c==this.c_usageMeasure){
return false;
}
}
return true;
};
CSelectionController.prototype.areSelectionsMeasureOrCalculation=function(){
var _42d=this.getAllSelectedObjects();
if(_42d.length==0){
return false;
}
var _42e=this.selectionsHaveCalculationMetadata();
for(var _42f=0;_42f<_42d.length;_42f++){
var _430=_42d[_42f];
var _431=_430.getSelectedContextIds()[0][0];
if(!this.isCalculationOrMeasure(_431,_42e)){
return false;
}
}
return true;
};
CSelectionController.prototype.selectionsHaveCalculationMetadata=function(){
try{
var _432=this.getDataContainerType();
var _433=this.getAllSelectedObjects();
for(var _434=0;_434<_433.length;_434++){
var _435=_433[_434];
var _436=_435.getSelectedContextIds();
var _437=_436[0][0];
var sHun=this.getHun(_437);
if(!this.hasCalculationMetadata(_437,_436,_432)){
return false;
}
}
}
catch(e){
return false;
}
return true;
};
CSelectionController.prototype.isCalculationOrMeasure=function(_439,_43a){
var mun=this.getMun(_439);
var _43c=this.getUsageInfo(_439);
if(!(((mun==null||typeof mun=="undefined"||mun.length==0)&&_43a)||_43c==this.c_usageMeasure)){
return false;
}
return true;
};
CSelectionController.prototype.hasCalculationMetadata=function(_43d,_43e,_43f){
var sHun=this.getHun(_43d);
if(this.getUsageInfo(_43d)!=this.c_usageMeasure){
if((this.isRelational(_43e)&&this.getQueryModelId(_43d)!=null)||(!this.isRelational(_43e)&&_43f=="list"&&(sHun&&sHun!=""))){
return false;
}
}
return true;
};
CSelectionController.prototype.selectionsAreDateTime=function(){
try{
var _441=this.getAllSelectedObjects();
for(var _442=0;_442<_441.length;_442++){
var _443=_441[_442];
var _444=_443.getSelectedContextIds();
var _445=_444[0][0];
var _446=this.getDataType(_445);
if(_446&&typeof this.m_ccl_dateTypes[_446]!=="undefined"){
return true;
}
}
}
catch(e){
return false;
}
return false;
};
CSelectionController.prototype.getSelectedObjectsJsonContext=function(){
try{
var _447=this.getAllSelectedObjects();
if(_447===null||_447.length<=0){
return null;
}
var _448=this.m_oCognosViewer.getModelPath();
var _449=[];
for(var i=0;i<_447.length;i++){
var obj=_447[i].getContextJsonObject(this,_448);
_449.push(obj);
}
return _449;
}
catch(e){
}
};
CSelectionController.prototype.destroy=function(){
delete this.m_oCognosViewer;
delete this.m_aCutColumns;
delete this.m_aSelectedObjects;
delete this.m_selectedClass;
delete this.m_cutClass;
if(this.m_oObserver&&this.m_oObserver.destroy){
this.m_oObserver.destroy();
}
delete this.m_oObserver;
delete this.m_aReportMetadataArray;
delete this.m_aReportContextDataArray;
if(this.m_oCDManager&&this.m_oCDManager.destroy){
this.m_oCDManager.destroy();
}
delete this.m_oCDManager;
if(this.m_oSelectionObjectFactory&&this.m_oSelectionObjectFactory.destroy){
this.m_oSelectionObjectFactory.destroy();
}
delete this.m_oSelectionObjectFactory;
delete this.m_selectedChartArea;
delete this.m_selectedChartNodes;
delete this.m_selectionContainerMap;
delete this.m_chartHelpers;
delete this.m_oJsonForMarshal;
if(this.hasSavedSelections()){
this.clearSavedSelections();
}
};
function clearTextSelection(_44c){
if(!_44c){
_44c=document;
}
try{
if(typeof _44c.selection=="object"&&_44c.selection!==null){
_44c.selection.empty();
}else{
if(typeof window.getSelection=="function"&&typeof window.getSelection()=="object"&&window.getSelection()!==null){
window.getSelection().removeAllRanges();
}
}
}
catch(e){
}
};
function CDrillThroughTarget(_44d,_44e,_44f,_450,_451,path,_453,_454,_455,_456,_457,_458){
this.m_label=_44d;
this.m_outputFormat=_44e;
this.m_outputLocale=_44f;
this.m_showInNewWindow=_450;
this.m_method=_451;
this.m_path=path;
this.m_bookmark=_453;
this.m_parameters=_454;
this.m_objectPaths=_455;
this.m_prompt="false";
this.m_dynamicDrillThrough=false;
this.m_parameterProperties=_458;
if(typeof _456!="undefined"&&_456!=null){
if(_456=="yes"){
this.m_prompt="true";
}else{
if(_456=="target"){
this.m_prompt="";
}
}
}
if(typeof _457!="undefined"&&_457!=null){
if(typeof _457=="string"){
_457=_457=="true"?true:false;
}
this.m_dynamicDrillThrough=_457;
}
};
function CDrillThroughTarget_getParameterProperties(){
return this.m_parameterProperties;
};
function CDrillThroughTarget_getLabel(){
return this.m_label;
};
function CDrillThroughTarget_getOutputFormat(){
return this.m_outputFormat;
};
function CDrillThroughTarget_getOutputLocale(){
return this.m_outputLocale;
};
function CDrillThroughTarget_getShowInNewWindow(){
return this.m_showInNewWindow;
};
function CDrillThroughTarget_getMethod(){
return this.m_method;
};
function CDrillThroughTarget_getPath(){
return this.m_path;
};
function CDrillThroughTarget_getBookmark(){
return this.m_bookmark;
};
function CDrillThroughTarget_getParameters(){
return this.m_parameters;
};
function CDrillThroughTarget_getObjectPaths(){
return this.m_objectPaths;
};
function CDrillThroughTarget_getPrompt(){
return this.m_prompt;
};
function CDrillThroughTarget_isDynamicDrillThrough(){
return this.m_dynamicDrillThrough;
};
CDrillThroughTarget.prototype.getLabel=CDrillThroughTarget_getLabel;
CDrillThroughTarget.prototype.getOutputFormat=CDrillThroughTarget_getOutputFormat;
CDrillThroughTarget.prototype.getOutputLocale=CDrillThroughTarget_getOutputLocale;
CDrillThroughTarget.prototype.getShowInNewWindow=CDrillThroughTarget_getShowInNewWindow;
CDrillThroughTarget.prototype.getMethod=CDrillThroughTarget_getMethod;
CDrillThroughTarget.prototype.getPath=CDrillThroughTarget_getPath;
CDrillThroughTarget.prototype.getBookmark=CDrillThroughTarget_getBookmark;
CDrillThroughTarget.prototype.getParameters=CDrillThroughTarget_getParameters;
CDrillThroughTarget.prototype.getObjectPaths=CDrillThroughTarget_getObjectPaths;
CDrillThroughTarget.prototype.getPrompt=CDrillThroughTarget_getPrompt;
CDrillThroughTarget.prototype.isDynamicDrillThrough=CDrillThroughTarget_isDynamicDrillThrough;
CDrillThroughTarget.prototype.getParameterProperties=CDrillThroughTarget_getParameterProperties;
function sXmlEncode(_459){
var _45a=""+_459;
if((_45a=="0")||((_459!=null)&&(_459!=false))){
_45a=_45a.replace(/&/g,"&amp;");
_45a=_45a.replace(/</g,"&lt;");
_45a=_45a.replace(/>/g,"&gt;");
_45a=_45a.replace(/"/g,"&quot;");
_45a=_45a.replace(/'/g,"&apos;");
}else{
if(_459==null){
_45a="";
}
}
return _45a;
};
function createFormField(name,_45c){
var _45d=document.createElement("input");
_45d.setAttribute("type","hidden");
_45d.setAttribute("name",name);
_45d.setAttribute("value",_45c);
return (_45d);
};
function setBackURLToCloseWindow(_45e){
var _45f=_45e.childNodes;
if(_45f){
for(var _460=0;_460<_45f.length;++_460){
var _461=_45f[_460];
var _462=_461.getAttribute("name");
if(_462&&_462=="ui.backURL"){
_45e.removeChild(_461);
}
}
}
_45e.appendChild(createFormField("ui.backURL","javascript:window.close();"));
};
function doMultipleDrills(_463,cvId){
if(parent!=this&&parent.doMultipleDrills){
if(getCVId()!=""&&getCVId()!=cvId){
cvId=getCVId();
}
return parent.doMultipleDrills(_463,cvId);
}else{
if(window.gViewerLogger){
window.gViewerLogger.log("Drill Targets",_463,"text");
}
var oCV=null;
try{
oCV=getCognosViewerObjectRef(cvId);
}
catch(exception){
}
var _466=buildDrillForm(oCV);
addDrillEnvironmentFormFields(_466,oCV);
if(typeof oCV!="undefined"&&oCV!=null){
var _467=oCV.getModelPath();
_466.appendChild(createFormField("modelPath",_467));
var _468=oCV.getSelectionController();
var _469="";
if(typeof getViewerSelectionContext!="undefined"&&typeof CSelectionContext!="undefined"){
_469=getViewerSelectionContext(_468,new CSelectionContext(_467));
}
_466.appendChild(createFormField("drillContext",_469));
_466.appendChild(createFormField("modelDrillEnabled",_468.getModelDrillThroughEnabled()));
if(typeof document.forms["formWarpRequest"+oCV.getId()]["ui.object"]!="undefined"&&document.forms["formWarpRequest"+oCV.getId()]["ui.object"].value!=""){
_466.appendChild(createFormField("drillSource",document.forms["formWarpRequest"+oCV.getId()]["ui.object"].value));
}else{
if(typeof oCV.envParams["ui.spec"]!="undefined"){
_466.appendChild(createFormField("sourceSpecification",oCV.envParams["ui.spec"]));
}
}
}
_466.setAttribute("launchGotoPage","true");
_466.appendChild(createFormField("drillTargets",_463));
_466.appendChild(createFormField("invokeGotoPage","true"));
_466.appendChild(createFormField("m","portal/drillthrough.xts"));
_466.appendChild(createFormField("b_action","xts.run"));
var _46a="winNAT_"+(new Date()).getTime();
var _46b="..";
if(oCV!=null){
_46b=oCV.getWebContentRoot();
var _46c=oCV.getExecutionParameters();
if(_46c!=""){
_466.appendChild(createFormField("encExecutionParameters",_46c));
}
}
if(!oCV||!oCV.launchGotoPageForIWidgetMobile(_466)){
if(oCV&&typeof oCV.launchGotoPage==="function"){
oCV.launchGotoPage(_466);
}else{
var _46d=_46b+"/rv/blankDrillWin.html";
_466.target=_46a;
window.open(_46d,_46a);
}
}
}
};
function buildDrillForm(oCV){
var _46f=document.getElementById("drillForm");
if(_46f){
document.body.removeChild(_46f);
}
_46f=document.createElement("form");
if(typeof oCV!="undefined"&&oCV!=null){
var _470=document.getElementById("formWarpRequest"+oCV.getId());
_46f.setAttribute("target",_470.getAttribute("target"));
_46f.setAttribute("action",_470.getAttribute("action"));
}else{
_46f.setAttribute("action",location.pathname);
}
_46f.setAttribute("id","drillForm");
_46f.setAttribute("name","drillForm");
_46f.setAttribute("method","post");
_46f.style.display="none";
document.body.appendChild(_46f);
return _46f;
};
function addDrillEnvironmentFormFields(_471,oCV){
if(window.g_dfEmail){
_471.appendChild(createFormField("dfemail",window.g_dfEmail));
}
if(oCV!=null){
_471.appendChild(createFormField("cv.id",oCV.getId()));
if(typeof oCV.envParams["ui.sh"]!="undefined"){
_471.appendChild(createFormField("ui.sh",oCV.envParams["ui.sh"]));
}
if(oCV.getViewerWidget()==null){
if(typeof oCV.envParams["cv.header"]!="undefined"){
_471.appendChild(createFormField("cv.header",oCV.envParams["cv.header"]));
}
if(typeof oCV.envParams["cv.toolbar"]!="undefined"){
_471.appendChild(createFormField("cv.toolbar",oCV.envParams["cv.toolbar"]));
}else{
var _473=oCV.getAdvancedServerProperty("VIEWER_PASS_PORTLET_TOOLBAR_STATE_ON_DRILLTHROUGH");
if(oCV.m_viewerFragment&&_473!=null&&_473===true){
var _474=oCV.m_viewerFragment.canShowToolbar()?"true":"false";
_471.appendChild(createFormField("cv.toolbar",_474));
}
}
}
if(typeof oCV.envParams["ui.backURL"]!="undefined"){
_471.appendChild(createFormField("ui.backURL",oCV.envParams["ui.backURL"]));
}
if(typeof oCV.envParams["ui.postBack"]!="undefined"){
_471.appendChild(createFormField("ui.postBack",oCV.envParams["ui.postBack"]));
}
if(typeof oCV.envParams["savedEnv"]!="undefined"){
_471.appendChild(createFormField("savedEnv",oCV.envParams["savedEnv"]));
}
if(typeof oCV.envParams["ui.navlinks"]!="undefined"){
_471.appendChild(createFormField("ui.navlinks",oCV.envParams["ui.navlinks"]));
}
if(typeof oCV.envParams["lang"]!="undefined"){
_471.appendChild(createFormField("lang",oCV.envParams["lang"]));
}
if(typeof oCV.envParams["ui.errURL"]!="undefined"){
_471.appendChild(createFormField("ui.errURL",oCV.envParams["ui.errURL"]));
}
var _475="";
if(oCV.envParams["ui.routingServerGroup"]){
_475=oCV.envParams["ui.routingServerGroup"];
}
_471.appendChild(createHiddenFormField("ui.routingServerGroup",_475));
}else{
_471.appendChild(createFormField("cv.header","false"));
_471.appendChild(createFormField("cv.toolbar","false"));
}
};
function appendReportHistoryObjects(oCV,_477){
if(oCV!=null&&typeof oCV.rvMainWnd!="undefined"&&_477!=null){
oCV.rvMainWnd.addCurrentReportToReportHistory();
var _478=oCV.rvMainWnd.saveReportHistoryAsXML();
_477.appendChild(createFormField("cv.previousReports",_478));
}
};
function doSingleDrill(_479,args,_47b,_47c,_47d,_47e,_47f,_480,cvId,_482,_483){
var _484="";
if(typeof cvId=="string"){
_484=cvId;
}
var oCV=null;
try{
oCV=getCognosViewerObjectRef(cvId);
}
catch(exception){
}
if(!oCV&&parent!=this&&parent.doSingleDrill){
if(getCVId()!=""&&getCVId()!=cvId){
cvId=getCVId();
}
return parent.doSingleDrill(_479,args,_47b,_47c,_47d,_47e,_47f,_480,cvId,_482,_483);
}else{
if(typeof _47b=="undefined"){
_47b="default";
}else{
if(_47b=="execute"){
_47b="run";
}
}
if(_47b=="edit"&&oCV!=null&&typeof oCV.m_viewerFragment){
_479="_blank";
}
var _486=buildDrillForm(oCV);
var _487="<authoredDrillRequest>";
_487+="<param name=\"action\">"+sXmlEncode(_47b)+"</param>";
_487+="<param name=\"target\">"+sXmlEncode(args[0][1])+"</param>";
_487+="<param name=\"format\">"+sXmlEncode(_47c)+"</param>";
_487+="<param name=\"locale\">"+sXmlEncode(_47d)+"</param>";
_487+="<param name=\"prompt\">"+sXmlEncode(_482)+"</param>";
_487+="<param name=\"dynamicDrill\">"+sXmlEncode(_483)+"</param>";
if(typeof oCV!="undefined"&&oCV!=null){
_487+="<param name=\"sourceTracking\">"+oCV.getTracking()+"</param>";
if(typeof document.forms["formWarpRequest"+oCV.getId()]["ui.object"]!="undefined"){
_487+="<param name=\"source\">"+sXmlEncode(document.forms["formWarpRequest"+oCV.getId()]["ui.object"].value)+"</param>";
}
var _488=oCV.getModelPath();
_487+="<param name=\"metadataModel\">"+sXmlEncode(_488)+"</param>";
_487+="<param name=\"selectionContext\">"+sXmlEncode(getViewerSelectionContext(oCV.getSelectionController(),new CSelectionContext(_488)))+"</param>";
if(typeof document.forms["formWarpRequest"+oCV.getId()]["ui.object"]!="undefined"&&document.forms["formWarpRequest"+oCV.getId()]["ui.object"].value!=""){
_487+="<param name=\"source\">"+sXmlEncode(document.forms["formWarpRequest"+oCV.getId()]["ui.object"].value)+"</param>";
}else{
if(typeof oCV.envParams["ui.spec"]!="undefined"){
_487+="<param name=\"sourceSpecification\">"+sXmlEncode(oCV.envParams["ui.spec"])+"</param>";
}
}
}
if(_47e!=""){
_487+="<param name=\"bookmark\">"+_47e+"</param>";
}
if(_47b!="view"){
if(typeof _47f!="undefined"){
_487+="<param name=\"sourceContext\">"+sXmlEncode(_47f)+"</param>";
}
if(typeof _480!="undefined"){
_487+="<param name=\"objectPaths\">"+sXmlEncode(_480)+"</param>";
}
}
var _489=0;
_487+="<drillParameters>";
var _48a=[];
for(_489=1;_489<args.length;_489++){
var sSel=args[_489][1];
if(_47c=="HTML"&&(sSel.indexOf("<selectChoices")==0)){
var _48c=XMLHelper_GetFirstChildElement(XMLHelper_GetFirstChildElement(XMLBuilderLoadXMLFromString(args[_489][1])));
if(_48c){
var sMun=_48c.getAttribute("mun");
if(sMun!=null&&sMun!=""){
_48c.setAttribute("useValue",sMun);
sSel="<selectChoices>"+XMLBuilderSerializeNode(_48c)+"</selectChoices>";
}
}
}
var _48e=args[_489][0];
var _48f=false;
for(var i=0;i<_48a.length;i++){
var _491=_48a[i];
if(_491.name===_48e&&_491.value===sSel){
_48f=true;
break;
}
}
if(!_48f){
_48a.push({"name":_48e,"value":sSel});
_487+="<param name=\""+sXmlEncode(_48e)+"\">"+sXmlEncode(sSel)+"</param>";
}
}
_487+="</drillParameters>";
_487+=getExecutionParamNode(oCV);
_487+="</authoredDrillRequest>";
_486.appendChild(createFormField("authoredDrill.request",_487));
_486.appendChild(createFormField("ui.action","authoredDrillThrough2"));
_486.appendChild(createFormField("b_action","cognosViewer"));
addDrillEnvironmentFormFields(_486,oCV);
if(!oCV||!oCV.executeDrillThroughForIWidgetMobile(_486)){
if(oCV&&typeof oCV.sendDrillThroughRequest==="function"){
oCV.sendDrillThroughRequest(_486);
}else{
if(_479==""&&oCV!=null&&typeof oCV.m_viewerFragment!="undefined"){
oCV.m_viewerFragment.raiseAuthoredDrillEvent(_487);
}else{
if((oCV!=null&&oCV.getViewerWidget()!=null)||_479!=""){
setBackURLToCloseWindow(_486);
var _492="winNAT_"+(new Date()).getTime();
var _493="..";
if(oCV!=null){
_493=oCV.getWebContentRoot();
}
var _494=_493+"/rv/blankDrillWin.html";
if(_484){
_494+="?cv.id="+_484;
}
if(oCV==null){
_494=window.location.href.substring(0,window.location.href.indexOf("/v1"));
_494+="/?perspective=classicviewer";
_494+="&altDrillFlag=true";
_494+="&format="+sXmlEncode(_47c);
var _495=_486.getAttribute("name")+Date.now().toString();
_486.setAttribute("name",_495);
if(typeof (Storage)!=="undefined"){
localStorage.setItem(_495,_486.outerHTML);
_494+="&drillFormLabel="+_495;
}else{
console.log("Sorry! No Web Storage support...");
}
}
if(window.gViewerLogger){
window.gViewerLogger.log("Drill Specification",_487,"xml");
}
_486.target=_492;
newWindow=window.open(_494,_492);
}else{
appendReportHistoryObjects(oCV,_486);
if(window.gViewerLogger){
window.gViewerLogger.log("Drill Specification",_487,"xml");
}
_486.target=(oCV&&oCV.getDrillFormTarget)?oCV.getDrillFormTarget():"_self";
_486.submit();
if(oCV!=null&&!oCV.getDrillFormTarget){
setTimeout(getCognosViewerObjectRefAsString(oCV.getId())+".getRequestIndicator().show()",10);
}
}
}
}
}
}
};
function getExecutionParamNode(oCV){
var _497="";
if(typeof oCV!="undefined"&&oCV!=null){
var _498=oCV.getExecutionParameters();
if(_498!=""){
_497+="<param name=\"executionParameters\">";
_497+=sXmlEncode(_498);
_497+="</param>";
}
}
return _497;
};
function doSingleDrillThrough(_499,_49a,cvId){
var _49c=_499[0][0];
if(typeof _49c=="undefined"||_49c==null){
return;
}
var _49d=cvId&&window[cvId+"drillTargets"]?window[cvId+"drillTargets"][_49c]:drillTargets[_49c];
if(typeof _49d=="undefined"){
return;
}
if(_49a!=""&&_49d.getPath()==""){
document.location="#"+_49a;
}else{
var args=[];
args[args.length]=["ui.object",_49d.getPath()];
for(var _49f=1;_49f<_499.length;++_49f){
args[args.length]=_499[_49f];
}
var _4a0="";
if(_49d.getShowInNewWindow()=="true"){
_4a0="_blank";
}
var _4a1=_49d.getParameters();
var _4a2=_49d.getObjectPaths();
var _4a3=cvId;
if(!cvId){
_4a3=getCVId();
}
doSingleDrill(_4a0,args,_49d.getMethod(),_49d.getOutputFormat(),_49d.getOutputLocale(),_49a,_4a1,_4a2,_4a3,_49d.getPrompt(),false);
}
};
function getCVId(){
var _4a4="";
try{
_4a4=this.frameElement.id.substring("CVIFrame".length);
}
catch(exception){
}
return _4a4;
};
function doMultipleDrillThrough(_4a5,cvId){
var _4a7="<rvDrillTargets>";
for(var _4a8=0;_4a8<_4a5.length;++_4a8){
var _4a9=_4a5[_4a8];
if(_4a9.length<3){
continue;
}
var _4aa=_4a9[0];
if(typeof _4aa=="undefined"||_4aa==null){
continue;
}
var _4ab=_4a9[1];
if(typeof _4ab=="undefined"||_4ab==null){
continue;
}
var _4ac=cvId&&window[cvId+"drillTargets"]?window[cvId+"drillTargets"][_4aa]:drillTargets[_4aa];
if(typeof _4ac=="undefined"||_4ac==null){
continue;
}
if(_4ab===null||_4ab===""){
_4ab=_4ac.getLabel();
}
_4a7+="<drillTarget ";
_4a7+="outputFormat=\"";
_4a7+=_4ac.getOutputFormat();
_4a7+="\" ";
_4a7+="outputLocale=\"";
_4a7+=_4ac.getOutputLocale();
_4a7+="\" ";
_4a7+="label=\"";
_4a7+=sXmlEncode(_4ab);
_4a7+="\" ";
_4a7+="path=\"";
_4a7+=sXmlEncode(_4ac.getPath());
_4a7+="\" ";
_4a7+="showInNewWindow=\"";
_4a7+=_4ac.getShowInNewWindow();
_4a7+="\" ";
_4a7+="method=\"";
_4a7+=_4ac.getMethod();
_4a7+="\" ";
_4a7+="prompt=\"";
_4a7+=_4ac.getPrompt();
_4a7+="\" ";
_4a7+="dynamicDrill=\"";
_4a7+=_4ac.isDynamicDrillThrough();
_4a7+="\">";
for(var _4ad=2;_4ad<_4a9.length;++_4ad){
_4a7+=_4a9[_4ad];
}
_4a7+=_4ac.getParameters();
_4a7+=_4ac.getObjectPaths();
_4a7+="</drillTarget>";
}
_4a7+="</rvDrillTargets>";
if(!cvId){
cvId=getCVId();
}
doMultipleDrills(_4a7,cvId);
};
function CScriptLoader(_4ae){
this.m_oFiles={};
this.m_aScripts=[];
this.m_aDocumentWriters=[];
this.m_ajaxWarnings=[];
this.m_bIgnoreAjaxWarnings=false;
this.m_bHandleStylesheetLimit=false;
this.m_iInterval=20;
this.m_reFindCssPath=new RegExp("<link[^>]*href=\"([^\"]*)\"","i");
this.m_reFindInlineStyle=/<style\b(\s|.)*?<\/style>/gi;
this.m_reHasCss=/<link .*?>/gi;
this.m_reIsCss=/\.css$/i;
this.m_reIsJavascript=/\.js$/i;
this.m_reIsPromptingLocaleJavascript=/prompting.res.[promptingStrings|promptLocale].*\.js$/i;
this.m_reScriptTagClose=/\s*<\/script>.*?$/i;
this.m_reScriptTagOpen=/^.*?<script[^>]*>\s*/i;
this.m_reStyleTagClose=/(-|>|\s)*<\/style>\s*$/gi;
this.m_reStyleTagOpen=/^\s*<style[^>]*>(\s|<|!|-)*/gi;
this.m_reEscapedCharacters=/\\[\\"']/g;
this.m_reStringLiterals=/("|')[\s\S]*?\1/g;
this.m_sWebContentRoot=_4ae;
this.m_bHasCompletedExecution=false;
this.m_aScriptLoadQueue=[];
this.m_bBlockScriptLoading=false;
this.m_bUseScriptBlocking=false;
this.m_bBlockPromptingLocaleScripts=false;
this.m_aBlockedPromptingLocaleFileQueue=[];
};
CScriptLoader.prototype.hasCompletedExecution=function(){
return this.m_bHasCompletedExecution;
};
CScriptLoader.prototype.setHandlerStylesheetLimit=function(_4af){
this.m_bHandleStylesheetLimit=_4af;
};
CScriptLoader.prototype.executeScripts=function(_4b0,_4b1){
if(this.isReadyToExecute()){
for(var _4b2=0;_4b2<this.m_aScripts.length;_4b2++){
if(this.m_aScripts[_4b2]){
var _4b3=document.createElement("script");
_4b3.setAttribute("language","javascript");
_4b3.setAttribute("type","text/javascript");
this.addNamespaceAttribute(_4b3,_4b1);
_4b3.text=this.m_aScripts[_4b2];
document.getElementsByTagName("head").item(0).appendChild(_4b3);
}
}
this.m_aScripts=[];
for(var idx=0;idx<this.m_aDocumentWriters.length;++idx){
var _4b5=this.m_aDocumentWriters[idx];
_4b5.execute();
}
this.m_aDocumentWriters=[];
if(!this.m_aScripts.length&&!this.m_aDocumentWriters.length){
if(typeof _4b0=="function"){
_4b0();
}
this.m_bHasCompletedExecution=true;
}else{
setTimeout(function(){
window.gScriptLoader.executeScripts(_4b0,_4b1);
},this.m_iInterval);
}
}else{
setTimeout(function(){
window.gScriptLoader.executeScripts(_4b0,_4b1);
},this.m_iInterval);
}
};
CScriptLoader.prototype.isReadyToExecute=function(){
for(var _4b6 in this.m_oFiles){
if(this.m_oFiles[_4b6]!="complete"){
return false;
}
}
if(this.m_aScriptLoadQueue.length>0){
return false;
}
return true;
};
CScriptLoader.prototype.loadCSS=function(_4b7,_4b8,_4b9,_4ba){
var aM=_4b7.match(this.m_reHasCss);
if(aM){
for(var i=0;i<aM.length;i++){
if(aM[i].match(this.m_reFindCssPath)){
var _4bd=RegExp.$1;
if(_4bd.indexOf("GlobalReportStyles")!=-1){
this.validateGlobalReportStyles(_4bd);
if(_4b9){
if(_4bd.indexOf("GlobalReportStyles.css")!=-1){
_4bd=_4bd.replace("GlobalReportStyles.css","GlobalReportStyles_10.css");
}
var _4be=this.getGlobalReportStylesClassPrefix(_4bd);
_4bd=_4bd.replace(".css","_NS.css");
if(_4b8){
_4b8.className="buxReport "+_4be;
}
}
}
this.loadObject(_4bd,_4ba);
}
_4b7=_4b7.replace(aM[i],"");
}
}
return _4b7;
};
CScriptLoader.prototype.getGlobalReportStylesClassPrefix=function(_4bf){
var _4c0=null;
if(_4bf.indexOf("GlobalReportStyles_11.4.css")!=-1){
_4c0="v114";
}
if(_4bf.indexOf("GlobalReportStyles_11.css")!=-1){
_4c0="v11";
}
if(_4bf.indexOf("GlobalReportStyles_10.css")!=-1){
_4c0="v10";
}else{
if(_4bf.indexOf("GlobalReportStyles_1.css")!=-1){
_4c0="v1";
}else{
if(_4bf.indexOf("GlobalReportStyles_none.css")!=-1){
_4c0="vnone";
}else{
if(_4bf.indexOf("GlobalReportStyles.css")!=-1){
_4c0="v8";
}
}
}
}
return _4c0;
};
CScriptLoader.prototype.validateGlobalReportStyles=function(_4c1){
var _4c2=document.getElementsByTagName("link");
for(var i=0;i<_4c2.length;++i){
var _4c4=_4c2[i];
if(_4c4.getAttribute("href").indexOf("GlobalReportStyles")!=-1){
if(_4c4.getAttribute("href").toLowerCase()!=_4c1.toLowerCase()){
var _4c5=_4c1.split("/");
var _4c6=_4c4.getAttribute("href").split("/");
if(_4c5[_4c5.length-1]!=_4c6[_4c6.length-1]){
this.m_ajaxWarnings.push("Ajax response contains different versions of the GlobalReportStyles.css.");
}
}
break;
}
}
};
CScriptLoader.prototype.loadFile=function(_4c7,_4c8,_4c9){
var sURL="";
if(_4c7){
sURL=_4c7;
}
var _4cb=null;
if(typeof _4c8=="string"){
_4cb=_4c8;
}
var _4cc="POST";
if(_4c9=="GET"){
_4cc="GET";
}
var _4cd=null;
if(typeof ActiveXObject!="undefined"){
_4cd=new ActiveXObject("Msxml2.XMLHTTP");
}else{
_4cd=new XMLHttpRequest();
}
_4cd.open(_4cc,sURL,false);
_4cd.send(_4cb);
return _4cd.responseText;
};
function CScriptLoader_onReadyStateChange(){
if(typeof this.readyState=="undefined"){
this.readyState="complete";
}
if(this.readyState=="loaded"||this.readyState=="complete"){
var path=this.sFilePath;
if(!path&&this.getAttribute){
path=this.getAttribute("href");
}
window.gScriptLoader.setFileState(path,"complete");
window.gScriptLoader.m_bBlockScriptLoading=false;
if(this.sFilePath&&window.gScriptLoader.m_bBlockPromptingLocaleScripts&&this.sFilePath.match(window.gScriptLoader.m_reIsPromptingLocaleJavascript)){
window.gScriptLoader.m_bBlockPromptingLocaleScripts=false;
if(window.gScriptLoader.m_aBlockedPromptingLocaleFileQueue.length>0){
var _4cf=window.gScriptLoader.m_aBlockedPromptingLocaleFileQueue.shift();
window.gScriptLoader.loadObject(_4cf.sName,_4cf.sNamespaceId);
}
}
if(window.gScriptLoader.m_aScriptLoadQueue.length>0){
window.gScriptLoader.loadObject();
}
}
};
CScriptLoader.prototype.moveLinks=function(node){
if(!node){
return;
}
var _4d1=node.getAttribute("href");
if(!_4d1||this.m_oFiles[_4d1]){
return;
}
this.m_oFiles[_4d1]="complete";
document.getElementsByTagName("head").item(0).appendChild(node);
};
CScriptLoader.prototype.loadObject=function(_4d2,_4d3){
var _4d4=null;
if(typeof _4d2==="undefined"){
if(this.m_aScriptLoadQueue.length>0){
var _4d5=this.m_aScriptLoadQueue.shift();
_4d2=_4d5.name;
_4d3=_4d5.namespaceId;
}else{
return;
}
}
if(this.m_oFiles[_4d2]){
return;
}
if(this.m_bBlockScriptLoading){
this.m_aScriptLoadQueue.push({"name":_4d2,"namespaceId":_4d3});
}else{
if(_4d2.match(this.m_reIsCss)){
_4d4=document.createElement("link");
_4d4.setAttribute("rel","stylesheet");
_4d4.setAttribute("type","text/css");
_4d4.setAttribute("href",_4d2);
if(window.isIE&&window.isIE()){
_4d4.onreadystatechange=CScriptLoader_onReadyStateChange;
_4d4.onload=CScriptLoader_onReadyStateChange;
_4d4.onerror=CScriptLoader_onReadyStateChange;
this.m_oFiles[_4d2]="new";
}else{
this.m_oFiles[_4d2]="complete";
}
}else{
if(_4d2.match(this.m_reIsJavascript)){
if(_4d2.match(this.m_reIsPromptingLocaleJavascript)){
if(this.m_bBlockPromptingLocaleScripts){
this.m_aBlockedPromptingLocaleFileQueue.push({"sName":_4d2,"sNamespaceId":_4d3});
return;
}
this.m_bBlockPromptingLocaleScripts=true;
}
this.m_bBlockScriptLoading=this.m_bUseScriptBlocking;
_4d4=document.createElement("script");
_4d4.setAttribute("language","javascript");
_4d4.setAttribute("type","text/javascript");
_4d4.setAttribute("src",_4d2);
_4d4.sFilePath=_4d2;
_4d4.onreadystatechange=CScriptLoader_onReadyStateChange;
_4d4.onload=CScriptLoader_onReadyStateChange;
_4d4.onerror=CScriptLoader_onReadyStateChange;
this.addNamespaceAttribute(_4d4,_4d3);
this.m_oFiles[_4d2]="new";
}
}
if(_4d4){
document.getElementsByTagName("head").item(0).appendChild(_4d4);
}
}
};
CScriptLoader.prototype.loadScriptsFromDOM=function(_4d6,_4d7,_4d8){
if(!_4d6){
return;
}
var _4d9=_4d6.parentNode.getElementsByTagName("script");
while(_4d9.length>0){
var _4da=_4d9[0];
if(_4da.getAttribute("src")!=null&&_4da.getAttribute("src").length>0){
this.loadObject(_4da.getAttribute("src"),_4d7);
}else{
var _4db=_4da.innerHTML;
var _4dc=false;
if(_4db.indexOf("document.write")!=-1){
var _4dd=_4db.replace(this.m_reEscapedCharacters,"").replace(this.m_reStringLiterals,"");
_4dc=(_4dd.indexOf("document.write")!=-1);
}
if(_4dc){
if(_4d8){
var sId="CVScriptFromDOMPlaceHolder"+_4d9.length+_4d7;
var _4df=_4da.ownerDocument.createElement("span");
_4df.setAttribute("id",sId);
_4da.parentNode.insertBefore(_4df,_4da);
this.m_aDocumentWriters.push(new CDocumentWriter(sId,_4db));
}
}else{
if(_4db.length>0){
this.m_aScripts.push(_4db);
}
}
}
_4da.parentNode.removeChild(_4da);
}
};
CScriptLoader.prototype.loadStyles=function(_4e0,_4e1){
if(!_4e0||!_4e0.parentNode){
return;
}
var _4e2=_4e0.parentNode.getElementsByTagName("style");
while(_4e2.length>0){
var _4e3=_4e2[0];
if(_4e1){
this.addNamespaceAttribute(_4e3,_4e1);
}
if(window.isIE&&window.isIE()&&window.getNavVer()<10){
if((document.getElementsByTagName("style").length+document.getElementsByTagName("link").length)>=30){
if(this.m_bHandleStylesheetLimit){
if(typeof window.gaRV_INSTANCES!="undefined"){
for(var i=0;i<window.gaRV_INSTANCES.length;i++){
window.gaRV_INSTANCES[i].cleanupStyles();
}
}
}
if((document.getElementsByTagName("style").length+document.getElementsByTagName("link").length)>=30){
if(typeof console!="undefined"&&console&&console.log){
console.log("Stylesheet limit reached.");
}
this.m_ajaxWarnings.push("Stylesheet limit reached.");
return;
}
}
}
document.getElementsByTagName("head").item(0).appendChild(_4e3);
}
};
CScriptLoader.prototype.loadAll=function(_4e5,_4e6,_4e7,_4e8){
this.m_bScriptLoaderCalled=true;
this.m_bHasCompletedExecution=false;
this.loadScriptsFromDOM(_4e5,_4e7,_4e8);
if(this.containsAjaxWarnings()){
return false;
}
this.loadStyles(_4e5,_4e7);
if(this.containsAjaxWarnings()){
return false;
}
this.executeScripts(_4e6,_4e7);
return true;
};
CScriptLoader.prototype.setFileState=function(_4e9,_4ea){
this.m_oFiles[_4e9]=_4ea;
};
CScriptLoader.prototype.containsAjaxWarnings=function(){
if(this.m_bIgnoreAjaxWarnings){
return false;
}else{
return (this.m_ajaxWarnings.length>0);
}
};
CScriptLoader.prototype.addNamespaceAttribute=function(_4eb,_4ec){
if(typeof _4ec==="string"){
_4eb.setAttribute("namespaceId",_4ec);
}
};
if(typeof window.gScriptLoader=="undefined"){
window.gScriptLoader=new CScriptLoader();
}
var InfoBarHelper={};
InfoBarHelper.getContainerId=function(oCV,_4ee){
var _4ef=oCV.getLayoutElement(_4ee);
var lid=_4ef.getAttribute("lid");
var _4f1=lid===null?"":lid;
_4f1=_4f1.replace(oCV.getViewerWidget().getViewerId(),"").replace("RAP_NDH_","");
return _4f1;
};
InfoBarHelper.infoBarRemoveFilter=function(_4f2,_4f3,_4f4,_4f5){
var oCV=eval("window.oCV"+_4f2);
if(typeof oCV!="undefined"){
var _4f7=this.getContainerId(oCV,_4f3);
oCV.executeAction("Filter",{type:"remove",id:_4f7,item:_4f4,details:_4f5});
}
};
InfoBarHelper.infoBarRemoveSlider=function(_4f8,_4f9){
var oCV=eval("window.oCV"+_4f8);
var _4fb={};
_4fb[_4f9]={blockedEvents:["*"]};
oCV.fireWidgetEvent("com.ibm.bux.widget.updateEventFilter",_4fb);
if(typeof oCV!="undefined"){
oCV.executeAction("UpdateDataFilter",{"filterPayload":"{ \"clientId\" :\""+_4f9+"\"}"});
}
};
InfoBarHelper.infoBarRemoveSort=function(_4fc,_4fd,_4fe,_4ff){
var oCV=eval("window.oCV"+_4fc);
if(typeof oCV!="undefined"){
var _501=this.getContainerId(oCV,_4fd);
if(_4ff=="true"){
oCV.executeAction("Sort",{order:"none",id:_501,item:_4fe,type:"label"});
}else{
oCV.executeAction("Sort",{order:"none",id:_501,item:_4fe});
}
}
};
dojo.provide("InfoBarBase");
dojo.declare("InfoBarBase",null,{constructor:function(_502){
this.m_cognosViewer=_502;
this.m_parameterValues=new CParameterValues();
var _503=XMLBuilderLoadXMLFromString(this.m_cognosViewer.getExecutionParameters());
if(_503.childNodes.length==1){
this.m_parameterValues.loadWithOptions(_503.childNodes[0],false);
}
this.m_parameterStringOperators=new CParameterValueStringOperators(RV_RES.IDS_JS_FILTER_BETWEEN,RV_RES.IDS_JS_FILTER_NOT_BETWEEN,RV_RES.IDS_JS_FILTER_LESS_THAN,RV_RES.IDS_JS_FILTER_GREATER_THAN,RV_RES.IDS_JS_INFOBAR_AND_TEXT,RV_RES.IDS_JS_FILTER_EXCLUDE);
this.c_SliderCheckboxParameterPrefix="BusinessInsight.";
this.m_containerInfo=null;
this.m_editableFilters=null;
this.m_editableSorts=null;
this.m_editableSliders=null;
this.m_id=null;
this.m_layoutIndex=null;
this.m_timingDetails=null;
},setContainerInfo:function(_504){
this.m_containerInfo=_504;
},setTimingDetails:function(_505){
this.m_timingDetails=_505;
},setEditableFilters:function(_506){
this.m_editableFilters=_506;
},setId:function(_507){
this.m_id=_507;
},getId:function(){
return this.m_id;
},hasPrompts:function(){
var _508=this.m_parameterValues.length();
for(var _509=0;_509<_508;++_509){
var _50a=this.m_parameterValues.getAt(_509);
if(_50a!==null&&_50a.length()>0&&_50a.name().indexOf(this.c_SliderCheckboxParameterPrefix)!==0){
return true;
}
}
return false;
},addPromptDetails:function(_50b){
var _50c="";
var _50d=(_50b!==true);
if(this.hasPrompts()){
var _50e=this.m_id+"instructions "+this.m_id+"_promptString "+this.m_id+"_lockedString ";
for(var _50f=0,_510=this.m_parameterValues.length();_50f<_510;++_50f){
var _511=_50e+this.m_id+_50f+"_promptDetail";
var _512=this.m_parameterValues.getAt(_50f);
var _513=_512.length();
if(_512!==null&&_513>0&&_512.name().indexOf(this.c_SliderCheckboxParameterPrefix)!==0){
_50c+="<div class=\"infoBarDetailRow\" aria-labelledby=\""+_511+"\" role=\"listitem\""+(!_50d?">":" tabindex=\"-1\">");
_50c+="<table role=\"presentation\"><tr>";
_50c+=this.addInfoBarIcon("infobar_filter.gif",true);
_50c+="<td class=\"infoBarDetailsText\" role=\"presentation\" id=\""+this.m_id+_50f+"_promptDetail\">";
_50c+="<span class=\"bibi\">";
_50c+=html_encode(_512.name());
_50c+="</span>";
_50c+=" : ";
_50c+=_512.toString(this.m_parameterStringOperators);
_50c+="</td>";
_50c+=(_50d?this.addInfoBarIcon("infobar_locked.gif",false):"");
_50c+="</tr></table></div>";
}
}
}
return _50c;
},getPromptDetailsInJSON:function(){
var _514=[];
if(this.hasPrompts()){
for(var _515=0,_516=this.m_parameterValues.length();_515<_516;++_515){
var _517=this.m_parameterValues.getAt(_515);
var _518=_517.length();
if(_517!==null&&_518>0&&_517.name().indexOf(this.c_SliderCheckboxParameterPrefix)!==0){
_514.push({"type":"prompt","label":_517.name(),"description":_517.toString(this.m_parameterStringOperators)});
}
}
}
return _514;
},addSliderDetails:function(_519){
var _51a="";
var _51b=(_519!==true);
if(this.m_containerInfo!==null&&this.m_editableSliders){
var _51c=this.m_id+"instructions "+this.m_id+"_sliderString ";
var _51d=this.m_editableSliders.length;
for(var _51e=0;_51e<_51d;++_51e){
var _51f=_51c+this.m_id+_51e+"_sliderDetail";
var _520=this.m_editableSliders[_51e];
if(_520&&_520.name){
_51a+="<div class=\"infoBarDetailRow\" type=\"slider\" aria-labelledby=\""+_51f+"\" role=\"listitem\""+(!_51b?">":" tabindex=\"-1\">");
_51a+="<table role=\"presentation\"><tr>";
if(typeof _520.controlType!="undefined"&&_520.controlType=="checkbox"){
_51a+=this.addInfoBarIcon("infobar_select.gif",true);
}else{
_51a+=this.addInfoBarIcon("infobar_slider.gif",true);
}
_51a+="<td class=\"infoBarDetailsText\" role=\"presentation\" id=\""+this.m_id+_51e+"_sliderDetail\">";
_51a+="<span class=\"bibi\">";
_51a+=(_520.label?_520.label:_520.name);
_51a+=(_520.attributeName)?(" - "+_520.attributeName):"";
_51a+="</span>";
_51a+=" : ";
if(typeof _520.values!="undefined"){
_51a+=this.processFilterOperatorItems(_520.values);
}else{
if(_520.min==_520.max){
_51a+=_520.min;
}else{
_51a+=this.processFilterOperatorRange(RV_RES.IDS_JS_INFOBAR_BETWEEN_TEXT,_520.min,_520.max);
}
}
_51a+="</td>";
_51a+=(_51b?this.addRemoveSliderButton(_520.clientId):"");
_51a+="</tr></table></div>";
}
}
}
return _51a;
},getSliderDetailsInJSON:function(){
var _521=[];
if(this.m_containerInfo!==null&&this.m_editableSliders){
var _522=this.m_id+"instructions "+this.m_id+"_sliderString ";
var _523=this.m_editableSliders.length;
for(var _524=0;_524<_523;++_524){
var _525=this.m_editableSliders[_524];
if(_525&&_525.name){
var _526=(_525.label?_525.label:_525.name);
if(_525.attributeName){
_526+=(" "+_525.attributeName);
}
var _527="";
if(typeof _525.values!="undefined"){
_527+=this.processFilterOperatorItems(_525.values);
}else{
if(_525.min==_525.max){
_527+=_525.min;
}else{
_527+=this.processFilterOperatorRange(RV_RES.IDS_JS_INFOBAR_BETWEEN_TEXT,_525.min,_525.max);
}
}
_521.push({"type":"slider","label":_526,"description":_527});
}
}
}
return _521;
},hasLockedFilters:function(){
var _528=false;
if(this.m_containerInfo!==null&&typeof this.m_containerInfo.lockedFilters!=="undefined"){
var _529=this.m_containerInfo.lockedFilters.length;
for(var _52a=0;_52a<_529;++_52a){
var _52b=this.m_containerInfo.lockedFilters[_52a];
if(typeof _52b.staticText!="undefined"&&_52b.staticText.charAt(0)!==" "){
_528=true;
}
}
}
return _528;
},addLockedFilterDetails:function(_52c){
var _52d="";
var _52e=(_52c!==true);
if(this.m_containerInfo!==null&&typeof this.m_containerInfo.lockedFilters!=="undefined"){
var _52f=this.m_id+"instructions "+this.m_id+"_filterString "+this.m_id+"_lockedString ";
var _530=this.m_containerInfo.lockedFilters.length;
for(var _531=0;_531<_530;++_531){
var _532=_52f+this.m_id+_531+"_lockedFilterDetail";
var _533=this.m_containerInfo.lockedFilters[_531];
if(typeof _533.staticText!="undefined"&&_533.staticText.charAt(0)!==" "){
_52d+="<div class=\"infoBarDetailRow\" aria-labelledby=\""+_532+"\" role=\"listitem\""+(!_52e?">":" tabindex=\"-1\">");
_52d+="<table role=\"presentation\"><tr>";
_52d+=this.addInfoBarIcon("infobar_filter.gif",true);
_52d+="</td>";
_52d+="<td class=\"infoBarDetailsText\" role=\"presentation\" id=\""+this.m_id+_531+"_lockedFilterDetail\">";
_52d+="<span class=\"bibi\">";
_52d+=html_encode(_533.staticText);
_52d+="</span>";
_52d+="</td>";
_52d+=(_52e?this.addInfoBarIcon("infobar_locked.gif",false):"");
_52d+="</tr></table></div>";
}
}
}
return _52d;
},addFilteredItemsDetails:function(_534){
var _535="";
var _536=(_534!==true);
if(this.m_editableFilters){
for(var _537=0,_538=this.m_editableFilters.length;_537<_538;++_537){
var _539=this.m_editableFilters[_537];
var _53a=this.m_id+"instructions "+this.m_id+"_filterString "+this.m_id+_537+"_filterDetail";
var _53b=(typeof _539.itemLabel=="string")?_539.itemLabel:_539.item;
_535+="<div class=\"infoBarDetailRow\" type=\"filter\" aria-labelledby=\""+_53a+"\" role=\"listitem\""+(!_536?">":" tabindex=\"-1\">");
_535+="<table role=\"presentation\"><tr>";
_535+=this.addInfoBarIcon("infobar_filter.gif",true);
_535+="<td class=\"bibi infoBarDetailsText\" role=\"presentation\" id=\""+this.m_id+_537+"_filterDetail\">";
_535+=this.createHiddenSpan(this.m_id+_537+"_filterPosition",getCurrentPosistionString(this.m_cognosViewer,_537+1,_538));
_535+=html_encode(enforceTextDir(_53b));
_535+=this.processFilterOperator(_539);
_535+="</td>";
_535+=(_536?this.addRemoveFilterButton(_539.item,this.processFilterDetails(_539)):"");
_535+="</tr></table></div>";
}
}
return _535;
},getFilteredItemsDetailsInJSON:function(){
var _53c=[];
if(this.m_editableFilters){
for(var _53d=0,_53e=this.m_editableFilters.length;_53d<_53e;++_53d){
var _53f=this.m_editableFilters[_53d];
var _540=(typeof _53f.itemLabel=="string")?_53f.itemLabel:_53f.item;
_53c.push({"type":"filter","label":enforceTextDir(_540)+this.processFilterOperator(_53f),"description":""});
}
}
return _53c;
},addSortDetails:function(_541){
var _542="";
var _543=(_541!==true);
if(this.m_editableSorts){
for(var _544=0,_545=this.m_editableSorts.length;_544<_545;++_544){
var _546=this.m_editableSorts[_544];
var _547=this.m_id+"instructions "+this.m_id+"_sortString "+this.m_id+_544+"_sortDetail";
_542+="<div class=\"infoBarDetailRow\" type=\"sort\" aria-labelledby=\""+_547+"\" role=\"listitem\""+(!_543?">":" tabindex=\"-1\">");
_542+="<table role=\"presentation\"><tr>";
_542+=this.addInfoBarIcon("infobar_sort.gif",true);
var _548;
if(typeof _546.labels=="string"||typeof _546.valuesOf=="string"){
var _549=(typeof _546.labels=="string")?_546.labels:_546.valuesOf;
_548=(typeof _546.itemLabel=="string")?_546.itemLabel:_549;
_542+="<td class=\"bibi infoBarDetailsText\" role=\"presentation\" id=\""+this.m_id+_544+"_sortDetail\">";
_542+=this.createHiddenSpan(this.m_id+_544+"_sortPosition",getCurrentPosistionString(this.m_cognosViewer,_544+1,_545));
_542+=html_encode(_548);
_542+=" : ";
if(_546.byItems instanceof Array){
for(var _54a=0;_54a<_546.byItems.length;++_54a){
_542+=(_54a>0)?" - ":"";
_542+=_546.byItems[_54a].item;
_542+=", ";
_542+=this.m_sortStrings[_546.byItems[_54a].order];
}
}else{
if(typeof _546.valuesOf=="string"){
_542+=this.m_sortStrings["byValue"];
}else{
_542+=this.m_sortStrings["byLabel"];
}
_542+=", ";
_542+=this.m_sortStrings[_546.order];
}
_542+="</td>";
_542+=(_543?this.addRemoveSortButton(_549,"true"):"");
}else{
if(_546.valuesOf instanceof Array){
if(_546.valuesOf.length>0&&typeof _546.valuesOf[0].item=="string"){
_542+="<td class=\"bibi infoBarDetailsText\" role=\"presentation\" id=\""+this.m_id+_544+"_sortDetail\">";
_542+=this.createHiddenSpan(this.m_id+_544+"_sortPosition",getCurrentPosistionString(this.m_cognosViewer,_544+1,_545));
_548="";
if(typeof _546.itemLabel=="string"){
_548=_546.itemLabel;
}else{
for(var _54b=0;_54b<_546.valuesOf.length;++_54b){
_548+=" - ";
_548+=_546.valuesOf[_54b].item;
}
_548=_548.substring(3);
}
_542+=_548;
_542+=" : ";
_542+=this.m_sortStrings["byValue"];
_542+=", ";
_542+=this.m_sortStrings[_546.order];
_542+="</td>";
_542+=(_543?this.addRemoveSortButton(_546.valuesOf[0].item,"false"):"");
}
}
}
_542+="</tr></table></div>";
}
}
return _542;
},addInfoBarIcon:function(_54c,_54d){
return "<td class=\"infoBar"+(_54d?"Left":"Right")+"Icon\">"+"<img alt=\"\" src=\""+this.m_cognosViewer.getWebContentRoot()+"/rv/images/"+_54c+"\"/>"+"</td>";
},createHiddenSpan:function(id,text){
return "<span style=\"display:none\" id=\""+id+"\"> "+text+" </span>";
},addRemoveFilterButton:function(item,_551){
var _552="";
var _553=this.m_cognosViewer.getViewerWidget();
if(!this.m_cognosViewer.isLimitedInteractiveMode()&&!_553.isConsumeUser()){
var _554=RV_RES.IDS_JS_DELETE;
var _555=this.m_id+"_delete";
_552="<td class=\"infoBarRightIcon\" filterItem=\""+item+"\""+(_551?" details=\""+_551+"\"":"")+">"+"<button class=\"dijitStretch infoBarDeleteButton BUXNoPrint\" onclick=\"InfoBarHelper.infoBarRemoveFilter('"+this.m_cognosViewer.getId()+"',"+this.m_layoutIndex+",'"+item+"'"+(_551?",'"+_551+"'":"")+");\" aria-labelledby=\""+_555+"\" type=\"button\" role=\"button\" tabindex=\"0\" value=\"\" title=\""+_554+"\">"+"<span class=\"dijitInline infoBarIconDelete\" title=\""+_554+"\"></span>"+"<span class=\"dijitInline dijitDisplayNone infoBarDeleteButtonText\">x</span>"+"</button>"+"</td>";
}
return _552;
},addRemoveSliderButton:function(_556){
var _557="";
var _558=this.m_cognosViewer.getViewerWidget();
if(!this.m_cognosViewer.isLimitedInteractiveMode()&&!_558.isConsumeUser()){
var _559=RV_RES.IDS_JS_DELETE;
var _55a=this.m_id+"_delete";
_557="<td class=\"infoBarRightIcon\" slider=\""+_556+"\">"+"<button class=\"dijitStretch infoBarDeleteButton BUXNoPrint\" onclick=\"InfoBarHelper.infoBarRemoveSlider('"+this.m_cognosViewer.getId()+"','"+_556+"');\" aria-labelledby=\""+_55a+"\" type=\"button\" role=\"button\" tabindex=\"0\" value=\"\" title=\""+_559+"\">"+"<span class=\"dijitInline infoBarIconDelete\" title=\""+_559+"\"></span>"+"<span class=\"dijitInline dijitDisplayNone infoBarDeleteButtonText\">x</span>"+"</button>"+"</td>";
}
return _557;
},addRemoveSortButton:function(item,_55c){
var _55d="";
var _55e=this.m_cognosViewer.getViewerWidget();
if(!this.m_cognosViewer.isLimitedInteractiveMode()&&!this.m_cognosViewer.isBlacklisted("Sort")){
var _55f=RV_RES.IDS_JS_DELETE;
var _560=this.m_id+"_delete";
_55d="<td class=\"infoBarRightIcon\" sortItem=\""+item+"\" byLabel=\""+_55c+"\">"+"<button class=\"dijitStretch infoBarDeleteButton BUXNoPrint\" onclick=\"InfoBarHelper.infoBarRemoveSort('"+this.m_cognosViewer.getId()+"',"+this.m_layoutIndex+",'"+item+"','"+_55c+"');\" aria-labelledby=\""+_560+"\" type=\"button\" role=\"button\" tabindex=\"0\" value=\"\" title=\""+_55f+"\">"+"<span class=\"dijitInline infoBarIconDelete\" title=\""+_55f+"\"></span>"+"<span class=\"dijitInline dijitDisplayNone infoBarDeleteButtonText\">x</span>"+"</button>"+"</td>";
}
return _55d;
},processFilterOperator:function(_561){
var _562="";
if(typeof _561["in"]!="undefined"){
_562+=" "+CViewerCommon.getMessage(RV_RES.IDS_JS_INFOBAR_INCLUDE_TEXT,this.processFilterOperatorItems(_561["in"]));
}else{
if(typeof _561["notIn"]!="undefined"){
_562+=" "+CViewerCommon.getMessage(RV_RES.IDS_JS_INFOBAR_EXCLUDE_TEXT,this.processFilterOperatorItems(_561["notIn"]));
}else{
if(typeof _561["range"]!="undefined"||typeof _561["notRange"]!="undefined"){
var _563=typeof _561["range"]!="undefined"?RV_RES.IDS_JS_INFOBAR_BETWEEN_TEXT:RV_RES.IDS_JS_INFOBAR_NOT_BETWEEN_TEXT;
var _564=typeof _561["range"]!="undefined"?_561["range"]:_561["notRange"];
for(var _565=0;_565<_564.length;++_565){
var _566=_564[_565];
_562+=" "+CViewerCommon.getMessage(_563,[_566.from,_566.to]);
}
}else{
if(typeof _561["lessThan"]!="undefined"){
_562+=" "+RV_RES.IDS_JS_FILTER_LESS_THAN+" "+_561["lessThan"];
}else{
if(typeof _561["lessThanEqual"]!="undefined"){
_562+=" "+RV_RES.IDS_JS_FILTER_LESS_THAN_EQUAL+" "+_561["lessThanEqual"];
}else{
if(typeof _561["greaterThan"]!="undefined"){
_562+=" "+RV_RES.IDS_JS_FILTER_GREATER_THAN+" "+_561["greaterThan"];
}else{
if(typeof _561["greaterThanEqual"]!="undefined"){
_562+=" "+RV_RES.IDS_JS_FILTER_GREATER_THAN_EQUAL+" "+_561["greaterThanEqual"];
}else{
if(typeof _561["not"]!="undefined"&&_561["not"]=="true"){
_562+=" "+RV_RES.IDS_JS_FILTER_IS_NOT;
}
if(typeof _561["endsWith"]!="undefined"){
_562+=" "+RV_RES.IDS_JS_FILTER_ENDS_WITH+" "+_561["endsWith"];
}else{
if(typeof _561["beginsWith"]!="undefined"){
_562+=" "+RV_RES.IDS_JS_FILTER_BEGINS_WITH+" "+_561["beginsWith"];
}else{
if(typeof _561["contains"]!="undefined"){
_562+=" "+RV_RES.IDS_JS_FILTER_CONTAINS+" "+_561["contains"];
}else{
if(typeof _561["isMatchesSQLPatternFilter"]!="undefined"){
_562+=" "+RV_RES.IDS_JS_FILTER_IS_MATCHES_SQLPATTERNFILTER+" "+_561["isMatchesSQLPatternFilter"];
}
}
}
}
}
}
}
}
}
}
}
return _562;
},processFilterDetails:function(_567){
return html_encode("["+dojo.toJson(_567)+"]");
},processFilterOperatorItems:function(_568){
var _569="";
for(var _56a=0;_56a<_568.length;++_56a){
if(_56a!==0){
_569+=(RV_RES.IDS_JS_LIST_SEPARATOR+" ");
}
_569+=enforceTextDir(_568[_56a]);
}
return _569;
},processFilterOperatorRange:function(_56b,_56c,_56d){
if(typeof _56c=="undefined"){
_56c=" ";
}
if(typeof _56d=="undefined"){
_56d=" ";
}
return CViewerCommon.getMessage(_56b,[_56c,_56d]);
}});
dojo.declare("InfoBar",InfoBarBase,{constructor:function(_56e,_56f,_570,_571,_572){
this.m_layoutElement=_56f;
this.m_containerInfo=_570;
this.m_bRendered=false;
this.initializeEditableSorts(_571);
this.initializeEditableFilters(_571);
this.initializeEditableSliders(_571);
this.m_id=_572+_56e.getId();
this.m_layoutIndex=_572;
this.m_sortStrings={byLabel:RV_RES.IDS_JS_SORTED_BY_LABEL,byValue:RV_RES.IDS_JS_SORTED_BY_VALUE,descending:RV_RES.IDS_JS_SORT_DESCENDING_ORDER,ascending:RV_RES.IDS_JS_SORT_ASCENDING_ORDER};
this.connections=[];
},getLayoutElement:function(){
var _573=this.m_layoutElement;
var _574=_573.getAttribute("lid");
if(_574==null){
_574=_573.getAttribute("pflid");
}
if(_574!==null){
if(_573.tagName.toUpperCase()=="MAP"){
var _575=_573.parentNode.childNodes;
for(var _576=0;_576<_575.length;++_576){
var _577=_575[_576].getAttribute("usemap");
if(_577!==null&&_577==("#"+this.m_cognosViewer.getId()+_574)){
return _575[_576];
}
}
}else{
if(_573.parentNode.getAttribute("chartcontainer")=="true"){
return _573.parentNode;
}
}
return _573;
}
return null;
},initializeEditableSorts:function(_578){
if(this.m_containerInfo!==null){
if(typeof this.m_containerInfo.sort!=="undefined"){
this.m_editableSorts=this.m_containerInfo.sort;
}
if(typeof _578!=="undefined"){
for(var i=0;i<_578.length;++i){
this.m_editableSorts=this.mergeChildInfo(this.m_editableSorts,_578[i].sort,"labels");
this.m_editableSorts=this.mergeChildInfo(this.m_editableSorts,_578[i].sort,"valuesOf");
}
}
}
},initializeEditableFilters:function(_57a){
if(typeof this.m_containerInfo!=="undefined"&&this.m_containerInfo!==null){
if(typeof this.m_containerInfo.filter!=="undefined"){
this.m_editableFilters=this.m_containerInfo.filter;
}
if(typeof _57a!=="undefined"){
for(var i=0;i<_57a.length;++i){
this.m_editableFilters=this.mergeChildInfo(this.m_editableFilters,_57a[i].filter,"item");
}
}
}
},initializeEditableSliders:function(_57c){
if(typeof this.m_containerInfo!=="undefined"&&this.m_containerInfo!==null){
if(typeof this.m_containerInfo.sliders!=="undefined"){
this.m_editableSliders=this.m_containerInfo.sliders;
}
if(typeof _57c!=="undefined"){
for(var i=0;i<_57c.length;++i){
this.m_editableSliders=this.mergeChildInfo(this.m_editableSliders,_57c[i].sliders,"name");
}
}
}
},mergeChildInfo:function(_57e,_57f,key){
if(typeof _57f!="undefined"){
if(typeof _57e==="undefined"||_57e===null){
_57e=_57f;
}else{
var _581=[];
for(var i=0;i<_57e.length;++i){
_581[_57e[i][key]]=_57e[i];
}
for(var j=0;j<_57f.length;++j){
var _584=_57f[j];
if(typeof _581[_584[key]]=="undefined"){
_57e.push(_584);
_581[_584.item]=_584;
}
}
}
}
return _57e;
},hasSomethingRendered:function(){
return this.m_bRendered;
},render:function(){
var _585=document.getElementById("infoBar"+this.m_id);
if(_585===null){
var _586=(this.m_containerInfo&&this.m_containerInfo.displayTypeId==="singleton")?true:false;
if(_586&&!this.m_editableFilters&&!this.m_editableSliders){
return;
}
if(this.m_timingDetails||this.m_editableSorts||this.m_editableFilters||this.m_editableSliders||this.hasPrompts()||this.hasLockedFilters()){
var _587=this.getLayoutElement();
var _588=document.createElement("div");
_588.setAttribute("dir",this.m_cognosViewer.getDirection()==="rtl"?"rtl":"ltr");
_585=document.createElement("div");
_585.className="infoBar";
_585.setAttribute("id","infoBar"+this.m_id);
_585.setAttribute("cvid",this.m_cognosViewer.getId());
_585.setAttribute("layoutid",this.m_id);
_585.setAttribute("containerid",this.m_layoutIndex);
_585.setAttribute("role","region");
_585.setAttribute("aria-label",RV_RES.IDS_JS_REPORT_INFO_TITLE);
if(_586){
dojo.style(_585,{opacity:"0.6"});
}
_585.appendChild(this.renderHeader());
_585.appendChild(this.renderDetails());
_588.appendChild(_585);
_587.parentNode.insertBefore(_588,_587);
this.connections.push(dojo.connect(_585,"onkeydown",this,this.onKeyDown));
this.connections.push(dojo.query(".infoBarHeader",_585).connect("onmousedown",this,this.toggle));
this.connections.push(dojo.query(".infoBarLeftIcon",_585).connect("onmousedown",this,this.ignoreEvent));
this.connections.push(dojo.query(".infoBarDetailsText",_585).connect("onmousedown",this,this.ignoreEvent));
this.connections.push(dojo.query(".infoBarLockedItems",_585).connect("onmousedown",this,this.ignoreEvent));
this.m_bRendered=true;
if(this.wasInfoBarExpanded(this.m_id)){
this.show();
}
}
}
},renderHeader:function(){
var _589=this.isFilterApplied();
var _58a=this.isSortApplied();
var _58b=document.createElement("div");
_58b.id="infoBarHeader"+this.m_id;
_58b.className="infoBarHeaderDiv";
var _58c="<div role=\"presentation\" class=\"infoBarHeader BUXNoPrint\" style=\"width:100%\">"+this.addHeaderCloseButton()+this.addHeaderNavigationButton(_589,_58a)+this.addHeaderText(_589,_58a)+"</div>";
_58b.innerHTML=_58c;
return _58b;
},addHeaderNavigationButton:function(_58d,_58e){
var _58f=RV_RES.IDS_JS_INFOBAR_EXPAND;
var _590="infoBarIcon"+(_58d?"Filter":"")+(_58e?"Sort":"")+"Applied";
var _591="infoBarHeaderButton"+this.m_id+" infoBarHeaderText"+this.m_id;
return "<button class=\"dijitStretch infoBarHeaderButton\" id=\"infoBarHeaderButton"+this.m_id+"\" aria-labelledby=\""+_591+"\" type=\"button\" role=\"button\" tabindex=\"0\" value=\"\" title=\""+_58f+"\">"+"<span class=\"dijitInline "+_590+"\" title=\""+_58f+"\"></span>"+"<span class=\"dijitInline dijitDisplayNone infoBarHeaderButtonText\">!</span>"+"</button>";
},addHeaderText:function(_592,_593){
var _594=[];
if(_592){
_594.push(RV_RES.IDS_JS_FILTER_APPLIED);
}
if(_593){
_594.push(RV_RES.IDS_JS_SORT_APPLIED);
}
return "<span class=\"infoBarHeaderText\" id=\"infoBarHeaderText"+this.m_id+"\">"+_594.join(", ")+"</span>";
},addHeaderCloseButton:function(){
var _595=RV_RES.IDS_JS_INFOBAR_COLLAPSE;
var _596=this.m_id+"_collapse";
return "<button class=\"dijitStretch infoBarHeaderCloseButton\" id=\"infoBarHeaderCloseButton"+this.m_id+"\" aria-labelledby=\""+_596+"\" type=\"button\" role=\"button\" tabindex=\"0\" value=\"\" title=\""+_595+"\">"+"<span class=\"dijitInline infoBarIconClose BUXNoPrint\" title=\""+_595+"\"></span>"+"<span class=\"dijitInline dijitDisplayNone infoBarCloseButtonText\">x</span>"+"</button>";
},isFilterApplied:function(){
if(this.m_editableFilters||this.m_editableSliders||typeof this.m_containerInfo.lockedFilters!=="undefined"||this.hasPrompts()){
return true;
}
return false;
},isSortApplied:function(){
if(this.m_editableSorts){
return true;
}
return false;
},renderDetails:function(){
var _597=document.getElementById("infoBarFlyout"+this.m_id);
var _598=document.getElementById(this.m_id+"instructions");
if(_597===null){
this.getLayoutElement();
_597=document.createElement("div");
_597.setAttribute("id","infoBarFlyout"+this.m_id);
_597.setAttribute("cvid",this.m_cognosViewer.getId());
_597.setAttribute("layoutid",this.m_id);
_597.setAttribute("containerid",this.m_layoutIndex);
_597.className="infoBarFlyout";
_597.style.display="none";
_597.innerHTML="<div class=\"infoBarFlyoutContent\" id=\"infoBarFlyoutContent"+this.m_id+"\" role=\"list\">"+this.addLockedInfoBarDetails()+this.addEditableInfoBarDetails()+this.addRAPTimingDetails()+"</div>"+this.createHiddenSpan(this.m_id+"_filterString",RV_RES.IDS_JS_FILTER)+this.createHiddenSpan(this.m_id+"_sortString",RV_RES.IDS_JS_SORT)+this.createHiddenSpan(this.m_id+"_promptString",RV_RES.IDS_JS_INFOBAR_PROMPT)+this.createHiddenSpan(this.m_id+"_sliderString",RV_RES.IDS_JS_INFOBAR_SLIDER)+this.createHiddenSpan(this.m_id+"_lockedString",RV_RES.IDS_JS_INFOBAR_LOCKED)+this.createHiddenSpan(this.m_id+"_collapse",RV_RES.IDS_JS_INFOBAR_COLLAPSE)+this.createHiddenSpan(this.m_id+"_delete",RV_RES.IDS_JS_DELETE);
this.connections.push(dojo.connect(_597,"onkeydown",this,this.onKeyDown));
this.connections.push(dojo.query(".infoBarDetailRow",_597).forEach(function(item,_59a,_59b){
dojo.attr(item,{"aria-setsize":_59b.length,"aria-posinset":_59a+1});
}).connect("onfocus",function(e){
dojo.query(e.currentTarget).addClass("infoBarDetailRowHover");
}).connect("onblur",function(e){
var el=typeof e.explicitOriginalTarget!=="undefined"?e.explicitOriginalTarget:document.activeElement;
if(dojo.hasClass(el,"infoBarDeleteButton")){
return true;
}
dojo.query(e.currentTarget).removeClass("infoBarDetailRowHover");
}).connect("onmouseover",this,function(e){
this.focusDetailRow(e.currentTarget);
}));
}
if(_598===null){
_598=document.createElement("span");
_598.id=this.m_id+"instructions";
_598.setAttribute("role","presentation");
_598.style.visibility="hidden";
_598.style.display="none";
document.body.appendChild(_598);
_598.innerHTML=RV_RES.IDS_JS_INFOBAR_EXPLANATION;
}
return _597;
},addRAPTimingDetails:function(){
if(this.m_timingDetails){
var _5a0=this.m_timingDetails.length-1;
var _5a1=this.m_timingDetails[_5a0].time-this.m_timingDetails[0].time;
return "<div><table role=\"presentation\" class=\"infoBarLockedItems\">"+"<tr>"+this.addTimingIcon(_5a1,250,500)+"<td colspan=\"2\" class=\"bibi inforBarDetailsText\" role=\"presentation\" id=\""+this.m_id+"_timingDetail\" style=\"background-color:LightGray\"><b>RAP Total Time: ("+_5a1+")</b></td>"+"</tr>"+this.addRAPTimingItemDetails()+"</table></div>";
}
return "";
},addRAPTimingItemDetails:function(){
var _5a2="";
if(this.m_timingDetails){
for(var _5a3=0;_5a3<=this.m_timingDetails.length-1;++_5a3){
var _5a4=this.m_timingDetails[_5a3];
var _5a5=this.getTimeDiff(_5a3);
_5a2+="<tr class=\"infoBarDetailRow\" type=\"filter\" tabindex=\"-1\">";
if(_5a4.level){
_5a2+="<td colspan=3><font size=\"1\">"+_5a5+":"+html_encode(_5a4.event)+"</font></td></tr>";
}else{
_5a2+=this.addTimingIcon(_5a5,100,500);
_5a2+="<td class=\"bibi infoBarDetailsText\" role=\"presentation\" id=\""+this.m_id+_5a3+"_timingDetail\">";
_5a2+=html_encode(_5a4.event);
_5a2+="</td><td align=\"right\">"+_5a5+"</td>";
}
_5a2+="</tr>";
}
}
return _5a2;
},getTimeDiff:function(_5a6){
var _5a7=_5a6+1;
if(_5a7>=this.m_timingDetails.length){
return 0;
}
var _5a8=this.m_timingDetails[_5a6].level;
if(!(_5a8==this.m_timingDetails[_5a7].level)){
while(_5a7<this.m_timingDetails.length&&this.m_timingDetails[_5a7].level!=_5a8&&typeof this.m_timingDetails[_5a7].level!="undefined"){
_5a7++;
}
}
return (this.m_timingDetails[_5a7].time-this.m_timingDetails[_5a6].time);
},addTimingIcon:function(_5a9,_5aa,red){
var _5ac="icon_excellent_traffic.gif";
if(_5a9>red){
_5ac="icon_poor_traffic.gif";
}else{
if(_5a9>_5aa){
_5ac="icon_average_traffic.gif";
}
}
return this.addInfoBarIcon(_5ac,true);
},addLockedInfoBarDetails:function(){
if(this.hasPrompts()||typeof this.m_containerInfo.lockedFilters!=="undefined"){
return "<div role=\"presentation\" class=\"infoBarLockedItems\">"+this.addPromptDetails()+this.addLockedFilterDetails()+"</div>";
}
return "";
},addEditableInfoBarDetails:function(){
if(this.m_editableFilters||this.m_editableSorts||this.m_editableSliders){
return "<div role=\"presentation\" class=\"infoBarEditableItems\">"+this.addFilteredItemsDetails()+this.addSliderDetails()+this.addSortDetails()+"</div>";
}
return "";
},onKeyDown:function(evt){
var _5ae=evt.target;
var cvId=this.m_cognosViewer.getId();
var _5b0=document.getElementById("infoBarHeaderButton"+this.m_id);
var _5b1=document.getElementById(this.m_id+"instructions");
var node;
if(evt.keyCode=="13"){
_5b1.innerHTML=RV_RES.IDS_JS_INFOBAR_EXPLANATION;
if(_5ae===_5b0){
this.toggle();
return stopEventBubble(evt);
}
}else{
if(evt.keyCode=="27"){
var _5b3=this.m_cognosViewer.getA11YHelper();
if(this.m_cognosViewer.getCurrentNodeFocus()){
node=this.m_cognosViewer.getCurrentNodeFocus();
if(node.nodeName.toLowerCase()!="span"){
var _5b4=node.getElementsByTagName("span");
for(var _5b5=0;_5b5<_5b4.length;_5b5++){
if(_5b4[_5b5].style.display!="hidden"){
node=_5b4[_5b5];
break;
}
}
}
this.hide(false);
_5b3.setFocusToNode(node);
}else{
this.hide();
}
return stopEventBubble(evt);
}else{
if(evt.keyCode=="46"){
if(dojo.hasClass(_5ae,"infoBarDetailRow")){
node=dojo.query("td.infoBarRightIcon",_5ae)[0];
if(typeof node!=="undefined"){
if(_5ae.getAttribute("type")=="filter"){
InfoBarHelper.infoBarRemoveFilter(cvId,this.m_layoutIndex,node.getAttribute("filterItem"),node.getAttribute("details"));
}else{
if(_5ae.getAttribute("type")=="sort"){
InfoBarHelper.infoBarRemoveSort(cvId,this.m_layoutIndex,node.getAttribute("sortItem"),node.getAttribute("byLabel"));
}else{
if(_5ae.getAttribute("type")=="slider"){
InfoBarHelper.infoBarRemoveSlider(cvId,node.getAttribute("slider"));
}
}
}
}
}
}else{
if(evt.keyCode=="38"){
if(dojo.hasClass(_5ae,"infoBarDetailRow")){
this.focusDetailRow(_5ae,"prev");
}else{
this.focusDetailRow();
}
_5b1.innerHTML="";
return stopEventBubble(evt);
}else{
if(evt.keyCode=="40"){
if(dojo.hasClass(_5ae,"infoBarDetailRow")){
this.focusDetailRow(_5ae,"next");
}else{
this.focusDetailRow();
}
_5b1.innerHTML="";
return stopEventBubble(evt);
}else{
if(evt.keyCode=="9"){
var _5b6=document.getElementById("infoBar"+this.m_id);
if(dojo.hasClass(_5b6,"infoBarExpanded")){
if(dojo.hasClass(_5ae,"infoBarDetailRow")){
dojo.byId("infoBarHeaderCloseButton"+this.m_id).focus();
}else{
this.focusDetailRow();
}
return stopEventBubble(evt);
}
}
}
}
}
}
}
},focusDetailRow:function(_5b7,dir){
var _5b9=document.getElementById("infoBarFlyout"+this.m_id);
var _5ba=document.getElementById("infoBar"+this.m_id);
if(!dojo.hasClass(_5ba,"infoBarExpanded")){
return;
}
if(typeof _5b7=="undefined"||_5b7===null){
var _5bb=dojo.query(".infoBarLockedItems .infoBarDetailRow, .infoBarEditableItems .infoBarDetailRow",_5b9);
_5b7=_5bb[0];
}
if(_5b7&&dojo.hasClass(_5b7,"infoBarDetailRow")){
var _5bc,rows,len,i;
if(dir==="prev"){
if(_5b7.parentNode.previousSibling){
_5bc=_5b7.parentNode.previousSibling.childNodes[1];
}else{
rows=dojo.query(".infoBarDetailRow",_5b9);
len=rows.length;
if(_5b7===rows[0]){
_5bc=rows[len-1];
}else{
for(i=1;i<len;i++){
if(_5b7===rows[i]){
_5bc=rows[i-1];
break;
}
}
}
}
}else{
if(dir==="next"){
if(_5b7.parentNode.nextSibling){
_5bc=_5b7.parentNode.nextSibling.childNodes[1];
}else{
rows=dojo.query(".infoBarDetailRow",_5b9);
len=rows.length;
if(_5b7===rows[len-1]){
_5bc=rows[0];
}else{
for(i=0;i<len-1;i++){
if(_5b7===rows[i]){
_5bc=rows[i+1];
break;
}
}
}
}
}else{
_5bc=_5b7;
}
}
_5bc.focus();
}
},toggle:function(evt){
var _5c1=document.getElementById("infoBar"+this.m_id);
if(dojo.hasClass(_5c1,"infoBarExpanded")){
this.hide();
}else{
this.show();
}
stopEventBubble(evt);
},ignoreEvent:function(evt){
stopEventBubble(evt);
},show:function(){
var _5c3=document.getElementById("infoBar"+this.m_id);
if(!dojo.hasClass(_5c3,"infoBarExpanded")){
var _5c4=document.getElementById("infoBarHeader"+this.m_id);
var _5c5=document.getElementById("infoBarFlyout"+this.m_id);
var _5c6=document.getElementById("infoBarHeaderButton"+this.m_id);
var _5c7,_5c8,_5c9;
var _5ca=dojo.fx.wipeIn({node:_5c5,duration:300,onEnd:dojo.hitch(this,function(){
this.focusDetailRow();
_5c6.setAttribute("title",RV_RES.IDS_JS_INFOBAR_COLLAPSE);
_5c6.childNodes[0].setAttribute("title",RV_RES.IDS_JS_INFOBAR_COLLAPSE);
})});
this.updateInfoBarRenderedState(this.m_id,"true");
dojo.addClass(_5c3,"infoBarExpanded");
if(this.m_containerInfo&&this.m_containerInfo.displayTypeId==="singleton"){
dojo.style(_5c3,{opacity:"1"});
}
dojo.style(_5c3,"width","auto");
_5ca.play();
var _5cb=document.getElementById("infoBarHeaderText"+this.m_id).innerHTML;
var _5cc=this._getTextWidth(_5cb)+40;
if(_5cc<500){
_5cc=500;
}
var _5cd=this.m_cognosViewer.getViewerWidget();
var _5ce=_5cd.findContainerDiv().clientWidth;
if(_5cc>_5ce){
_5cc=_5ce-5;
}
_5c3.style.width=_5cc+"px";
dojo.removeClass(_5c4,"BUXNoPrint");
}
},_getTextWidth:function(text){
var div=document.createElement("div");
div.className="infoBar infoBarHeader";
div.style.fontWeight="bold";
div.style.position="absolute";
div.style.visibility="hidden";
div.style.height="auto";
div.style.width="auto";
document.body.appendChild(div);
div.innerHTML=text;
var _5d1=div.clientWidth;
document.body.removeChild(div);
return _5d1;
},hide:function(_5d2){
var _5d3=document.getElementById("infoBar"+this.m_id);
if(dojo.hasClass(_5d3,"infoBarExpanded")){
this.updateInfoBarRenderedState(this.m_id,"false");
var _5d4=document.getElementById("infoBarHeader"+this.m_id);
var _5d5=document.getElementById("infoBarFlyout"+this.m_id);
var _5d6=document.getElementById("infoBarHeaderButton"+this.m_id);
dojo.addClass(_5d4,"BUXNoPrint");
dojo.fx.wipeOut({node:_5d5,duration:300,onEnd:dojo.hitch(this,function(){
dojo.removeClass(_5d3,"infoBarExpanded");
dojo.style(_5d3,"width","auto");
if(this.m_containerInfo&&this.m_containerInfo.displayTypeId==="singleton"){
dojo.style(_5d3,{opacity:"0.6"});
}
_5d6.setAttribute("title",RV_RES.IDS_JS_INFOBAR_EXPAND);
_5d6.childNodes[0].setAttribute("title",RV_RES.IDS_JS_INFOBAR_EXPAND);
if(!_5d2){
_5d6.focus();
}
})}).play();
}
},updateInfoBarRenderedState:function(_5d7,_5d8){
var _5d9=this.m_cognosViewer.getViewerWidget();
if(_5d9){
var _5da=_5d9.getInfoBarRenderedState();
_5da[_5d7]=_5d8;
}
},wasInfoBarExpanded:function(_5db){
var _5dc=this.m_cognosViewer.getViewerWidget();
if(_5dc){
var _5dd=_5dc.getInfoBarRenderedState();
if(_5dd){
if(_5dd[_5db]){
if("true"===_5dd[_5db]){
return true;
}
}
}
}
return false;
},destroy:function(){
for(var i=0;i<this.connections.length;i++){
var _5df=this.connections[i];
if(_5df&&_5df.remove){
dojo.disconnect(_5df);
}
}
var _5e0=document.getElementById("infoBar"+this.m_id);
if(_5e0){
var _5e1=_5e0.parentNode;
if(_5e1){
_5e1.removeChild(_5e0);
}
}
_5e0=document.getElementById(this.m_id+"instructions");
if(_5e0){
_5e0.parentNode.removeChild(_5e0);
}
delete this.m_layoutElement;
delete this.m_containerInfo;
}});
dojo.declare("AnnotationFilterContext",null,{m_parameterValuesString:null,m_parameterValuesSpec:null,m_slidersJSON:null,m_filterJSON:null,constructor:function(_5e2,_5e3,_5e4,_5e5){
this.m_parameterValuesString=_5e2;
this.m_parameterValuesSpec=_5e3;
this.m_slidersJSON=_5e4;
this.m_filterJSON=_5e5;
},setParameterValuesString:function(_5e6){
this.m_parameterValuesString=_5e6;
},setParameterValuesSpec:function(_5e7){
this.m_parameterValuesSpec=_5e7;
},setSlidersJSON:function(_5e8){
this.m_slidersJSON=_5e8;
},setFilterJSON:function(_5e9){
this.m_filterJSON=_5e9;
},getParameterValuesString:function(){
return this.m_parameterValuesString||null;
},getParameterValuesSpec:function(){
return this.m_parameterValuesSpec||null;
},getPromptsJSON:function(){
var _5ea=null;
if(this.m_parameterValuesString){
_5ea={};
_5ea.parameterValuesString=this.m_parameterValuesString;
}
if(this.m_parameterValuesString){
_5ea=_5ea||{};
_5ea.parameterValuesSpec=this.m_parameterValuesSpec;
}
return _5ea;
},getSlidersJSON:function(){
return this.m_slidersJSON||null;
},getFilterJSON:function(){
return this.m_filterJSON||null;
},isEmpty:function(){
if(this.m_parameterValuesString||this.m_parameterValuesSpec||this.m_slidersJSON||this.m_filterJSON){
return false;
}
return true;
}});
dojo.declare("AnnotationInfoBar",InfoBarBase,{constructor:function(_5eb,lid){
this.m_id="annoInfoBar_"+lid;
this.m_layoutElementId=lid;
},createFilterContext:function(){
var _5ed=null;
var _5ee=null;
var _5ef=null;
var _5f0=null;
if(this.m_cognosViewer.getRAPReportInfo()){
var _5f1=this.m_cognosViewer.getRAPReportInfo();
if(_5f1.getContainers()){
var _5f2=_5f1.getContainers();
if(_5f2[this.m_layoutElementId]){
var _5f3=_5f2[this.m_layoutElementId];
if(typeof _5f3.filter!=="undefined"){
_5ed=_5f3.filter;
}
if(typeof _5f3.sliders!=="undefined"){
_5ee=_5f3.sliders;
}
}
}
}
if(this.hasPrompts()){
_5ef=CViewerCommon.buildParameterValuesSpec(this.m_cognosViewer);
_5f0=this.m_cognosViewer.getExecutionParameters();
}
if(_5ed||_5ee||_5ef||_5f0){
return new AnnotationFilterContext(_5f0,_5ef,_5ee,_5ed);
}
return null;
}});
dojo.declare("AnnotationInfoBarRenderer",null,{m_AnnotationInfoBar:null,m_id:null,m_labelledByHideButton:"",miniCognosViewer:null,m_editableSliders:null,constructor:function(_5f4,lid,_5f6,_5f7){
this.m_AnnotationInfoBar=null;
this.miniCognosViewer={};
this.miniCognosViewer.m_sId=_5f4.id;
this.miniCognosViewer.getId=_5f4.getId;
this.miniCognosViewer.m_sParameters=(_5f6===null||_5f6.getParameterValuesString()===null)?"":_5f6.getParameterValuesString();
this.miniCognosViewer.getExecutionParameters=_5f4.getExecutionParameters;
this.miniCognosViewer.getWebContentRoot=_5f4.getWebContentRoot;
this.m_AnnotationInfoBar=new AnnotationInfoBar(this.miniCognosViewer,lid);
this.m_AnnotationInfoBar.setId("annoInfoBar_"+_5f7+lid);
this.m_id="annoInfoBar_"+_5f7+lid+"_renderer";
if(_5f6){
if(_5f6.getSlidersJSON()){
this.m_AnnotationInfoBar.setContainerInfo({"sliders":_5f6.getSlidersJSON()});
this.m_AnnotationInfoBar.m_editableSliders=_5f6.getSlidersJSON();
}
if(_5f6.getFilterJSON()){
this.m_AnnotationInfoBar.setEditableFilters(_5f6.getFilterJSON());
}
}
},render:function(){
var _5f8="<div class=\"infoBar infoBarCollapsed\" id=\"infoBarHeaderCollapsed"+this.m_id+"\" >"+this.renderHeader(false)+"</div>";
var _5f9="<div class=\"infoBar infoBarExpanded\" id=\"infoBarHeaderExpanded"+this.m_id+"\" style=\"display:none;\" >"+this.renderHeader(true)+this.renderDetails()+"</div>";
_5f9=this.updateHideButtonLabelledBy(_5f9);
var _5fa=document.getElementById("annotationInfoBarInstructions");
if(_5fa===null){
_5fa=document.createElement("span");
_5fa.id="annotationInfoBarInstructions";
_5fa.setAttribute("role","presentation");
_5fa.style.visibility="hidden";
_5fa.style.display="none";
var _5fb=this.m_AnnotationInfoBar.createHiddenSpan("annoInfoBarButtonInstruction",RV_RES.IDS_JS_ANNO_INFOBAR_BUTTON_EXPLANATION)+this.m_AnnotationInfoBar.createHiddenSpan("annoInfoBar_filterString",RV_RES.IDS_JS_FILTER)+this.m_AnnotationInfoBar.createHiddenSpan("annoInfoBar_promptString",RV_RES.IDS_JS_INFOBAR_PROMPT)+this.m_AnnotationInfoBar.createHiddenSpan("annoInfoBar_sliderString",RV_RES.IDS_JS_INFOBAR_SLIDER);
document.body.appendChild(_5fa);
_5fa.innerHTML=_5fb;
}
return _5f8+_5f9;
},renderInJSON:function(){
var _5fc=[];
return _5fc.concat(this.m_AnnotationInfoBar.getPromptDetailsInJSON(),this.m_AnnotationInfoBar.getFilteredItemsDetailsInJSON(),this.m_AnnotationInfoBar.getSliderDetailsInJSON());
},renderHeader:function(_5fd){
var mode=(_5fd)?"Hide":"Show";
var _5ff=(_5fd)?RV_RES.IDS_JS_ANNO_INFOBAR_HIDE:RV_RES.IDS_JS_ANNO_INFOBAR_SHOW;
var _600=(_5fd)?("XXREPLACEXX"):" annoInfoBarHeaderControlButtonText"+mode+this.m_id;
var _601="<table class=\"annoInfoBarHeader\" id=\"annoInfoBarHeader"+mode+this.m_id+"\" role=\"presentation\">"+"<tr>"+"<td class=\"annoInfoBarHeaderText\" id=\"infoBarHeaderText"+this.m_id+"\" >"+RV_RES.IDS_JS_FILTER_APPLIED+"</td>"+"<td class=\"annoInfoBarHeaderControl\" id=\"infoBarHeader"+mode+this.m_id+"\" >"+"<button id=\"annoInfoBarHeaderControl"+mode+this.m_id+"\" aria-labelledby=\""+_600+"\" type=\"button\" role=\"button\" tabindex=\"0\" value=\"\" title=\""+_5ff+"\""+" onmousedown=\"annotationInfoBarToggle('"+this.m_id+"', '"+mode+"');\">"+"<span id=\"annoInfoBarHeaderControlButtonText"+mode+this.m_id+"\"class=\"dijitInline annoInfoBarHeaderControlText\" title=\""+_5ff+"\" >"+_5ff+"</span>"+"</button>"+"</td>"+"</tr>"+"</table>";
return _601;
},renderDetails:function(){
var _602=this.m_AnnotationInfoBar.addPromptDetails(true);
var _603=this.m_AnnotationInfoBar.addFilteredItemsDetails(true);
var _604=this.m_AnnotationInfoBar.addSliderDetails(true);
var _605="<div class=\"annoInfoBarDetails\" id=\"annoInfoBarDetails"+this.m_id+"\" role=\"presentation\">"+_602+_603+_604+"</div>";
this.m_labelledByHideButton=(_602.length===0)?"":(" annoInfoBar_promptString "+this.m_AnnotationInfoBar.getId()+"0_promptDetail ");
this.m_labelledByHideButton+=(_603.length===0)?"":(" annoInfoBar_filterString "+this.m_AnnotationInfoBar.getId()+"0_filterDetail ");
this.m_labelledByHideButton+=(_604.length===0)?"":(" annoInfoBar_sliderString "+this.m_AnnotationInfoBar.getId()+"0_sliderDetail  annoInfoBar_sliderString "+this.m_AnnotationInfoBar.getId()+"1_sliderDetail ");
this.m_labelledByHideButton+=" annoInfoBarHeaderControlButtonTextHide"+this.m_id;
return _605;
},updateHideButtonLabelledBy:function(_606){
return _606.replace("XXREPLACEXX",this.m_labelledByHideButton);
}});
function annotationInfoBarToggle(mId,_608){
var _609=document.getElementById("infoBarHeaderExpanded"+mId);
var _60a=document.getElementById("infoBarHeaderCollapsed"+mId);
var _60b=null;
if("Show"===_608){
dojo.style(_609,{display:""});
dojo.style(_60a,{display:"none"});
_60b=document.getElementById("annoInfoBarHeaderControlHide"+mId);
}else{
dojo.style(_60a,{display:""});
dojo.style(_609,{display:"none"});
_60b=document.getElementById("annoInfoBarHeaderControlShow"+mId);
}
if(_60b){
_60b.focus();
}
};
var CV_BACKGROUND_LAYER_ID="CV_BACK";
if(typeof window.gaRV_INSTANCES=="undefined"){
window.gaRV_INSTANCES=[];
}
if(!window.gViewerLogger){
window.gViewerLogger={log:function(hint,_60d,type){
},addContextInfo:function(_60f){
}};
}
function CognosViewerSession(oCV){
this.m_sConversation=oCV.getConversation();
this.m_sParameters=oCV.getExecutionParameters();
this.m_envParams={};
applyJSONProperties(this.m_envParams,oCV.envParams);
this.m_bRefreshPage=false;
};
function CCognosViewer(sId,_612){
if(typeof window.gCognosViewer=="undefined"){
window.gCognosViewer=this;
}
if(typeof ViewerConfig=="function"){
this.m_viewerConfig=new ViewerConfig();
try{
if(typeof window.getViewerConfiguration=="function"){
this.m_viewerConfig.configure(window.getViewerConfiguration());
}else{
if(window.parent&&typeof window.parent.getViewerConfiguration=="function"){
this.m_viewerConfig.configure(window.parent.getViewerConfiguration());
}
}
}
catch(e){
}
this.m_viewerUIConfig=this.m_viewerConfig.getUIConfig();
}
this.m_sActionState="";
this.m_bKeepSessionAlive=false;
this.m_undoStack=[];
this.m_aSecRequests=[];
this.m_bDebug=false;
this.m_sCAFContext="";
this.m_sContextInfoXML="";
this.m_sConversation="";
this.m_sStatus="";
this.m_sGateway=_612;
this.m_sId=sId;
this.m_sMetadataInfoXML="";
this.m_sParameters="";
this.m_sReportState="";
this.envParams={};
this.m_sTracking="";
this.m_sSoapFault="";
this.m_sWaitHTML="";
this.m_oDrillMgr=null;
this.goDrillManager=null;
this.m_oWorkingDialog=null;
this.m_oRequestExecutedIndicator=null;
this.m_bUseWorkingDialog=true;
this.m_oSubscriptionManager=null;
this.m_oCVMgr=null;
this.m_bUseSafeMode=true;
if(typeof CViewerManager=="function"){
this.m_oCVMgr=new CViewerManager(this);
}
if(window.gaRV_INSTANCES){
var _613=false;
for(var _614=0;_614<window.gaRV_INSTANCES.length;_614++){
if(window.gaRV_INSTANCES[_614].m_sId==sId){
window.gaRV_INSTANCES[_614]=this;
_613=true;
break;
}
}
if(!_613){
window.gaRV_INSTANCES=window.gaRV_INSTANCES.concat(this);
}
}
this.m_bReportHasPrompts=false;
this.m_viewerWidget=null;
this.m_flashChartsObjectIds=[];
this.m_raiseSharePromptEvent=true;
this.m_actionFactory=null;
this.m_calculationCache={};
this.m_drillTargets=[];
this.m_reportRenderingDone=false;
if(typeof PinFreezeManager!=="undefined"){
this.m_pinFreezeManager=new PinFreezeManager(this);
}
if(typeof ViewerDispatcher!=="undefined"){
this.m_viewerDispatcher=new ViewerDispatcher();
}
this.m_retryDispatcherEntry=null;
this.m_RAPReportInfo=null;
if(typeof ViewerState=="function"){
this.m_viewerState=new ViewerState();
}
this.m_aInfoBar=null;
};
CCognosViewer.prototype.setScheduledMobileOutput=function(_615){
this.m_mobileScheduledOutput=_615;
if(_615){
this.m_sStatus="complete";
}
};
CCognosViewer.prototype.setTabInfo=function(_616){
this.m_tabsPayload=_616;
if(this.m_tabsPayload&&this.m_tabsPayload.tabs&&this._keepTabSelected){
var _617=false;
for(var i=0;i<this.m_tabsPayload.tabs.length;i++){
var tab=this.m_tabsPayload.tabs[i];
if(tab.id==this._keepTabSelected){
this.m_tabsPayload.currentTabId=this._keepTabSelected;
break;
}
}
this._keepTabSelected=null;
}
};
CCognosViewer.prototype.setKeepTabSelected=function(_61a){
this._keepTabSelected=_61a;
};
CCognosViewer.prototype.getTabController=function(){
return this.m_tabControl;
};
CCognosViewer.prototype.getCurrentlySelectedTab=function(){
return this.m_currentlySelectedTab?this.m_currentlySelectedTab:null;
};
CCognosViewer.prototype.deleteTabs=function(){
if(this.m_tabControl){
this.m_tabControl.destroy();
delete this.m_tabControl;
this.m_tabControl=null;
}
this.m_tabsPayload=null;
};
CCognosViewer.prototype.renderTabs=function(){
if(!this.m_tabsPayload){
return;
}
var _61b=this.isSavedOutput()&&!this.m_mobileScheduledOutput;
var _61c=document.getElementById("CVNavLinks"+this.getId());
if(_61c||!this.shouldWriteNavLinks()||_61b){
var _61d=this.getReportDiv();
this.m_bHasTabs=true;
if(this.m_tabControl&&this.m_tabControl.isSavedOutput()!=_61b){
this.deleteTabs();
}
if(!this.m_tabControl){
if(this.getStatus()!="complete"&&!_61b){
return;
}
var tr=document.createElement("tr");
var _61f=document.createElement("td");
tr.appendChild(_61f);
var _620=document.getElementById("mainViewerTR"+this.getId());
if(!_620){
return;
}
if(this.m_tabsPayload.position=="topLeft"){
_620.parentNode.insertBefore(tr,_620);
}else{
_620.parentNode.appendChild(tr);
}
var _621=null;
if(this.m_viewerWidget){
_621=this.m_viewerWidget.findContainerDiv().firstChild;
}else{
_621=_61f;
}
var oCV=this;
if(_61b){
this.m_tabControl=new CognosTabControl(_621,function(_623){
oCV.switchSavedOutputTab(_623,true);
});
this.switchSavedOutputTab(this.m_tabsPayload.currentTabId,false);
}else{
this.m_tabControl=new CognosTabControl(_621,function(_624){
oCV.switchTabs(_624);
});
}
if(this.m_viewerWidget){
this.m_tabControl.setSpaceSaverContainer(_61f);
this.m_tabControl.setScrollAttachNode(this.m_viewerWidget.findContainerDiv());
this.m_tabControl.useAbsolutePosition(true);
}
this.m_tabControl.setIsSavedOutput(_61b);
if(!window.gScriptLoader.m_bScriptLoaderCalled){
var _625=document.getElementById("RVContent"+this.getId());
var _626=this._getNodesWithViewerId(_625,"link",null);
for(var i=0;i<_626.length;i++){
window.gScriptLoader.moveLinks(_626[i]);
if(_626[i].getAttribute("href").indexOf("promptCommon.css")>0){
this.setHasPrompts(true);
}
}
window.gScriptLoader.loadStyles(_625,this.getId());
this.repaintDiv(_625);
}
}
if(this.getStatus()=="prompting"){
this.previouslySelectedTab=null;
this.m_tabControl.hide();
}else{
if(this.isHighContrast()){
this.m_tabControl.setHighContrast(true);
}
this.m_tabControl.render(this.m_tabsPayload);
this.m_currentlySelectedTab=this.m_tabControl.getSelectedTabId();
if(this.m_switchingToTabId&&this.m_currentlySelectedTab!=this.m_switchingToTabId){
this._removeTabContent(_61d.parentNode,this.m_switchingToTabId);
this._removeTabContent(_61d.parentNode,this.m_currentlySelectedTab);
if(_61c){
this._removeTabContent(_61c.parentNode,this.m_switchingToTabId);
this._removeTabContent(_61c.parentNode,this.m_currentlySelectedTab);
}
this.m_tabInfo={};
}
this.m_switchingToTabId=null;
_61d.setAttribute("tabId",this.m_currentlySelectedTab);
if(_61c){
_61c.setAttribute("tabId",this.m_currentlySelectedTab);
}
if(isIE()&&_61b&&window.resizeIFrame&&!this.m_viewerFragment&&!this.m_viewerWidget){
window.resizeIFrame();
}
}
this.setMaxContentSize();
}else{
var obj=this;
setTimeout(function(){
obj.renderTabs();
},100);
}
};
CCognosViewer.prototype.cancelTabSwitch=function(){
var _629=this.getReportDiv();
var _62a=this.m_switchingToTabId;
this.m_currentlySelectedTab=_62a;
this.m_tabControl.selectTab(this.previouslySelectedTab,false);
this.switchTabs(this.previouslySelectedTab);
if(_629){
_629.parentNode.removeChild(_629);
}
if(this.m_tabInfo[this.m_currentlySelectedTab]&&this.m_tabInfo[this.m_currentlySelectedTab].styles){
this._addTabStylesToHead(this.m_tabInfo[this.m_currentlySelectedTab].styles);
}
this.previouslySelectedTab=null;
this.m_tabInfo[_62a]=null;
};
CCognosViewer.prototype.switchSavedOutputTab=function(_62b,_62c){
var _62d=this.getSelectionController();
if(_62d){
_62d.clearSelectedObjects();
}
this.m_currentlySelectedTab=this.m_tabControl.getSelectedTabId();
if(_62c){
this.notifyTabChange(_62b);
}
if(this.m_viewerWidget){
this.m_viewerWidget.getSavedOutput().switchSavedOutputTab(_62b,_62c);
this.getTabController().resetPosition();
}else{
if(!this.savedOutputTabNodes){
var _62e=document.getElementById("CVIFrame"+this.getId());
this.savedOutputTabNodes=getElementsByAttribute(_62e.contentWindow.document.body,"*","tabid");
}
if(!this.savedOutputTabNodes){
return;
}
for(var i=0;i<this.savedOutputTabNodes.length;i++){
var _630=this.savedOutputTabNodes[i];
_630.style.display=_630.getAttribute("tabid")==_62b?"":"none";
}
this.setMaxContentSize();
}
};
CCognosViewer.prototype.notifyTabChange=function(_631){
};
CCognosViewer.prototype._getNodesWithViewerId=function(_632,_633,id){
var _635=[];
var _636=_632.getElementsByTagName(_633);
for(var i=0;i<_636.length;i++){
var node=_636[i];
if(!id||(node.getAttribute&&node.getAttribute("namespaceId")==id)){
node.parentNode.removeChild(node);
_635.push(node);
i--;
}
}
return _635;
};
CCognosViewer.prototype._removeTabStylesFromHead=function(){
var id=this.getId();
return this._getNodesWithViewerId(document.getElementsByTagName("head").item(0),"style",id);
};
CCognosViewer.prototype._addTabStylesToHead=function(_63a){
if(!_63a){
return;
}
for(var i=0;i<_63a.length;i++){
document.getElementsByTagName("head").item(0).appendChild(_63a[i]);
}
};
CCognosViewer.prototype.switchTabs=function(_63c){
if(this.m_currentlySelectedTab==_63c){
return;
}
var _63d=this.getSelectionController();
if(_63d){
_63d.clearSelectedObjects();
}
var _63e=this.getReportDiv();
this.m_nReportDiv=null;
var _63f=_63e.clientHeight;
_63e.removeAttribute("id");
_63e.style.display="none";
if(!this.m_tabInfo){
this.m_tabInfo={};
}
var _640=this._removeTabStylesFromHead();
var _641=this.getSelectionController().getCCDManager();
this.m_tabInfo[this.m_currentlySelectedTab]={"conversation":this.getConversation(),"metadata":_641.getClonedMetadataArray(),"contextdata":_641.getClonedContextdataArray(),"secondaryRequests":this.getSecondaryRequests(),"styles":_640,"hasPromptControl":this.getHasPrompts()};
var _642=this._findChildWithTabId(_63e.parentNode,_63c);
this.previouslySelectedTab=this.m_currentlySelectedTab;
if(_642&&this.m_tabInfo[_63c]&&this.m_tabInfo[_63c].hasPromptControl){
if(_642){
_642.parentNode.removeChild(_642);
_642=null;
}
delete this.m_tabInfo[_63c];
this.m_tabInfo[_63c]=null;
}
if(_642){
this.m_currentlySelectedTab=_63c;
_642.style.display="block";
_642.setAttribute("id","CVReport"+this.getId());
if(this.m_tabInfo&&this.m_tabInfo[_63c]){
var _643=this.m_tabInfo[_63c];
if(_643.conversation){
this.setConversation(_643.conversation);
}
if(_643.metadata){
_641.SetMetadata(_643.metadata);
}
if(_643.contextdata){
_641.SetContextData(_643.contextdata);
}
if(_643.secondaryRequests){
this.setSecondaryRequests(_643.secondaryRequests);
}
if(_643.styles){
this._addTabStylesToHead(_643.styles);
}
this.setHasPrompts(_643.hasPromptControl);
}
if(this.shouldWriteNavLinks()){
this.writeNavLinks(this.getSecondaryRequests().join(" "));
}
if(this.getPinFreezeManager()&&this.getPinFreezeManager().hasFrozenContainers()){
this.getPinFreezeManager().rePaint();
if(isIE()){
var _644=document.getElementById("RVContent"+this.getId());
this.repaintDiv(_644);
}
}
if(this.m_viewerWidget){
this.m_viewerWidget.placeTabControlInView();
}
this._keepFocus=null;
this.doneLoadingUpdateA11Y("complete");
this.getTabController().resetPosition();
this.setMaxContentSize();
}else{
this.m_switchingToTabId=_63c;
var _645=_63e.cloneNode(false);
_645.style.display="block";
_645.setAttribute("id","CVReport"+this.getId());
_645.removeAttribute("tabId");
_63e.parentNode.appendChild(_645);
_645.innerHTML="<table height='"+_63f+"px'><tr><td height='100%'></td></tr></table>";
var _646=new ViewerDispatcherEntry(this);
_646.addFormField("ui.action","reportAction");
_646.addFormField("generic.anyURI.http://developer.cognos.com/ceba/constants/runOptionEnum#pageGroup",_63c);
if(this.m_viewerWidget){
this.m_viewerWidget.placeTabControlInView();
}
this.dispatchRequest(_646);
}
};
CCognosViewer.prototype._removeTabContent=function(_647,_648){
var _649=this._findChildWithTabId(_647,_648);
while(_649){
_649.parentNode.removeChild(_649);
_649=this._findChildWithTabId(_647,_648);
}
};
CCognosViewer.prototype._findChildWithTabId=function(_64a,_64b){
var _64c=null;
for(var i=0;i<_64a.childNodes.length;i++){
var _64e=_64a.childNodes[i];
if(_64e.getAttribute("tabId")==_64b){
_64c=_64e;
break;
}
}
return _64c;
};
CCognosViewer.prototype.clearTabs=function(){
if(!this.m_bHasTabs){
return;
}
this.m_tabInfo={};
var _64f=this.getReportDiv();
var _650=_64f.parentNode;
for(var i=0;i<_650.childNodes.length;i++){
var node=_650.childNodes[i];
if(node.getAttribute("id")!="CVReport"+this.m_sId){
_650.removeChild(node);
i--;
}
}
};
CCognosViewer.prototype.isSavedOutput=function(){
var _653=this.envParams["ui.action"];
return _653==="view"||_653==="buxView";
};
CCognosViewer.prototype.renderSavedOutputIFrame=function(url,_655,_656){
var _657=document.getElementById("CVReport"+this.getId());
var _658=document.createElement("iframe");
_658.style.width="100%";
_658.style.height="99%";
_658.id="CVIFrame"+this.getId();
_658.title=_655;
_658.setAttribute("frameBorder","0");
_657.appendChild(_658);
var obj=this;
var func=function(){
obj.renderTabs();
};
setTimeout(function(){
if(_656){
if(_658.attachEvent){
_658.attachEvent("onload",func);
}else{
_658.addEventListener("load",func,true);
}
}
_658.src=url;
},1);
};
CCognosViewer.prototype.updatePageState=function(_65b){
if(_65b&&this.getState()){
this.getState().setPageState(_65b);
}
};
CCognosViewer.prototype.getPageInfo=function(){
if(this.m_viewerState&&this.m_viewerState.getPageState()){
var _65c=this.m_viewerState.getPageState();
return {"currentPage":_65c.getCurrentPage(),"pageCount":_65c.getPageCount()};
}
return {};
};
CCognosViewer.prototype.isIWidgetMobile=function(){
return this.m_viewerWidget&&this.m_viewerWidget.isMobile();
};
CCognosViewer.prototype.isInteractiveViewer=function(){
return false;
};
CCognosViewer.prototype.launchGotoPageForIWidgetMobile=function(form){
if(this.isIWidgetMobile()){
this.m_viewerWidget.launchGotoPageForIWidgetMobile(form);
return true;
}
return false;
};
CCognosViewer.prototype.executeDrillThroughForIWidgetMobile=function(form){
if(this.isIWidgetMobile()){
this.m_viewerWidget.executeDrillThroughForIWidgetMobile(form);
return true;
}
return false;
};
CCognosViewer.prototype.getState=function(){
return this.m_viewerState;
};
CCognosViewer.prototype.getConfig=function(){
return this.m_viewerConfig;
};
CCognosViewer.prototype.getUIConfig=function(){
return this.m_viewerUIConfig;
};
CCognosViewer.prototype.setCurrentNodeFocus=function(node){
this.m_currentNodeFocus=node;
};
CCognosViewer.prototype.getCurrentNodeFocus=function(node){
return this.m_currentNodeFocus;
};
CCognosViewer.prototype.setCurrentPromptControlFocus=function(node){
this.m_CurrentPromptControlFocus=node;
};
CCognosViewer.prototype.getCurrentPromptControlFocus=function(node){
return this.m_CurrentPromptControlFocus;
};
CCognosViewer.prototype.loadExtra=function(){
};
CCognosViewer.prototype.setRetryDispatcherEntry=function(_663){
this.m_retryDispatcherEntry=_663;
};
CCognosViewer.prototype.getRetryDispatcherEntry=function(){
return this.m_retryDispatcherEntry;
};
CCognosViewer.prototype.resetViewerDispatcher=function(){
if(this.m_viewerDispatcher!==null){
delete this.m_viewerDispatcher;
this.m_viewerDispatcher=new ViewerDispatcher();
}
};
CCognosViewer.prototype.getViewerDispatcher=function(){
return this.m_viewerDispatcher;
};
CCognosViewer.prototype.setFaultDispatcherEntry=function(_664){
this.m_faultDispatcherEntry=_664;
};
CCognosViewer.prototype.getFaultDispatcherEntry=function(){
return this.m_faultDispatcherEntry;
};
CCognosViewer.prototype.dispatchRequest=function(_665){
this.setFaultDispatcherEntry(null);
this.getViewerDispatcher().dispatchRequest(_665);
};
CCognosViewer.prototype.getActiveRequest=function(){
return this.getViewerDispatcher().getActiveRequest();
};
CCognosViewer.prototype.getProductLocale=function(){
if(this.sProductLocale){
return this.sProductLocale;
}
return "en";
};
CCognosViewer.prototype.getDirection=function(){
if(this.sDirection){
return this.sDirection;
}
return "ltr";
};
CCognosViewer.prototype.isBidiEnabled=function(){
if(this.bIsBidiEnabled){
return true;
}
return false;
};
CCognosViewer.prototype.getBaseTextDirection=function(){
if(this.isBidiEnabled()){
if(this.sBaseTextDirection){
return this.sBaseTextDirection;
}
}
return "";
};
CCognosViewer.prototype.getActionFactory=function(){
if(!this.m_actionFactory){
this.m_actionFactory=new ActionFactory(this);
}
return this.m_actionFactory;
};
CCognosViewer.prototype.getAction=function(_666){
var _666=this.getActionFactory().load(_666);
_666.setCognosViewer(this);
return _666;
};
CCognosViewer.prototype.getCalculationCache=function(){
return this.m_calculationCache;
};
CCognosViewer.prototype.updateOutputForA11ySupport=function(){
this.updateBorderCollapse();
if(this.getA11YHelper()){
this.getA11YHelper().addLabelledByForItemsOutsideOfContainers();
}
var _667=navigator.userAgent.toLowerCase();
var _668=_667.indexOf("iphone")!=-1;
var _669=_667.indexOf("ipod")!=-1;
var _66a=_667.indexOf("ipad")!=-1;
var _66b=_668||_669||_66a;
var _66c=_667.indexOf("android")!=-1;
if(_66b||_66c){
document.body.classList.add("clsViewerMobile");
}
};
CCognosViewer.prototype.checkForHighContrast=function(){
if(this.isBux){
this.m_bHighContrast=dojo.hasClass(document.body,"dijit_a11y")?true:false;
}else{
var _66d=document.createElement("div");
_66d.id=this.m_sId+"hc";
_66d.style.border="1px solid";
_66d.style.borderColor="red green";
_66d.style.height="10px";
_66d.style.top="-999px";
_66d.style.position="absolute";
document.body.appendChild(_66d);
var _66e=null;
if(isIE()){
_66e=_66d.currentStyle;
}else{
_66e=_66d.ownerDocument.defaultView.getComputedStyle(_66d,null);
}
if(!_66e){
return;
}
this.m_bHighContrast=_66e.borderTopColor==_66e.borderRightColor;
document.body.removeChild(_66d);
}
};
CCognosViewer.prototype.isHighContrast=function(){
if(typeof this.m_bHighContrast==="undefined"){
this.checkForHighContrast();
}
return this.m_bHighContrast;
};
CCognosViewer.prototype.isLimitedInteractiveMode=function(){
return this.envParams&&this.envParams.limitedInteractiveMode&&this.envParams.limitedInteractiveMode==="true";
};
CCognosViewer.prototype.updateBorderCollapse=function(){
if(this.isHighContrast()==true){
var _66f=null;
if(this.envParams["ui.action"]=="view"&&!this.isBux){
var _670=document.getElementById("CVIFrame"+this.getId());
_66f=_670.contentWindow.document;
}else{
_66f=document.getElementById("CVReport"+this.getId());
}
var _671=_66f.getElementsByTagName("table");
for(var i=0;i<_671.length;i++){
if(_671[i].style.borderCollapse=="collapse"){
_671[i].style.borderCollapse="separate";
}
}
}
};
CCognosViewer.prototype.isAccessibleMode=function(){
if(this.m_bAccessibleMode==true){
return true;
}
return false;
};
CCognosViewer.prototype.isSinglePageReport=function(){
for(var _673 in this.m_aSecRequests){
if(this.m_aSecRequests[_673]=="nextPage"||this.m_aSecRequests[_673]=="previousPage"){
return false;
}
}
return true;
};
CCognosViewer.prototype.hasNextPage=function(){
for(var _674 in this.m_aSecRequests){
if(this.m_aSecRequests[_674]=="nextPage"){
return true;
}
}
return false;
};
CCognosViewer.prototype.hasPrevPage=function(){
for(var _675 in this.m_aSecRequests){
if(this.m_aSecRequests[_675]=="previousPage"){
return true;
}
}
return false;
};
CCognosViewer.prototype.captureHotkeyPageNavigation=function(evt){
evt=(evt)?evt:((event)?event:null);
if(evt){
var node=getNodeFromEvent(evt);
var _678=(node&&node.nodeName)?node.nodeName.toLowerCase():null;
if((evt.keyCode==8&&_678!="input"&&_678!="textarea")||(evt.altKey==true&&(evt.keyCode==37||evt.keyCode==39))){
evt.returnValue=false;
evt.cancelBubble=true;
if(typeof evt.stopPropagation!="undefined"){
evt.stopPropagation();
}
if(typeof evt.preventDefault!="undefined"){
evt.preventDefault();
}
return false;
}
}
return true;
};
CCognosViewer.prototype.setUseWorkingDialog=function(_679){
this.m_bUseWorkingDialog=_679;
};
CCognosViewer.prototype.getWorkingDialog=function(){
if(!this.m_oWorkingDialog&&this.m_bUseWorkingDialog&&typeof WorkingDialog!=="undefined"){
if(this.getConfig()&&this.getConfig().getHttpRequestConfig()&&this.getConfig().getHttpRequestConfig().getWorkingDialog()){
this.m_oWorkingDialog=this.getConfig().getHttpRequestConfig().getWorkingDialog();
}else{
this.m_oWorkingDialog=new WorkingDialog(this);
}
}
return this.m_oWorkingDialog;
};
CCognosViewer.prototype.getRequestIndicator=function(){
if(this.m_bUseWorkingDialog&&!this.m_oRequestExecutedIndicator&&typeof RequestExecutedIndicator!=="undefined"){
if(this.getConfig()&&this.getConfig().getHttpRequestConfig()&&this.getConfig().getHttpRequestConfig().getRequestIndicator()){
this.m_oRequestExecutedIndicator=this.getConfig().getHttpRequestConfig().getRequestIndicator();
}else{
this.m_oRequestExecutedIndicator=new RequestExecutedIndicator(this);
}
}
return this.m_oRequestExecutedIndicator;
};
CCognosViewer.prototype.disableBrowserHotkeyPageNavigation=function(){
if(document.attachEvent){
document.attachEvent("onkeydown",this.captureHotkeyPageNavigation);
}else{
if(document.addEventListener){
document.addEventListener("keydown",this.captureHotkeyPageNavigation,false);
}
}
};
CCognosViewer.prototype.setHasPrompts=function(_67a){
if(!_67a){
this.preProcessControlArray=[];
}
this.m_bReportHasPrompts=_67a;
};
CCognosViewer.prototype.getHasPrompts=function(){
return this.m_bReportHasPrompts;
};
CCognosViewer.prototype.setUsePageRequest=function(_67b){
this.m_viewerDispatcher.setUsePageRequest(_67b);
};
CCognosViewer.prototype.getUsePageRequest=function(){
return this.m_viewerDispatcher.getUsePageRequest();
};
CCognosViewer.prototype.setKeepSessionAlive=function(_67c){
this.m_bKeepSessionAlive=_67c;
};
CCognosViewer.prototype.getKeepSessionAlive=function(){
return this.m_bKeepSessionAlive;
};
CCognosViewer.prototype.getWebContentRoot=function(){
if(typeof this.sWebContentRoot!="undefined"){
return this.sWebContentRoot;
}else{
return "..";
}
};
CCognosViewer.prototype.getSkin=function(){
if(typeof this.sSkin!="undefined"){
return this.sSkin;
}else{
return this.getWebContentRoot()+"/skins/corporate";
}
};
CCognosViewer.prototype.getSelectionController=function(){
var _67d;
try{
_67d=getCognosViewerSCObjectRef(this.m_sId);
}
catch(e){
_67d=null;
}
return _67d;
};
CCognosViewer.prototype.addCallback=function(_67e,oFct,_680){
if(!this.m_aCallback){
this.m_aCallback=[];
}
this.m_aCallback=this.m_aCallback.concat({m_sEvent:_67e,m_oCallback:oFct,m_bCaptureEvent:(_680===true)});
};
CCognosViewer.prototype.canDrillDown=function(sId){
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _683=this.getSelectionController();
if(_683){
return (_683.canDrillDown(sCtx));
}
}
return false;
};
CCognosViewer.prototype.canDrillUp=function(sId){
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _686=this.getSelectionController();
if(_686){
return (_686.canDrillUp(sCtx));
}
}
return false;
};
CCognosViewer.prototype.canSubmitPrompt=function(){
var _687=null;
if(this.preProcessControlArray&&this.preProcessControlArray instanceof Array){
var _688=this.preProcessControlArray.length;
for(var k=0;k<_688;k++){
_687=eval(this.preProcessControlArray[k]);
if(_687.isValid()===false){
if(!this.m_reportRenderingDone||!_687.getCascadeOnParameter||!_687.getCascadeOnParameter()){
return false;
}
}
}
}
return true;
};
CCognosViewer.prototype.closeContextMenuAndToolbarMenus=function(){
if(this.rvMainWnd){
this.rvMainWnd.closeContextMenuAndToolbarMenus();
}
};
CCognosViewer.prototype.dcm=function(_68a,_68b){
if(this.canDisplayContextMenu()){
if(this.preSelectNode==true){
_68b=false;
this.preSelectNode=false;
}
if(this.rvMainWnd.displayContextMenu(_68a,_68b)!=false){
return stopEventBubble(_68a);
}
}
};
CCognosViewer.prototype.canDisplayContextMenu=function(){
if(!this.getUIConfig()||this.getUIConfig().getShowContextMenu()){
return (!this.isWorkingOrPrompting()&&this.rvMainWnd!=null&&typeof this.bCanUseCognosViewerContextMenu!="undefined"&&this.bCanUseCognosViewerContextMenu);
}
return false;
};
CCognosViewer.prototype.de=function(_68c){
var _68d=this.getDrillMgr();
if(_68d){
_68d.singleClickDrillEvent(_68c,"RV");
}
};
CCognosViewer.prototype.debug=function(sMsg){
if(this.m_bDebug){
var _68f="";
var _690=this.debug.caller;
if(typeof _690=="object"&&_690!==null){
_68f=_690.toString().match(/function (\w*)/)[1];
}
if(!_68f){
_68f="?";
}
alert(_68f+": "+sMsg);
}
};
CCognosViewer.prototype.callbackExists=function(_691){
var _692=false;
if(this.m_aCallback&&this.m_aCallback.length){
for(var _693=0;_693<this.m_aCallback.length;++_693){
var oCB=this.m_aCallback[_693];
if(oCB.m_sEvent==_691){
return true;
}
}
}
return false;
};
CCognosViewer.prototype.executeCallback=function(_695){
var _696=false;
if(this.m_aCallback&&this.m_aCallback.length){
for(var _697=0;_697<this.m_aCallback.length;++_697){
var oCB=this.m_aCallback[_697];
if(oCB.m_sEvent==_695){
if(typeof oCB.m_oCallback=="function"){
oCB.m_oCallback();
}
if(oCB.m_bCaptureEvent){
_696=true;
}
}
}
}
return _696;
};
CCognosViewer.prototype.getCAFContext=function(){
return this.m_sCAFContext;
};
CCognosViewer.prototype.getSoapFault=function(){
return this.m_sSoapFault;
};
CCognosViewer.prototype.getColumnContextIds=function(sId){
return this.getContextIds(sId,2);
};
CCognosViewer.prototype.getConversation=function(){
return this.m_sConversation;
};
CCognosViewer.prototype.getStatus=function(){
return (this.m_sStatus?this.m_sStatus:"");
};
CCognosViewer.prototype.isWorking=function(_69a){
if(typeof _69a!="string"){
_69a=this.getStatus();
}
return ((""+_69a).match(/^(working|stillWorking)$/)?true:false);
};
CCognosViewer.prototype.isWorkingOrPrompting=function(){
return (this.getStatus().match(/^(working|stillWorking|prompting)$/)?true:false);
};
CCognosViewer.prototype.getActionState=function(){
return this.m_sActionState;
};
CCognosViewer.prototype.getDataItemName=function(sId){
var _69c=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _69e=this.getSelectionController();
if(_69e){
var _69f=_69e.getRefDataItem(sCtx);
if(_69f){
_69c=_69f;
}
}
}
return _69c;
};
CCognosViewer.prototype.getDataType=function(sId){
var _6a1=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _6a3=this.getSelectionController();
if(_6a3){
var _6a4=_6a3.getDataType(sCtx);
if(_6a4){
_6a1=_6a4;
}
}
}
return _6a1;
};
CCognosViewer.prototype.getDepth=function(sId){
var _6a6=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _6a8=this.getSelectionController();
if(_6a8){
var _6a9=_6a8.getDepth(sCtx);
if(_6a9){
_6a6=_6a9;
}
}
}
return _6a6;
};
CCognosViewer.prototype.getDrillMgr=function(){
if(!this.m_oDrillMgr){
this.loadExtra();
if(typeof CDrillManager=="function"){
this.m_oDrillMgr=new CDrillManager(this);
this.goDrillManager=this.m_oDrillMgr;
}
}
return this.m_oDrillMgr;
};
CCognosViewer.prototype.getSubscriptionManager=function(){
if(!this.m_oSubscriptionManager){
this.loadExtra();
if(typeof CSubscriptionManager=="function"){
this.m_oSubscriptionManager=new CSubscriptionManager(this);
}
}
return this.m_oSubscriptionManager;
};
CCognosViewer.prototype.updateGlobalParameters=function(_6aa){
var oReq=new ViewerDispatcherEntry(this);
oReq.addFormField("ui.action","forward");
oReq.addFormField("generic.anyURI.runOptionEnum#globalParameters",_6aa);
oReq.addFormField("run.prompt",true);
oReq.addFormField("_promptControl","reprompt");
this.submitPromptValues(oReq);
};
CCognosViewer.prototype.getExecutionParameters=function(){
return this.m_sParameters;
};
CCognosViewer.prototype.getGateway=function(){
return this.m_sGateway;
};
CCognosViewer.prototype.getSpecification=function(){
return this.envParams["ui.spec"];
};
CCognosViewer.prototype.getHierarchyUniqueName=function(sId){
var sHun=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _6af=this.getSelectionController();
if(_6af){
var aHUN=_6af.getHun(sCtx);
if(aHUN){
sHun=aHUN;
}
}
}
return sHun;
};
CCognosViewer.prototype.getDimensionUniqueName=function(sId){
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _6b3=this.getSelectionController();
if(_6b3){
var aDUN=_6b3.getDun(sCtx);
if(aDUN){
return aDUN;
}
}
}
return null;
};
CCognosViewer.prototype.getId=function(){
return this.m_sId;
};
CCognosViewer.prototype.getLevelId=function(sId){
var _6b6=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _6b8=this.getSelectionController();
if(_6b8){
var aLUN=_6b8.getLun(sCtx);
if(aLUN){
_6b6=aLUN;
}
}
}
return _6b6;
};
CCognosViewer.prototype.getMemberUniqueName=function(sId){
var sMUN=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _6bd=this.getSelectionController();
if(_6bd){
var aMUN=_6bd.getMun(sCtx);
if(aMUN){
sMUN=aMUN;
}
}
}
return sMUN;
};
CCognosViewer.prototype.getObjectId=function(){
var _6bf="window";
if(typeof this.getId()=="string"){
_6bf=getCognosViewerObjectRefAsString(this.getId());
}
return _6bf;
};
CCognosViewer.prototype.getQueryModelId=function(sId){
var _6c1=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _6c3=this.getSelectionController();
if(_6c3){
var _6c4=_6c3.getQueryModelId(sCtx);
if(_6c4){
_6c1=_6c4;
}
}
}
return _6c1;
};
CCognosViewer.prototype.getQueryName=function(sId){
var _6c6=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _6c8=this.getSelectionController();
if(_6c8){
var _6c9=_6c8.getRefQuery(sCtx);
if(_6c9){
_6c6=_6c9;
}
}
}
return _6c6;
};
CCognosViewer.prototype.getContextIds=function(sId,_6cb){
var aIds=[];
var sCtx=this.findCtx(sId);
if(sCtx){
var _6ce=sCtx.split("::");
if(_6ce&&_6ce.length>1&&_6cb<_6ce.length){
aIds=_6ce[_6cb].split(":");
}
}
return aIds;
};
CCognosViewer.prototype.getRowContextIds=function(sId){
return this.getContextIds(sId,1);
};
CCognosViewer.prototype.getPageContextIds=function(sId){
return this.getContextIds(sId,3);
};
CCognosViewer.prototype.getString=function(sKey){
if(RV_RES&&RV_RES[sKey]){
return RV_RES[sKey];
}
return sKey;
};
CCognosViewer.prototype.getRV=function(){
if(typeof this.m_oCVMgr=="object"){
return this.m_oCVMgr;
}
return window;
};
CCognosViewer.prototype.getSecondaryRequests=function(){
return this.m_aSecRequests;
};
CCognosViewer.prototype.getTracking=function(){
return this.m_sTracking;
};
CCognosViewer.prototype.findCtx=function(sId){
var sCtx="";
if(typeof sId=="string"){
var aCtx=this.getReportContextHelper().processCtx(sId);
var _6d5=aCtx[0][0];
var _6d6=this.getSelectionController();
if(_6d6){
if(_6d6.isContextId(_6d5)){
sCtx=sId;
}
}
}
if(!sCtx){
var _6d7=this.findElementWithCtx(sId);
if(_6d7){
sCtx=_6d7.getAttribute("ctx");
}
}
return sCtx;
};
CCognosViewer.prototype.findElementWithCtx=function(sId){
var _6d9=sId;
if(typeof sId=="string"){
_6d9=this.findElementWithCtx(document.getElementById(sId));
}
if(_6d9){
if(_6d9.getAttribute&&_6d9.getAttribute("ctx")){
return _6d9;
}
for(var _6da=0;_6da<_6d9.childNodes.length;_6da++){
var _6db=this.findElementWithCtx(_6d9.childNodes[_6da]);
if(_6db){
return _6db;
}
}
}
return null;
};
CCognosViewer.prototype.getUseValue=function(sId){
var sVal=null;
var sCtx=this.findCtx(sId).split("::")[0];
if(sCtx){
var _6df=this.getSelectionController();
if(_6df){
sVal=_6df.getUseValue(sCtx);
}
}
return sVal;
};
CCognosViewer.prototype.init=function(_6e0){
if(_6e0&&typeof _6e0=="object"){
for(var _6e1 in _6e0){
this[_6e1]=_6e0[_6e1];
}
}
};
CCognosViewer.prototype.initViewer=function(_6e2){
var _6e3=new RequestHandler(this);
var _6e4=document.getElementById("formBackJax"+this.getId());
if(_6e4&&typeof _6e4.state!="undefined"&&_6e4.state.value.length>0){
_6e3.loadReportHTML(_6e4.result.value);
var _6e5=eval("("+_6e4.state.value+")");
_6e3.updateViewerState(_6e5);
_6e3.postComplete();
}else{
if(this.getUsePageRequest()){
var _6e6=_6e2?_6e2.m_sStatus:null;
if(isIE()){
if(window.location.hash=="#working"){
window.history.go(-2);
return;
}else{
if(_6e6==="working"||_6e6==="stillWorking"){
window.location.hash="#working";
}
}
}else{
if(_6e4&&_6e4.working){
if(_6e4.working.value=="true"){
window.history.go(-1);
return;
}else{
if(_6e6==="working"||_6e6==="stillWorking"){
_6e4.working.value="true";
}
}
}
}
}
_6e3.processInitialResponse(_6e2);
}
};
CCognosViewer.prototype.saveBackJaxInformation=function(_6e7){
var _6e8=document.getElementById("formBackJax"+this.getId());
if(_6e8){
if(typeof _6e8.state!="undefined"){
_6e8.state.value=_6e7.getResponseStateText();
}
if(typeof _6e8.result!="undefined"){
_6e8.result.value=_6e7.getResult();
}
}
};
CCognosViewer.prototype.pcc=function(evt){
if(evt&&typeof evt.button!="undefined"&&evt.button!="1"){
this.preSelectNode=true;
var _6ea=this.getSelectionController();
if(_6ea){
_6ea.pageContextClicked(evt);
}
}
};
CCognosViewer.prototype.isValidAjaxResponse=function(_6eb){
return (_6eb&&_6eb.childNodes&&_6eb.childNodes.length>0&&_6eb.childNodes[0].nodeName!="parsererror"?true:false);
};
CCognosViewer.prototype.resubmitInSafeMode=function(_6ec){
if(this.m_bUseSafeMode){
this.resetViewerDispatcher();
this.setUsePageRequest(true);
this.envParams["cv.useAjax"]="false";
if(_6ec){
_6ec.retryRequest();
}
}
};
CCognosViewer.prototype.showLoadedContent=function(_6ed){
if(_6ed!==null&&typeof _6ed!="undefined"){
_6ed.style.display="block";
}
this.m_resizeReady=true;
this.doneLoading();
var obj=this;
setTimeout(function(){
obj.renderTabs();
},1);
};
CCognosViewer.prototype.doneLoading=function(){
var _6ef=this.getViewerWidget();
if(_6ef){
if(window.IBM&&window.IBM.perf){
window.IBM.perf.log("viewer_doneLoading",this);
}
var _6f0=this.getStatus();
if(!this.m_reportRenderingDone&&this.m_resizeReady&&this.m_stateSet){
var _6f1=_6f0=="working"||_6f0=="stillWorking"||_6f0=="fault";
_6ef.fireEvent("com.ibm.bux.widget.render.done",null,{noAutoResize:_6f1});
if(_6f0=="complete"){
if(window.IBM&&window.IBM.perf){
window.IBM.perf.log("viewer_doneLoading",this);
}
if(typeof _6ef.postLoadContent=="function"){
_6ef.postLoadContent();
}
this.m_reportRenderingDone=true;
if(!_6f1){
var _6f2=this;
setTimeout(function(){
_6f2.m_readyToRespondToResizeEvent=true;
},20);
}
}
}
if(_6f0!="fault"){
_6ef.clearErrorDlg();
}
this.doneLoadingUpdateA11Y(_6f0);
}else{
var _6f0=this.getStatus();
if(_6f0=="complete"){
this.m_reportRenderingDone=true;
this.JAWSTalk(RV_RES.IDS_JS_READY);
}else{
if(_6f0=="working"){
this.JAWSTalk(RV_RES.IDS_JS_WAIT_PAGE_LOADING);
}
}
}
};
CCognosViewer.prototype.doneLoadingUpdateA11Y=function(_6f3){
if(this.getKeepFocus()!==false&&this.getKeepFocus()!=null){
var _6f4=this.getKeepFocus();
if(_6f3=="complete"){
this.setKeepFocus(false);
}
var _6f5=null;
if(this.getVisibleDialog()!==null){
_6f5=this.getVisibleDialog().getDialogDiv();
}else{
if(_6f4===true){
_6f5=document.getElementById("CVReport"+this.getId());
}else{
if(typeof _6f4=="string"){
_6f5=document.getElementById(_6f4);
}else{
if(_6f4!==null){
_6f5=_6f4;
if(this.isBux){
dojo.window.scrollIntoView(_6f5);
}
}
}
}
}
if(_6f5){
setFocusToFirstTabItem(_6f5);
}
if(_6f3=="complete"){
this.JAWSTalk(RV_RES.IDS_JS_READY);
}else{
if(_6f3=="working"||_6f3=="stillWorking"){
this.JAWSTalk(RV_RES.IDS_JS_WAIT_PAGE_LOADING);
}
}
}
};
CCognosViewer.prototype.JAWSTalk=function(_6f6){
if(this.isMobile()||this.isIWidgetMobile()){
return;
}
var id=this.getId();
var div=document.getElementById("JAWS_Alert_"+id);
if(div){
div.parentNode.removeChild(div);
}
div=document.createElement("div");
div.id="JAWS_Alert_"+id;
div.style.position="absolute";
div.style.top="-9000px";
div.style.display="none";
div.setAttribute("role","alert");
div.appendChild(document.createTextNode(_6f6));
var _6f9=document.getElementById("RVContent"+id);
if(_6f9){
_6f9.appendChild(div);
}else{
if(typeof console!="undefined"&&console&&console.log){
console.log("CCognosViewer: Could not find the Viewer div to append the JAWS alert.");
}
}
};
CCognosViewer.prototype.canInsertExpandIconsForAllCrosstabs=function(){
if(this.isLimitedInteractiveMode()||this.isBlacklisted("ExpandMember")||this.isIWidgetMobile()){
return false;
}
var _6fa=this.getAdvancedServerProperty("VIEWER_JS_EXPAND_COLLAPSE_CONTROLS_DEFAULT");
if(_6fa===null){
return false;
}
var _6fb=this.getViewerWidget().getProperties().getShowExpandCollapseIconFlag();
return (_6fa.toLowerCase()==="on"&&_6fb!==false)||(_6fa.toLowerCase()==="off"&&_6fb===true);
};
CCognosViewer.prototype.setMaxContentSize=function(){
if("10"!=window.getIEVersion()){
return;
}
if(document.body.className==="viewer"){
var _6fc=document.body.offsetHeight;
var _6fd=this.getNonReportHeight(document.getElementById("CVReport"+this.getId()));
var _6fe=document.getElementById("mainViewerTable"+this.getId());
_6fe.style.maxHeight=_6fc-_6fd-2+"px";
var _6ff=GUtil.generateCallback(this.setMaxContentSize,[true],this);
if(!this.attachedOnResize){
this.attachedOnResize=true;
if(window.attachEvent){
window.attachEvent("onresize",_6ff);
}else{
if(window.addEventListener){
window.addEventListener("resize",_6ff,false);
}
}
}
}
};
CCognosViewer.prototype.getNonReportHeight=function(node){
var _701=0;
var _702=node.parentNode;
if(!_702){
return _701;
}
if(_702.childNodes.length>1){
for(var i=0;i<_702.childNodes.length;i++){
var _704=_702.childNodes[i];
if(_704!=node&&!isNaN(_704.clientHeight)&&_704.style.display!="none"){
_701+=_704.clientHeight;
}
}
}
if(node.getAttribute("id")!=("mainViewerTable"+this.m_viewerId)){
_701+=this.getNonReportHeight(_702);
}
return _701;
};
CCognosViewer.prototype.addPageAdornments=function(){
this.m_layoutElements=null;
this.m_lidToElement=null;
this.initFlashCharts();
this.insertSortIconsForAllLists();
var _705=this.getViewerWidget().getProperties();
if(this.canInsertExpandIconsForAllCrosstabs()){
this.insertExpandIconsForAllCrosstabs();
}
var _706=document.getElementById("CVReport"+this.getId());
if(_706){
var oCV=this;
setTimeout(function(){
if(oCV.getPinFreezeManager()&&oCV.getPinFreezeManager().hasFrozenContainers()){
oCV.getPinFreezeManager().renderReportWithFrozenContainers(_706);
}
oCV.addInfoBar();
},1);
}
this.getViewerWidget().reselectSelectionFilterObjects();
this.getViewerWidget().addChromeWhitespaceHandler(this.getId());
};
CCognosViewer.prototype.addFlashChart=function(_708){
this.m_flashChartsObjectIds.push(_708);
};
CCognosViewer.prototype.flashChartError=function(_709){
var _70a=this.getViewerWidget();
var _70b=_70a.getProperties();
_70b.setProperty("flashCharts",false);
var _70c=this.getAction("Redraw");
_70c.isUndoable=function(){
return false;
};
_70c.execute();
};
CCognosViewer.prototype.initFlashCharts=function(){
var _70d=this.getViewerWidget();
if(this.m_flashChartsObjectIds.length>0){
var _70e=document.getElementById("rt"+this.getId());
if(window.addEventListener){
_70e.addEventListener("mousedown",onFlashChartRightClick,true);
}else{
var _70f={};
var _710=function(){
this.releaseCapture();
};
var _711=function(){
onFlashChartRightClick(event);
this.setCapture();
};
for(var i=0;i<this.m_flashChartsObjectIds.length;++i){
var _713=this.m_flashChartsObjectIds[i];
var _714=document.getElementById(_713);
_70f[_713]=1;
_714.parentNode.onmouseup=_710;
_714.parentNode.onmousedown=_711;
}
if(this.m_flashChartsObjectIds.length>0){
_70e.attachEvent("oncontextmenu",function(){
if(_70f[window.event.srcElement.id]){
return false;
}
});
}
}
if(_70d){
_70d.fireEvent("com.ibm.bux.widget.setShowBordersWhenInnactive",null,true);
}
}else{
if(_70d){
_70d.fireEvent("com.ibm.bux.widget.setShowBordersWhenInnactive",null,false);
}
}
};
CCognosViewer.prototype.initializeLayoutElements=function(){
var _715=document.getElementById("rt"+this.getId());
var _716=getElementsByAttribute(_715,"*","lid");
this.m_lidToElement={};
this.m_layoutElements=[];
var _717=0;
var _718=this.getPinFreezeManager();
for(var i=0;i<_716.length;i++){
var e=_716[i];
if(!_718||!_718.getContainerElement(e)||_718.isElementInMainOutput(e)){
this.m_layoutElements[_717]=e;
this.m_lidToElement[e.getAttribute("lid")]=e;
_717++;
}
}
};
CCognosViewer.prototype.getLayoutElement=function(_71b){
if(!this.m_layoutElements){
this.initializeLayoutElements();
}
if(this.m_layoutElements){
return this.m_layoutElements[_71b];
}
return null;
};
CCognosViewer.prototype.getLayoutElementFromLid=function(lid){
if(!this.m_lidToElement){
this.initializeLayoutElements();
}
return this.m_lidToElement[lid];
};
CCognosViewer.prototype.getInfoBars=function(){
return this.m_aInfoBar?this.m_aInfoBar:null;
};
CCognosViewer.prototype.addInfoBar=function(){
if(this.getAdvancedServerProperty("VIEWER_JS_HIDE_INFO_BAR")==="true"){
return;
}
var _71d=this.getRAPReportInfo();
if(_71d){
var _71e=document.getElementById("rt"+this.getId());
this.initializeLayoutElements();
var _71f=[];
this.m_aInfoBar=[];
for(var _720=0;_720<this.m_layoutElements.length;++_720){
var _721=this.m_layoutElements[_720];
var lid=_721.getAttribute("lid");
if(lid){
if(lid.indexOf("RAP_NDH_")>-1){
lid=lid.substring(8);
}
lid=lid.substring(0,lid.indexOf(this.getId()));
}
var _723=_71d.getContainer(lid);
if(_723&&typeof _723.parentContainer=="undefined"){
var _724=this.collectChildContainers(_723.container);
if(this.getPinFreezeManager()){
oPinFreezeContainerElement=this.getPinFreezeManager().getContainerElement(_721);
_721=(oPinFreezeContainerElement)?oPinFreezeContainerElement:_721;
}
var _725=new InfoBar(this,_721,_723,_724,_720);
_725.setTimingDetails(_71d._getEventTimings());
_725.render();
if(_725.hasSomethingRendered()){
_71f.push(_725.getId());
}
this.m_aInfoBar.push(_725);
}
}
var _726=this.getViewerWidget();
if(_726){
_726.refreshInfoBarRenderedState(_71f);
}
}
};
CCognosViewer.prototype.collectChildContainers=function(_727){
var _728=[];
var _729=this.getRAPReportInfo();
if(_729){
var _72a=_729.getContainerCount();
for(var cidx=0;cidx<_72a;++cidx){
var _72c=_729.getContainerFromPos(cidx);
if(typeof _72c.parentContainer!="undefined"&&_72c.parentContainer==_727){
_728.push(_72c);
}
}
}
return _728;
};
CCognosViewer.prototype.addReportInfo=function(){
var _72d=this.getViewerWidget();
if(typeof _72d==="undefined"||_72d===null){
return;
}
if(!_72d.getAttributeValue("originalReport")||this.isIWidgetMobile()){
return;
}
var _72e=this.envParams["baseReportModificationTime"];
var _72f=_72d.getAttributeValue("baseReportModificationTime");
if(typeof _72e!=="undefined"&&typeof _72f!=="undefined"&&_72f&&_72f!="<empty>"&&_72e!==_72f){
var cvid=this.getId();
var _731=document.getElementById("CVReport"+cvid);
var _732=_731.parentNode;
var id="ReportInfo"+cvid;
var _734=document.createElement("div");
_734.setAttribute("id",id+"_container");
_734.setAttribute("cvid",cvid);
_734.className="new-info-indicator BUXNoPrint";
var _735=document.createElement("img");
var img=null;
if(this.getDirection()==="rtl"){
img="/rv/images/action_show_info_rtl.png";
}else{
img="/rv/images/action_show_info.png";
}
_735.src=this.getWebContentRoot()+img;
_735.className="reportInfoIcon";
_735.setAttribute("tabIndex","0");
_735.setAttribute("alt","");
_735.setAttribute("title","");
_735.setAttribute("role","presentation");
var _737=RV_RES.IDS_JS_REPORT_INFO_TITLE;
var _738=RV_RES.IDS_JS_REPORT_INFO_TEXT;
var _739=RV_RES.IDS_JS_REPORT_INFO_LINK_TEXT;
_734.appendChild(_735);
_732.insertBefore(_734,_731);
this.m_reportInfoTooltip=new bux.reportViewer.ReportInfo({connectId:[id+"_container"],focusElement:_735,position:["above","below"],title:_737,text:_738,linkText:_739,linkScript:getCognosViewerObjectRefAsString(cvid)+".reportInfoResetReport();",allowMouseOverToolTip:true});
}
};
CCognosViewer.prototype.reportInfoResetReport=function(){
this.executeAction("ResetToOriginal");
};
CCognosViewer.prototype.hideReportInfo=function(){
var _73a=document.getElementById("ReportInfo"+this.getId()+"_container");
if(typeof _73a!=="undefined"&&_73a!==null){
_73a.style.visibility="hidden";
}
};
CCognosViewer.prototype.insertSortIcons=function(){
var _73b=this.envParams?this.envParams.limitedInteractiveMode:true;
if(typeof _73b==="undefined"||_73b===true){
return;
}
if(this.envParams["ui.action"]==="run"||this.envParams["ui.primaryAction"]==="run"){
this.insertSortIconsForAllLists();
}
};
CCognosViewer.prototype._getContainers=function(_73c){
var _73d=[];
var _73e="",_73f="";
if(_73c==="list"){
_73e="list";
_73f="ls";
}else{
if(_73c==="crosstab"){
_73e="crosstab";
_73f="xt";
}
}
var _740=document.getElementById("CVReport"+this.getId());
if(this.getRAPReportInfo()){
var _741=this.getRAPReportInfo().getContainerIds(_73e);
for(var i=0;i<_741.length;++i){
var _743=getElementsByAttribute(_740,"table","lid",_741[i]+this.getId(),1);
if(_743&&_743.length>0){
_73d.push(_743[0]);
}
}
}else{
_73d=getElementsByClassName(_740,"table",_73f);
}
return _73d;
};
CCognosViewer.prototype.insertSortIconsForAllLists=function(){
var _744=this._getContainers("list");
for(var i=0;i<_744.length;++i){
this.insertSortIconsToList(_744[i]);
}
};
CCognosViewer.prototype.insertSortIconsToList=function(_746){
var _747=getElementsByAttribute(_746,"*","type","columnTitle");
for(var i=0;i<_747.length;++i){
var _749=_747[i];
this.getSelectionController().getSelectionObjectFactory().getSelectionObject(_749);
if(_749.getAttribute("canSort")!="false"&&_749.getAttribute("CTNM")===null&&_749.getAttribute("CC")===null){
var _74a=false;
for(var _74b=0;_74b<_749.childNodes.length;_74b++){
var _74c=_749.childNodes[_74b];
if(_74c.nodeName.toLowerCase()=="img"){
if(_74c.id&&_74c.id.indexOf("sortimg")===0){
_74a=true;
break;
}
var sLid=_74c.getAttribute("lid");
if(sLid&&sLid.indexOf("SortIcon")!==-1){
_749.removeChild(_74c);
break;
}
}
}
if(!_74a&&this.canInsertSortIcon(_749)){
this.insertSortIconToColumnHeader(_749);
}
}
}
};
CCognosViewer.prototype.isDrillBlackListed=function(){
if(typeof this.m_bDrillBlacklisted=="undefined"){
this.m_bDrillBlacklisted=this.isBlacklisted("DrillDown")||this.isBlacklisted("DrillUp");
}
return this.m_bDrillBlacklisted;
};
CCognosViewer.prototype.isBlacklisted=function(item){
return this.UIBlacklist&&this.UIBlacklist.indexOf(" "+item+" ")>0;
};
CCognosViewer.prototype.canInsertSortIcon=function(_74f){
var _750=_74f.getAttribute("rp_sort");
return ((!this.isLimitedInteractiveMode()&&!this.isBlacklisted("Sort"))||(_750!==undefined&&_750!==null&&_750.length>0));
};
CCognosViewer.prototype.insertSortIconToColumnHeader=function(_751){
if(!_751.style.whiteSpace){
_751.style.whiteSpace="nowrap";
}
var _752=document.createElement("img");
_752.setAttribute("id","sortimg"+Math.random());
if((!this.isLimitedInteractiveMode()&&!this.isBlacklisted("Sort"))){
_752.onmouseover=function(){
this.setAttribute("oldClassName",this.className);
this.className+=" sortIconOver";
};
_752.onmouseout=function(){
this.className=this.getAttribute("oldClassName");
this.removeAttribute("oldClassName");
};
}
_752.src=this.getImgSrc(_751);
var _753=this.getSortInfo(_751);
var _754=this.getSortOrder(_753);
_752.setAttribute("alt",this.getSortAltText(_754));
_752.setAttribute("title",this.getSortAltText(_754));
_752.className=this.getSortClass(_753);
_752.setAttribute("sortOrder",_754);
_751.appendChild(_752);
};
CCognosViewer.prototype.canInsertShowExpandCollapseIconForNode=function(_755,_756){
var _757=this.getSelectionController();
var _758=_757.hasCalculationMetadata(_756,[_756],"crosstab");
return ((_757.canDrillDown(_756)||_755.alwaysCanExpandCollapse)&&!_757.isCalculationOrMeasure(_756,_758));
};
CCognosViewer.prototype.insertExpandIconsForAllCrosstabs=function(){
var _759=this._getContainers("crosstab");
var _75a=this;
var _75b=this.getRAPReportInfo();
var _75c=this.getReportContextHelper();
for(var i=0;i<_759.length;i++){
var _75e=_759[i];
var _75f=_75e.getAttribute("lid");
_75f=_75f.substring(0,_75f.length-this.getId().length);
var _760=getElementsByAttribute(_75e,["td","th"],"ctnm","true");
for(var j=0;j<_760.length;j++){
var _762=_760[j];
var sCtx=this.findCtx(_762);
var _764=_75c.getDataItemName(sCtx);
if(_764){
var _765=_75b.getItemInfo(_75f,_764);
var _766=_75c.processCtx(sCtx);
if(this.canInsertShowExpandCollapseIconForNode(_765,_766[0][0])){
var sMun=_75c.getMun(sCtx);
var _768=sMun&&_765.expandedMembers&&_765.expandedMembers[sMun]===true;
var _769=document.createElement("div");
_769.setAttribute("skipSelection","true");
_769.className="expandButton "+(_768?"collapse":"expand");
_762.insertBefore(_769,_762.firstChild);
var _76a=document.createElement("span");
_76a.className="expandButtonCaption";
_76a.innerHTML=(_768?"[-]":"[+]");
_769.appendChild(_76a);
}
}
}
}
};
CCognosViewer.prototype.removeExpandIconsForAllCrosstabs=function(){
var _76b=this._getContainers("crosstab");
for(var i=0;i<_76b.length;i++){
var _76d=_76b[i];
var _76e=_76d.getAttribute("lid");
_76e=_76e.substring(0,_76e.length-this.getId().length);
var _76f=getElementsByAttribute(_76d,"td","ctnm","true");
for(var j=0;j<_76f.length;j++){
var _771=_76f[j];
if(_771.firstChild.className==="expandButton collapse"||_771.firstChild.className==="expandButton expand"){
_771.removeChild(_771.firstChild);
}
}
}
};
CCognosViewer.prototype.fillInContextData=function(){
if(!this.isLimitedInteractiveMode()){
var _772=document.getElementById("CVReport"+this.getId());
var _773=getElementsByClassName(_772,"table","ls");
for(var i=0;i<_773.length;++i){
var _775=getElementsByAttribute(_773[i],"*","type","columnTitle");
for(var j=0;j<_775.length;++j){
this.getSelectionController().getSelectionObjectFactory().getSelectionObject(_775[j]);
}
}
}
};
CCognosViewer.prototype.getSortAltText=function(_777){
if(_777==="ascending"){
return RV_RES.IDS_JS_SORT_ASCENDING;
}else{
if(_777==="descending"){
return RV_RES.IDS_JS_SORT_DESCENDING;
}else{
if(_777==="nosort"){
return RV_RES.IDS_JS_NOT_SORTED;
}
}
}
};
CCognosViewer.prototype.getSortInfo=function(_778){
var _779=_778.getAttribute("rp_sort");
if(_779){
_779=_779.split(".");
}
return _779;
};
CCognosViewer.prototype.getSortClass=function(_77a){
var _77b="sortIconHidden";
if(_77a){
if(_77a[0]==="d"||_77a[0]==="a"){
_77b="sortIconVisible";
}
}
return _77b;
};
CCognosViewer.prototype.getSortOrder=function(_77c){
var _77d="nosort";
if(_77c){
if(_77c[0]==="d"){
_77d="descending";
}else{
if(_77c[0]==="a"){
_77d="ascending";
}
}
}
return _77d;
};
CCognosViewer.prototype.getImgSrc=function(_77e){
var _77f=_77e.getAttribute("rp_sort");
var src=this.getWebContentRoot()+"/rv/images/"+this.getSortIconName(_77f);
return src;
};
CCognosViewer.prototype.getSortIconName=function(_781){
var _782="sort_no.gif";
if(_781){
_781=_781.split(".");
if(_781[0]==="d"){
_782="sort_descending.gif";
}else{
if(_781[0]==="a"){
_782="sort_ascending.gif";
}
}
}
return _782;
};
CCognosViewer.prototype.shouldWriteNavLinks=function(){
if(this.envParams["cv.navlinks"]=="false"){
return false;
}else{
if(!this.getUIConfig()||this.getUIConfig().getShowPageNavigation()){
if(this.rvMainWnd||(this.isBux&&!this.isActiveReport())){
return true;
}
}
}
return false;
};
CCognosViewer.prototype.isActiveReport=function(){
if(this.envParams["cv.responseFormat"]==="activeReport"){
return true;
}
return false;
};
CCognosViewer.prototype.resetRaiseSharePromptEventFlag=function(){
this.m_raiseSharePromptEvent=true;
};
CCognosViewer.prototype.resetbHasPromptFlag=function(){
this.m_bHasPrompt=null;
};
CCognosViewer.prototype.disableRaiseSharePromptEvent=function(){
this.m_raiseSharePromptEvent=false;
};
CCognosViewer.prototype.widgetHasPromptParameters=function(){
var _783=this.getViewerWidget();
return (_783&&_783.promptParametersRetrieved==true&&this.envParams&&typeof this.envParams["reportPrompts"]!="undefined"&&this.envParams["reportPrompts"]!=null&&this.envParams["reportPrompts"].length>0);
};
CCognosViewer.prototype.getPromptParametersInfo=function(){
var _784=null;
if(this.widgetHasPromptParameters()){
_784="<widget><parameterValues>"+sXmlEncode(this.getExecutionParameters())+"</parameterValues>"+this.envParams["reportPrompts"]+"</widget>";
}
return _784;
};
CCognosViewer.prototype.raisePromptEvent=function(_785,_786,_787){
try{
var _788=this.getViewerWidget();
_788.getWidgetContextManager().raisePromptEvent(_785,_786,_786.get("ui.action"),this.getModelPath(),_787);
}
catch(e){
}
};
CCognosViewer.prototype.getModelPath=function(){
var _789=this.getSelectionController().getModelPathForCurrentSelection();
if(_789){
return _789;
}else{
if(this.envParams.modelPath){
return this.envParams.modelPath;
}else{
if(typeof document.forms["formWarpRequest"+this.getId()].modelPath!=="undefined"){
return document.forms["formWarpRequest"+this.getId()].modelPath.value;
}
}
}
return "";
};
CCognosViewer.prototype.setKeepFocus=function(_78a){
this._keepFocus=_78a;
};
CCognosViewer.prototype.getKeepFocus=function(){
if(typeof this._keepFocus!="undefined"){
return this._keepFocus;
}
return false;
};
CCognosViewer.prototype.onFocus=function(evt){
var _78c=this.getA11YHelper();
if(_78c){
_78c.onFocus(evt);
}
};
CCognosViewer.prototype.getA11YHelper=function(){
if(!this.a11yHelper){
this.loadExtra();
if(typeof ViewerA11YHelper=="function"){
this.a11yHelper=new ViewerA11YHelper(this);
}else{
if(typeof console!=="undefined"&&console.log){
console.log("CCognosViewer: Could not create ViewerA11YHelper object.");
}
return null;
}
}
return this.a11yHelper;
};
CCognosViewer.prototype.onKeyDown=function(evt){
if(this.getA11YHelper()){
this.getA11YHelper().onKeyDown(evt);
}
};
CCognosViewer.prototype.updateSkipToReportLink=function(){
var _78e=this.getStatus();
var _78f=document.getElementById("cvSkipToReport"+this.getId());
if(_78f){
_78f.style.display=_78e=="prompting"?"none":"";
}
};
CCognosViewer.prototype.updateSkipToNavigationLink=function(_790){
var _791=document.getElementById("cvSkipToNavigation"+this.getId());
if(_791){
_791.style.display=_790?"none":"";
}
};
CCognosViewer.prototype.pageAction=function(_792){
this.setKeepFocus("CVNavLinks"+this.getId());
var _793=new ViewerDispatcherEntry(this);
_793.addFormField("ui.action",_792);
if(this.getCurrentlySelectedTab()){
_793.addFormField("generic.anyURI.http://developer.cognos.com/ceba/constants/runOptionEnum#pageGroup",this.getCurrentlySelectedTab());
}
this.dispatchRequest(_793);
};
CCognosViewer.prototype.writeNavLink=function(_794,_795,_796,_797){
var _798="";
if(_796){
_798="<td nowrap=\"nowrap\">"+"<img src=\"LINK_IMG\" width=\"15\" height=\"15\" alt=\"\" style=\"vertical-align:middle;\">"+"</td>"+"<td nowrap=\"nowrap\">";
if(_797){
_798+="<a href=\"#\" tabindex=\"0\" onclick=\""+getCognosViewerObjectRefAsString(this.getId())+".getViewerWidget().getSavedOutput().pageAction('LINK_REQUEST');return false;\"";
}else{
_798+="<a href=\"#\" tabindex=\"0\" onclick=\""+getCognosViewerObjectRefAsString(this.getId())+".pageAction('LINK_REQUEST');return false;\"";
}
_798+=">LINK_TEXT</a>&#160;"+"</td>";
}else{
_798="<td nowrap=\"nowrap\">"+"<img src=\"LINK_IMG\" width=\"15\" height=\"15\" alt=\"\" style=\"vertical-align:middle;\">"+"</td>"+"<td nowrap=\"nowrap\">LINK_TEXT&#160;</td>";
}
var sImg=this.sSkin+(!_796&&_794.sImgDisabled?_794.sImgDisabled:_794.sImg);
return _798.replace(/LINK_REQUEST/g,_795).replace(/LINK_TEXT/g,_794.sText).replace(/LINK_IMG/g,sImg);
};
CCognosViewer.prototype.loadNavLinks=function(){
var _79a=window.gScriptLoader.loadFile(this.getGateway(),"b_action=xts.run&m=portal/report-viewer-navlinks.xts");
if(_79a){
this.init(eval("("+_79a+")"));
}
};
CCognosViewer.prototype.writeNavLinks=function(sSR,_79c){
var _79d=document.getElementById("CVNavLinks"+this.getId());
if(_79d){
var _79e=document.getElementById("CVNavLinks_Container"+this.getId());
if(typeof this.oNavLinks!="object"||typeof sSR!="string"||!sSR.match(/\bfirstPage\b|\bpreviousPage\b|\bnextPage\b|\blastPage\b|\bplayback\b/i)){
_79d.style.display="none";
if(_79e){
_79e.style.display="none";
}
this.updateSkipToNavigationLink(true);
return;
}
this.updateSkipToNavigationLink(false);
if(_79e){
_79e.style.display="";
}
_79d.style.display=(isIE()?"block":"table-cell");
var _79f="";
_79f+="<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"pageControls BUXNoPrint\" role=\"presentation\"><tbody><tr>";
_79f+=this.writeNavLink(this.oNavLinks.oFirst,"firstPage",sSR.match(/\bfirstPage\b/gi),_79c);
_79f+=this.writeNavLink(this.oNavLinks.oPrevious,"previousPage",sSR.match(/\bpreviousPage\b/gi),_79c);
_79f+=this.writeNavLink(this.oNavLinks.oNext,"nextPage",sSR.match(/\bnextPage\b/gi),_79c);
_79f+=this.writeNavLink(this.oNavLinks.oLast,"lastPage",sSR.match(/\blastPage\b/gi),_79c);
_79f+="</tr></tbody></table>";
var _7a0=document.getElementById("CVNavLinks_label"+this.getId());
var _7a1="";
if(_7a0){
_7a1+="<span id=\"CVNavLinks_label"+this.getId()+"\" style=\"visibilty:hidden; display:none;\">"+_7a0.innerHTML+"</span>";
}
_79d.innerHTML=_7a1+_79f;
}else{
if(this.shouldWriteNavLinks()){
setTimeout(getCognosViewerObjectRefAsString(this.getId())+".writeNavLinks(\""+sSR+"\",\""+_79c+"\");",100);
}
}
};
function CVBackgroundLayer_ignoreMouseClick(e){
if(e.returnValue){
e.returnValue=false;
}else{
if(e.preventDefault){
e.preventDefault();
}else{
return false;
}
}
};
CCognosViewer.prototype.createTransparentBackgroundLayer=function(){
this.removeTransparentBackgroundLayer();
var oBL=document.createElement("div");
oBL.id=CV_BACKGROUND_LAYER_ID;
oBL.style.display="none";
oBL.style.position="absolute";
oBL.setAttribute("role","region");
oBL.setAttribute("aria-label",RV_RES.IDS_JS_A11Y_BACKGROUND_TINT);
oBL.style.top="0px";
oBL.style.left="0px";
oBL.style.zIndex=98;
oBL.style.width="100%";
oBL.style.height="100%";
oBL.style.backgroundColor="rgb(238, 238, 238)";
oBL.style.opacity="0";
oBL.style.filter="alpha(opacity:0)";
oBL.innerHTML="<table tabindex=\"1\" width=\"100%\" height=\"100%\"><tr><td role=\"presentation\" onclick=\"CVBackgroundLayer_ignoreMouseClick(event)\"></td></tr></table>";
oBL.style.display="inline";
document.body.appendChild(oBL);
};
CCognosViewer.prototype.removeTransparentBackgroundLayer=function(){
var oBL=document.getElementById(CV_BACKGROUND_LAYER_ID);
if(oBL){
oBL.parentNode.removeChild(oBL);
}
};
CCognosViewer.prototype.closeActiveHTTPConnection=function(){
var _7a5=this.getActiveRequest();
if(_7a5){
_7a5.abortHttpRequest();
}
};
CCognosViewer.prototype.canCancel=function(){
var _7a6=this.getTracking();
var _7a7=this.getStatus();
return _7a6!=""&&_7a7!="complete";
};
CCognosViewer.prototype.cancel=function(_7a8){
if(this.getWorkingDialog()&&this.getWorkingDialog().disableCancelButton){
this.getWorkingDialog().disableCancelButton(_7a8);
}
this.removeTransparentBackgroundLayer();
this.clearPrompts();
if(this.m_viewerFragment&&this.envParams["fragment.fireEventWhenComplete"]){
this.envParams["fragment.fireEventWhenComplete"]="";
}
var _7a9=null;
if(this.m_undoStack.length>0){
_7a9=this.m_undoStack.pop();
}
var _7aa=this.getActiveRequest();
if(this.canCancel()===true||_7aa){
if(_7aa){
_7aa.cancelRequest(true);
}else{
var _7ab=null;
var _7ac=_7a9!=null&&_7a9.m_bRefreshPage;
if(typeof this.getCancelDispatcherEntry=="function"){
_7ab=this.getCancelDispatcherEntry();
}else{
if(_7ac||this.m_viewerFragment){
_7ab=new ViewerDispatcherEntry(this);
}else{
if(this.getId()=="RS"){
_7ab=new ViewerDispatcherEntry(this);
_7ab.addFormField("cv.responseFormat","rs");
}else{
_7ab=new DispatcherEntry(this);
_7ab.addFormField("cv.responseFormat","successfulRequest");
}
}
}
_7ab.forceSynchronous();
_7ab.addFormField("ui.action","cancel");
_7ab.addFormField("m_tracking",this.getTracking());
this.setTracking("");
if(_7ac){
var _7ad="<CognosViewerUndo><conversation>";
_7ad+=_7a9.m_sConversation;
_7ad+="</conversation></CognosViewerUndo>";
_7ab.addFormField("cv.previousSession",_7ad);
}
this.dispatchRequest(_7ab);
if(!this.isBux&&!this.m_viewerFragment&&(this.getUsePageRequest()||!this.isReportRenderingDone())){
this.executeCallback("cancel");
}
}
this.setStatus("complete");
var _7ae=this.envParams["ui.action"];
var _7af=this.getUsePageRequest();
var _7b0=this.m_undoStack.length;
if(_7a9!=null){
this.m_sConversation=_7a9.m_sConversation;
this.m_sParameters=_7a9.m_sParameters;
this.envParams={};
applyJSONProperties(this.envParams,_7a9.m_envParams);
this.m_undoStack.push(_7a9);
}
this.setTracking("");
if(this.previouslySelectedTab){
this.cancelTabSwitch();
}else{
if(_7ae!="view"&&_7b0<=0&&this.rvMainWnd){
this.rvMainWnd.executePreviousReport(-1);
}
}
return true;
}else{
if(this.rvMainWnd&&typeof this.envParams!="undefined"&&(this.envParams["ui.primaryAction"]=="authoredDrillThrough"||this.envParams["ui.primaryAction"]=="authoredDrillThrough2")){
this.rvMainWnd.executePreviousReport(-1);
return true;
}else{
if(!this.isBux){
executeBackURL(this.getId());
}
return true;
}
}
return false;
};
CCognosViewer.prototype.clearPrompts=function(){
if(this.preProcessControlArray){
var _7b1=this.preProcessControlArray.length;
var k=0;
for(k=0;k<_7b1;k++){
var _7b3=eval(this.preProcessControlArray[k]);
if(_7b3){
if(_7b3.clearSubmit){
_7b3.clearSubmit();
}
}
}
}
};
CCognosViewer.prototype.wait=function(){
if(this.isWorking()){
this.JAWSTalk(RV_RES.IDS_JS_WAIT_PAGE_LOADING);
var _7b4=new ViewerDispatcherEntry(this);
_7b4.addFormField("ui.action","wait");
_7b4.addFormField("ui.primaryAction",this.envParams["ui.primaryAction"]);
_7b4.addFormField("cv.actionState",this.envParams["cv.actionState"]);
_7b4.addNonEmptyStringFormField("bux",this.envParams["bux"]);
_7b4.addNonEmptyStringFormField("ui.preserveRapTags",this.envParams["ui.preserveRapTags"]);
this.dispatchRequest(_7b4);
return true;
}
return false;
};
CCognosViewer.prototype.setCAFContext=function(_7b5){
this.m_sCAFContext=_7b5;
};
CCognosViewer.prototype.setContextInfo=function(sXML){
this.m_sContextInfoXML=sXML;
};
CCognosViewer.prototype.setConversation=function(_7b7){
this.m_sConversation=_7b7;
};
CCognosViewer.prototype.setActionState=function(_7b8){
this.m_sActionState=_7b8;
};
CCognosViewer.prototype.setStatus=function(_7b9){
this.m_sStatus=_7b9;
};
CCognosViewer.prototype.setDebug=function(_7ba){
this.m_bDebug=_7ba;
};
CCognosViewer.prototype.setExecutionParameters=function(_7bb){
this.m_sParameters=_7bb;
};
CCognosViewer.prototype.setMetadataInfo=function(sXML){
this.m_sMetadataInfoXML=sXML;
};
CCognosViewer.prototype.setSecondaryRequests=function(_7bd){
if(_7bd){
this.m_aSecRequests=_7bd;
}else{
this.m_aSecRequests=[];
}
};
CCognosViewer.prototype.setTracking=function(_7be){
this.m_sTracking=_7be;
};
CCognosViewer.prototype.setSoapFault=function(_7bf){
this.m_sSoapFault=_7bf;
};
CCognosViewer.prototype.showOutputInNewWindow=function(sURL){
var _7c1=document.getElementById("formWarpRequest"+this.getId());
var _7c2=_7c1.elements["ui.postBack"];
var _7c3=_7c1.elements["ui.backURL"];
if(this.isAccessibleMode()&&this.envParams["run.outputFormat"]=="PDF"&&window.detachLeavingRV){
window.detachLeavingRV();
}
if(window.opener||_7c2||(_7c3&&_7c3.value!=="javascript:window.close();")){
window.open(sURL,"","");
this.updateNewBrowserWindow();
}else{
window.location=sURL;
}
};
CCognosViewer.prototype.hideToolbar=function(_7c4){
this.m_bHideToolbar=_7c4;
};
CCognosViewer.prototype.showExcel=function(sURL){
var _7c6=true;
var _7c7=document.getElementById("formWarpRequest"+this.getId());
var _7c8=_7c7.elements["ui.backURL"];
if(_7c8&&_7c8.value.indexOf("javascript:window.close()")!==0&&_7c8.value.indexOf("close.html")===-1){
_7c6=false;
}
if(window.detachLeavingRV){
window.detachLeavingRV();
}
var _7c9=window;
if(window.opener&&(isIE()||isFF())&&_7c6){
_7c9=window.opener?window.opener:window;
}else{
if(!window.opener&&_7c6){
window.location=sURL;
return;
}
}
var _7ca=null;
var _7cb="";
try{
if(this.envParams["cv.excelWindowOpenProperties"]){
_7cb=this.envParams["cv.excelWindowOpenProperties"];
}
_7ca=_7c9.open(sURL,"",_7cb);
}
catch(e){
_7c9=window;
_7ca=_7c9.open(sURL,"",_7cb);
}
if(!_7ca||_7ca.closed||typeof _7ca.closed=="undefined"){
alert(RV_RES.RV_BROWSER_POPUP_IS_ENABLED);
}
this.updateNewBrowserWindow();
};
CCognosViewer.prototype.updateNewBrowserWindow=function(){
var id=this.getId();
var _7cd=document.forms["formWarpRequest"+id].elements["ui.postBack"];
var _7ce=document.forms["formWarpRequest"+id].elements["ui.backURL"];
if(_7cd&&_7cd.value){
setTimeout(getCognosViewerObjectRefAsString(id)+".getRV().doPostBack();",100);
}else{
if(_7ce&&_7ce.value){
if(_7ce.value.length<2048){
setTimeout("location.replace(\""+_7ce.value+"\");",100);
}else{
_7ce=decodeURIComponent(_7ce.value);
var _7cf=_7ce.split("?");
var _7d0=document.createElement("form");
_7d0.style.display="none";
_7d0.setAttribute("target","_self");
_7d0.setAttribute("method","post");
_7d0.setAttribute("action",_7cf[0]);
var _7d1=_7cf[1].split("&");
for(var _7d2=0;_7d2<_7d1.length;_7d2++){
var _7d3=_7d1[_7d2].indexOf("=");
var _7d4=_7d1[_7d2].substr(0,_7d3);
var _7d5=_7d1[_7d2].substr(_7d3+1);
var _7d6=document.createElement("img");
_7d6.setAttribute("type","hidden");
_7d6.setAttribute("name",decodeURIComponent(_7d4));
_7d6.setAttribute("value",decodeURIComponent(_7d5));
_7d0.appendChild(_7d6);
}
document.body.appendChild(_7d0);
_7d0.submit();
}
}else{
window.close();
}
}
};
CCognosViewer.prototype.showWaitPage=function(){
};
CCognosViewer.prototype.sendRequest=function(_7d7){
var _7d8=new ViewerDispatcherEntry(this);
_7d8.addFormField("ui.action",_7d7.getAction());
if(_7d7.getCallback()!=null){
_7d8.setCallbacks({"complete":{"object":null,"method":_7d7.getCallback()}});
}
var _7d9=_7d7.getFormFields().keys();
for(var _7da=0;_7da<_7d9.length;_7da++){
_7d8.addFormField(_7d9[_7da],_7d7.getFormFields().get(_7d9[_7da]));
}
var _7db=_7d7.m_oOptions.keys();
for(var _7dc=0;_7dc<_7db.length;_7dc++){
_7d8.addFormField(_7db[_7dc],_7d7.getOption(_7db[_7dc]));
}
var _7dd=_7d7.m_oParams.keys();
for(var _7de=0;_7de<_7dd.length;_7de++){
_7d8.addFormField(_7dd[_7de],_7d7.getParameter(_7dd[_7de]));
}
this.dispatchRequest(_7d8);
};
CCognosViewer.prototype.promptAction=function(_7df,sUrl){
this.setKeepFocus(true);
if(typeof datePickerObserverNotify=="function"){
datePickerObserverNotify();
}
var _7e1=this.getViewerWidget();
if(_7df=="cancel"){
this.cancelPrompt(sUrl);
if(_7e1){
if(!this.isReportRenderingDone()){
var _7e2={action:"deleteWidget"};
_7e1.fireEvent("com.ibm.bux.widget.action",null,_7e2);
}
}
}else{
var oReq=new ViewerDispatcherEntry(this);
oReq.addFormField("ui.action",_7df=="back"?"back":"forward");
if(_7df=="finish"){
oReq.addFormField("run.prompt",false);
}else{
if(_7df=="back"||_7df=="next"){
oReq.addFormField("run.prompt",true);
}
}
if(_7df=="reprompt"){
if(typeof repromptObserverNotify=="function"){
repromptObserverNotify(this);
}
oReq.addFormField("_promptControl",_7df);
}else{
oReq.addFormField("_promptControl","prompt");
}
if(_7e1){
_7e1.fireEvent("com.ibm.bux.widget.modified",null,{"modified":true});
if(_7e1.isSelectionFilterEnabled){
_7e1.clearSelectionFilter();
}
}
this.submitPromptValues(oReq);
}
};
CCognosViewer.prototype.cancelPrompt=function(sUrl){
this.cancel();
};
CCognosViewer.prototype.notify=function(_7e5,_7e6){
var _7e7=0,k=0;
var _7e9=null;
if(this.rangeObserverArray&&this.rangeObserverArray instanceof Array){
_7e7=this.rangeObserverArray.length;
for(k=0;k<_7e7;k++){
_7e9=eval(this.rangeObserverArray[k]);
if(_7e9&&typeof _7e9=="object"&&typeof _7e9.update=="function"){
_7e9.update();
}
}
}
var _7ea=true;
if(this.preProcessControlArray&&this.preProcessControlArray instanceof Array){
_7e7=this.preProcessControlArray.length;
for(k=0;k<_7e7;k++){
_7e9=eval(this.preProcessControlArray[k]);
if((typeof _7e9.getValid=="function")&&!_7e9.getValid()){
_7ea=false;
break;
}
}
}
this.notifyPageNavEnabled(_7ea);
if(this.multipleObserverArray&&this.multipleObserverArray instanceof Array){
_7e7=this.multipleObserverArray.length;
for(k=0;k<_7e7;k++){
_7e9=eval(this.multipleObserverArray[k]);
if(_7e9&&typeof _7e9=="object"&&typeof _7e9.checkInsertRemove=="function"){
_7e9.checkInsertRemove();
}
}
}
for(var _7eb=0;_7eb<gaNotifyTargets.length;_7eb++){
var _7ec=gaNotifyTargets[_7eb];
if(typeof _7ec!="undefined"&&typeof _7ec.notify=="function"){
_7ec.notify(_7e5,_7e6);
}
}
};
CCognosViewer.prototype.notifyPageNavEnabled=function(_7ed){
if(this.pageNavigationObserverArray&&this.pageNavigationObserverArray instanceof Array){
var _7ee=this.pageNavigationObserverArray.length;
var _7ef=false;
var _7f0=null;
var _7f1=null;
var k=0;
for(k=0;k<_7ee;k++){
try{
_7f0=eval(this.pageNavigationObserverArray[k]);
_7f1=_7f0.getType();
if(_7f1==PROMPTBUTTON_FINISH){
_7ef=true;
break;
}
}
catch(e){
}
}
for(k=0;k<_7ee;k++){
try{
_7f0=eval(this.pageNavigationObserverArray[k]);
_7f1=_7f0.getType();
if(!_7ed){
if((_7f1==PROMPTBUTTON_NEXT)||(_7f1==PROMPTBUTTON_OK)||(_7f1==PROMPTBUTTON_FINISH)){
_7f0.setEnabled(false);
}
}else{
if(_7f1==PROMPTBUTTON_FINISH){
_7f0.setEnabled(this.bCanFinish);
}else{
if(_7f1==PROMPTBUTTON_NEXT){
_7f0.setEnabled(this.bNextPage||!_7ef);
}else{
if(_7f1==PROMPTBUTTON_OK){
_7f0.setEnabled(true);
}
}
}
}
}
catch(e2){
}
}
}
};
CCognosViewer.prototype.getDrillResetHUNs=function(_7f3){
var _7f4=null;
if(this.getRAPReportInfo()){
_7f4=this.getRAPReportInfo().getDrilledOnHUNs();
}
if(!_7f4){
return null;
}
var _7f5=this.getExecutionParameters();
if(!_7f5){
return null;
}
var _7f6=this._getListOfChangedPromptParameters(_7f3);
if(!_7f6||_7f6.length===0){
return null;
}
var _7f7=[];
for(var i=0;i<_7f4.length;i++){
for(var j=0;j<_7f6.length;j++){
if(_7f6[j].indexOf(_7f4[i])!==-1){
_7f7.push(_7f4[i]);
}
}
}
return _7f7;
};
CCognosViewer.prototype.getOldParameters=function(){
var _7fa=new CParameterValues();
var _7fb=XMLBuilderLoadXMLFromString(this.getExecutionParameters());
if(_7fb.childNodes.length==1){
_7fa.loadWithOptions(_7fb.childNodes[0],false);
}
if(!_7fa||!_7fa.m_parameterValues||!_7fa.m_parameterValues.m_aValues){
return null;
}
return _7fa.m_parameterValues.m_aValues;
};
CCognosViewer.prototype._createDummyRequest=function(){
var _7fc=new ViewerDispatcherEntry(this);
return this.preparePromptValues(_7fc);
};
CCognosViewer.prototype._getChangedPromptParametersValues=function(_7fd,_7fe,_7ff){
var _800=XMLBuilderLoadXMLFromString(_7fe);
if(!_800){
for(var j=0;j<_7fd.length;j++){
var _802=_7fd[j].m_useValue;
if(_7fe.indexOf(sXmlEncode(_802))<0){
_7ff.push(_802);
}
}
return;
}
var _803=_800.getElementsByTagName("selectOption");
if(!_803){
return;
}
var _804=_7fd.length;
var _805=_803.length;
for(var i=0;i<_805;i++){
var _7fe=_803[i].attributes.getNamedItem("useValue").nodeValue;
bMatchOldParam=false;
for(var j=0;j<_804;j++){
var _802=_7fd[j].m_useValue;
if(_7fe.indexOf(_802)===0){
bMatchOldParam=true;
break;
}
}
if(!bMatchOldParam){
_7ff.push(_7fe);
}
}
};
CCognosViewer.prototype._getListOfChangedPromptParameters=function(_807){
var _808=this.getOldParameters();
if(!_808){
return null;
}
var _809=[];
if(!_807){
var _80a=this._createDummyRequest();
for(var _80b in _808){
var _80c=_808[_80b].m_parmValueItems;
var _80d=_80a.getRequest().getFormFields().get("p_"+_80b);
if(!_80d){
continue;
}
this._getChangedPromptParametersValues(_80c,_80d,_809);
}
}else{
if(!_807.parameters){
return null;
}
var _80e=_807.parameters;
for(var i=0;i<_80e.length;i++){
var _810=_80e[i].parmName;
if(!_810||!_808[_810]){
continue;
}
var _80c=_808[_810].m_parmValueItems;
if(!_80c||_80c.length==0){
continue;
}
this._getChangedPromptParametersValues(_80c,_80e[i].parmValue,_809);
}
}
return _809;
};
CCognosViewer.prototype.submitPromptValues=function(oReq){
if(this.gbPromptRequestSubmitted===true){
return false;
}
this.gbPromptRequestSubmitted=true;
if(this.isBux){
var _812=this.getDrillResetHUNs(null);
if(_812&&_812.length!==0){
var _813={"drilledResetHUNs":_812};
this.executeAction("DrillReset",_813);
return;
}
}
oReq=this.preparePromptValues(oReq);
if(window.portletSharePrompt){
var _814=this.portletPromptParams(oReq);
if(_814.length>0){
portletSharePrompt(_814);
}
}
this.dispatchRequest(oReq);
};
CCognosViewer.prototype.portletPromptParams=function(oReq){
var _816=[];
var _817=null;
var _818=true;
var _819=oReq.getFormFields().keys();
for(var _81a=0;_81a<_819.length;_81a++){
_817=_819[_81a];
if(_817=="_promptControl"&&oReq.getFormField(_817)=="search"){
_818=false;
break;
}else{
if(_817.indexOf("p_")===0){
if(_817.indexOf("p_credential")===0){
_818=false;
break;
}else{
_816.push([_817,oReq.getFormField(_817)]);
}
}
}
}
if(_816&&!_818){
_816=[];
}
return _816;
};
CCognosViewer.prototype.preparePromptValues=function(oReq){
var _81c=[];
if(this.preProcessControlArray){
var _81d=this.preProcessControlArray.length;
var k=0;
for(k=0;k<_81d;k++){
var _81f=eval(this.preProcessControlArray[k]);
var _820=(typeof _81f.isEnabled=="function"?_81f.isEnabled():true);
if(_81f&&typeof _81f.preProcess=="function"&&_820){
_81f.preProcess();
if(_81f.m_oSubmit){
if(oReq.addParameter){
oReq.addParameter(_81f.m_oSubmit.name,_81f.m_oSubmit.value);
}else{
oReq.addFormField(_81f.m_oSubmit.name,_81f.m_oSubmit.value);
}
_81c.push(_81f.m_oSubmit);
if(_81f.m_sPromptId&&_81f.m_oForm&&_81f.m_oForm.elements&&typeof _81f.m_oForm.elements["p_"+_81f.m_sRef]=="object"){
if(oReq.addParameter){
oReq.addParameter("p_"+_81f.m_sPromptId,_81f.m_oForm.elements["p_"+_81f.m_sRef].value);
}else{
oReq.addFormField("p_"+_81f.m_sPromptId,_81f.m_oForm.elements["p_"+_81f.m_sRef].value);
}
}
}
}
}
}
var _821=document.getElementById("formWarpRequest"+this.getId());
if(_821){
var _822=_821.elements;
for(var _823=0;_823<_822.length;_823++){
var _824=_822[_823];
if(!_824.name||!_824.name.match(/^p_/)){
continue;
}
var _825=true;
for(var _826=0;_826<_81c.length;_826++){
if(_81c[_826]==_824){
_825=false;
break;
}
}
if(_825){
oReq.addFormField(_824.name,_824.value);
_81c.push(_824);
}
}
}
var oRM=this["CognosReport"];
if(oRM){
var _828=oRM.prompt.getParameters();
for(var i=0;i<_828.length;i++){
var _82a="p_"+_828[i].getName();
if(!oReq.getFormField(_82a)){
oReq.addFormField(_82a,_828[i].getXML());
}
}
}
return oReq;
};
CCognosViewer.prototype.setViewerWidget=function(_82b){
this.m_viewerWidget=_82b;
};
CCognosViewer.prototype.getViewerWidget=function(){
return this.m_viewerWidget;
};
CCognosViewer.prototype.getFlashChartOption=function(){
var _82c=this.getViewerWidget();
var _82d=null;
if(_82c){
var _82e=_82c.getProperties();
if(_82e){
_82d=_82e.getFlashCharts();
}
}
return _82d;
};
CCognosViewer.prototype.fireWidgetEvent=function(evt,_830){
var _831=this.getViewerWidget();
if(_831!=null){
_831.fireEvent(evt,null,_830);
}
};
CCognosViewer.prototype.isMobile=function(){
return false;
};
CCognosViewer.prototype.setVisibleDialog=function(_832){
this.m_visibleDialog=_832;
};
CCognosViewer.prototype.getVisibleDialog=function(){
if(typeof this.m_visibleDialog!="undefined"){
return this.m_visibleDialog;
}
return null;
};
CCognosViewer.prototype.getContentLocale=function(){
var _833=document.getElementById("formWarpRequest"+this.getId());
if(_833&&_833["ui.contentLocale"]&&_833["reRunObj"]&&_833["reRunObj"].value.length>0){
return _833["ui.contentLocale"].value;
}
return null;
};
CCognosViewer.prototype.updateLayout=function(_834){
var cvid=this.getId();
var _836=document.getElementById("CVHeader"+cvid);
var _837=document.getElementById("CVToolbar"+cvid);
if(!_836&&!_837){
setTimeout(getCognosViewerObjectRefAsString(cvid)+".updateLayout(\""+_834+"\");",100);
return;
}
if(_836){
var _838=this.getUIConfig()&&!this.getUIConfig().getShowBanner();
if((_834=="prompting"&&!this.bShowHeaderWithPrompts)||_838){
_836.parentNode.style.display="none";
}else{
_836.parentNode.style.display="";
}
}
if(_837){
if(_834=="prompting"||this.m_bHideToolbar==true){
_837.parentNode.style.display="none";
}else{
_837.parentNode.style.display="";
}
}
};
CCognosViewer.prototype.updateResponseSpecification=function(_839){
this.sResponseSpecification=_839;
};
CCognosViewer.prototype.getResponseSpecification=function(){
return this.sResponseSpecification;
};
CCognosViewer.prototype.release=function(_83a){
if(this.getStatus()!="fault"){
this._release(_83a);
}
};
CCognosViewer.prototype._release=function(_83b){
var form=document.getElementById("formWarpRequest"+this.getId());
var _83d=this.getTracking();
if(!_83d&&form&&form["m_tracking"]&&form["m_tracking"].value){
_83d=form["m_tracking"].value;
form["m_tracking"].value="";
}
this.setTracking("");
if(_83d){
var _83e=new DispatcherEntry(this);
if(this.isWorkingOrPrompting()){
_83e.addFormField("ui.action","cancel");
}else{
_83e.addFormField("ui.action","release");
}
_83e.addFormField("cv.responseFormat","successfulRequest");
_83e.addNonEmptyStringFormField("ui.primaryAction",this.envParams["ui.primaryAction"]);
_83e.addNonEmptyStringFormField("ui.objectClass",this.envParams["ui.objectClass"]);
_83e.addFormField("m_tracking",_83d);
if(_83b!=true){
_83e.forceSynchronous();
}
var _83f=this.getActiveRequest()?this.getActiveRequest():this.getFaultDispatcherEntry();
if(_83f&&_83f.getFormField("cv.outputKey")){
_83e.addFormField("b_action","cvx.high");
_83e.addFormField("cv.outputKey",_83f.getFormField("cv.outputKey"));
_83e.addFormField("cv.waitForResponse","false");
_83e.setHeaders(_83f.getHeaders());
}
_83e.sendRequest();
return true;
}
return false;
};
CCognosViewer.prototype.cleanupStyles=function(){
if(this.getViewerWidget()){
this.getViewerWidget().cleanupStyles();
}
};
CCognosViewer.prototype.destroy=function(_840){
this.release(_840);
if(!this.m_destroyed){
if(typeof window.gaRV_INSTANCES!="undefined"){
for(var _841=0;_841<window.gaRV_INSTANCES.length;_841++){
if(window.gaRV_INSTANCES[_841].m_sId==this.getId()){
window.gaRV_INSTANCES.splice(_841,1);
this.m_destroyed=true;
break;
}
}
}
if(this.m_layoutElements){
for(var i=0;i<this.m_layoutElements.length;i++){
var e=this.m_layoutElements[i];
var j=e.getAttribute("lid");
this.m_layoutElements.splice(i,1);
delete this.m_lidToElement[j];
var _845=e.parentNode;
if(_845){
_845.removeChild(e);
}
}
delete this.m_layoutElements;
delete this.m_lidToElement;
}
if(this.m_oDrillMgr){
this.m_oDrillMgr.setCV(null);
}
var _846=this.getSelectionController();
if(_846){
GUtil.destroyProperties(_846);
}
var cvId=this.getId();
this.m_viewerDispatcher=null;
GUtil.destroyProperties(this,true);
cleanupGlobalObjects(cvId);
}
};
CCognosViewer.prototype.exit=function(){
this.release();
};
CCognosViewer.prototype.executeAction=function(_848,_849){
var _84a=this.getAction(_848);
_84a.setRequestParms(_849);
return _84a.execute();
};
CCognosViewer.prototype.getCalculation=function(_84b){
var calc=null;
var _84d=this.getCalculationCache();
if(_84d[_84b]){
calc=_84d[_84b];
}else{
calc=eval("new "+_84b+"();");
calc.setCognosViewer(this);
_84d[_84b]=calc;
}
return calc;
};
CCognosViewer.prototype.findBlueDotMenu=function(_84e){
var root=null;
var _850=(_84e)?_84e:this.getToolbar();
for(var idx=0;idx<_850.length;++idx){
if(typeof _850[idx]._root!="undefined"){
root=_850[idx]._root;
break;
}
}
return root;
};
CCognosViewer.prototype.findToolbarItem=function(_852,_853){
var spec=typeof _853=="undefined"||_853==null?this.getToolbar():_853;
var _855=null;
for(var _856=0;_856<spec.length;++_856){
var name=spec[_856]["name"];
if(typeof name!="undefined"&&name==_852){
_855=spec[_856];
break;
}
}
return _855;
};
CCognosViewer.prototype.findToolbarItemIndex=function(_858,_859){
var spec=typeof _859=="undefined"||_859==null?this.getToolbar():_859;
var _85b=null;
for(var _85c=0;_85c<spec.length;++_85c){
var name=spec[_85c]["name"];
if(typeof name!="undefined"&&name==_858){
_85b=_85c;
break;
}
}
return _85b;
};
CCognosViewer.prototype.addedButtonToToolbar=function(_85e,_85f,_860,_861){
if(typeof _85f!="undefined"&&_85f!=null){
if(this.findToolbarItem(_85f.name,_85e)==null){
_860=this.findToolbarItemIndex(_860,_85e);
if(typeof _860!="undefined"&&_860!=null){
_85e.splice(++_860,0,_85f);
return true;
}else{
if(typeof _861!="undefined"&&_861!=null){
_85e.splice(_861,0,_85f);
return true;
}
}
}
}
return false;
};
CCognosViewer.prototype.addDrillTargets=function(_862){
this.m_drillTargets=_862;
};
CCognosViewer.prototype.getDrillTargets=function(){
if(this.m_drillTargets.length==0&&this.envParams["ui.action"]=="view"){
var _863=document.getElementById("CVIFrame"+this.getId());
if(typeof _863!="undefined"&&_863!=null){
if(_863.contentWindow.drillTargets){
return _863.contentWindow.drillTargets;
}
}
}
return this.m_drillTargets;
};
CCognosViewer.prototype.getDrillTarget=function(idx){
if(idx>=this.m_drillTargets.length){
return null;
}
return this.m_drillTargets[idx];
};
CCognosViewer.prototype.getNumberOfDrillTargets=function(){
return this.m_drillTargets.length;
};
CCognosViewer.prototype.isReportRenderingDone=function(){
return this.m_reportRenderingDone;
};
CCognosViewer.prototype.setReportRenderingDone=function(flag){
this.m_reportRenderingDone=flag;
};
CCognosViewer.prototype.hasAVSChart=function(){
var _866=this.getRAPReportInfo();
if(_866){
var _867=_866.getDisplayTypes();
return _867.match("_v2")!=null||_867.match("v2_")!=null;
}
return false;
};
CCognosViewer.prototype.getPinFreezeManager=function(){
return this.m_pinFreezeManager;
};
CCognosViewer.prototype.getReportContextHelper=function(){
if(!this.m_reportContextHelper){
this.m_reportContextHelper=new ReportContextHelper(this.getSelectionController().getCCDManager());
}
return this.m_reportContextHelper;
};
CCognosViewer.prototype.getRAPReportInfo=function(){
return this.m_RAPReportInfo;
};
CCognosViewer.prototype.setRAPReportInfo=function(_868){
this.m_RAPReportInfo=_868;
};
CCognosViewer.prototype.isNodeVisible=function(node){
if(this.m_pinFreezeManager){
return this.m_pinFreezeManager.isNodeVisible(node);
}
return true;
};
CCognosViewer.prototype.getWarpRequestForm=function(){
return document.getElementById("formWarpRequest"+this.getId());
};
CCognosViewer.prototype.getBrowser=function(){
return this.sBrowser;
};
CCognosViewer.prototype.repaintDiv=function(oDiv){
var _86b=oDiv.style.display;
oDiv.style.display="none";
oDiv.style.display=_86b;
};
CCognosViewer.prototype.isMetadataEmpty=function(){
var oSC=this.getSelectionController();
if(oSC){
var _86d=oSC.getCCDManager();
if(_86d){
return _86d.isMetadataEmpty();
}
}
return true;
};
CCognosViewer.prototype.setContextMenu=function(_86e){
this.m_contextMenu=_86e;
};
CCognosViewer.prototype.getContextMenu=function(){
return this.m_contextMenu;
};
CCognosViewer.prototype.setToolbar=function(_86f){
this.m_toolbar=_86f;
};
CCognosViewer.prototype.getToolbar=function(){
return this.m_toolbar;
};
CCognosViewer.prototype.getAdvancedServerProperty=function(_870){
if(this.m_advancedProperties&&this.m_advancedProperties[_870]!==undefined&&this.m_advancedProperties[_870]!==null){
return this.m_advancedProperties[_870];
}else{
return null;
}
};
CCognosViewer.prototype.hasPrompt=function(){
if(typeof this.m_bHasPrompt==="undefined"||this.m_bHasPrompt===null){
var _871=false;
if(this.getAdvancedServerProperty("VIEWER_JS_PROMPT_AGAIN_SHOW_ALWAYS")==="true"||(this.envParams.reportPrompts&&this.envParams.reportPrompts.length>0)){
_871=true;
}else{
var _872=new CParameterValues();
var _873=XMLBuilderLoadXMLFromString(this.getExecutionParameters());
if(_873.childNodes.length==1){
_872.loadWithOptions(_873.childNodes[0],true);
var _874=_872.length();
for(var _875=0;_875<_874;++_875){
var _876=_872.getAt(_875);
if(_876!==null&&_876.length()>0&&_876.name().indexOf("credential:")!=-1){
_871=true;
break;
}
}
}
}
this.m_bHasPrompt=_871;
}
return this.m_bHasPrompt;
};
CCognosViewer.prototype.getDrillState=function(){
return this.m_sStateData?this.m_sStateData:"";
};
CCognosViewer.prototype.isSelectionFilterEnabled=function(){
if(typeof this.m_bSelectionFilterSwitch=="undefined"){
this.m_bSelectionFilterSwitch=false;
}
return this.m_bSelectionFilterSwitch;
};
CCognosViewer.prototype.broadcastContextChange=function(evt,_878){
if(this.getViewerWidget()){
this.getViewerWidget().broadcastContextChange(_878);
}
stopEventBubble(evt);
};
CCognosViewer.prototype.broadcastParameterChange=function(evt,_87a){
if(this.getViewerWidget()){
this.getViewerWidget().broadcastParameterChange(_87a);
}
stopEventBubble(evt);
};
CCognosViewer.prototype.getReportDiv=function(){
if(!this.m_nReportDiv){
this.m_nReportDiv=document.getElementById("CVReport"+this.m_sId);
}
return this.m_nReportDiv;
};
function CDocumentWriter(sId,_87c){
this.m_sId=sId;
this.m_sText="";
this.m_sScript=_87c;
};
CDocumentWriter.prototype.isValid=function(){
if(typeof this.m_sScript!="undefined"&&this.m_sScript&&window.gScriptLoader){
return true;
}
return false;
};
CDocumentWriter.prototype.execute=function(){
if(this.isValid()&&window.gScriptLoader){
var _87d=/document\.write(ln)?\s*\(/gi;
var _87e=this.m_sScript.replace(_87d,"this.write(").replace(window.gScriptLoader.m_reScriptTagOpen,"").replace(window.gScriptLoader.m_reScriptTagClose,"");
try{
eval(_87e);
var _87f=document.getElementById(this.m_sId);
if(_87f){
_87f.innerHTML=this.m_sText;
return true;
}
}
catch(e){
}
}
return false;
};
CDocumentWriter.prototype.write=function(_880){
var _881="";
if(typeof _880=="function"){
_881=eval(_880);
}else{
if(typeof _880=="string"){
_881=_880;
}
}
this.m_sText+=_881;
};
function setFocusToFirstTabItem(_882){
if(!window.dojo){
return;
}
var _883=dojo.query("*",_882);
var _884=_883.length;
for(var i=0;i<_884;i++){
var node=_883[i];
if(!node.style||(node.style.display!="none"&&node.style.visibility!="hidden")){
if(node.getAttribute("tabIndex")==0){
try{
node.focus();
}
catch(e){
}
break;
}
}
}
};
function ReportContextHelper(_887){
this.m_oCDManager=_887;
};
ReportContextHelper.prototype.destroy=function(){
if(this.m_oCDManager&&this.m_oCDManager.destroy){
this.m_oCDManager.destroy();
}
delete this.m_oCDManager;
};
ReportContextHelper.prototype.processCtx=function(sCtx){
var _889=sCtx.split("::");
var _88a=[];
for(var i=0;i<_889.length;++i){
_88a[i]=_889[i].split(":");
}
if(_88a&&_88a.length&&_88a[0].length){
return _88a;
}else{
return null;
}
};
ReportContextHelper.prototype.getDataItemName=function(sCtx){
var _88d=this.processCtx(sCtx);
if(_88d){
return this.getRefDataItem(_88d[0][0]);
}
return null;
};
ReportContextHelper.prototype.getRefDataItem=function(_88e){
var _88f=this.m_oCDManager.GetRDIValue(_88e);
return (_88f==null)?"":_88f;
};
ReportContextHelper.prototype.getMun=function(_890){
var aCtx=null;
if(typeof _890==="string"){
aCtx=this.processCtx(_890);
}else{
if(typeof _890==="number"){
aCtx=this.processCtx(_890.toString());
}else{
aCtx=_890;
}
}
if(aCtx){
var sMun=this.m_oCDManager.GetMUN(aCtx[0][0]);
return (sMun==null)?"":sMun;
}
return "";
};
function ViewerConfig(){
this.uiConfig=new ViewerUIConfig();
this.findConfig=typeof ViewerFindActionConfig=="function"?new ViewerFindActionConfig():null;
this.httpRequestConfig=typeof ViewerHttpRequestConfig=="function"?new ViewerHttpRequestConfig():null;
this.eventsConfig=typeof ViewerEventsConfig=="function"?new ViewerEventsConfig():null;
};
ViewerConfig.prototype.configure=function(_893){
if(!_893){
return;
}
if(_893.findAction&&this.findConfig){
this.findConfig.configure(_893.findAction);
}
if(_893.UI){
this.uiConfig.configure(_893.UI);
}
if(_893.httpRequestCallbacks&&this.httpRequestConfig){
this.httpRequestConfig.configure(_893.httpRequestCallbacks);
}
if(_893.events&&this.eventsConfig){
this.eventsConfig.configure(_893.events);
}
};
ViewerConfig.prototype.getUIConfig=function(){
return this.uiConfig;
};
ViewerConfig.prototype.getFindActionConfig=function(){
return this.findConfig;
};
ViewerConfig.prototype.getHttpRequestConfig=function(){
return this.httpRequestConfig;
};
ViewerConfig.prototype.getEventsConfig=function(){
return this.eventsConfig;
};
function ViewerUIConfig(){
this.showBanner=true;
this.showToolbar=true;
this.showContextMenu=true;
this.showPageNavigation=true;
this.primarySelectionColor=null;
this.secondarySelectionColor=null;
this.showSecondarySelection=true;
};
ViewerUIConfig.prototype.configure=function(_894){
applyJSONProperties(this,_894);
};
ViewerUIConfig.prototype.getShowBanner=function(){
return this.showBanner;
};
ViewerUIConfig.prototype.getShowToolbar=function(){
return this.showToolbar;
};
ViewerUIConfig.prototype.getShowContextMenu=function(){
return this.showContextMenu;
};
ViewerUIConfig.prototype.getShowPageNavigation=function(){
return this.showPageNavigation;
};
ViewerUIConfig.prototype.getPrimarySelectionColor=function(){
return this.primarySelectionColor;
};
ViewerUIConfig.prototype.getSeondarySelectionColor=function(){
return this.secondarySelectionColor;
};
ViewerUIConfig.prototype.getShowSecondarySelection=function(){
return this.showSecondarySelection;
};
function ViewerHttpRequestConfig(){
this.reportStatus={};
this.UI={};
};
ViewerHttpRequestConfig.prototype.configure=function(_895){
applyJSONProperties(this,_895);
};
ViewerHttpRequestConfig.prototype.getRequestIndicator=function(){
if(this.UI){
return this.UI.requestIndicator?this.UI.requestIndicator:null;
}
};
ViewerHttpRequestConfig.prototype.getWorkingDialog=function(){
if(this.UI){
return this.UI.workingDialog?this.UI.workingDialog:null;
}
};
ViewerHttpRequestConfig.prototype.getReportStatusCallback=function(_896){
if(this.reportStatus){
var _897=this.reportStatus[_896];
if(_897){
return _897;
}
if(_896=="complete"&&this.reportStatus["initialComplete"]){
var _898=this.reportStatus["initialComplete"];
this.reportStatus["initialComplete"]=null;
return _898;
}
}
return null;
};
function ViewerState(){
this.findState=null;
this.pageState=null;
};
ViewerState.prototype.setFindState=function(_899){
if(typeof ViewerFindState!="function"){
return;
}
if(!this.findState){
this.findState=new ViewerFindState();
}
this.findState.setState(_899);
};
ViewerState.prototype.clearFindState=function(){
this.findState=null;
};
ViewerState.prototype.getFindState=function(){
return this.findState;
};
ViewerState.prototype.setPageState=function(_89a){
if(typeof ViewerPageState!="function"){
return;
}
if(!this.pageState){
this.pageState=new ViewerPageState();
}
this.pageState.setState(_89a);
};
ViewerState.prototype.clearPageState=function(){
this.pageState=null;
};
ViewerState.prototype.getPageState=function(){
return this.pageState;
};
function ViewerEventsConfig(){
this.showContextMenuOnClick=false;
};
ViewerEventsConfig.prototype.configure=function(_89b){
applyJSONProperties(this,_89b);
};
ViewerEventsConfig.prototype.getShowContextMenuOnClick=function(){
return this.showContextMenuOnClick;
};
CCognosViewer.prototype.loadExtra=function(){
var _89c=this.getViewerWidget();
if(_89c){
_89c.loadExtraJavascriptFiles(this.getWebContentRoot());
}
};
function CCognosViewerToolbarHelper(){
};
CCognosViewerToolbarHelper.updateToolbarForCurrentSelection=function(oCV,_89e){
if(_89e){
var _89f=oCV.getActionFactory();
for(var _8a0=0;_8a0<_89e.length;++_8a0){
var name=_89e[_8a0]["name"];
if(typeof name!="undefined"&&name!=null){
var _8a2=_89f.load(name);
if(_8a2!=null&&typeof _8a2!="undefined"){
var _8a3=_8a2.updateMenu(_89e[_8a0]);
if(_8a3.visible==false){
if(_8a3.save){
oCV.getViewerWidget().addButtonToSavedToolbarButtons(name,_89e[_8a0],_8a0);
}
_89e.splice(_8a0,1);
--_8a0;
}else{
_89e[_8a0]=_8a3;
}
}
}else{
if(typeof _89e[_8a0]._root!="undefined"){
CCognosViewerToolbarHelper.updateToolbarForCurrentSelection(oCV,_89e[_8a0]._root);
}else{
if(_89e[_8a0].separator){
if(_8a0==0||(_8a0>0&&_89e[_8a0-1].separator)||_8a0==_89e.length){
_89e.splice(_8a0,1);
--_8a0;
}
}
}
}
}
}
};
CCognosViewerToolbarHelper.updateContextMenuForCurrentSelection=function(oCV,_8a5){
var _8a6=[];
if(_8a5){
var _8a7=oCV.getActionFactory();
for(var _8a8=0;_8a8<_8a5.length;++_8a8){
var _8a9=_8a5[_8a8];
var name=_8a5[_8a8]["name"];
var _8ab=true;
if(typeof name!="undefined"){
var _8ac=_8a7.load(name);
if(!_8ac){
if(name=="drillDown"){
_8ac=_8a7.load("DrillDown");
}else{
if(name=="drillUp"){
_8ac=_8a7.load("DrillUp");
}
}
}
if(_8ac!=null&&typeof _8ac!="undefined"){
if(typeof _8ac.buildMenu=="function"){
_8a9=_8ac.buildMenu(_8a5[_8a8]);
}else{
_8a9=_8ac.updateMenu(_8a5[_8a8]);
}
_8ab=_8ac.isValidMenuItem();
}else{
if(typeof _8a9.items!="undefined"){
_8a9.items=CCognosViewerToolbarHelper.updateContextMenuForCurrentSelection(oCV,_8a9.items);
_8ab=(_8a9.items&&_8a9.items.length>0)?true:false;
if(_8ab&&_8a9.items.length==1){
_8a9=_8a9.items[0];
}
}
}
}
if(_8a9&&_8a9.visible!==false&&_8ab){
if(_8a9.separator===true){
if(_8a6.length>0&&typeof _8a6[_8a6.length-1].separator=="undefined"){
_8a6[_8a6.length]=_8a9;
}
}else{
if(_8a9.useChildrenItems==true&&_8a9.items&&_8a9.items.length>0){
if(!_8a9.disabled){
for(var _8ad=0;_8ad<_8a9.items.length;_8ad++){
_8a6[_8a6.length]=_8a9.items[_8ad];
}
}
}else{
if(typeof _8a9._root!="undefined"){
_8a6[_8a6.length]={"_root":CCognosViewerToolbarHelper.updateContextMenuForCurrentSelection(oCV,_8a9._root)};
}else{
_8a6[_8a6.length]=_8a9;
}
}
}
}
}
if(_8a6.length>1){
if(_8a6[_8a6.length-1].separator){
_8a6=_8a6.splice(0,_8a6.length-1);
}
}
}
return _8a6;
};
function CCDManager(cv){
this.m_cd=null;
this.m_md=null;
this.m_oCV=null;
this.m_dataItemInfo=null;
};
CCDManager.prototype.SetContextData=function(CD){
if(this.m_cd){
this.m_cd=null;
}
this.m_cd=CD;
};
CCDManager.prototype.SetMetadata=function(MD){
if(this.m_md){
this.m_md=null;
}
this.m_md=MD;
};
CCDManager.prototype.AddContextData=function(CD){
if(!this.m_cd){
this.m_cd=CD;
}else{
for(var i in CD){
this.m_cd[i]=CD[i];
}
}
};
CCDManager.prototype.AddMetadata=function(MD){
if(!this.m_md){
this.m_md=MD;
}else{
for(var j in MD){
this.m_md[j]=MD[j];
}
}
};
CCDManager.prototype.getClonedMetadataArray=function(){
var _8b5={};
applyJSONProperties(_8b5,this.m_md);
return _8b5;
};
CCDManager.prototype.getClonedContextdataArray=function(){
var _8b6={};
applyJSONProperties(_8b6,this.m_cd);
return _8b6;
};
CCDManager.prototype.SetCognosViewer=function(_8b7){
if(_8b7){
this.m_oCV=_8b7;
}
};
CCDManager.prototype.onComplete_GetCDRequest=function(_8b8,_8b9){
if(_8b8){
var _8ba=_8b8.getResult();
var _8bb=XMLBuilderLoadXMLFromString(_8ba);
if(_8bb){
var _8bc=_8bb.getElementsByTagName("Block");
for(var i=0;i<_8bc.length;i++){
var _8be="";
var _8bf=_8bc[i].firstChild;
while(_8bf){
_8be+=_8bf.nodeValue;
_8bf=_8bf.nextSibling;
}
var cd=eval("("+_8be+")");
this.AddContextData(cd);
}
}
}
if(_8b9&&typeof _8b9=="function"){
_8b9();
}
};
CCDManager.prototype.FetchContextData=function(_8c1,_8c2){
var _8c3=[];
var c=null,_8c5=_8c1.length;
for(var i=0;i<_8c5;++i){
c=_8c1[i];
if(c!=""&&!this.ContextIdExists(c)){
_8c3.push(c);
}
}
if(_8c3.length){
if(this.m_oCV){
this.getContextData(_8c3,_8c2);
}
}
return _8c3.length;
};
CCDManager.prototype.getContextData=function(_8c7,_8c8){
var oCV=this.m_oCV;
var _8ca=new AsynchDataDispatcherEntry(oCV);
_8ca.setCanBeQueued(false);
if(!oCV.isBux){
_8ca.forceSynchronous();
}
var form=document["formWarpRequest"+oCV.getId()];
var _8cc=oCV.getConversation();
var _8cd=oCV.getTracking();
if(!_8cd&&form&&form["m_tracking"]&&form["m_tracking"].value){
_8cd=form["m_tracking"].value;
}
if(oCV.m_viewerFragment){
var _8ce=oCV.getActiveRequest();
if(_8ce&&_8ce.getFormField("m_tracking")==_8cd){
return;
}
}
var _8cf={customArguments:[_8c8],"complete":{"object":this,"method":this.onComplete_GetCDRequest}};
if(oCV.getStatus()=="prompting"){
_8cf["prompting"]={"object":this,"method":this.onComplete_GetCDRequest};
}
_8ca.setCallbacks(_8cf);
if(_8cc&&oCV.envParams["ui.action"]!="view"){
_8ca.addFormField("ui.action","getContext");
_8ca.addFormField("ui.conversation",_8cc);
}else{
var _8d0=form["ui.object"];
if(typeof _8d0.length!="undefined"&&_8d0.length>1){
_8ca.addFormField("ui.object",form["ui.object"][0].value);
}else{
_8ca.addFormField("ui.object",form["ui.object"].value);
}
_8ca.addFormField("ui.action","getObjectContext");
}
_8ca.addFormField("cv.responseFormat","asynchDetailContext");
_8ca.addFormField("context.format","initializer");
_8ca.addFormField("context.type","reportService");
_8ca.addFormField("context.selection",_8c7.join(","));
_8ca.addNonEmptyStringFormField("m_tracking",_8cd);
oCV.dispatchRequest(_8ca);
};
CCDManager.prototype.ContextIdExists=function(_8d1){
return (this.m_cd&&this.m_cd[_8d1]?true:false);
};
CCDManager.prototype.HasContextData=function(){
return (this.m_cd?true:false);
};
CCDManager.prototype.HasMetadata=function(){
return (this.m_md?true:false);
};
CCDManager.prototype._getMDPropertyFromCD=function(_8d2,_8d3,_8d4){
var p=null;
this.FetchContextData([_8d2]);
var cd=this.m_cd&&this.m_cd[_8d2];
if(cd){
var md=this.m_md[cd[_8d3]];
if(md){
p=md[_8d4];
}
}
return p;
};
CCDManager.prototype.GetDrillFlag=function(_8d8){
return this._getMDPropertyFromCD(_8d8,"r","drill");
};
CCDManager.prototype.getModelPathFromBookletItem=function(_8d9){
var mp=null;
var md=this.m_md[_8d9];
if(md){
mp=md.mp;
if(mp&&this.m_md[mp]){
mp=this.m_md[mp].mp;
}
}
return mp?mp:null;
};
CCDManager.prototype.GetBookletModelBasedDrillThru=function(_8dc){
var p=null;
var md=this.m_md[_8dc];
if(md){
p=md.modelBasedDrillThru;
}
return p?p:0;
};
CCDManager.prototype.GetDrillFlagForMember=function(_8df){
var _8e0=null;
var d=this._getMDPropertyFromCD(_8df,"r","drill");
if(d!==null&&this.m_cd[_8df].m){
_8e0=d;
}
return _8e0;
};
CCDManager.prototype.GetDataType=function(_8e2){
return this._getMDPropertyFromCD(_8e2,"r","dtype");
};
CCDManager.prototype.GetUsage=function(_8e3){
return this._getMDPropertyFromCD(_8e3,"r","usage");
};
CCDManager.prototype.GetHUN=function(_8e4){
var hun=this._getMDPropertyFromCD(_8e4,"h","h");
if(!hun){
var h=this._getMDPropertyFromCD(_8e4,"r","h");
if(h){
hun=this.m_md[h].h;
}
}
if(hun!=null&&hun.indexOf("[__ns_")==0){
hun=null;
}
return hun;
};
CCDManager.prototype.GetQuery=function(_8e7){
var qry=null;
var q=this._getMDPropertyFromCD(_8e7,"r","q");
if(q){
qry=this.m_md[q].q;
}
return qry;
};
CCDManager.prototype.GetDepth=function(_8ea){
return this._getMDPropertyFromCD(_8ea,"r","level");
};
CCDManager.prototype.GetDisplayValue=function(_8eb){
var _8ec=null;
this.FetchContextData([_8eb]);
if(this.ContextIdExists(_8eb)&&this.m_cd[_8eb]){
_8ec=this.m_cd[_8eb].u;
}
return _8ec;
};
CCDManager.prototype.GetPUN=function(_8ed){
return this._getMDPropertyFromCD(_8ed,"p","p");
};
CCDManager.prototype.GetLUN=function(_8ee){
return this._getMDPropertyFromCD(_8ee,"l","l");
};
CCDManager.prototype.GetMUN=function(_8ef){
return this._getMDPropertyFromCD(_8ef,"m","m");
};
CCDManager.prototype.GetDUN=function(_8f0){
return this._getMDPropertyFromCD(_8f0,"d","d");
};
CCDManager.prototype.GetQMID=function(_8f1){
return this._getMDPropertyFromCD(_8f1,"i","i");
};
CCDManager.prototype.GetRDIValue=function(_8f2){
return this._getMDPropertyFromCD(_8f2,"r","r");
};
CCDManager.prototype.GetBIValue=function(_8f3){
return this._getMDPropertyFromCD(_8f3,"r","bi");
};
CCDManager.prototype.getContextIdForMetaData=function(lun,hun,_8f6){
var _8f7=[{"expression":lun,"type":"l"},{"expression":hun,"type":"h"}];
for(var _8f8=0;_8f8<_8f7.length;++_8f8){
var _8f9=_8f7[_8f8].expression;
var _8fa=_8f7[_8f8].type;
if(_8f9==""){
continue;
}
for(var _8fb in this.m_md){
if(this.m_md[_8fb][_8fa]==_8f9){
for(var _8fc in this.m_md){
if(this.m_md[_8fc].r&&this.m_md[_8fc][_8fa]==_8fb){
if(this.m_md[_8fc].drill!=0||_8f6==true){
for(var ctx in this.m_cd){
if(this.m_cd[ctx].r==_8fc&&this.m_cd[ctx].m){
return ctx;
}
}
}
}
}
}
}
}
return "";
};
CCDManager.prototype.GetContextIdForMUN=function(mun){
var _8ff=null;
var _900=null;
for(var i in this.m_md){
if(this.m_md[i].m==mun){
_8ff=i;
break;
}
}
if(_8ff!=null){
for(var j in this.m_cd){
if(this.m_cd[j].m==_8ff){
_900=j;
break;
}
}
}
return _900;
};
CCDManager.prototype.GetContextIdsForRDI=function(rdi){
var _904=[];
for(var i in this.m_md){
if(this.m_md[i].r==rdi){
_904.push(i);
}
}
return _904;
};
CCDManager.prototype.getMUNForRDIAndUseValue=function(rdi,_907){
var _908=this.GetContextIdsForRDI(rdi);
for(var i in this.m_cd){
for(var j in _908){
if(this.m_cd[i].r==_908[j]&&this.m_cd[i].u==_907){
var _90b=this.m_cd[i].m;
if(_90b){
return this.m_md[_90b].m;
}
}
}
}
return null;
};
CCDManager.prototype.GetPageMinMaxForRDI=function(rdi){
var _90d=null;
var _90e=null;
var _90f=this.GetContextIdsForRDI(rdi);
this.FetchContextData([0]);
for(var i in this.m_cd){
for(var j in _90f){
if(this.m_cd[i].r==_90f[j]){
var _912=parseFloat(this.m_cd[i].u);
if(_912==this.m_cd[i].u){
if(_90d==null||_912<_90d){
_90d=_912;
}
if(_90e==null||_912>_90e){
_90e=_912;
}
}
}
}
}
if(_90d!=null&&_90e!=null){
return eval("({ pageMin: "+_90d+", pageMax: "+_90e+"})");
}
};
CCDManager.prototype.GetContextIdForDisplayValue=function(_913){
var _914=null;
for(var i in this.m_cd){
if(this.m_cd[i].u==_913){
_914=i;
break;
}
}
return _914;
};
CCDManager.prototype.GetContextIdForUseValue=function(_916){
var _917=null;
var _918=null;
var _919=null;
for(var i in this.m_md){
var md=this.m_md[i];
for(var j in md){
if(md[j]==_916){
_917=i;
_918=j;
break;
}
}
}
if(_917!=null){
for(var k in this.m_cd){
if(this.m_cd[k][_918]==_917){
_919=k;
break;
}
}
}
return _919;
};
CCDManager.prototype.getDataItemInfo=function(){
if(this.m_cd){
var _91e={};
this.m_dataItemInfo={};
for(var i in this.m_cd){
var _920=this.m_cd[i].r;
if(typeof _920!="undefined"){
var _921=this.m_md[_920].r;
if(this.m_dataItemInfo[_921]==null){
this.m_dataItemInfo[_921]=1;
}else{
this.m_dataItemInfo[_921]++;
}
}
}
return CViewerCommon.toJSON(this.m_dataItemInfo);
}
return "";
};
CCDManager.prototype.DataItemInfoToJSON=function(){
return this.getDataItemInfo();
};
CCDManager.prototype.MetadataToJSON=function(){
if(this.m_md){
return CViewerCommon.toJSON(this.m_md);
}
return "";
};
CCDManager.prototype.ContextDataToJSON=function(){
if(this.m_cd){
return CViewerCommon.toJSON(this.m_cd);
}
return "";
};
CCDManager.prototype.ContextDataSubsetToJSON=function(_922){
if(_922<=0){
return this.ContextDataToJSON();
}
if(this.m_cd){
var _923={};
var _924={};
for(var i in this.m_cd){
var _926=this.m_cd[i].r;
if(typeof _926!="undefined"){
if(_923[_926]==null){
_923[_926]=0;
}else{
_923[_926]++;
}
if(_923[_926]<_922){
_924[i]=this.m_cd[i];
}
}
}
return CViewerCommon.toJSON(_924);
}
return "";
};
CCDManager.prototype.GetHUNForRDI=function(rdi,_928){
for(var i in this.m_md){
if(this.m_md[i].r==rdi&&this.m_md[i].q==_928){
var _92a=this.m_md[i].h;
if(_92a){
return this.m_md[_92a].h;
}
}
}
return null;
};
CCDManager.prototype.GetMetadataIdForQueryName=function(_92b){
for(var i in this.m_md){
if(this.m_md[i].q===_92b){
return i;
}
}
return null;
};
CCDManager.prototype._isEmptyObject=function(obj){
for(var _92e in obj){
return false;
}
return true;
};
CCDManager.prototype.isMetadataEmpty=function(){
if(this.m_md){
return this._isEmptyObject(this.m_md);
}
return true;
};
CCDManager.prototype.GetBestPossibleItemName=function(_92f){
var item=this.m_cd[_92f];
if(!item){
return null;
}
if(item.l&&this.m_md[item.l].l){
return this._getStringInLastBracket(this.m_md[item.l].l);
}
if(item.r&&this.m_md[item.r].r){
return this._getStringInLastBracket(this.m_md[item.r].r);
}
if(item.h&&this.m_md[item.h].h){
return this._getStringInLastBracket(this.m_md[item.h].h);
}
if(item.i&&this.m_md[item.i].i){
return this._getStringInLastBracket(this.m_md[item.i].i);
}
return null;
};
CCDManager.prototype.GetBestPossibleDimensionMeasureName=function(_931){
var item=this.m_cd[_931];
if(item&&item.m&&this.m_md[item.m]&&this.m_md[item.m].m){
return this._getStringInLastBracket(this.m_md[item.m].m);
}
return null;
};
CCDManager.prototype._getStringInLastBracket=function(str){
if(str&&str.indexOf("].[")>0){
var _934=str.split("].[");
var _935=_934[_934.length-1];
return _935.substring(0,_935.length-1);
}
return str;
};
CCDManager.prototype._replaceNamespaceForSharedTM1DimensionOnly=function(_936){
var _937=this._getNamespaceAndDimensionFromUniqueName(_936);
if(_937&&this.m_md){
for(var _938 in this.m_md){
var sMun=this.m_md[_938].m;
if(sMun&&sMun.length>0){
if(sMun.indexOf("->:[TM].")>0){
var oObj=this._getNamespaceAndDimensionFromUniqueName(sMun);
if(oObj.dimension&&oObj.dimension===_937.dimension&&oObj.namespace!==_937.namespace){
var _93b=_936.indexOf(".");
return oObj.namespace+_936.substr(_93b,_936.length);
}
}else{
var _93c=sMun.indexOf("->:[");
if(_93c>0){
if(sMun.substr(_93c+4,4)!=="TM]."){
return _936;
}
}
}
}
}
}
return _936;
};
CCDManager.prototype._getNamespaceAndDimensionFromUniqueName=function(_93d){
if(_93d&&_93d.length>0&&_93d.indexOf("].[")>0){
var _93e=_93d.split("].[");
if(_93e.length>1){
return {"namespace":_93e[0]+"]","dimension":"["+_93e[1]+"]"};
}
}
return null;
};
CCDManager.prototype.destroy=function(){
delete this.m_cd;
delete this.m_md;
delete this.m_oCV;
delete this.m_dataItemInfo;
};
var GUtil={};
GUtil.createHiddenForm=function(name,_940,_941,_942){
var form=document.getElementById(name);
if(form){
document.body.removeChild(form);
}
form=document.createElement("form");
form.id=name;
form.name=name;
form.method=_940;
form.style.display="none";
form.action=document.forms["formWarpRequest"+_941].action;
form.target=_942+(new Date()).getTime();
document.body.appendChild(form);
return form;
};
GUtil.createFormField=function(el,name,_946){
var _947=document.createElement("input");
_947.type="hidden";
_947.name=name;
_947.value=_946;
el.appendChild(_947);
};
GUtil.generateCallback=function(func,_949,_94a){
if(func){
var _94b=_94a||this;
_949=(_949 instanceof Array)?_949:[];
return (function(_94c){
if(typeof _94c!="undefined"&&_949.length==0){
_949.push(_94c);
}
return func.apply(_94b,_949);
});
}else{
return (function(){
});
}
};
GUtil.destroyProperties=function(_94d,_94e){
var _94f;
if(_94d instanceof Array){
for(var i=0;i<_94d.length;i++){
_94f=_94d[i];
if(_94f instanceof String){
_94f=null;
}else{
if(_94f&&_94f.destroy&&!_94f._beingDestroyed){
_94f.destroy();
}
GUtil.destroyProperties(_94f);
}
}
}else{
if(_94d instanceof Object){
if(_94d._beingDestroyed){
return;
}
var obj=_94d;
obj._beingDestroyed=true;
for(var _952 in obj){
_94f=obj[_952];
if(_952==="_beingDestroyed"||_952==="m_destroyed"||_952==="_destroyed"||typeof _94f=="function"){
continue;
}
if(_94f instanceof Array){
GUtil.destroyProperties(_94f);
}else{
if(_94f instanceof Object){
if(typeof _94f.destroy=="function"&&!_94f._destroyed&&(_94f!==CCognosViewer||_94e)){
_94f.destroy();
}
}
}
delete obj[_952];
}
}
}
};
cvLoadDialog=function(_953,_954,_955,_956,_957,_958){
_958=((_958===undefined)?true:_958);
var _959=document.getElementById("formWarpRequest"+_953.getId());
if(_959&&_953){
_953.getWorkingDialog().hide();
var _95a="";
var _95b="";
var _95c=null;
if(_953.isAccessibleMode()){
_95a="winNAT_"+(new Date()).getTime();
_95b=_953.getWebContentRoot()+"/"+"rv/blankNewWin.html?cv.id="+this.getCVId();
}else{
var _95d=document.body;
_95c=new CModal("","",_95d,null,null,_956,_955,true,true,false,true,_953.getWebContentRoot());
if(typeof _957=="string"){
document.getElementById(CMODAL_CONTENT_ID).setAttribute("title",_957);
}
document.getElementById(CMODAL_BACK_IFRAME_ID).setAttribute("title",RV_RES.IDS_JS_MODAL_BACK_IFRAME);
_95a=CMODAL_CONTENT_ID;
}
var _95e=document.createElement("FORM");
_95e.method="POST";
_95e.action=_953.getGateway();
_95e.target=_95a;
_95e.style.margin="0px";
document.body.appendChild(_95e);
for(var _95f in _954){
_95e.appendChild(createHiddenFormField(_95f,_954[_95f]));
}
if(_958){
_95e.appendChild(createHiddenFormField("cv.id",_953.getId()));
_95e.appendChild(createHiddenFormField("b_action","xts.run"));
_95e.appendChild(createHiddenFormField("ui.action",_959["ui.action"].value));
_95e.appendChild(createHiddenFormField("ui.object",_959["ui.object"].value));
if(typeof _953.rvMainWnd!="undefined"){
_95e.appendChild(createHiddenFormField("run.outputFormat",_953.rvMainWnd.getCurrentFormat()));
}
if(typeof _959["run.outputLocale"]!="undefined"){
_95e.appendChild(createHiddenFormField("run.outputLocale",_959["run.outputLocale"].value));
}
if(typeof _95e["backURL"]=="undefined"&&typeof _95e["ui.backURL"]=="undefined"&&typeof _959["ui.backURL"]!="undefined"){
_95e.appendChild(createHiddenFormField("ui.backURL",_959["ui.backURL"].value));
}
if(typeof _953!="undefined"&&typeof _953.getConversation!="undefined"&&typeof _953.getTracking!="undefined"){
_95e.appendChild(createHiddenFormField("ui.conversation",_953.getConversation()));
_95e.appendChild(createHiddenFormField("m_tracking",_953.getTracking()));
if(_953.envParams["ui.name"]!="undefined"){
_95e.appendChild(createHiddenFormField("ui.name",_953.envParams["ui.name"]));
}
}
}
var _960=window.onbeforeunload;
window.onbeforeunload=null;
if(_953.isAccessibleMode()){
window.open(_95b,_95a,"rv");
_95e.submit();
}else{
_95e.submit();
_95c.show();
}
window.onbeforeunload=_960;
document.body.removeChild(_95e);
_953.modalShown=true;
}
};
function createHiddenFormField(name,_962){
var _963=document.createElement("input");
_963.setAttribute("type","hidden");
_963.setAttribute("name",name);
_963.setAttribute("id",name);
_963.setAttribute("value",_962);
return (_963);
};
function isAuthenticationFault(_964){
if(_964!=null){
var _965=XMLHelper_FindChildByTagName(_964,"CAM",true);
return (_965!=null&&XMLHelper_FindChildByTagName(_965,"promptInfo",true)!=null);
}
};
function processAuthenticationFault(_966,_967){
if(isAuthenticationFault(_966)){
launchLogOnDialog(_967,_966);
return true;
}
return false;
};
function isObjectEmpty(_968){
for(var _969 in _968){
if(_968.hasOwnProperty(_969)){
return false;
}
}
return true;
};
function launchLogOnDialog(cvID,_96b){
try{
var oCV=getCognosViewerObjectRef(cvID);
var _96d={"b_action":"xts.run","m":"portal/close.xts","h_CAM_action":"logonAs"};
if(_96b!=null){
var _96e=XMLHelper_FindChildrenByTagName(_96b,"namespace",true);
if(_96e!=null){
for(var _96f=0;_96f<_96e.length;++_96f){
var _970=_96e[_96f];
if(_970!=null){
var _971=XMLHelper_FindChildByTagName(_970,"name",false);
var _972=XMLHelper_FindChildByTagName(_970,"value",false);
if(_971!=null&&_972!=null){
var _973=XMLHelper_GetText(_971);
var _974=XMLHelper_GetText(_972);
if(_973!=null&&_973.length>0){
_96d[_973]=_974;
}
}
}
}
}
}
cvLoadDialog(oCV,_96d,540,460,null,false);
}
catch(exception){
}
};
function getCVWaitingOnFault(){
var oCV=null;
for(var _976=0;_976<window.gaRV_INSTANCES.length;_976++){
if(window.gaRV_INSTANCES[_976].getRetryDispatcherEntry()!=null){
oCV=window.gaRV_INSTANCES[_976];
break;
}
}
return oCV;
};
function ccModalCallBack(_977,data){
var oCV=getCVWaitingOnFault();
destroyCModal();
if(typeof HiddenIframeDispatcherEntry=="function"&&HiddenIframeDispatcherEntry.hideIframe){
var oCV=window.gaRV_INSTANCES[0];
if(oCV){
HiddenIframeDispatcherEntry.hideIframe(oCV.getId());
}
}
if(oCV!=null){
if(typeof _977!="undefined"&&_977=="ok"){
var _97a=oCV.getRetryDispatcherEntry();
if(_97a){
_97a.retryRequest();
}
if(oCV.getRV()!=null){
oCV.getRV().updateUserName();
}
}else{
oCV.rvMainWnd.hideOpenMenus();
}
}
};
function closeErrorPage(){
var oCV=getCVWaitingOnFault();
destroyCModal();
if(oCV!=null){
oCV.setRetryDispatcherEntry(null);
oCV.rvMainWnd.hideOpenMenus();
}
};
function getCrossBrowserNode(evt,_97d){
var node=null;
if(_97d&&evt.explicitOriginalTarget){
node=evt.explicitOriginalTarget;
}else{
if(evt.originalTarget){
node=evt.originalTarget;
}else{
if(evt.target){
node=evt.target;
}else{
if(evt.srcElement){
node=evt.srcElement;
}
}
}
}
try{
if(node&&node.nodeType==3){
node=node.parentNode;
}
}
catch(ex){
}
return node;
};
function getNodeFromEvent(evt,_980){
var node=getCrossBrowserNode(evt,true);
if(node&&node.getAttribute&&node.getAttribute("name")=="primarySelectionDiv"){
node=node.parentNode.firstChild;
}
if(node&&node.getAttribute&&node.getAttribute("flashChartContainer")=="true"){
node=node.firstChild;
}
if(node&&node.getAttribute&&node.getAttribute("chartContainer")=="true"&&node.childNodes){
for(var i=0;i<node.childNodes.length;i++){
if(node.childNodes[i].nodeName.toLowerCase()=="img"){
node=node.childNodes[i];
break;
}
}
}else{
if(!_980&&node&&node.nodeName&&node.nodeName.toLowerCase()=="img"&&node.getAttribute("rsvpChart")!="true"){
node=node.parentNode;
}
}
return node;
};
function getCtxNodeFromEvent(evt){
try{
var node=getCrossBrowserNode(evt);
var _985=node.nodeName.toUpperCase();
if((_985=="SPAN"||_985=="AREA"||_985=="IMG")&&node.getAttribute("ctx")!=null){
return node;
}else{
if(_985=="SPAN"&&(node.parentNode.getAttribute("ctx")!=null)){
return node.parentNode;
}
}
}
catch(exception){
}
return null;
};
function getDocumentFromEvent(evt){
var node=getCrossBrowserNode(evt,true);
var _988=node.document?node.document:node.ownerDocument;
return _988;
};
function stopEventBubble(evt){
evt.returnValue=false;
evt.cancelBubble=true;
if(typeof evt.stopPropagation!="undefined"){
evt.stopPropagation();
}
if(typeof evt.preventDefault!="undefined"){
evt.preventDefault();
}
return false;
};
function setNodeFocus(evt){
evt=(evt)?evt:((event)?event:null);
var _98b=getNodeFromEvent(evt);
if(_98b&&_98b.nodeName){
var _98c=_98b.nodeName.toLowerCase();
if((_98c=="td"||_98c=="span")&&_98b.childNodes&&_98b.childNodes.length>0&&_98b.childNodes[0].className=="textItem"){
try{
_98b.childNodes[0].focus();
}
catch(e){
if(typeof console!=="undefined"&&console.log){
console.log("CCognosViewer: Could not set focus to node. setNodeFocus method common.js");
}
}
}
}
};
function html_encode(str){
return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");
};
function replaceNewLine(_98e){
var regX=/\r\n|\r|\n/g;
var _990="<br/>";
return _98e.replace(regX,_990);
};
function xml_encode(_991){
var _992=""+_991;
if((_992=="0")||((_991!=null)&&(_991!=false))){
_992=_992.replace(/&/g,"&amp;");
_992=_992.replace(/</g,"&lt;");
_992=_992.replace(/>/g,"&gt;");
_992=_992.replace(/"/g,"&quot;");
_992=_992.replace(/'/g,"&apos;");
}else{
if(_991==null){
_992="";
}
}
return _992;
};
function xml_decodeParser(sAll,_994){
var _995=sAll;
switch(_994){
case "amp":
_995="&";
break;
case "lt":
_995="<";
break;
case "gt":
_995=">";
break;
case "quot":
_995="\"";
break;
case "apos":
_995="'";
break;
}
return _995;
};
function xml_decode(_996){
var _997=""+_996;
if((_997=="0")||((_996!=null)&&(_996!=false))){
_997=_997.replace(/&(amp|lt|gt|quot|apos);/g,xml_decodeParser);
}else{
if(_996==null){
_997="";
}
}
return _997;
};
function xpath_attr_encode(_998){
var _999=null;
if(_998.indexOf("'")>=0&&_998.indexOf("\"")>=0){
var _99a=_998.split("\"");
_999="concat(";
for(var i=0;i<_99a.length;++i){
if(i>0){
_999+=",";
}
if(_99a[i].length>0){
_999+=("\""+_99a[i]+"\"");
}else{
_999+="'\"'";
}
}
_999+=")";
}else{
if(_998.indexOf("'")>=0){
_999="\""+_998+"\"";
}else{
_999="'"+_998+"'";
}
}
return _999;
};
function getCognosViewerObjectString(sId){
return "oCV"+sId;
};
function getCognosViewerObjectRefAsString(sId){
return "window."+getCognosViewerObjectString(sId);
};
function getCognosViewerObjectRef(sId){
return window[getCognosViewerObjectString(sId)];
};
function getCognosViewerSCObjectString(sId){
return "oCVSC"+sId;
};
function getCognosViewerSCObjectRefAsString(sId){
return "window."+getCognosViewerSCObjectString(sId);
};
function getCognosViewerSCObjectRef(sId){
return window[getCognosViewerSCObjectString(sId)];
};
function cleanupGlobalObjects(sId){
cleanupVariable(getCognosViewerObjectString(sId));
cleanupVariable(getCognosViewerSCObjectString(sId));
};
function cleanupVariable(_9a3){
if(typeof window[_9a3]!="undefined"&&window[_9a3]){
if(isIE()){
eval("delete "+_9a3);
}else{
delete window[_9a3];
}
}
};
function loadClass(_9a4){
try{
var _9a5=eval("new "+_9a4+"();");
return _9a5;
}
catch(e){
return null;
}
};
function getElementsByClassName(oElm,_9a7,_9a8){
var _9a9=(_9a7=="*"&&oElm.all)?oElm.all:oElm.getElementsByTagName(_9a7);
var _9aa=[];
var _9ab=new RegExp("(^|\\s)"+_9a8+"(\\s|$)");
var _9ac=_9a9.length;
for(var i=0;i<_9ac;i++){
var _9ae=_9a9[i];
if(_9ab.test(_9ae.className)){
_9aa.push(_9ae);
}
}
return _9aa;
};
function getImmediateLayoutContainerId(node){
var _9b0=node;
while(_9b0!=null){
if(_9b0.getAttribute&&_9b0.getAttribute("lid")!=null){
return _9b0.getAttribute("lid");
}
_9b0=_9b0.parentNode;
}
return null;
};
function getChildElementsByAttribute(oElm,_9b2,_9b3,_9b4){
return getDescendantElementsByAttribute(oElm,_9b2,_9b3,_9b4,true);
};
function getElementsByAttribute(oElm,_9b6,_9b7,_9b8,_9b9,_9ba){
return getDescendantElementsByAttribute(oElm,_9b6,_9b7,_9b8,false,_9b9,_9ba);
};
function getDescendantElementsByAttribute(oElm,_9bc,_9bd,_9be,_9bf,_9c0,_9c1){
var _9c2=[];
var _9c3=null;
if(typeof _9c1==="undefined"){
_9c3=(typeof _9be!="undefined")?new RegExp("(^|\\s)"+_9be+"(\\s|$)","i"):null;
}else{
_9c3=_9c1;
}
if(typeof _9bc=="string"){
_9bc=[_9bc];
}
var _9c4=(oElm?_9bc.length:0);
for(var _9c5=0;_9c5<_9c4;_9c5++){
var _9c6=null;
if(_9bf){
if(_9bc[_9c5]=="*"&&oElm.all){
_9c6=oElm.childNodes;
}else{
_9c6=[];
var _9c7=oElm.childNodes;
for(var i=0;i<_9c7.length;++i){
if(_9c7[i].nodeName.toLowerCase()==_9bc[_9c5].toLowerCase()){
_9c6.push(_9c7[i]);
}
}
}
}else{
_9c6=(_9bc[_9c5]=="*"&&oElm.all)?oElm.all:oElm.getElementsByTagName(_9bc[_9c5]);
}
var _9c9=_9c6.length;
for(var idx=0;idx<_9c9;idx++){
var _9cb=_9c6[idx];
var _9cc=_9cb.getAttribute&&_9cb.getAttribute(_9bd);
if(_9cc!==null){
var _9cd=null;
if(typeof _9cc==="number"){
_9cd=String(_9cc);
}else{
if(typeof _9cc==="string"&&_9cc.length>0){
_9cd=_9cc;
}
}
if(_9cd!==null){
if(typeof _9be=="undefined"||(_9c3&&_9c3.test(_9cd))){
_9c2.push(_9cb);
if(_9c0!=-1&&_9c2.length>_9c0){
return [];
}else{
if(_9c0==1&&_9c2.length==1){
return _9c2;
}
}
}
}
}
}
}
return _9c2;
};
function savedOutputDoneLoading(cvId,_9cf){
var oCV=window["oCV"+cvId];
var _9d1=(oCV&&oCV.getViewerWidget?oCV.getViewerWidget():null);
var _9d2=(_9d1?_9d1.getSavedOutput():null);
if(_9d2){
_9d2.outputDoneLoading();
}else{
if(_9cf<5){
_9cf++;
var _9d3=function(){
savedOutputDoneLoading(cvId,_9cf);
};
setTimeout(_9d3,100);
}
}
};
function getNavVer(){
var temp;
if(isIE()){
return getIEVersion();
}else{
temp=navigator.userAgent.split("/");
return parseFloat(temp[temp.length-1]);
}
};
function isSafari(){
return (navigator.userAgent.toLowerCase().indexOf("safari")!=-1&&navigator.userAgent.toLowerCase().indexOf("chrome")==-1);
};
function isIE(){
return (navigator.userAgent.indexOf("MSIE")!=-1||navigator.userAgent.indexOf("Trident")!=-1);
};
function getIEVersion(){
var _9d5=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/);
return _9d5?parseFloat(_9d5[1]):null;
};
function isFF(){
return (navigator.userAgent.indexOf("Firefox")!=-1);
};
function isIOS(){
return navigator.userAgent.indexOf("iPad")!=-1||navigator.userAgent.indexOf("iPhone")!=-1;
};
function displayChart(_9d6,_9d7,_9d8,_9d9){
if(_9d7.length>1){
document.images[_9d6].src=_9d7;
}
};
function isFlashChartNode(evt){
var node=getNodeFromEvent(evt);
if(node!=null&&typeof node.getAttribute=="function"){
return node.getAttribute("flashChart")!=null;
}
return false;
};
function onFlashChartRightClick(evt){
if(evt&&evt.button&&evt.button!=0&&isFlashChartNode(evt)){
return onViewerChartFocus(evt);
}
};
function onViewerChartFocus(evt){
if(evt.stopPropagation){
evt.stopPropagation();
}
if(evt.preventDefault){
evt.preventDefault();
}
if(evt.preventCapture){
evt.preventCapture();
}
if(evt.preventBubble){
evt.preventBubble();
}
var node=getNodeFromEvent(evt);
var _9df=node.getAttribute("viewerId");
if(!_9df){
_9df=node.parentNode.getAttribute("viewerId");
}
if(!_9df){
return;
}
var oCV=window["oCV"+_9df];
var _9e1=oCV.getAction("Selection");
_9e1.pageClicked(evt);
return stopEventBubble(evt);
};
function clientToScreenCoords(_9e2,_9e3){
var _9e4=_9e2;
var _9e5={topCoord:0,leftCoord:0};
while(_9e4!=null&&_9e4!=_9e3){
_9e5.topCoord+=_9e4.offsetTop;
_9e5.leftCoord+=_9e4.offsetLeft;
_9e4=_9e4.offsetParent;
}
return _9e5;
};
function getCurrentPosistionString(oCV,_9e7,_9e8){
var _9e9=RV_RES.IDS_JS_INFOBAR_ITEM_COUNT;
var _9ea=/\{0\}/;
var _9eb=/\{1\}/;
_9e9=_9e9.replace(_9ea,_9e7);
_9e9=" "+_9e9.replace(_9eb,_9e8)+" ";
return _9e9;
};
function applyJSONProperties(obj,_9ed){
for(property in _9ed){
if(typeof _9ed[property]=="object"&&!(_9ed[property] instanceof Array)){
if(typeof obj[property]=="undefined"){
obj[property]={};
}
applyJSONProperties(obj[property],_9ed[property]);
}else{
obj[property]=_9ed[property];
}
}
};
function CViewerCommon(){
};
CViewerCommon.openNewWindowOrTab=function(sURL,_9ef){
return window.open(sURL,_9ef);
};
CViewerCommon.toJSON=function(obj){
var type=typeof (obj);
if(type!="object"||type===null){
if(type==="string"){
obj="\""+obj+"\"";
}
return String(obj);
}else{
var _9f2;
var prop;
var json=[];
var _9f5=(obj&&obj.constructor==Array);
for(_9f2 in obj){
prop=obj[_9f2];
type=typeof (prop);
if(type==="string"){
prop="\""+prop+"\"";
}else{
if(type=="object"&&prop!==null){
prop=CViewerCommon.toJSON(prop);
}
}
json.push((_9f5?"":"\""+_9f2+"\":")+String(prop));
}
return (_9f5?"[":"{")+String(json)+(_9f5?"]":"}");
}
};
function resizePinnedContainers(){
var oCV=window.gaRV_INSTANCES[0];
if(oCV&&!oCV.m_viewerFragment){
var _9f7=oCV.getPinFreezeManager();
if(_9f7&&_9f7.hasFrozenContainers()){
var _9f8=document.getElementById("RVContent"+oCV.getId());
var _9f9=document.getElementById("mainViewerTable"+oCV.getId());
var _9fa=_9f8.clientWidth;
var _9fb=_9f9.clientHeight;
_9f7.resize(_9fa,_9fb);
if(isIE()){
oCV.repaintDiv(_9f8);
}
}
}
};
function setWindowHref(url){
var _9fd=window.onbeforeunload;
window.onbeforeunload=null;
window.location.href=url;
window.onbeforeunload=_9fd;
};
CViewerCommon.getMessage=function(msg,args){
if(typeof args=="undefined"){
return msg;
}else{
if(typeof args=="string"){
msg=msg.replace("{0}",args);
}else{
if(args.length){
for(var i=0;i<args.length;++i){
msg=msg.replace("{"+i+"}",args[i]);
}
}else{
msg=msg.replace("{0}",args);
}
}
}
return msg;
};
function getViewerDirection(){
if(window.gaRV_INSTANCES&&window.gaRV_INSTANCES.length){
return gaRV_INSTANCES[0].getDirection();
}
return "ltr";
};
function isViewerBidiEnabled(){
if(window.gaRV_INSTANCES&&window.gaRV_INSTANCES.length){
var _a01=gaRV_INSTANCES[0].isBidiEnabled();
if(_a01){
return true;
}
}
return false;
};
function getViewerBaseTextDirection(){
if(window.gaRV_INSTANCES&&window.gaRV_INSTANCES.length){
return gaRV_INSTANCES[0].getBaseTextDirection();
}
return "";
};
function enforceTextDir(_a02){
if(isViewerBidiEnabled()&&_a02){
var sDir=getViewerBaseTextDirection();
var _a04=BidiUtils.getInstance();
if(sDir=="auto"){
sDir=_a04.resolveStrBtd(_a02);
}
var _a05=(!dojo._isBodyLtr())?_a04.RLM:_a04.LRM;
return _a05+((sDir==="rtl")?_a04.RLE:_a04.LRE)+_a02+_a04.PDF+_a05;
}
return _a02;
};
function getElementDirection(_a06){
var dir=null;
if(_a06.currentStyle){
dir=_a06.currentStyle.direction;
}else{
if(window.getComputedStyle){
var _a08=window.getComputedStyle(_a06,null);
if(_a08){
dir=_a08.getPropertyValue("direction");
}
}
}
if(dir){
dir=dir.toLowerCase();
}
return dir;
};
function getScrollLeft(_a09){
if(getElementDirection(_a09)==="rtl"&&isFF()){
return _a09.scrollWidth-_a09.offsetWidth+_a09.scrollLeft;
}
return _a09.scrollLeft;
};
function setScrollLeft(_a0a,_a0b){
if(getElementDirection(_a0a)==="rtl"&&isFF()){
_a0a.scrollLeft=_a0a.offsetWidth+_a0b-_a0a.scrollWidth;
}else{
_a0a.scrollLeft=_a0b;
}
};
function setScrollRight(_a0c,_a0d){
if(getElementDirection(_a0c)==="rtl"&&isFF()){
_a0c.scrollLeft=-_a0d;
}else{
_a0c.scrollLeft=_a0c.scrollWidth-_a0c.offsetWidth-_a0d;
}
};
function getBoxInfo(el,_a0f){
if(!getBoxInfo.aStyles){
getBoxInfo.aStyles=[{name:"marginLeft",ie:"marginLeft",ff:"margin-left"},{name:"marginRight",ie:"marginRight",ff:"margin-right"},{name:"marginTop",ie:"marginTop",ff:"margin-top"},{name:"marginBottom",ie:"marginBottom",ff:"margin-bottom"},{name:"borderLeftWidth",ie:"borderLeftWidth",ff:"border-left-width"},{name:"borderRightWidth",ie:"borderRightWidth",ff:"border-right-width"},{name:"borderTopWidth",ie:"borderTopWidth",ff:"border-top-width"},{name:"borderBottomWidth",ie:"borderBottomWidth",ff:"border-bottom-width"},{name:"paddingLeft",ie:"paddingLeft",ff:"padding-left"},{name:"paddingRight",ie:"paddingRight",ff:"padding-right"},{name:"paddingTop",ie:"paddingTop",ff:"padding-top"},{name:"paddingBottom",ie:"paddingBottom",ff:"padding-bottom"}];
}
var _a10={};
var _a11=null;
if(el.currentStyle){
_a11=el.currentStyle;
}else{
if(window.getComputedStyle){
_a11=window.getComputedStyle(el,null);
}
}
if(!_a11){
return null;
}
for(i in getBoxInfo.aStyles){
var _a12=getBoxInfo.aStyles[i];
var size=null;
if(_a11.getPropertyValue){
size=_a11.getPropertyValue(_a12.ff);
}else{
size=_a11[_a12.ie];
}
if(size&&_a0f){
size=Number(size.replace("px",""));
}
_a10[_a12.name]=size;
}
return _a10;
};
if(!CViewerCommon){
var CViewerCommon={};
}
CViewerCommon.buildParameterValuesSpec=function(oCV){
var _a15=XMLBuilderLoadXMLFromString(oCV.getExecutionParameters());
var _a16=new CParameterValues();
if(_a15.childNodes.length==1){
_a16.loadWithOptions(_a15.childNodes[0],false);
}
var _a17=_a16.length();
var _a18="<pvs>";
if(_a17>0){
var _a19=new CParameterValueStringOperators(RV_RES.IDS_JS_FILTER_BETWEEN,RV_RES.IDS_JS_FILTER_NOT_BETWEEN,RV_RES.IDS_JS_FILTER_LESS_THAN,RV_RES.IDS_JS_FILTER_GREATER_THAN);
for(var _a1a=0;_a1a<_a17;++_a1a){
var _a1b=_a16.getAt(_a1a);
if(_a1b!=null){
_a18+="<pv>";
_a18+="<name>";
_a18+=xml_encode(_a1b.name());
_a18+="</name>";
_a18+="<value>";
_a18+=xml_encode(_a1b.toString(_a19));
_a18+="</value>";
_a18+="</pv>";
}
}
}
_a18+="</pvs>";
return _a18;
};
function PinFreezeContainer(_a1c,lid,_a1e,_a1f,_a20,_a21,_a22){
this.m_pinFreezeManager=_a1c;
this.m_lid=lid;
this.m_lidNS=lid+_a1e+_a22;
this.m_viewerId=_a1e;
this.m_freezeTop=_a1f;
this.m_freezeSide=_a20;
this.m_cachedReportDiv=null;
this.m_cachedPFContainer=null;
this.m_cachedBaseContainer=_a21;
this.m_containerMargin={"top":0,"left":0};
if(this.m_cachedBaseContainer&&this.m_cachedBaseContainer.style){
if(this.m_cachedBaseContainer.style.marginTop){
this.m_containerMargin.top=Number(this.m_cachedBaseContainer.style.marginTop.replace("px",""));
}
if(this.m_cachedBaseContainer.style.marginLeft){
this.m_containerMargin.left=Number(this.m_cachedBaseContainer.style.marginLeft.replace("px",""));
}
}
this.m_cachedContainerIndex=_a22;
this.m_sectionCache=null;
this.m_homeCellNodes={};
this.m_fixedWidth=null;
this.m_clientWidth=700;
this.m_scrollableClientWidth=700;
this.m_fixedHeight=null;
this.m_clientHeight=300;
this.m_scrollableClientHeight=300;
this.m_wrapFlag=false;
this.c_pageMargin=(this.m_freezeTop&&this.m_freezeSide)?50:20;
this.touchScrollSections=false;
this.touchPreviousX=-1;
this.touchPreviousY=-1;
};
PinFreezeContainer.prototype.toJSONString=function(){
var _a23="{";
_a23+="\"m_clientWidth\":"+this.m_clientWidth+"";
_a23+=",\"m_scrollableClientWidth\":"+this.m_scrollableClientWidth+"";
_a23+=",\"m_clientHeight\":"+this.m_clientHeight+"";
_a23+=",\"m_scrollableClientHeight\":"+this.m_scrollableClientHeight+"";
_a23+="}";
return _a23;
};
PinFreezeContainer.prototype.copyProperties=function(_a24){
this.m_clientWidth=_a24.m_clientWidth;
this.m_scrollableClientWidth=_a24.m_scrollableClientWidth;
this.m_clientHeight=_a24.m_clientHeight;
this.m_scrollableClientHeight=_a24.m_scrollableClientHeight;
};
PinFreezeContainer.prototype.setViewerId=function(id){
this.m_viewerId=id;
};
PinFreezeContainer.prototype.getLid=function(){
return this.m_lid;
};
PinFreezeContainer.prototype.createPFContainer=function(_a26,_a27){
var _a28=document.createElement("temp");
if(this.m_cachedBaseContainer){
this.applyAuthoredFixedSizes(this.m_cachedBaseContainer);
this.m_cachedReportDiv=_a26;
var _a29=this.m_cachedBaseContainer.parentNode;
var _a2a=this.loadTemplateHTML();
if(_a2a){
_a28.innerHTML=_a2a;
var _a2b=this.getContainerByLID(_a28);
var _a2c=this.getSectionByLID(_a28.firstChild,"pfMainOutput");
if(_a2c){
var i=this.getChildPosition(_a29,this.m_cachedBaseContainer);
if(i!=-1){
var _a2e=this.m_pinFreezeManager.m_oCV;
if(_a2e&&_a2e.envParams["freezeDefaultWrap"]){
if(this.m_cachedBaseContainer.style.whiteSpace===""&&_a2e.envParams["freezeDefaultWrap"].toLowerCase()==="true"){
var _a2f=this.m_cachedBaseContainer.getElementsByTagName("span");
if(_a2f){
for(var k=0;k<_a2f.length;k++){
_a2f[k].style.whiteSpace="nowrap";
}
}
this.m_wrapFlag=true;
}
}
if(!_a27){
if(!this._getFixedWidth()){
this.m_cachedBaseContainer.setAttribute("authoredFixedWidth","false");
this.m_addedFixedWidth=this.m_cachedBaseContainer.clientWidth+1;
this.m_cachedBaseContainer.style.width=this.m_addedFixedWidth+"px";
}
if(!this._getFixedHeight()){
this.m_cachedBaseContainer.setAttribute("authoredFixedHeight","false");
this.m_addedFixedHeight=this.m_cachedBaseContainer.clientHeight;
this.m_cachedBaseContainer.style.height=this.m_addedFixedHeight+"px";
}
_a2c.style.width=this.m_cachedBaseContainer.clientWidth+2+"px";
_a2c.style.height=this.m_cachedBaseContainer.clientHeight+2+"px";
}
_a2c.appendChild(this.m_cachedBaseContainer);
this.insertAt(_a29,_a2b,i);
}
if(this.m_cachedBaseContainer.style.border!==""){
_a2b.style.border=this.m_cachedBaseContainer.style.border;
this.m_cachedBaseContainer.style.border="";
}
}
}
}
};
PinFreezeContainer.prototype._getFixedWidth=function(_a31){
if(_a31&&_a31.style.width&&!_a31.getAttribute("authoredFixedWidth")){
var _a32=Number(_a31.style.width.split("px")[0]);
return isNaN(_a32)?null:_a32;
}
return null;
};
PinFreezeContainer.prototype._getFixedHeight=function(_a33){
if(_a33&&_a33.style.height&&!_a33.getAttribute("authoredFixedHeight")){
var _a34=Number(_a33.style.height.split("px")[0]);
return isNaN(_a34)?null:_a34;
}
return null;
};
PinFreezeContainer.prototype.applyAuthoredFixedSizes=function(_a35){
var _a36=this._getFixedWidth(_a35);
if(_a36){
this.m_fixedWidth=_a36;
this.m_clientWidth=this.m_fixedWidth;
this.m_scrollableClientWidth=this.m_fixedWidth;
}
var _a37=this._getFixedHeight(_a35);
if(_a37){
this.m_fixedHeight=_a37;
this.m_clientHeight=this.m_fixedHeight;
this.m_scrollableClientHeight=this.m_fixedHeight;
}
};
PinFreezeContainer.prototype.loadFreezeBothTemplateHTML=function(){
var _a38="<table pflid=\""+this.m_lidNS+"\" pfclid=\"pfContainer_"+this.m_lidNS+"\" cellpadding=\"0\" style=\"white-space:nowrap; width:0px; height:0px;\" cellspacing=\"0\">"+"<tr class=\"BUXNoPrint\" templatePart=\"freezeTop\"><td align=\"center\" templatePart=\"freezeSide\"><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfHomeCell_"+this.m_lidNS+"\" style=\"overflow-x:hidden; overflow-y:hidden; width:100%; height:100%\"/></td>"+"<td valign=top><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfTopHeadings_"+this.m_lidNS+"\" style=\"width:0px; height:0px; overflow-x:hidden; overflow-y:hidden; position:relative;\"/></td><td templatePart=\"freezeTop\"></td></tr>"+"<tr><td class=\"BUXNoPrint\" valign=top templatePart=\"freezeSide\"><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfSideHeadings_"+this.m_lidNS+"\" style=\"width:0px; height:0px; overflow-x:hidden; overflow-y:hidden; position:relative;\"/></td>"+"<td valign=top><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfMainOutput_"+this.m_lidNS+"\" style=\"width:0px; height:0px; overflow-x:hidden; overflow-y:hidden; position:relative;\">"+"</div></td>"+"<td class=\"BUXNoPrint\" templatePart=\"freezeTop\">"+"<div style=\"padding-right:1px;overflow-x:hidden; overflow-y:scroll;\" pflid=\""+this.m_lidNS+"\" pfslid=\"pfVerticalScrollBar_"+this.m_lidNS+"\" tabIndex=\"-1\" onmouseup=\"stopEventBubble(event);\" onmousedown=\"stopEventBubble(event);\" onscroll=\""+getCognosViewerObjectRefAsString(this.m_viewerId)+".m_pinFreezeManager.getContainer('"+this.m_lid+"', "+this.m_cachedContainerIndex+").synchVScroll()\">"+"<div style=\"padding-right:1px;\"/>"+"</div>"+"</td>"+"</tr>"+"<tr class=\"BUXNoPrint\" templatePart=\"freezeSide\"><td></td><td>"+"<div style=\"overflow-x:scroll; overflow-y:hidden;\" pflid=\""+this.m_lidNS+"\" pfslid=\"pfHorizontalScrollBar_"+this.m_lidNS+"\" tabIndex=\"-1\" onmouseup=\"stopEventBubble(event);\" onmousedown=\"stopEventBubble(event);\" onscroll=\""+getCognosViewerObjectRefAsString(this.m_viewerId)+".m_pinFreezeManager.getContainer('"+this.m_lid+"', "+this.m_cachedContainerIndex+").synchScroll()\">"+"<div style=\"height:2px;\">&nbsp;</div>"+"</div>"+"</td><td></td></tr></table>";
return _a38;
};
PinFreezeContainer.prototype.loadFreezeSideTemplateHTML=function(){
var _a39="<table pflid=\""+this.m_lidNS+"\" pfclid=\"pfContainer_"+this.m_lidNS+"\" cellpadding=\"0\" style=\"white-space:nowrap; width:0px; height:0px;\" cellspacing=\"0\"><tr>"+"<td class=\"BUXNoPrint\" valign=top><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfSideHeadings_"+this.m_lidNS+"\" style=\"width:0px; height:0px; overflow-x:hidden; overflow-y:hidden; position:relative;\"/></td>"+"<td valign=top><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfMainOutput_"+this.m_lidNS+"\" style=\"width:0px; height:0px; overflow-x:hidden; overflow-y:hidden; position:relative;\">"+"</div></td>"+"</tr>"+"<tr class=\"BUXNoPrint\"><td></td><td>"+"<div style=\"overflow-x:scroll; overflow-y:hidden;\" pflid=\""+this.m_lidNS+"\" pfslid=\"pfHorizontalScrollBar_"+this.m_lidNS+"\" tabIndex=\"-1\" onmouseup=\"stopEventBubble(event);\" onmousedown=\"stopEventBubble(event);\" onscroll=\""+getCognosViewerObjectRefAsString(this.m_viewerId)+".m_pinFreezeManager.getContainer('"+this.m_lid+"', "+this.m_cachedContainerIndex+").synchScroll()\">"+"<div style=\"height:2px;\">&nbsp;</div>"+"</div>"+"</td></tr></table>";
return _a39;
};
PinFreezeContainer.prototype.loadFreezeTopTemplateHTML=function(){
var _a3a="<table pflid=\""+this.m_lidNS+"\" pfclid=\"pfContainer_"+this.m_lidNS+"\" cellpadding=\"0\" style=\"white-space:nowrap; width:0px; height:0px;\" cellspacing=\"0\">"+"<tr class=\"BUXNoPrint\"><td valign=top><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfTopHeadings_"+this.m_lidNS+"\" style=\"width:0px; height:0px; overflow-x:hidden; overflow-y:hidden; position:relative;\"/></td><td></td></tr>"+"<tr><td valign=top><div pflid=\""+this.m_lidNS+"\" pfslid=\"pfMainOutput_"+this.m_lidNS+"\" style=\"width:0px; height:0px; overflow-x:hidden; overflow-y:hidden; position:relative;\"></div></td>"+"<td class=\"BUXNoPrint\">"+"<div style=\"padding-right:1px;overflow-x:hidden; overflow-y:scroll;\" pflid=\""+this.m_lidNS+"\" pfslid=\"pfVerticalScrollBar_"+this.m_lidNS+"\" tabIndex=\"-1\" onmouseup=\"stopEventBubble(event);\" onmousedown=\"stopEventBubble(event);\" onscroll=\""+getCognosViewerObjectRefAsString(this.m_viewerId)+".m_pinFreezeManager.getContainer('"+this.m_lid+"', "+this.m_cachedContainerIndex+").synchVScroll()\">"+"<div style=\"padding-right:1px;\"/>"+"</div>"+"</td>"+"</tr></table>";
return _a3a;
};
PinFreezeContainer.prototype.loadTemplateHTML=function(){
if(this.m_freezeSide&&this.m_freezeTop){
return this.loadFreezeBothTemplateHTML();
}else{
if(this.m_freezeSide){
return this.loadFreezeSideTemplateHTML();
}else{
if(this.m_freezeTop){
return this.loadFreezeTopTemplateHTML();
}
}
}
return null;
};
PinFreezeContainer.prototype.createSideHeadings=function(_a3b){
var _a3c=this.getSection("pfMainOutput");
var _a3d=_a3c.getAttribute("pfslid");
var _a3e=this.getSection("pfSideHeadings");
var _a3f=_a3e.getAttribute("pfslid");
var _a40=this.getMainOutputHomeCell();
if(!_a40){
return;
}
var _a41=_a3b;
var _a42=_a3e;
var _a43=this.isA11yEnabled(_a41);
var _a44=this.m_pinFreezeManager.deepCloneNode(_a41);
_a42.appendChild(_a44);
var _a45=this.getSectionHomeCell(_a3e);
if(!_a45){
return;
}
var _a46=_a41.getElementsByTagName("tbody");
var _a47=_a44.getElementsByTagName("tbody");
if(_a46.length>0&&_a47.length>0){
var _a48=_a46[0];
var _a49=_a47[0];
var _a4a=_a48.firstChild;
var _a4b=_a49.firstChild;
var _a4c=_a40.rowSpan;
this.markAsCopy(_a40,_a45,_a3d,_a3f);
for(var r=0;r<_a4c;++r){
var _a4e=_a49.rows[r];
this.removeCTX(_a4e);
}
for(var r=_a4c;r<_a49.rows.length;++r){
var _a4f=_a48.rows[r];
var _a4e=_a49.rows[r];
_a4e.style.visibility="hidden";
for(var c=0;c<_a4e.cells.length;++c){
var _a51=_a4e.cells[c];
if(_a43){
_a51=this.m_pinFreezeManager.removeIdAttribute(_a51);
}
if(_a51.getAttribute("type")=="datavalue"){
_a51.removeAttribute("ctx");
_a51.removeAttribute("uid");
_a51.removeAttribute("name");
}else{
var _a52=_a4f.cells[c];
this.markAsCopy(_a52,_a51,_a3d,_a3f);
}
}
_a4e.style.visibility="visible";
}
}
};
PinFreezeContainer.prototype.applyNeighbouringBorderStylesToHomeCell=function(_a53,_a54){
if(isFF()||isIE()){
if(_a53&&_a53.length&&_a53[0].cells&&_a53[0].cells.length>1){
if(this.m_freezeSide){
var _a55=this.getBorderInfo(_a53[0].cells[1],"right");
if(_a55){
_a54.style.borderRightWidth=_a55.borderRightWidth;
_a54.style.borderRightStyle=_a55.borderRightStyle;
_a54.style.borderRightColor=_a55.borderRightColor;
}
}
if(this.m_freezeTop){
var _a55=this.getBorderInfo(_a53[0].cells[1],"bottom");
if(_a55){
_a54.style.borderBottomWidth=_a55.borderBottomWidth;
_a54.style.borderBottomStyle=_a55.borderBottomStyle;
_a54.style.borderBottomColor=_a55.borderBottomColor;
}
}
}
}
};
PinFreezeContainer.prototype.createTopHeadings=function(_a56){
var _a57=this.getSection("pfMainOutput");
var _a58=_a57.getAttribute("pfslid");
var _a59=this.getSection("pfTopHeadings");
var _a5a=_a59.getAttribute("pfslid");
var _a5b=this.getMainOutputHomeCell();
if(!_a5b){
return;
}
var _a5c=_a56;
var _a5d=_a59;
var _a5e=this.isA11yEnabled(_a5c);
var _a5f=this.m_pinFreezeManager.deepCloneNode(_a5c);
_a5f.setAttribute("clonednode","true");
_a5d.appendChild(_a5f);
var _a60=_a5c.getElementsByTagName("tbody");
var _a61=_a5f.getElementsByTagName("tbody");
if(_a60.length>0&&_a61.length>0){
var _a62=_a60[0];
var _a63=_a61[0];
var _a64=_a5b.rowSpan;
for(var r=0;r<_a63.rows.length;++r){
var _a66=_a62.rows[r];
var _a67=_a63.rows[r];
if(_a5e){
_a67=this.m_pinFreezeManager.removeIdAttribute(_a67);
}
_a67.style.visibility="hidden";
for(var c=0;c<_a67.cells.length;++c){
var _a69=_a67.cells[c];
if(r>_a64||_a69.getAttribute("type")=="datavalue"){
_a69.removeAttribute("ctx");
_a69.removeAttribute("uid");
_a69.removeAttribute("name");
}else{
var _a6a=_a66.cells[c];
this.markAsCopy(_a6a,_a69,_a58,_a5a);
if(_a6a===_a5b){
this.initializeHomeCellTabIndex(_a69);
this.applyNeighbouringBorderStylesToHomeCell(_a62.rows,_a69);
}
}
}
_a67.style.visibility="visible";
}
}
};
PinFreezeContainer.prototype.createHomeCellHeading=function(){
var _a6b=this.getSection("pfMainOutput");
var _a6c=_a6b.getAttribute("pfslid");
var _a6d=this.getSection("pfHomeCell");
var _a6e=_a6d.parentNode;
var _a6f=_a6d.getAttribute("pfslid");
var _a70=this.getMainOutputHomeCell();
if(!_a70){
return;
}
_a6e.style.height="100%";
var _a71=this.getTopHeadingSectionHeight(_a70);
_a6d.style.height=_a71-this.m_containerMargin.top+"px";
_a6d.style.width=this.getSideHeadingSectionWidth(_a70)-this.m_containerMargin.left+"px";
_a6d.style.marginTop=this.m_containerMargin.top+"px";
_a6d.style.marginLeft=this.m_containerMargin.left+"px";
var _a72=_a70.parentNode;
var _a73=_a72.cloneNode(false);
var _a74=this._findBestGuessHomeCell(_a70);
var _a75=document.createElement("div");
_a75.style.width="100%";
_a75.style.height="100%";
while(_a70.offsetLeft<=_a74.offsetLeft){
oTargetHomeCell=this.m_pinFreezeManager.deepCloneNode(_a70);
if(isFF()||isIE()){
_a70.appendChild(_a75);
oTargetHomeCell.style.width=_a75.clientWidth+"px";
_a70.removeChild(_a75);
}else{
oTargetHomeCell.style.width=_a70.clientWidth+1+"px";
}
oTargetHomeCell.style.borderBottomWidth="0px";
_a73.appendChild(oTargetHomeCell);
this.markAsCopy(_a70,oTargetHomeCell,_a6c,_a6f);
if(_a70.nextSibling){
_a70=_a70.nextSibling;
}else{
break;
}
}
if(oTargetHomeCell){
oTargetHomeCell.style.borderRightWidth="0px";
}
var _a76=_a72.parentNode;
var _a77=_a76.cloneNode(false);
_a77.appendChild(_a73);
var _a78=_a76.parentNode;
var _a79=_a78.cloneNode(false);
_a79.appendChild(_a77);
_a79.style.width="100%";
_a79.style.height="100%";
_a79.style.marginLeft="";
_a79.style.marginTop="";
_a6d.appendChild(_a79);
this.initializeHomeCellTabIndex(oTargetHomeCell);
this.applyNeighbouringBorderStylesToHomeCell(_a6b.firstChild.rows,_a6d);
};
PinFreezeContainer.prototype.markAsCopy=function(main,copy,_a7c,_a7d){
if(!main.pfCopy){
main.setAttribute("pfslid",_a7c);
main.pfCopy=[];
}
main.pfCopy.push(copy);
copy.pfMain=main;
copy.setAttribute("pfslid",_a7d);
};
PinFreezeContainer.prototype.getCopy=function(_a7e){
if(_a7e.pfCopy){
var _a7f={};
for(var i in _a7e.pfCopy){
var copy=_a7e.pfCopy[i];
if(copy.getAttribute){
var _a82=copy.getAttribute("pfslid");
if(_a82){
var _a83=PinFreezeContainer.getSectionNameFromSlid(_a82);
var _a84=this.getSection(_a83);
if(_a84&&PinFreezeContainer.isSectionVisible(_a84)){
_a7f[_a83]=copy;
}
}
}
}
if(_a7f["pfHomeCell"]){
return _a7f["pfHomeCell"];
}
for(i in _a7f){
return _a7f[i];
}
}
return null;
};
PinFreezeContainer.prototype.getMain=function(_a85){
if(_a85.pfMain){
return _a85.pfMain;
}
return null;
};
PinFreezeContainer.isSectionVisible=function(_a86){
var node=_a86;
if(!node){
return false;
}
while(node.parentNode&&!node.getAttribute("pfclid")){
if(node.style&&node.style.display==="none"){
return false;
}
node=node.parentNode;
}
return (!node.style||node.style.display!=="none");
};
PinFreezeContainer.prototype.getSectionStructure=function(){
var _a88={isSideFrozen:false,isTopFrozen:false};
if(this.m_freezeSide){
var side=this.getSection("pfSideHeadings");
if(side){
_a88.isSideFrozen=PinFreezeContainer.isSectionVisible(side);
}
}
if(this.m_freezeTop){
var top=this.getSection("pfTopHeadings");
if(top){
_a88.isTopFrozen=PinFreezeContainer.isSectionVisible(top);
}
}
return _a88;
};
PinFreezeContainer.prototype.checkSectionStructureChange=function(_a8b,_a8c){
if(_a8b.isSideFrozen!==_a8c.isSideFrozen||_a8b.isTopFrozen!==_a8c.isTopFrozen){
this.m_pinFreezeManager.sectionStructureChange();
}
};
PinFreezeContainer.prototype.freezeContainerInReport=function(_a8d){
this.cacheContainerAndSections(this.getContainerByLID(_a8d));
this.m_homeCellNodes={};
this.updateContainer();
};
PinFreezeContainer.prototype.frozenSectionsRequired=function(){
return (this.frozenSideHeadingsRequired()||this.frozenTopHeadingsRequired());
};
PinFreezeContainer.prototype.frozenSideHeadingsRequired=function(){
var _a8e=this.getSection("pfMainOutput");
if(_a8e){
if(this.m_freezeSide){
var _a8f=_a8e.scrollWidth;
return ((this.m_clientWidth<_a8f)||_a8f==0);
}
}
return false;
};
PinFreezeContainer.prototype.frozenTopHeadingsRequired=function(){
var _a90=this.getSection("pfMainOutput");
if(_a90){
if(this.m_freezeTop){
var _a91=_a90.scrollHeight;
return ((this.m_clientHeight<_a91)||_a91==0);
}
}
return false;
};
PinFreezeContainer.prototype.showTemplatePart=function(_a92,_a93){
var _a94=this.getContainer().rows;
for(var r=0;r<_a94.length;++r){
if(_a94[r].getAttribute("templatePart")===_a92){
_a94[r].style.display=((_a93)?"":"none");
}else{
var _a96=_a94[r].cells;
for(var c=0;c<_a96.length;++c){
if(_a96[c].getAttribute("templatePart")===_a92){
_a96[c].style.display=((_a93)?"":"none");
}
}
}
}
};
PinFreezeContainer.prototype.showFreezeTopOnly=function(_a98){
if(!(this.m_freezeTop&&this.m_freezeSide)){
return;
}
var _a99=(_a98.scrollWidth==0)?_a98.clientWidth:_a98.scrollWidth;
this.updateMainOutputWidth(_a99);
this.setScrollX(_a98,0);
if(this.getSection("pfTopHeadings")){
this.getSection("pfTopHeadings").style.width=_a99+"px";
this.setScrollX(this.getSection("pfTopHeadings"),0);
}
this.showTemplatePart("freezeSide",false);
};
PinFreezeContainer.prototype.showFreezeSideOnly=function(_a9a){
if(!(this.m_freezeTop&&this.m_freezeSide)){
return;
}
var _a9b=(_a9a.scrollHeight==0)?_a9a.clientHeight:_a9a.scrollHeight;
this.updateMainOutputHeight(_a9b);
this.setScrollY(_a9a,0);
if(this.getSection("pfSideHeadings")){
this.getSection("pfSideHeadings").style.height=_a9b+"px";
this.setScrollY(this.getSection("pfSideHeadings"),0);
}
this.showTemplatePart("freezeTop",false);
};
PinFreezeContainer.prototype.showAll=function(){
if(!(this.m_freezeTop&&this.m_freezeSide)){
return;
}
this.showTemplatePart("freezeTop",true);
this.showTemplatePart("freezeSide",true);
};
PinFreezeContainer.prototype.showMainOutputOnly=function(_a9c){
this.updateMainOutputWidth((_a9c.scrollWidth==0)?_a9c.clientWidth:_a9c.scrollWidth);
this.updateMainOutputHeight((_a9c.scrollHeight==0)?_a9c.clientHeight:_a9c.scrollHeight);
this.setInitialScrollPosition(_a9c,0,0);
if(this.m_freezeSide&&this.m_freezeTop){
this.getSection("pfHomeCell").style.display="none";
}
if(this.m_freezeSide){
this.getSection("pfSideHeadings").style.display="none";
this.getSection("pfHorizontalScrollBar").style.display="none";
}
if(this.m_freezeTop){
this.getSection("pfTopHeadings").style.display="none";
this.getSection("pfVerticalScrollBar").style.display="none";
}
};
PinFreezeContainer.prototype.getWrap=function(el){
if(el.currentStyle){
return el.currentStyle.whiteSpace;
}else{
if(window.getComputedStyle){
return window.getComputedStyle(el,null).getPropertyValue("white-space");
}else{
return el.style.whiteSpace;
}
}
};
PinFreezeContainer.prototype.getStyleDisplay=function(el){
if(el.currentStyle){
return el.currentStyle.display;
}else{
if(window.getComputedStyle){
return window.getComputedStyle(el,null).getPropertyValue("display");
}else{
return el.style.display;
}
}
};
PinFreezeContainer.prototype.headingsCreated=function(_a9f){
return _a9f.firstChild?true:false;
};
PinFreezeContainer.prototype.updateContainer=function(){
var _aa0=this.getSection("pfMainOutput");
var _aa1=this.getMainOutputHomeCell();
if(_aa1){
if(this.m_scrollableClientHeight===this.m_clientHeight||!this.m_scrollableClientHeight){
this.m_scrollableClientHeight-=_aa1.offsetHeight;
var _aa2=this.calculateMinCrossTabScrollableClientHeight();
if(_aa2>this.m_scrollableClientHeight){
this.m_scrollableClientHeight=_aa2;
}
}
if(this.m_scrollableClientWidth===this.m_clientWidth||!this.m_scrollableClientWidth){
this.m_scrollableClientWidth-=this.getHomeCellOffsetWidth(_aa1);
}
}
if(_aa0&&_aa1){
this.showAll();
if(this.frozenSectionsRequired()){
this.updateMainOutputSize();
this.initializeHomeCellTabIndex(_aa1);
if(this.m_freezeSide){
var _aa3=this.getSection("pfSideHeadings");
if(!this.headingsCreated(_aa3)){
this.createSideHeadings(this.m_cachedBaseContainer);
if(this.m_freezeTop){
this.initializeTouchScrolling(_aa3);
}
}
var _aa4=this.getSection("pfHorizontalScrollBar");
_aa4.scrollLeft="0px";
}
if(this.m_freezeTop){
var _aa5=this.getSection("pfTopHeadings");
if(!this.headingsCreated(_aa5)){
this.createTopHeadings(this.m_cachedBaseContainer);
if(this.m_freezeSide){
this.initializeTouchScrolling(_aa5);
}
}
var _aa6=this.getSection("pfVerticalScrollBar");
_aa6.scrollTop="0px";
}
if(this.m_freezeSide&&this.m_freezeTop){
var _aa7=this.getSection("pfHomeCell");
if(!this.headingsCreated(_aa7)){
this.createHomeCellHeading();
}
_aa7.style.display="";
}
var _aa8=this.updateSideHeadingSize(_aa1);
var _aa9=this.updateTopHeadingSize(_aa1);
if(!this.frozenSectionsRequired()){
this.showMainOutputOnly(_aa0);
}
this.setInitialScrollPosition(_aa0,_aa8,_aa9);
if(this.m_freezeTop&&this.m_freezeSide){
this.setInitialScrollPosition(this.getSection("pfSideHeadings"),0,_aa9);
this.setInitialScrollPosition(this.getSection("pfTopHeadings"),_aa8,0);
}
this.initializeTouchScrolling(_aa0);
}else{
this.showMainOutputOnly(_aa0);
this.removeTouchScrolling();
}
this.updateTabIndexValues();
}
};
PinFreezeContainer.prototype.calculateMinCrossTabScrollableClientHeight=function(){
var _aaa=0;
if(this.m_cachedPFContainer){
var _aab=this.getElementByLID(this.m_cachedPFContainer,"table",this.m_lid+this.m_viewerId);
if(_aab){
var _aac=0;
for(var r=0;r<_aab.rows.length;r++){
var row=_aab.rows[r];
for(var c=0;c<row.cells.length;c++){
var cell=row.cells[c];
if(cell.getAttribute("type")=="datavalue"){
_aac++;
if(cell.childNodes.length===1&&cell.childNodes[0].getAttribute&&cell.childNodes[0].getAttribute("class")==="textItem"){
_aaa=_aaa+cell.offsetHeight;
}else{
_aac++;
var _ab1=this.getSection("pfVerticalScrollBar");
if(_ab1){
_aaa=_ab1.offsetWidth*2;
}
}
break;
}
}
if(_aac>=2){
break;
}
}
}
}
return _aaa;
};
PinFreezeContainer.prototype.updateSideHeadingSize=function(_ab2){
var _ab3=0;
if(this.m_freezeSide){
var _ab4=this.getSection("pfMainOutput");
if(!_ab4){
return 0;
}
if(!this.frozenSideHeadingsRequired()){
this.showFreezeTopOnly(_ab4);
return 0;
}
var _ab5=this.getSection("pfSideHeadings");
_ab3=this.getSideHeadingSectionWidth(_ab2);
var _ab6=this.getSection("pfHorizontalScrollBar");
var _ab7=this.getSectionHomeCell(_ab5);
if(_ab5.style.display=="none"){
_ab5.style.display="";
_ab6.style.display="";
}
_ab5.style.width=_ab3+"px";
_ab5.style.height=_ab4.clientHeight+"px";
}
return _ab3;
};
PinFreezeContainer.prototype.updateTopHeadingSize=function(_ab8){
var _ab9=0;
if(this.m_freezeTop){
var _aba=this.getSection("pfMainOutput");
if(!_aba){
return 0;
}
if(!this.frozenTopHeadingsRequired()){
this.showFreezeSideOnly(_aba);
return 0;
}
var _abb=this.getSection("pfTopHeadings");
_ab9=this.getTopHeadingSectionHeight(_ab8);
var _abc=this.getSection("pfVerticalScrollBar");
var _abd=this.getSectionHomeCell(_abb);
if(_abb.style.display=="none"){
_abb.style.display="";
_abc.style.display="";
}
_abb.style.height=_ab9+"px";
_abb.style.width=_aba.clientWidth+"px";
}
return _ab9;
};
PinFreezeContainer.prototype.setScrollX=function(_abe,_abf){
if(getElementDirection(_abe)==="rtl"){
setScrollRight(_abe,_abf);
}else{
setScrollLeft(_abe,_abf);
}
};
PinFreezeContainer.prototype.setScrollY=function(_ac0,_ac1){
_ac0.scrollTop=_ac1;
};
PinFreezeContainer.prototype.setInitialScrollPosition=function(_ac2,_ac3,_ac4){
if(getElementDirection(_ac2)==="rtl"){
setScrollRight(_ac2,_ac3);
}else{
setScrollLeft(_ac2,_ac3);
}
_ac2.scrollTop=_ac4;
};
PinFreezeContainer.prototype.getScrollableClientWidth=function(){
return this.m_scrollableClientWidth;
};
PinFreezeContainer.prototype.setScrollableClientWidth=function(_ac5){
this.m_scrollableClientWidth=_ac5;
};
PinFreezeContainer.prototype.getContainerWidth=function(){
return this.m_addedFixedWidth?this.m_addedFixedWidth:this.m_clientWidth;
};
PinFreezeContainer.prototype.getClientWidth=function(){
return this.m_clientWidth;
};
PinFreezeContainer.prototype.getScrollableClientHeight=function(){
return this.m_scrollableClientHeight;
};
PinFreezeContainer.prototype.setScrollableClientHeight=function(_ac6){
this.m_scrollableClientHeight=_ac6;
};
PinFreezeContainer.prototype.getClientHeight=function(){
return this.m_clientHeight;
};
PinFreezeContainer.prototype.clientHeight=function(_ac7){
return _ac7.clientHeight;
};
PinFreezeContainer.prototype.findBestContainerHeight=function(_ac8){
if(this.m_freezeTop&&this.m_cachedReportDiv){
var _ac9=this.m_cachedReportDiv.parentNode;
if(_ac9){
var _aca=this._findRestOfPageHeight(this.getContainer());
return _ac8-_aca-(this.c_pageMargin/2)-this.m_containerMargin.top;
}
}
return _ac8-this.c_pageMargin;
};
PinFreezeContainer.prototype.findBestContainerWidth=function(_acb){
var node=this.getContainer();
while(node&&node.nodeName.toLowerCase()!="td"&&node.getAttribute("id")!=("mainViewerTable"+this.m_viewerId)){
node=node.parentNode;
}
if(!node){
return -1;
}
if(node.nodeName.toLowerCase()=="td"){
var _acd=0;
var _ace=node.parentNode.childNodes;
for(var i=0;i<_ace.length;i++){
if(_ace[i]!==node){
_acd+=_ace[i].clientWidth;
}
}
return _acb-_acd-(this.c_pageMargin/2);
}
return _acb;
};
PinFreezeContainer.prototype._findRestOfPageHeight=function(node){
var _ad1=0;
var _ad2=node.parentNode;
if(!_ad2){
return _ad1;
}
if(_ad2.childNodes.length>1){
for(var i=0;i<_ad2.childNodes.length;i++){
var _ad4=_ad2.childNodes[i];
if(_ad4.nodeType==1){
var _ad5=this.getStyleDisplay(_ad4);
if(_ad4!=node&&!isNaN(_ad4.clientHeight)&&_ad5!="none"&&_ad5!="table-cell"){
_ad1+=this.clientHeight(_ad4);
}
}
}
}
if(node.getAttribute("id")!=("mainViewerTable"+this.m_viewerId)){
_ad1+=this._findRestOfPageHeight(_ad2);
}
return _ad1;
};
PinFreezeContainer.prototype.resize=function(_ad6,_ad7,_ad8,_ad9){
if(this.m_fixedWidth&&this.m_fixedHeight){
return;
}
_ad6=(this.m_fixedWidth)?this.m_fixedWidth:_ad6;
_ad7=(this.m_fixedHeight)?this.m_fixedHeight:_ad7;
var _ada=this.getSectionStructure();
if(this.m_sectionCache&&this.m_cachedPFContainer){
var _adb=0;
if(_ad7!==0){
_adb=this.findBestContainerHeight(_ad7);
if(_ad8&&_adb<300){
_adb=300;
}else{
if(_adb<100){
_adb=100;
}
}
}
this.m_clientHeight=_adb>0?_adb:this.m_clientHeight;
var _adc=0;
if(_ad6!==0){
_adc=this.findBestContainerWidth(_ad6);
}
this.m_clientWidth=(_adc>0)?_adc-5-(this.c_pageMargin/2):this.m_clientWidth;
var _add=this.getSection("pfMainOutput");
var _ade=this.getSectionHomeCell(_add);
if(_ade){
this.m_scrollableClientWidth=this.m_clientWidth-this.getSideHeadingSectionWidth(_ade);
this.m_scrollableClientHeight=this.m_clientHeight-_ade.offsetHeight;
}
if(_ad9){
var _adf=getElementsByAttribute(this.m_cachedPFContainer,"div","pflid",_ad9.lid);
if(_adf){
var node=_adf[0];
while(node.nodeName.toLowerCase()!="table"){
node=node.parentNode;
}
node.style.width=_ad9.width+"px";
}
}
this.updateContainer();
}else{
this.m_clientWidth=_ad6-this.c_pageMargin;
this.m_clientHeight=_ad7-this.c_pageMargin;
}
var _ae1=this.getSectionStructure();
this.checkSectionStructureChange(_ada,_ae1);
};
PinFreezeContainer.prototype.updateMainOutputSize=function(){
if(this.m_freezeSide&&this.m_freezeTop){
if(this.frozenSideHeadingsRequired()){
this.updateMainOutputWidth(this.getScrollableClientWidth());
}
if(this.frozenTopHeadingsRequired()){
this.updateMainOutputHeight(this.getScrollableClientHeight());
}
}else{
if(this.m_freezeSide){
this.updateMainOutputWidth(this.getScrollableClientWidth());
}else{
if(this.m_freezeTop){
this.updateMainOutputHeight(this.getScrollableClientHeight());
}
}
}
};
PinFreezeContainer.prototype.updateMainOutputWidth=function(_ae2){
var _ae3=this.getSection("pfMainOutput");
if(!_ae3){
return;
}
if(this.m_freezeSide==true){
_ae3.style.width=(_ae2+"px");
if(this.m_freezeTop==false||!this.frozenTopHeadingsRequired()){
_ae3.style.height=_ae3.firstChild.clientHeight+"px";
}
var _ae4=this.getSection("pfHorizontalScrollBar");
if(_ae4){
_ae4.style.width=(_ae2+"px");
var _ae5=_ae4.firstChild;
if(_ae5){
var _ae6=this.getSectionHomeCell(_ae3);
var _ae7=_ae3.scrollWidth-this.getHomeCellOffsetWidth(_ae6);
_ae5.style.width=_ae7+"px";
}
}
}
};
PinFreezeContainer.prototype.updateMainOutputHeight=function(_ae8){
var _ae9=this.getSection("pfMainOutput");
if(!_ae9){
return;
}
_ae9.style.height=(_ae8+"px");
if(!this.m_freezeSide||!this.frozenSideHeadingsRequired()){
_ae9.style.width=_ae9.firstChild.clientWidth+2+"px";
}
var _aea=this.getSection("pfVerticalScrollBar");
if(_aea){
_aea.style.height=(_ae8+"px");
var _aeb=_aea.firstChild;
if(_aeb){
var _aec=this.getSectionHomeCell(_ae9);
var _aed=_ae9.scrollHeight-_aec.offsetHeight;
_aeb.style.height=_aed+"px";
}
}
};
PinFreezeContainer.prototype.getElementByLID=function(_aee,tag,lid){
var _af1=getElementsByAttribute(_aee,tag,"lid",lid);
if(_af1.length>0){
return _af1[0];
}
return null;
};
PinFreezeContainer.prototype.getContainerByLID=function(_af2){
var _af3=getElementsByAttribute(_af2,"table","pfclid","pfContainer_"+this.m_lidNS);
if(_af3.length>0){
return _af3[0];
}
return null;
};
PinFreezeContainer.prototype.getSectionByLID=function(_af4,_af5){
var _af6=getElementsByAttribute(_af4,"div","pfslid",_af5+"_"+this.m_lidNS);
if(_af6.length>0){
return _af6[0];
}
return null;
};
PinFreezeContainer.getSectionNameFromSlid=function(slid){
return slid?slid.split("_")[0]:null;
};
PinFreezeContainer.getLidFromSlid=function(slid){
return slid.split("_")[1];
};
PinFreezeContainer.nodeToSlid=function(_af9){
while(_af9.parentNode&&!_af9.getAttribute("pfslid")){
_af9=_af9.parentNode;
}
if(_af9.getAttribute){
return _af9.getAttribute("pfslid");
}
return null;
};
PinFreezeContainer.prototype.cacheContainerAndSections=function(_afa){
if(!_afa){
return _afa;
}
this.m_cachedPFContainer=_afa;
var _afb=getElementsByAttribute(this.m_cachedPFContainer,"div","pflid",this.m_lidNS);
this.m_sectionCache={};
for(var i=0;i<_afb.length;++i){
var key=_afb[i].getAttribute("pfslid");
key=key.split("_",1);
this.m_sectionCache[key]=_afb[i];
}
return _afa;
};
PinFreezeContainer.prototype.getContainer=function(){
return this.m_cachedPFContainer;
};
PinFreezeContainer.prototype.getSection=function(key){
if(!this.m_sectionCache){
return null;
}
if(!this.m_sectionCache[key]){
this.m_sectionCache[key]=this.getSectionByLID(this.m_cachedPFContainer,key);
}
return this.m_sectionCache[key];
};
PinFreezeContainer.prototype.initializeHomeCellTabIndex=function(_aff){
var slid=PinFreezeContainer.nodeToSlid(_aff);
if(!this.m_homeCellNodes[slid]){
var _b01=getElementsByAttribute(_aff,"*","tabIndex","*");
for(var i in _b01){
if(!_b01[i].getAttribute("widgetid")){
this.m_homeCellNodes[slid]=_b01[i];
break;
}
}
}
};
PinFreezeContainer.prototype.updateTabIndexValues=function(){
if(this.isContainerFrozen()){
for(var slid in this.m_homeCellNodes){
var _b04=this.m_pinFreezeManager.isNodeVisible(this.m_homeCellNodes[slid])?"0":"-1";
this.m_homeCellNodes[slid].setAttribute("tabIndex",_b04);
}
}else{
for(var slid in this.m_homeCellNodes){
var _b04=(PinFreezeContainer.getSectionNameFromSlid(slid)==="pfMainOutput")?"0":"-1";
this.m_homeCellNodes[slid].setAttribute("tabIndex",_b04);
}
}
};
PinFreezeContainer.prototype.getSectionHomeCell=function(_b05){
if(_b05){
var _b06=this.getElementByLID(_b05,"table",this.m_lid+this.m_viewerId);
if(_b06&&_b06.rows.length&&_b06.rows[0].cells.length){
return _b06.rows[0].cells[0];
}
}
return null;
};
PinFreezeContainer.prototype.getMainOutputHomeCell=function(){
var _b07=this.getSection("pfMainOutput");
if(!_b07){
_b07=this.getSectionByLID(this.m_cachedPFContainer,"pfMainOutput");
}
return this.getSectionHomeCell(_b07);
};
PinFreezeContainer.prototype.getChildPosition=function(_b08,_b09){
for(var i=0;i<_b08.childNodes.length;++i){
if(_b08.childNodes[i]==_b09){
return i;
}
}
return -1;
};
PinFreezeContainer.prototype.insertAt=function(_b0b,_b0c,_b0d){
if(_b0d==_b0b.childNodes.length){
_b0b.appendChild(_b0c);
}else{
_b0b.insertBefore(_b0c,_b0b.childNodes[_b0d]);
}
};
PinFreezeContainer.prototype.synchScroll=function(){
if(!this.m_cachedPFContainer){
return;
}
var _b0e=this.getMainOutputHomeCell();
var _b0f=this.getSection("pfMainOutput");
var _b10=this.getSection("pfSideHeadings");
if(_b10!=null){
var _b11=this.getSection("pfHorizontalScrollBar");
if(_b11){
var _b12=this.getSideHeadingSectionWidth(_b0e);
if(getElementDirection(_b0f)==="rtl"){
_b12=0;
}
setScrollLeft(_b0f,getScrollLeft(_b11)+_b12);
if(this.m_freezeTop){
setScrollLeft(this.getSection("pfTopHeadings"),getScrollLeft(_b11)+_b12);
}
}
}
};
PinFreezeContainer.prototype.updateScroll=function(_b13){
var slid=PinFreezeContainer.nodeToSlid(_b13);
if(!slid){
return;
}
var _b15=PinFreezeContainer.getSectionNameFromSlid(slid);
if(!_b15){
return;
}
var _b16=document.getElementById("CVReport"+this.m_viewerId);
if(!_b16){
return;
}
if(!this.m_cachedPFContainer){
return;
}
var _b17=_b13.parentNode;
if(_b17){
var _b18=_b17.tagName.toLowerCase();
if(_b18==="td"||_b18==="th"){
var _b19=this.getMainOutputHomeCell();
var _b1a=this.getSection("pfMainOutput");
if(_b15==="pfMainOutput"||_b15==="pfTopHeadings"){
var _b1b=this.getSection("pfHorizontalScrollBar");
if(_b1b){
var _b1c=PinFreezeContainer.calculateNewPosition(_b17.offsetLeft,_b17.offsetWidth,getScrollLeft(_b1a),_b1a.offsetWidth);
var _b1d=this.getHomeCellOffsetWidth(_b19);
if(getElementDirection(_b1a)==="rtl"){
_b1d=0;
}
setScrollLeft(_b1b,_b1c-_b1d);
setScrollLeft(_b1a,_b1c);
}
}
if(_b15==="pfMainOutput"||_b15==="pfSideHeadings"){
var _b1e=this.getSection("pfVerticalScrollBar");
if(_b1e){
var _b1f=PinFreezeContainer.calculateNewPosition(_b17.offsetTop,_b17.offsetHeight,_b1a.scrollTop,_b1a.offsetHeight);
_b1e.scrollTop=_b1f-_b19.offsetHeight;
_b1a.scrollTop=_b1f;
}
}
}
}
};
PinFreezeContainer.calculateNewPosition=function(_b20,_b21,_b22,_b23){
var _b24=_b20+_b21;
var _b25=_b22+_b23;
if(_b22>_b20){
return _b20;
}else{
if(_b25<_b24){
if(_b21>_b23){
return _b20;
}
return _b24-_b23;
}
}
return _b22;
};
PinFreezeContainer.prototype.synchVScroll=function(){
if(!this.m_cachedPFContainer){
return;
}
var _b26=this.getMainOutputHomeCell();
var _b27=this.getSection("pfMainOutput");
var _b28=this.getSection("pfTopHeadings");
if(_b28!=null){
var _b29=this.getSection("pfVerticalScrollBar");
if(_b29){
_b27.scrollTop=_b29.scrollTop+this.getTopHeadingSectionHeight(_b26);
if(this.m_freezeSide){
this.getSection("pfSideHeadings").scrollTop=_b29.scrollTop+this.getTopHeadingSectionHeight(_b26);
}
}
}
};
PinFreezeContainer.prototype.getTopHeadingSectionHeight=function(_b2a){
return _b2a.offsetHeight+_b2a.offsetTop+this.m_containerMargin.top;
};
PinFreezeContainer.prototype._findBestGuessHomeCell=function(_b2b){
if(this.m_bestGuessHomeCell){
return this.m_bestGuessHomeCell;
}
if(_b2b){
var _b2c=_b2b.parentNode.parentNode;
var _b2d=_b2b.rowSpan?(_b2b.rowSpan):1;
var tr=_b2c.childNodes[_b2d];
if(tr){
var _b2f=tr.childNodes.length;
var _b30=null;
var td=null;
for(var i=0;i<_b2f;i++){
td=tr.childNodes[i];
if(td.getAttribute("type")=="datavalue"){
break;
}
_b30=td;
}
if(_b30){
this.m_bestGuessHomeCell=_b30;
return this.m_bestGuessHomeCell;
}
}else{
return _b2b;
}
}
return null;
};
PinFreezeContainer.prototype.getHomeCellOffsetWidth=function(_b33){
var _b34=this._findBestGuessHomeCell(_b33);
return _b34?_b34.offsetWidth:0;
};
PinFreezeContainer.prototype.getSideHeadingSectionWidth=function(_b35){
var _b36=this._findBestGuessHomeCell(_b35);
if(_b36){
return _b36.offsetWidth+_b36.offsetLeft+this.m_containerMargin.left;
}else{
return _b35.offsetWidth+_b35.offsetLeft;
}
};
PinFreezeContainer.prototype.isContainerFrozen=function(){
return (this.m_freezeTop||this.m_freezeSide);
};
PinFreezeContainer.prototype.unfreeze=function(_b37){
var _b38=this.getContainerByLID(_b37);
this.m_freezeTop=false;
this.m_freezeSide=false;
if(_b38){
var _b39=_b38.parentNode;
pfMainOutput=this.getSectionByLID(_b38,"pfMainOutput");
if(pfMainOutput&&_b39){
if(_b38.style.border!==""){
pfMainOutput.firstChild.style.border=_b38.style.border;
_b38.style.border="";
}
if(this.m_wrapFlag){
var _b3a=pfMainOutput.firstChild.getElementsByTagName("span");
if(_b3a){
for(var k=0;k<_b3a.length;k++){
_b3a[k].style.whiteSpace="";
}
}
this.m_wrapFlag=false;
}
this.updateTabIndexValues();
if(this.m_cachedBaseContainer.getAttribute("authoredFixedWidth")){
this.m_cachedBaseContainer.removeAttribute("authoredFixedWidth");
this.m_cachedBaseContainer.style.width="auto";
this.m_addedFixedWidth=null;
}
if(this.m_cachedBaseContainer.getAttribute("authoredFixedHeight")){
this.m_cachedBaseContainer.removeAttribute("authoredFixedHeight");
this.m_cachedBaseContainer.style.height="auto";
this.m_addedFixedHeight=null;
}
_b39.replaceChild(this.m_pinFreezeManager.deepCloneNode(pfMainOutput.firstChild),_b38);
}
}
};
PinFreezeContainer.prototype.getBorderInfo=function(el,_b3d){
var _b3e={};
var _b3f="border-"+_b3d+"-";
var _b40="border"+_b3d.charAt(0).toUpperCase()+_b3d.substring(1);
if(el.currentStyle){
_b3e[_b40+"Width"]=el.currentStyle[_b40+"Width"];
_b3e[_b40+"Style"]=el.currentStyle[_b40+"Style"];
_b3e[_b40+"Color"]=el.currentStyle[_b40+"Color"];
}else{
if(window.getComputedStyle){
_b3e[_b40+"Width"]=window.getComputedStyle(el,null).getPropertyValue(_b3f+"width");
_b3e[_b40+"Style"]=window.getComputedStyle(el,null).getPropertyValue(_b3f+"style");
_b3e[_b40+"Color"]=window.getComputedStyle(el,null).getPropertyValue(_b3f+"color");
}else{
return null;
}
}
return _b3e;
};
PinFreezeContainer.prototype.isA11yEnabled=function(_b41){
return (_b41.getAttribute("role")==="grid");
};
PinFreezeContainer.isElementInMainOutput=function(_b42){
var _b43=PinFreezeContainer.nodeToSlid(_b42);
if(_b43){
return (_b43.indexOf("pfMainOutput_")===0);
}
return false;
};
PinFreezeContainer.prototype.removeCTX=function(_b44){
_b44.removeAttribute("ctx");
var _b45=getElementsByAttribute(_b44,"*","ctx","*");
if(_b45&&_b45.length){
for(var i=0;i<_b45.length;i++){
_b45[i].removeAttribute("ctx");
}
}
};
PinFreezeContainer.prototype.initializeTouchScrolling=function(_b47){
if(!this.m_pinFreezeManager.isIWidgetMobile()){
return;
}
if(_b47){
_b47.m_pinFreezeContainer=this;
if(document.attachEvent){
_b47.attachEvent("touchstart",this.touchStart);
_b47.attachEvent("touchmove",this.touchMove);
_b47.attachEvent("touchend",this.touchEnd);
}else{
_b47.addEventListener("touchstart",this.touchStart,false);
_b47.addEventListener("touchmove",this.touchMove,false);
_b47.addEventListener("touchend",this.touchEnd,false);
}
}
};
PinFreezeContainer.prototype.removeTouchScrolling=function(){
if(!this.m_pinFreezeManager.isIWidgetMobile()){
return;
}
this.removeTouchScrollingEvents(this.getSection("pfMainOutput"));
this.removeTouchScrollingEvents(this.getSection("pfSideHeadings"));
this.removeTouchScrollingEvents(this.getSection("pfTopHeadings"));
};
PinFreezeContainer.prototype.removeTouchScrollingEvents=function(_b48){
if(!this.m_pinFreezeManager.isIWidgetMobile()){
return;
}
if(_b48){
if(document.detachEvent){
_b48.detachEvent("touchstart",this.touchStart);
_b48.detachEvent("touchmove",this.touchMove);
_b48.detachEvent("touchend",this.touchEnd);
}else{
_b48.removeEventListener("touchstart",this.touchStart,false);
_b48.removeEventListener("touchmove",this.touchMove,false);
_b48.removeEventListener("touchend",this.touchEnd,false);
}
}
};
PinFreezeContainer.prototype.touchMove=function(e){
if(this.m_pinFreezeContainer&&e&&e.changedTouches&&e.touches&&e.touches.length==1){
var _b4a=e.changedTouches[0];
if(_b4a&&_b4a.clientX&&_b4a.clientY){
var _b4b=parseInt(_b4a.clientX);
var _b4c=parseInt(_b4a.clientY);
if(this.m_pinFreezeContainer.touchMoveHandler(_b4b,_b4c)){
return stopEventBubble(e);
}
}
}
};
PinFreezeContainer.prototype.touchStart=function(e){
if(this.m_pinFreezeContainer&&e&&e.changedTouches&&e.touches&&e.touches.length==1){
var _b4e=e.changedTouches[0];
if(_b4e&&_b4e.clientX&&_b4e.clientY){
var _b4f=parseInt(_b4e.clientX);
var _b50=parseInt(_b4e.clientY);
this.m_pinFreezeContainer.touchStartHandler(_b4f,_b50);
}
}
};
PinFreezeContainer.prototype.touchStartHandler=function(_b51,_b52){
this.touchScrollSections=false;
this.touchPreviousX=_b51;
this.touchPreviousY=_b52;
};
PinFreezeContainer.prototype.touchEnd=function(e){
if(this.m_pinFreezeContainer&&this.m_pinFreezeContainer.touchEndHandler()){
stopEventBubble(e);
}
};
PinFreezeContainer.prototype.touchEndHandler=function(){
var _b54=this.touchScrollSections;
this.touchScrollSections=false;
this.touchPreviousX=-1;
this.touchPreviousY=-1;
return _b54;
};
PinFreezeContainer.prototype.touchMoveHandler=function(_b55,_b56){
var _b57=this.getSection("pfMainOutput");
if(!_b57){
return;
}
var _b58=this.getSectionHomeCell(_b57);
var _b59=this.getTopHeadingSectionHeight(_b58);
var _b5a=this.getSideHeadingSectionWidth(_b58);
var _b5b=_b56-this.touchPreviousY;
var _b5c=_b55-this.touchPreviousX;
if(this.touchScrollSections){
if(_b5b!=0){
var _b5d=_b57.scrollTop-_b5b;
_b5d=(_b5d>_b59)?_b5d:_b59;
_b57.scrollTop=_b5d;
var _b5e=this.getSection("pfSideHeadings");
if(_b5e){
_b5e.scrollTop=_b5d;
}
}
if(_b5c!=0){
var _b5f=_b57.scrollLeft-_b5c;
_b5f=(_b5f>_b5a)?_b5f:_b5a;
_b57.scrollLeft=_b5f;
var _b60=this.getSection("pfTopHeadings");
if(_b60){
_b60.scrollLeft=_b5f;
}
}
}else{
this.firstTouchMove(_b57,_b5c,_b5b,_b5a,_b59);
}
this.touchPreviousX=_b55;
this.touchPreviousY=_b56;
return this.touchScrollSections;
};
PinFreezeContainer.prototype.firstTouchMove=function(_b61,_b62,_b63,_b64,_b65){
var _b66=this.mostlyVerticalTouchMove(_b62,_b63);
var _b67=PinFreezeContainer.isSectionVisible(this.getSection("pfTopHeadings"));
var _b68=PinFreezeContainer.isSectionVisible(this.getSection("pfSideHeadings"));
if(_b66&&(!_b67||(_b63>0&&_b61.scrollTop<=_b65)||(_b63<0&&_b61.scrollTop+_b61.clientHeight>=_b61.scrollHeight))){
this.touchScrollSections=false;
}else{
if(!_b66&&(!_b68||(_b62>0&&_b61.scrollLeft<=_b64)||(_b62<0&&_b61.scrollLeft+_b61.clientWidth>=_b61.scrollWidth))){
this.touchScrollSections=false;
}else{
this.touchScrollSections=true;
}
}
};
PinFreezeContainer.prototype.mostlyVerticalTouchMove=function(_b69,_b6a){
var _b6b=(_b69>0)?_b69:0-_b69;
var _b6c=(_b6a>0)?_b6a:0-_b6a;
return (_b6c>_b6b);
};
PinFreezeContainer.prototype.destroy=function(){
this.removeTouchScrolling();
GUtil.destroyProperties(this);
};
function PinFreezeManager(oCV){
this.m_oCV=oCV;
this.m_viewerId=oCV.getId();
this.m_frozenInfo=null;
this.m_lastWidthProcessed=0;
this.m_lastHeightProcessed=0;
this.c_resizeTweekLimit=5;
this.m_repaintOnVisible=false;
};
PinFreezeManager.prototype.addContainerObject=function(lid,_b6f,_b70,_b71,_b72){
if(_b6f||_b70){
if(!this.m_frozenInfo){
this.m_frozenInfo={};
}
if(!this.m_frozenInfo[lid]){
this._createDefaultFrozenInfo(lid);
}
this.m_frozenInfo[lid].freezeTop=_b6f;
this.m_frozenInfo[lid].freezeSide=_b70;
var _b73=this.newContainer(lid,_b6f,_b70,_b71,_b72);
this.m_frozenInfo[lid].pinFreezeContainers.push(_b73);
return _b73;
}
return null;
};
PinFreezeManager.prototype.newContainer=function(lid,_b75,_b76,_b77,_b78){
return new PinFreezeContainer(this,lid,this.m_viewerId,_b75,_b76,_b77,_b78);
};
PinFreezeManager.prototype.clearPinInfo=function(lid){
if(!this.m_frozenInfo){
return;
}
if(lid){
if(this.m_frozenInfo[lid]){
delete this.m_frozenInfo[lid];
}
}else{
delete this.m_frozenInfo;
this.m_frozenInfo=null;
}
};
PinFreezeManager.prototype._createDefaultFrozenInfo=function(lid){
this.m_frozenInfo[lid]={"lid":lid,"freezeTop":false,"freezeSide":false,"pinFreezeContainers":[],"childContainers":{}};
};
PinFreezeManager.prototype._resetFrozenInfo=function(lid){
var _b7c=this.m_frozenInfo[lid];
if(_b7c){
delete _b7c.pinFreezeContainers;
_b7c.pinFreezeContainers=[];
_b7c.freezeTop=false;
_b7c.freezeSide=false;
}
};
PinFreezeManager.prototype.prepopulateFrozenInfo=function(_b7d){
var _b7e=getDescendantElementsByAttribute(_b7d,"table","lid","",false,-1,new RegExp("[\\s\\S]*"));
if(_b7e){
if(!this.m_frozenInfo){
this.m_frozenInfo={};
}
for(var i=0;i<_b7e.length;i++){
var _b80=_b7e[i];
if(_b80.getAttribute("id")=="rt"+this.m_viewerId){
continue;
}
var lid=this.removeNamespace(_b80.getAttribute("lid"));
if(this.m_frozenInfo[lid]&&this.m_frozenInfo[lid].childContainers){
continue;
}
if(!this.m_frozenInfo[lid]){
this._createDefaultFrozenInfo(lid);
}
if(!this.m_frozenInfo[lid].childContainers){
this.m_frozenInfo[lid].childContainers={};
}
var _b82=getDescendantElementsByAttribute(_b80,"table","lid","",false,-1,new RegExp("[\\s\\S]*"));
if(_b82){
for(var _b83=0;_b83<_b82.length;_b83++){
var _b84=_b82[_b83];
var _b85=this.removeNamespace(_b84.getAttribute("lid"));
if(!this.m_frozenInfo[lid].childContainers[_b85]){
var _b86=_b84.parentNode;
while(_b86&&!_b86.getAttribute("lid")){
_b86=_b86.parentNode;
}
if(_b86&&this.removeNamespace(_b86.getAttribute("lid"))==lid){
this.m_frozenInfo[lid].childContainers[_b85]=true;
}
}
}
}
}
this._updateParentContainerInfo();
}
};
PinFreezeManager.prototype._updateParentContainerInfo=function(){
for(var _b87 in this.m_frozenInfo){
var _b88=this.m_frozenInfo[_b87].childContainers;
if(_b88){
for(var _b89 in _b88){
if(this.m_frozenInfo[_b89]){
this.m_frozenInfo[_b89].parentContainer=_b87;
break;
}
}
}
}
};
PinFreezeManager.prototype.getTopLevelContainerLID=function(lid){
if(this.m_frozenInfo[lid]){
while(this.m_frozenInfo[lid].parentContainer){
lid=this.m_frozenInfo[lid].parentContainer;
}
}
return lid;
};
PinFreezeManager.prototype.freezeContainer=function(lid,_b8c,_b8d){
var _b8e=document.getElementById("CVReport"+this.m_viewerId);
this.prepopulateFrozenInfo(_b8e);
var _b8f=this.getTopLevelContainerLID(lid);
this.unfreezeAllNestedContainers(_b8f,_b8e);
this.m_frozenInfo[lid].freezeTop=_b8c;
this.m_frozenInfo[lid].freezeSide=_b8d;
var _b90=this._createPinAndFreezeObject(_b8e,_b8f);
this.m_lastWidthProcessed=0;
this.m_lastHeightProcessed=0;
this._resizePinFreezeObjects(_b90);
this.sectionStructureChange();
if(isIE()){
var obj=this;
setTimeout(function(){
obj.refresh();
},1);
var _b92=document.getElementById("RVContent"+this.m_viewerId);
this.m_oCV.repaintDiv(_b92);
}
return _b90;
};
PinFreezeManager.prototype.getInitialWidthThreshold=function(){
return document.body.clientWidth*3/4;
};
PinFreezeManager.prototype.getInitialHeightThreshold=function(){
return document.body.clientWidth*9/10;
};
PinFreezeManager.prototype.hasFrozenContainers=function(){
return ((this.m_frozenInfo)?true:false);
};
PinFreezeManager.prototype.hasFrozenRowHeadings=function(lid){
if(this.m_frozenInfo&&this.m_frozenInfo[lid]){
return this.m_frozenInfo[lid].freezeSide?this.m_frozenInfo[lid].freezeSide:false;
}
return false;
};
PinFreezeManager.prototype.hasFrozenColumnHeadings=function(lid){
if(this.m_frozenInfo&&this.m_frozenInfo[lid]){
return this.m_frozenInfo[lid].freezeTop?this.m_frozenInfo[lid].freezeTop:false;
}
return false;
};
PinFreezeManager.prototype.removeNamespace=function(idNS){
if(idNS.length>this.m_viewerId.length){
if(idNS.indexOf(this.m_viewerId)>0){
return idNS.substring(0,idNS.indexOf(this.m_viewerId));
}
}
return idNS;
};
PinFreezeManager.prototype.getContainer=function(lid,_b97){
if(this.m_frozenInfo&&this.m_frozenInfo[lid]&&this.m_frozenInfo[lid].pinFreezeContainers[0]){
_b97=_b97?_b97:0;
return this.m_frozenInfo[lid].pinFreezeContainers[_b97];
}
return null;
};
PinFreezeManager.prototype.nodeToContainer=function(node){
var slid=PinFreezeContainer.nodeToSlid(node);
var _b9a=null;
if(slid){
var lid=this.removeNamespace(PinFreezeContainer.getLidFromSlid(slid));
_b9a=this.getContainer(lid);
}
return _b9a;
};
PinFreezeManager.prototype.getContainerElement=function(_b9c){
var lid=this.removeNamespace(_b9c.getAttribute("lid"));
if(lid){
var _b9e=this.getContainer(lid);
if(_b9e){
return _b9e.getContainer();
}
}
return null;
};
PinFreezeManager.prototype._createPinAndFreezeObject=function(_b9f,lid){
var _ba1=null;
if(this.m_frozenInfo){
var _ba2=this.m_frozenInfo[lid];
var _ba3=_ba2.initialLoad;
if(_ba3){
delete _ba2.initialLoad;
}
var _ba4=_ba2.freezeTop;
var _ba5=_ba2.freezeSide;
var _ba6=null;
if(_ba3&&_ba2.pinFreezeContainers&&(_ba4||_ba5)){
_ba6=_ba2.pinFreezeContainers.slice(0);
}
var _ba7=_b9f;
if(_ba2&&_ba2.parentContainer){
var _ba8=getElementsByAttribute(_b9f,"table","lid",_ba2.parentContainer+this.m_viewerId);
if(_ba8){
for(parentIndex=0;parentIndex<_ba8.length;parentIndex++){
if(!_ba8[parentIndex].getAttribute("clonednode")){
_ba7=_ba8[parentIndex];
break;
}
}
}
}
if(_ba2.childContainers){
for(var _ba9 in _ba2.childContainers){
var _baa=this._createPinAndFreezeObject(_ba7,_ba9);
_ba1=_ba1?_ba1:_baa;
}
}
var _bab=getElementsByAttribute(_ba7,"table","lid",lid+this.m_viewerId);
if(_bab&&_bab.length>0){
delete _ba2.pinFreezeContainers;
_ba2.pinFreezeContainers=[];
}else{
return null;
}
if(_bab&&(_ba4||_ba5)){
var _bac=(_ba1!==null);
for(var i=0;i<_bab.length;i++){
var _bae=_bab[i];
if(_bae.getAttribute("clonednode")=="true"){
continue;
}
_ba1=this.addContainerObject(lid,_ba4,_ba5,_bae,i);
if(_ba1){
_ba1.createPFContainer(_ba7,_bac);
if(_ba3){
_ba1.copyProperties(_ba6[0]);
}
_ba1.freezeContainerInReport(_b9f);
}
}
}
}
return _ba1;
};
PinFreezeManager.prototype.renderReportWithFrozenContainers=function(_baf){
if(this.m_frozenInfo){
var _bb0=false;
var _bb1=null;
for(var _bb2 in this.m_frozenInfo){
var _bb3=this.m_frozenInfo[_bb2];
if(!_bb0){
_bb0=_bb3.initialLoad;
}
if(!_bb3.parentContainer){
var temp=this._createPinAndFreezeObject(_baf,_bb3.lid);
_bb1=_bb1?_bb1:temp;
}
}
if(!_bb0&&_bb1){
this._resizePinFreezeObjects(_bb1);
}
this.refresh();
}
};
PinFreezeManager.prototype._resizePinFreezeObjects=function(_bb5){
var _bb6,_bb7;
var _bb8=this.m_oCV.getViewerWidget();
if(_bb8){
var size=_bb8.getWidgetSize();
_bb7=(size&&size.w&&(size.w<this.getInitialWidthThreshold()))?size.w:_bb5.getClientWidth();
_bb6=(size&&size.h&&(size.h<this.getInitialHeightThreshold()))?size.h:_bb5.getClientHeight();
}else{
var _bba=document.getElementById("RVContent"+this.m_viewerId);
var _bbb=document.getElementById("mainViewerTable"+this.m_viewerId);
_bb7=_bba.clientWidth;
_bb6=_bbb.clientHeight;
}
this.m_lastWidthProcessed=0;
this.m_lastHeightProcessed=0;
this.resize(_bb7,_bb6);
};
PinFreezeManager.prototype.resize=function(_bbc,_bbd){
var _bbe=(Math.abs(_bbc-this.m_lastWidthProcessed)<this.c_resizeTweekLimit);
var _bbf=(Math.abs(_bbd-this.m_lastHeightProcessed)<this.c_resizeTweekLimit);
if(_bbe&&_bbf){
return;
}
var _bc0=(Math.abs(_bbc-this.m_lastWidthProcessed)>2)?_bbc:0;
var _bc1=(Math.abs(_bbd-this.m_lastHeightProcessed)>2)?_bbd:0;
for(var lid in this.m_frozenInfo){
if(!this.m_frozenInfo[lid].parentContainer){
this.resizeContainer(lid,_bc0,_bc1);
}
}
this.m_lastWidthProcessed=_bbc;
this.m_lastHeightProcessed=_bbd;
};
PinFreezeManager.prototype.resizeContainer=function(lid,_bc4,_bc5){
var _bc6=this.m_frozenInfo[lid];
if(_bc6){
var _bc7=null;
if(_bc6.childContainers){
var _bc8=_bc4>10?_bc4-10:_bc4;
var _bc9=_bc5>10?_bc5-10:_bc5;
for(var _bca in _bc6.childContainers){
_bc7=this.resizeContainer(_bca,_bc8,_bc9);
}
}
var _bcb=_bc6.pinFreezeContainers;
var _bcc=null;
var _bcd=null;
if(_bcb){
for(var i=0;i<_bcb.length;i++){
_bcc=_bcb[i];
_bcc.resize(_bc4,_bc5,_bc6.parentContainer,_bc7);
var _bcf=_bcc.getContainer();
if(_bcf&&(!_bcd||(_bcd.width<_bcf.clientWidth))){
_bcd={"width":_bcf.clientWidth,"lid":_bcc.m_lidNS};
}
}
}
return _bcd;
}
};
PinFreezeManager.prototype.processAutoResize=function(_bd0,_bd1){
this.m_lastWidthProcessed=_bd0;
this.m_lastHeightProcessed=_bd1;
};
PinFreezeManager.prototype.onSetVisible=function(){
this.refresh();
if(this.m_repaintOnVisible){
this.rePaint();
this.m_repaintOnVisible=false;
}
};
PinFreezeManager.prototype.onResizeCanvas=function(_bd2){
if(_bd2){
this.rePaint();
}else{
this.m_repaintOnVisible=true;
}
};
PinFreezeManager.prototype.rePaint=function(){
for(var lid in this.m_frozenInfo){
if(!this.m_frozenInfo[lid].parentContainer){
this.resizeContainer(lid,this.m_lastWidthProcessed,this.m_lastHeightProcessed);
}
}
};
PinFreezeManager.prototype.refresh=function(){
for(var _bd4 in this.m_frozenInfo){
var _bd5=this.m_frozenInfo[_bd4].pinFreezeContainers;
if(_bd5){
for(var i=0;i<_bd5.length;i++){
var _bd7=_bd5[i];
_bd7.synchScroll();
_bd7.synchVScroll();
}
}
}
};
PinFreezeManager.prototype.freezeContainerRowHeadings=function(lid){
return this.freezeContainer(lid,this.hasFrozenColumnHeadings(lid),true);
};
PinFreezeManager.prototype.freezeSelectedRowHeadings=function(){
var lid=this.getValidSelectedContainerId(false);
if(lid){
this.m_oCV.getSelectionController().resetSelections();
return this.freezeContainerRowHeadings(lid);
}
return null;
};
PinFreezeManager.prototype.canFreezeSelectedRowHeadings=function(){
var lid=this.getValidSelectedContainerId(false);
if(lid){
return (!this.hasFrozenRowHeadings(lid));
}
return false;
};
PinFreezeManager.prototype.unfreezeContainerRowHeadings=function(lid){
this.freezeContainer(lid,this.hasFrozenColumnHeadings(lid),false);
};
PinFreezeManager.prototype.unfreezeSelectedRowHeadings=function(){
var lid=this.getValidSelectedContainerId(false);
if(lid){
this.m_oCV.getSelectionController().resetSelections();
this.unfreezeContainerRowHeadings(lid);
}
};
PinFreezeManager.prototype.canUnfreezeSelectedRowHeadings=function(){
var lid=this.getValidSelectedContainerId(false);
if(lid){
return (this.hasFrozenRowHeadings(lid));
}
return false;
};
PinFreezeManager.prototype.freezeContainerColumnHeadings=function(lid){
return this.freezeContainer(lid,true,this.hasFrozenRowHeadings(lid));
};
PinFreezeManager.prototype.freezeSelectedColumnHeadings=function(){
var lid=this.getValidSelectedContainerId(true);
if(lid){
this.m_oCV.getSelectionController().resetSelections();
return this.freezeContainerColumnHeadings(lid);
}
return null;
};
PinFreezeManager.prototype.canFreezeSelectedColumnHeadings=function(){
var lid=this.getValidSelectedContainerId(true);
if(lid){
return (!this.hasFrozenColumnHeadings(lid));
}
return false;
};
PinFreezeManager.prototype.unfreezeContainerColumnHeadings=function(lid){
this.freezeContainer(lid,false,this.hasFrozenRowHeadings(lid));
};
PinFreezeManager.prototype.unfreezeSelectedColumnHeadings=function(){
var lid=this.getValidSelectedContainerId(true);
if(lid){
this.m_oCV.getSelectionController().resetSelections();
this.unfreezeContainerColumnHeadings(lid);
}
};
PinFreezeManager.prototype.canUnfreezeSelectedColumnHeadings=function(){
var lid=this.getValidSelectedContainerId(true);
if(lid){
return (this.hasFrozenColumnHeadings(lid));
}
return false;
};
PinFreezeManager.prototype.getValidSelectedContainerId=function(_be4){
var _be5=this.m_oCV.getSelectionController().getAllSelectedObjects();
if(_be5&&_be5.length&&(_be5[0].getDataContainerType()==="crosstab"||(_be4&&_be5[0].getDataContainerType()==="list"))){
var lid=(_be5[0].getLayoutElementId());
if(lid){
if(!this.hasPromptControlsInFreezableCells(lid)){
return this.removeNamespace(lid);
}
}
}
return null;
};
PinFreezeManager.prototype.hasPromptControlsInFreezableCells=function(lid){
var _be8=this.m_oCV.getLayoutElementFromLid(lid);
var _be9=getElementsByAttribute(_be8,["td","th"],"type","columnTitle");
var _bea=new RegExp("(^|[W])clsPromptComponent($|[W])");
var _beb=isIE()?"className":"class";
for(var j in _be9){
if(_be9.hasOwnProperty(j)){
var _bed=getElementsByAttribute(_be9[j],"*",_beb,null,1,_bea);
if(_bed.length>0){
return true;
}
}
}
return false;
};
PinFreezeManager.prototype.unfreeze=function(lid,_bef,_bf0){
if(this.m_frozenInfo&&this.m_frozenInfo[lid]){
var _bf1=this.m_frozenInfo[lid].pinFreezeContainers;
if(_bf1){
for(var i=0;i<_bf1.length;i++){
var _bf3=_bf1[i];
_bf3.unfreeze(_bef);
}
if(_bf0){
this._resetFrozenInfo(lid);
}
}
}
};
PinFreezeManager.prototype.unfreezeAllNestedContainers=function(lid,_bf5){
var _bf6=this.m_frozenInfo[lid];
if(_bf6){
if(_bf6.freezeTop||_bf6.freezeSide){
this.unfreeze(lid,_bf5,false);
}
if(_bf6.childContainers){
for(var _bf7 in _bf6.childContainers){
this.unfreezeAllNestedContainers(_bf7,_bf5);
}
}
}
};
PinFreezeManager.prototype.isNodeVisible=function(node){
var slid=PinFreezeContainer.nodeToSlid(node);
if(!slid){
return true;
}
var lid=this.removeNamespace(PinFreezeContainer.getLidFromSlid(slid));
var _bfb=this.getContainer(lid);
if(!_bfb){
return true;
}
var _bfc=PinFreezeContainer.getSectionNameFromSlid(slid);
var _bfd=_bfb.getSection(_bfc);
var _bfe=null,_bff=null;
var _c00=node;
var _c01=null;
while(_c00&&_c00!==_bfd&&!_bfe&&!_bff){
_bfe=_bfb.getMain(_c00);
_bff=_bfb.getCopy(_c00);
_c01=_c00;
_c00=_c00.parentNode;
}
var _c02=_bfe?true:false;
var _c03=_bff?true:false;
if(_c02){
return _bfb.getCopy(_bfe)===_c01;
}else{
if(_c03){
return _bfb.getCopy(_c01)?false:true;
}else{
return true;
}
}
};
PinFreezeManager.prototype.sectionStructureChange=function(){
var _c04=this.m_oCV.getViewerWidget();
if(_c04&&_c04.getAnnotationHelper()){
_c04.getAnnotationHelper().repositionCommentIndicators();
}
};
PinFreezeManager.prototype.deepCloneNode=function(_c05){
var copy=_c05.cloneNode(true);
var _c07=this.m_oCV.getViewerWidget();
if(_c07){
if(_c07.reportContainsDijits()){
var _c08=getElementsByAttribute(copy,"*","widgetid","*");
if(_c08&&_c08.length){
for(var i=0;i<_c08.length;i++){
_c08[i].parentNode.removeChild(_c08[i]);
}
}
}
}
return copy;
};
PinFreezeManager.prototype.toJSONString=function(){
var _c0a="";
var _c0b="";
for(var _c0c in this.m_frozenInfo){
if(_c0a.length>0){
_c0a+=",";
}
var _c0d=this.m_frozenInfo[_c0c];
_c0a+="{";
_c0a+="\"lid\":\""+_c0d.lid.replace("\"","\\\"")+"\",";
_c0a+="\"freezeTop\":"+_c0d.freezeTop+",";
_c0a+="\"freezeSide\":"+_c0d.freezeSide+",";
if(_c0d.parentContainer){
_c0a+="\"parentContainer\":\""+_c0d.parentContainer+"\",";
}
if(_c0d.pinFreezeContainers&&_c0d.pinFreezeContainers.length>0){
_c0a+="\"properties\":"+_c0d.pinFreezeContainers[0].toJSONString()+",";
}
_c0a+="\"childContainers\": {";
if(_c0d.childContainers){
var _c0e=true;
for(var _c0f in _c0d.childContainers){
if(!_c0e){
_c0a+=",";
}
_c0a+="\""+_c0f+"\":true";
_c0e=false;
}
}
_c0a+="}}";
}
if(_c0a.length>0){
_c0b="{\"version\":1, \"containers\":["+_c0a+"]}";
}
return _c0b;
};
PinFreezeManager.prototype.fromJSONString=function(_c10){
if(!_c10||_c10.length===0){
return;
}
var _c11=null;
try{
_c11=eval("("+_c10+")");
}
catch(e){
if(typeof console!="undefined"){
console.log("PinFreezeManager.prototype.fromJSON could not parse JSON - "+_c10);
console.log(e);
}
}
if(!_c11){
return;
}
var _c12=_c11.containers;
var _c13=_c11.version;
if(_c12.length>0){
this.m_frozenInfo={};
}
for(var _c14=0;_c14<_c12.length;_c14++){
var _c15=_c12[_c14];
var lid=_c15.lid;
var _c17=_c15.freezeTop;
var _c18=_c15.freezeSide;
var _c19=document.getElementById("CVReport"+this.m_viewerId);
var _c1a=getElementsByAttribute(_c19,"table","lid",lid+this.m_viewerId);
var _c1b=[];
if(_c1a&&(_c17||_c18)){
for(var i=0;i<_c1a.length;i++){
var _c1d=_c1a[i];
var _c1e=new PinFreezeContainer(this,lid,this.m_viewerId,_c15.freezeTop,_c15.freezeSide,_c1d,i);
if(_c15.properties){
applyJSONProperties(_c1e,_c15.properties);
}
_c1b.push(_c1e);
}
}
this.m_frozenInfo[lid]={"lid":lid,"freezeTop":_c17,"freezeSide":_c18,"pinFreezeContainers":_c1b,"initialLoad":true};
if(_c13>=1){
if(_c15.childContainers){
this.m_frozenInfo[lid].childContainers=_c15.childContainers;
}
if(_c15.parentContainer){
this.m_frozenInfo[lid].parentContainer=_c15.parentContainer;
}
}
}
};
PinFreezeManager.prototype.removeIdAttribute=function(_c1f){
var _c20=_c1f.getAttribute("id");
if(_c20!==null&&_c20!==""){
_c1f.removeAttribute("id");
}
var _c21=getElementsByAttribute(_c1f,"*","id","*");
if(_c21&&_c21.length){
for(var i=0;i<_c21.length;i++){
_c21[i].removeAttribute("id");
}
}
return _c1f;
};
PinFreezeManager.prototype.isElementInMainOutput=function(_c23){
return PinFreezeContainer.isElementInMainOutput(_c23);
};
PinFreezeManager.prototype.isIWidgetMobile=function(){
return (this.m_oCV&&this.m_oCV.isIWidgetMobile());
};
PinFreezeManager.prototype.destroy=function(){
GUtil.destroyProperties(this);
};
dojo.provide("WidgetContextManager");
dojo.declare("WidgetContextManager",null,{PP_WIDGET_CONTEXT:"com.ibm.widget.context",PP_REPORT_PROMPT_CONTEXT:"com.ibm.widget.context.report.prompt",PP_REPORT_DRILL_CONTEXT:"com.ibm.widget.context.report.drill",PP_VALUES:"values",PP_RANGES:"ranges",PP_MULTIVALUED:"multivalued",PP_MODELITEM:"modelItem",PP_MODELINFO:"modelInfo",PP_PROMPT:"prompt",PP_DRILL:"drill",PP_SELECT_CHOICES:"selectChoices",PP_BUX_SELECTVALUECONTROL_CONTEXT:"com.ibm.widget.context.bux.selectValueControl",PP_BUX_SELECTION_CONTEXT:"com.ibm.widget.context.bux.selection",PP_CASCADEPROMPT_CLEAR:"clearCascadePromptParams",EVENT_NAME_PROMPT:"com.ibm.widget.contextChanged.prompt",EVENT_NAME_DRILL:"com.ibm.widget.contextChanged.drill",EVENT_NAME_SELECTVALUECONTROL:"com.ibm.widget.contextChanged.selectValueControl",DEFAULT_MODEL_PATH:".",m_widget:null,m_oWidgetContextContainer:null,m_oPromptContextContainer:null,m_oDrillContextContainer:null,m_oPromptGenericContext:null,m_oDrillGenericContext:null,m_oFilterGenericContext:null,m_oSelectionFilterContext:null,m_oContextCollection:null,m_oWidgetContextObject:null,m_oPromptContextObject:null,m_oDrillContextObject:null,m_aSelectionFilterObjects:null,constructor:function(_c24){
this.m_widget=_c24;
this.m_oWidgetContextContainer={};
this.m_oPromptContextContainer={};
this.m_oDrillContextContainer={};
this.m_oPromptGenericContext={};
this.m_oDrillGenericContext={};
this.m_oFilterGenericContext={};
this.m_oSelectionFilterContext={};
this.m_oContextCollection={};
this.m_oWidgetContextObject={};
this.m_oPromptContextObject={};
this.m_oDrillContextObject={};
this.m_aSelectionFilterObjects=null;
},getWidgetContextObject:function(){
var _c25={};
if(this.m_oWidgetContextContainer){
_c25[this.PP_WIDGET_CONTEXT]=this.m_oWidgetContextContainer;
if(this.m_widget){
_c25.clientId=this.m_widget.getWidgetId();
}
}
return _c25;
},getFilterFirstItemName:function(){
var _c26=this.m_oFilterGenericContext;
if(_c26){
var _c27=(_c26.values?_c26.values:_c26.ranges);
for(_c28 in _c27){
return _c28;
}
}
for(var _c28 in _c26){
return _c28;
}
return null;
},getItemNames:function(_c29){
var _c2a=[];
var _c2b=_c29[this.PP_WIDGET_CONTEXT];
if(_c2b){
var _c2c=(_c2b.values?_c2b.values:_c2b.ranges);
for(var _c2d in _c2c){
_c2a.push(_c2d);
}
return _c2a;
}
for(var _c2d in _c2b){
_c2a.push(_c2d);
}
return _c2a;
},raisePromptEvent:function(_c2e,_c2f,_c30,_c31,_c32){
var _c33=this._buildGeneralizedPromptPayload(_c2e,_c2f,_c30,_c31,_c32);
if(_c33){
this.m_widget.fireEvent(this.EVENT_NAME_PROMPT,null,_c33);
this._updatePromptContext(_c33);
this._updateWidgetContextContainer();
}
},_updatePromptContext:function(_c34){
this._updatePromptGenericContext(_c34);
this._updatePromptContextContainer(_c34);
},_resetWorkingMembers:function(){
this.m_oWidgetContextObject={};
this.m_oPromptContextObject={};
this.m_oDrillContextObject={};
},updateFilterContext:function(_c35){
this.m_oFilterGenericContext=_c35[this.PP_WIDGET_CONTEXT];
this._updateWidgetContextContainer();
},getSelectValueControlTypeFromPayload:function(_c36){
var _c37=_c36[this.PP_BUX_SELECTVALUECONTROL_CONTEXT];
if(_c37&&_c37["selectValueControl"]){
return _c37["selectValueControl"]["controlType"];
}
return null;
},getSelectValuePropertyFromPayload:function(_c38,_c39){
var _c3a=_c38[this.PP_BUX_SELECTVALUECONTROL_CONTEXT];
if(_c3a&&_c3a["selectValueControl"]){
return _c3a["selectValueControl"][_c39];
}
return null;
},_updateWidgetContextContainer:function(){
this.m_oWidgetContextContainer={};
var _c3b=null;
if(this.m_oDrillGenericContext[this.PP_VALUES]){
_c3b=dojo.mixin(_c3b,this.m_oDrillGenericContext[this.PP_VALUES]);
}
if(this.m_oPromptGenericContext[this.PP_VALUES]){
_c3b=dojo.mixin(_c3b,this.m_oPromptGenericContext[this.PP_VALUES]);
}
if(this.m_oFilterGenericContext[this.PP_VALUES]){
_c3b=dojo.mixin(_c3b,this.m_oFilterGenericContext[this.PP_VALUES]);
}
if(this.m_oSelectionFilterContext[this.PP_VALUES]){
_c3b=dojo.mixin(_c3b,this.m_oSelectionFilterContext[this.PP_VALUES]);
}
if(_c3b){
this.m_oWidgetContextContainer[this.PP_VALUES]=_c3b;
}
var _c3c=null;
if(this.m_oPromptGenericContext[this.PP_RANGES]){
_c3c=dojo.mixin(_c3c,this.m_oPromptGenericContext[this.PP_RANGES]);
}
if(this.m_oFilterGenericContext[this.PP_RANGES]){
_c3c=dojo.mixin(_c3c,this.m_oFilterGenericContext[this.PP_RANGES]);
}
if(_c3c){
this.m_oWidgetContextContainer[this.PP_RANGES]=_c3c;
}
},_updatePromptGenericContext:function(_c3d){
if(_c3d[this.PP_WIDGET_CONTEXT]){
this.m_oPromptGenericContext=_c3d[this.PP_WIDGET_CONTEXT];
}
},_updatePromptContextContainer:function(_c3e){
if(_c3e[this.PP_REPORT_PROMPT_CONTEXT]&&_c3e[this.PP_REPORT_PROMPT_CONTEXT][this.PP_PROMPT]){
this.m_oPromptContextContainer=_c3e[this.PP_REPORT_PROMPT_CONTEXT][this.PP_PROMPT];
}
},_buildGeneralizedPromptPayload:function(_c3f,_c40,_c41,_c42,_c43){
var _c44=null;
this._resetWorkingMembers();
var _c45=this._buildContextsFromPrompt(_c3f,_c40);
if(_c45){
_c44={};
_c44[this.PP_WIDGET_CONTEXT]=this.m_oWidgetContextObject;
var _c46={};
_c46[_c42]=this.m_oPromptContextObject;
_c44[this.PP_REPORT_PROMPT_CONTEXT]={"prompt":{"id":this.m_widget.iContext.widgetId,"action":_c41,"itemSpecification":_c46}};
_c44[this.PP_CASCADEPROMPT_CLEAR]=_c43;
}
return _c44;
},_getReportParameterNodes:function(_c47){
var _c48=XMLBuilderLoadXMLFromString(_c47);
if(!_c48){
return null;
}
var _c49=_c48.firstChild;
if(!_c49){
return null;
}
var _c4a=XMLHelper_FindChildByTagName(_c49,"reportParameters",true);
if(!_c4a){
return null;
}
var _c4b=XMLHelper_FindChildrenByTagName(_c4a,"reportParameter",false);
if(!_c4b){
return null;
}
return _c4b;
},_getSelectChoicesXMLString:function(_c4c,_c4d){
var _c4e=null;
var _c4f="p_"+_c4c;
if(_c4d.get(_c4f)){
_c4e=_c4d.get(_c4f);
}
return _c4e;
},_getSelectChoicesNode:function(_c50){
var _c51=null;
if(_c50){
var _c52=XMLBuilderLoadXMLFromString(_c50,true);
if(_c52&&_c52.firstChild){
_c51=_c52.firstChild;
}
}
return _c51;
},_buildContextsFromPrompt:function(_c53,_c54){
var _c55=this._getReportParameterNodes(_c53);
if(_c55===null){
return false;
}
for(var i in _c55){
var _c57=_c55[i];
var _c58=_c57.getAttribute("parameterName");
var _c59=this._getSelectChoicesXMLString(_c58,_c54);
var _c5a=this._getSelectChoicesNode(_c59);
if(_c5a){
var _c5b,_c5c,_c5d;
if(!this._isPromptRangeType(_c59)){
var _c5e=this._buildReportContextValuesFromPromptSelectOption(_c5a);
_c5b=this._createPromptDetailObject(_c59,_c57.getAttribute("modelItem"),_c57.getAttribute("multivalued"),_c5e);
_c5c=this._buildValuesArrayFromReportContextValueArray(_c5e);
_c5d=this.PP_VALUES;
}else{
_c5c=this._buildMinMaxArrayFromRangePrompt(_c5a);
_c5b=this._createPromptDetailObject(_c59,_c57.getAttribute("modelItem"),_c57.getAttribute("multivalued"),_c5c);
_c5d=this.PP_RANGES;
}
this.m_oPromptContextObject[_c58]=_c5b;
if(!this.m_oWidgetContextObject[_c5d]){
this.m_oWidgetContextObject[_c5d]={};
}
this.m_oWidgetContextObject[_c5d][_c58]=_c5c;
}
}
return true;
},_createPromptDetailObject:function(_c5f,_c60,_c61,_c62){
var _c63={};
_c63[this.PP_SELECT_CHOICES]=_c5f;
if(_c60!==null){
_c63[this.PP_MODELITEM]=_c60;
}
if(_c61!==null){
_c63[this.PP_MULTIVALUED]=true;
}
_c63[this.PP_VALUES]=_c62;
return _c63;
},_isPromptRangeType:function(_c64){
var _c65=new RegExp(/^<selectChoices><select[\s\S]*Range/);
return _c65.test(_c64);
},_buildReportContextValuesFromPromptSelectOption:function(_c66){
var _c67=[];
if(_c66){
var _c68=dojo.query("selectOption[displayValue]",_c66);
if(_c68.length>0){
for(var i=0;i<_c68.length;i++){
var _c6a=_c68[i].getAttribute("displayValue");
var _c6b=_c68[i].getAttribute("useValue");
var _c6c={"caption":_c6a,"use":_c6b};
_c67.push(_c6c);
}
}
}
return _c67;
},_buildValuesArrayFromReportContextValueArray:function(_c6d){
var _c6e=[];
if(_c6d&&_c6d.length>0){
for(var i=0;i<_c6d.length;i++){
var _c70=_c6d[i].caption;
if(_c70){
_c6e.push(_c70);
}
}
}
return _c6e;
},_buildMinMaxArrayFromRangePrompt:function(_c71){
var _c72=[];
if(_c71&&_c71.childNodes&&_c71.childNodes.length>0){
var _c73=_c71.childNodes.length;
for(var i=0;i<_c73;i++){
var _c75=this._buildMinMaxFromSelectAnyRange(_c71.childNodes[i]);
if(_c75){
_c72.push(_c75);
}
}
}
return _c72;
},_buildMinMaxFromSelectAnyRange:function(_c76){
var _c77=null;
if(_c76){
var _c78=dojo.query("[displayValue]",_c76);
if(_c78.length>0){
_c77={};
for(var i=0;i<_c78.length;i++){
var node=_c78[i];
var _c7b=(node.nodeName==="start")?"min":"max";
_c77[_c7b]=node.getAttribute("useValue");
_c77[_c7b+"Display"]=node.getAttribute("displayValue");
}
}
}
return _c77;
},handleIncomingPromptEvent:function(evt){
if(!evt||!evt.payload){
return;
}
var _c7d=this._convertToLegacyPromptPayload(evt.payload);
if(_c7d){
var _c7e={"payload":_c7d};
this.m_widget.onPromptLegacyPayload(_c7e);
}
},_convertToLegacyPromptPayload:function(_c7f){
var _c80=null;
var _c81=_c7f[this.PP_REPORT_PROMPT_CONTEXT];
if(_c81&&_c81.prompt){
_c81=_c81.prompt;
_c80={};
_c80.cv_id=_c81.id;
_c80.parameters=this._genLegacyPromptParameterArrayFromItemSpec(_c81.itemSpecification);
_c80.clearCascadePromptParams=_c7f[this.PP_CASCADEPROMPT_CLEAR];
}else{
if(_c7f[this.PP_WIDGET_CONTEXT]&&_c7f[this.PP_WIDGET_CONTEXT].values){
_c80={};
_c80.parameters=[];
var _c82=_c7f[this.PP_WIDGET_CONTEXT].values;
for(var _c83 in _c82){
var _c84=_c82[_c83];
if(_c84&&_c84.length>0){
if(_c84.length==1&&_c84[0].indexOf("<selectChoices>")===0){
_c80.parameters.push({"parmName":_c83,"parmValue":_c84[0]});
}else{
var _c85="<selectChoices>";
for(var i=0;i<_c84.length;i++){
_c85+="<selectOption useValue=\""+_c84[i]+"\" displayValue=\""+_c84[i]+"\"/>";
}
_c85+="</selectChoices>";
_c80.parameters.push({"parmName":_c83,"parmValue":_c85});
}
}
}
_c80.clearCascadePromptParams=_c7f[this.PP_CASCADEPROMPT_CLEAR];
}
}
return _c80;
},_genLegacyPromptParameterArrayFromItemSpec:function(_c87){
if(!_c87){
return null;
}
var _c88=this._getFirstPropertyOfObject(_c87);
var _c89=[];
for(var _c8a in _c88){
var _c8b=_c88[_c8a];
var _c8c={parmName:_c8a,parmValue:_c8b[this.PP_SELECT_CHOICES],modelItem:_c8b[this.PP_MODELITEM]};
if(_c8b[this.PP_MULTIVALUES]!==null){
_c8c.multivalued=true;
}
_c89.push(_c8c);
}
return _c89;
},_isRangeTypeValues:function(_c8d){
if(_c8d){
if(_c8d.min||_c8d.max){
return true;
}
}
return false;
},_getFirstPropertyOfObject:function(_c8e){
var _c8f=null;
for(var _c90 in _c8e){
_c8f=_c8e[_c90];
break;
}
return _c8f;
},_getFirstPropertyNameOfObject:function(_c91){
var _c92=null;
for(var _c93 in _c91){
_c92=_c93;
break;
}
return _c92;
},extractWidgetContextObject:function(_c94){
if(_c94){
var _c95=_c94[this.PP_WIDGET_CONTEXT];
if(_c95){
var obj={};
obj[this.PP_WIDGET_CONTEXT]=_c95;
return obj;
}
}
return null;
},genMergedWidgetContextObject:function(){
var _c97=null;
var _c98=null;
for(var key in this.m_oContextCollection){
var _c9a=this.m_oContextCollection[key];
if(_c9a){
var _c9b=_c9a[this.PP_WIDGET_CONTEXT];
if(_c9b){
if(_c9b[this.PP_VALUES]){
_c97=dojo.mixin(_c97,_c9b[this.PP_VALUES]);
}
if(_c9b[this.PP_RANGES]){
_c98=dojo.mixin(_c98,this._convertRangeArrayToObjectForActiveReport(_c9b[this.PP_RANGES]));
}
}
}
}
if(_c97||_c98){
var obj={};
obj[this.PP_WIDGET_CONTEXT]={};
if(_c97){
obj[this.PP_WIDGET_CONTEXT][this.PP_VALUES]=_c97;
}
if(_c98){
obj[this.PP_WIDGET_CONTEXT][this.PP_RANGES]=_c98;
}
return obj;
}
return null;
},raiseDrillEvent:function(_c9d,_c9e,_c9f){
var _ca0=this._buildGeneralizedDrillPayload(_c9d,_c9e,_c9f);
if(_ca0){
this.m_widget.fireEvent(this.EVENT_NAME_DRILL,null,_ca0);
this._updateDrillContext(_ca0);
this._updateWidgetContextContainer();
}
},_updateDrillContext:function(_ca1){
this._updateDrillGenericContext(_ca1);
this._updateDrillContextContainer(_ca1);
},_updateDrillGenericContext:function(_ca2){
if(_ca2[this.PP_WIDGET_CONTEXT]){
this.m_oDrillGenericContext=_ca2[this.PP_WIDGET_CONTEXT];
}
},_updateDrillContextContainer:function(_ca3){
if(_ca3[this.PP_REPORT_DRILL_CONTEXT]&&_ca3[this.PP_REPORT_DRILL_CONTEXT][this.PP_DRILL]){
this.m_oDrillContextContainer=_ca3[this.PP_REPORT_DRILL_CONTEXT][this.PP_DRILL];
}
},_buildGeneralizedDrillPayload:function(_ca4,_ca5,_ca6){
if(!_ca4||!_ca5){
return null;
}
var _ca7={};
var _ca8={};
for(var i in _ca4){
var _caa=_ca4[i];
var mun=(_caa.mun)?_caa.mun:"";
var lun=(_caa.lun)?_caa.lun:"";
var hun=(_caa.hun)?_caa.hun:"";
var _cae={};
_cae[this.PP_VALUES]=[{"caption":_caa.displayValue,"mun":mun,"lun":lun,"hun":hun}];
if(_caa.summary){
_cae["summary"]=_caa.summary;
}
_ca7[_caa.dataItem]=_cae;
_ca8[_caa.dataItem]=[_caa.displayValue];
}
var _caf={};
_caf[this.PP_VALUES]=_ca8;
var _cb0={};
_cb0[_ca6]=_ca7;
var _cb1={};
_cb1[_ca5]={"id":this.m_widget.iContext.widgetId,"action":_ca5,"itemSpecification":_cb0};
var _cb2={};
_cb2[this.PP_WIDGET_CONTEXT]=_caf;
_cb2[this.PP_REPORT_DRILL_CONTEXT]=_cb1;
return _cb2;
},genDrillSpecObjects:function(_cb3){
if(!_cb3||!_cb3[this.PP_REPORT_DRILL_CONTEXT]){
return null;
}
var _cb4=[];
var _cb5=_cb3[this.PP_REPORT_DRILL_CONTEXT];
var _cb6=this._getFirstPropertyOfObject(_cb5);
var _cb7=this._getFirstPropertyOfObject(_cb6.itemSpecification);
for(var _cb8 in _cb7){
var _cb9=_cb7[_cb8];
var _cba=_cb9[this.PP_VALUES];
if(_cba&&_cba.length>0){
var _cbb=_cba[0];
var _cbc={"dataItem":_cb8,"displayValue":_cbb.caption,"mun":_cbb.mun,"lun":_cbb.lun,"hun":_cbb.hun};
if(_cbb.summary){
_cbc["summary"]=_cbb.summary;
}
_cb4.push(_cbc);
}
}
return (_cb4.length>0)?_cb4:null;
},getDrillActionType:function(_cbd){
if(!_cbd||!_cbd[this.PP_REPORT_DRILL_CONTEXT]){
return null;
}
return this._getFirstPropertyNameOfObject(_cbd[this.PP_REPORT_DRILL_CONTEXT]);
},_convertRangeArrayToObjectForActiveReport:function(_cbe){
if(_cbe){
var _cbf={};
for(var name in _cbe){
var _cc1=_cbe[name];
if(_cc1&&_cc1.length>0){
_cbf[name]=_cc1[0];
}else{
_cbf[name]=_cc1;
}
}
return _cbf;
}
return _cbe;
},getItemsInItemSpecification:function(_cc2){
var _cc3=_cc2[this.PP_BUX_SELECTVALUECONTROL_CONTEXT];
if(_cc3&&_cc3["selectValueControl"]&&_cc3["selectValueControl"]["itemSpecification"]){
return this._getFirstPropertyOfObject(_cc3["selectValueControl"]["itemSpecification"]);
}
return null;
},genRemoveDiscreteFilterPayload:function(_cc4){
var _cc5={"clientId":_cc4,"com.ibm.widget.context":{},"com.ibm.widget.context.bux.selectValueControl":{"selectValueControl":{"id":_cc4,"controlType":"selectValueFilter","type":"discrete","valueType":"string"}}};
return _cc5;
},genEmptySelectionPayload:function(oCV,_cc7){
var obj={"clientId":_cc7,"com.ibm.widget.context":{},"com.ibm.widget.context.bux.selection":{"selection":{"id":_cc7,"valueType":"string"}}};
this.m_oSelectionFilterContext={};
this._updateWidgetContextContainer();
this.setSelectionFilterObjects(null);
return obj;
},genSelectionPayload:function(oCV,_cca,_ccb){
var _ccc={};
var _ccd={"id":_cca,"valueType":"string"};
var obj={"clientId":_cca,"com.ibm.widget.context":_ccc,"com.ibm.widget.context.bux.selection":{"selection":_ccd}};
var _ccf=false;
var _cd0=[];
var oSC=oCV.getSelectionController();
var _cd2=oSC.getAllSelectedObjects();
if(_cd2&&_cd2.length>0){
var _cd3={};
var _cd4=null;
var _cd5={};
var _cd6={};
for(var i=0;i<_cd2.length;i++){
if(_cd2[i].populateSelectionPayload(_cd5,_cd6,_ccb)){
_ccf=true;
_cd4=_cd2[i].getCtxAttributeString();
if(typeof _cd3[_cd4]=="undefined"){
_cd3[_cd4]=true;
_cd0.push(_cd2[i].marshal(oSC,oCV.getId()));
}
}
}
if(_ccf){
_ccc.values=_cd5;
var _cd8={};
var _cd9=oCV.getModelPath();
var _cda=(_cd9)?_cd9:".";
_cd8[_cda]=_cd6;
_ccd.itemSpecification=_cd8;
}
}
this.m_oSelectionFilterContext=obj[this.PP_WIDGET_CONTEXT];
this._updateWidgetContextContainer();
this.setSelectionFilterObjects(_cd0.length>0?_cd0:null);
return obj;
},isSelectionPayloadForReset:function(obj){
if(obj&&obj[this.PP_WIDGET_CONTEXT]){
return this.isEmptyObject(obj[this.PP_WIDGET_CONTEXT]);
}
return true;
},setSelectionFilterObjects:function(_cdc){
this.m_aSelectionFilterObjects=_cdc;
},getSelectionFilterObjects:function(){
return this.m_aSelectionFilterObjects;
},toStringSelectionFilterObjects:function(){
var str="";
for(var idx in this.m_aSelectionFilterObjects){
if(str.length>0){
str+=",";
}
str+=JSON.stringify(this.m_aSelectionFilterObjects[idx]);
}
return "["+str+"]";
},convertSelectionToSelectValueControlPayload:function(_cdf){
if(_cdf["com.ibm.widget.context.bux.selection"]){
var _ce0=_cdf["com.ibm.widget.context.bux.selection"]["selection"];
_ce0.controlType="selectValueFilter";
_ce0.type="discrete";
_cdf["com.ibm.widget.context.bux.selectValueControl"]={"selectValueControl":_ce0};
delete _cdf["com.ibm.widget.context.bux.selection"];
}
return _cdf;
},convertGenericToSelectValueControlPayload:function(_ce1){
if(this._hasItemSpecification(_ce1)){
return;
}
if(_ce1[this.PP_WIDGET_CONTEXT][this.PP_VALUES]){
var _ce2=_ce1[this.PP_WIDGET_CONTEXT][this.PP_VALUES];
for(dataItem in _ce2){
if(_ce2[dataItem].length==0){
delete _ce2[dataItem];
}
}
var _ce3=true;
for(dataItem in _ce2){
_ce3=false;
break;
}
if(_ce3){
delete _ce1[this.PP_WIDGET_CONTEXT][this.PP_VALUES];
}
}
if(_ce1[this.PP_WIDGET_CONTEXT][this.PP_RANGES]){
var _ce2=_ce1[this.PP_WIDGET_CONTEXT][this.PP_RANGES];
var _ce3=true;
for(dataItem in _ce2){
_ce3=false;
break;
}
if(_ce3){
delete _ce1[this.PP_WIDGET_CONTEXT][this.PP_RANGES];
}
}
var _ce2=null;
if(_ce1[this.PP_WIDGET_CONTEXT][this.PP_VALUES]){
key=this.PP_VALUES;
_ce2=_ce1[this.PP_WIDGET_CONTEXT][this.PP_VALUES];
}else{
key=this.PP_RANGES;
_ce2=_ce1[this.PP_WIDGET_CONTEXT][this.PP_RANGES];
}
var cv=this.m_widget.getViewerObject();
var _ce5=null;
if(cv){
var sc=cv.getSelectionController();
_ce5=sc.getCCDManager();
}
for(dataItem in _ce2){
var _ce7=true;
var _ce8={};
for(var _ce9 in _ce2){
var _cea=[];
for(var i=0;i<_ce2[_ce9].length;i++){
var _cec=_ce2[_ce9][i];
var _ced={"caption":_cec};
if(_ce7){
var mun=_ce5?_ce5.getMUNForRDIAndUseValue(_ce9,_cec):null;
if(mun!=null){
_ced.mun=mun;
}else{
_ce7=false;
for(var i=0;i<_cea.length;i++){
delete _cea[i].mun;
}
}
}
_cea.push(_ced);
}
_ce8[_ce9]={"values":_cea};
}
var _cef={};
var _cf0=cv?cv.getModelPath():null;
var _cf1=(_cf0)?_cf0:"unknown";
_cef[_cf1]=_ce8;
_ce1[this.PP_BUX_SELECTVALUECONTROL_CONTEXT]={"selectValueControl":{"valueType":"string","type":"discrete","controlType":"selectValueFilter","id":_ce1.clientId?_ce1.clientId:"","itemSpecification":_cef}};
}
},getMUNOfItemValueInItemSpecification:function(_cf2,_cf3){
var _cf4=this.getItemsInItemSpecification(_cf2);
if(_cf4&&_cf4[_cf3]){
var _cf5=_cf4[_cf3];
if(_cf5.values&&_cf5.values.length>0){
return _cf5.values[0].mun;
}
}
return null;
},_hasItemSpecification:function(_cf6){
if(_cf6[this.PP_BUX_SELECTVALUECONTROL_CONTEXT]&&_cf6[this.PP_BUX_SELECTVALUECONTROL_CONTEXT]["selectValueControl"]&&_cf6[this.PP_BUX_SELECTVALUECONTROL_CONTEXT]["selectValueControl"]["itemSpecification"]){
return true;
}
if(_cf6[this.PP_BUX_SELECTION_CONTEXT]&&_cf6[this.PP_BUX_SELECTION_CONTEXT]["selection"]&&_cf6[this.PP_BUX_SELECTION_CONTEXT]["selection"]["itemSpecification"]){
return true;
}
return false;
},getSourceUniqueId:function(_cf7,_cf8){
var id=null;
var _cfa=null;
if(_cf7["clientId"]){
id=_cf7["clientId"];
}
if(_cf7[this.PP_BUX_SELECTVALUECONTROL_CONTEXT]){
_cfa="selectValueControl";
if(!id&&_cf7[this.PP_BUX_SELECTVALUECONTROL_CONTEXT]["selectValueControl"]&&_cf7[this.PP_BUX_SELECTVALUECONTROL_CONTEXT]["selectValueControl"]["id"]){
id=_cf7[this.PP_BUX_SELECTVALUECONTROL_CONTEXT]["selectValueControl"]["id"];
}
}else{
if(_cf7[this.PP_BUX_SELECTION_CONTEXT]){
_cfa="selection";
if(!id&&_cf7[this.PP_BUX_SELECTION_CONTEXT]["selection"]&&_cf7[this.PP_BUX_SELECTION_CONTEXT]["selection"]["id"]){
id=_cf7[this.PP_BUX_SELECTION_CONTEXT]["selection"]["id"];
}
}else{
if(_cf7[this.PP_REPORT_PROMPT_CONTEXT]){
_cfa="prompt";
if(!id&&_cf7[this.PP_REPORT_PROMPT_CONTEXT]["prompt"]&&_cf7[this.PP_REPORT_PROMPT_CONTEXT]["prompt"]["id"]){
id=_cf7[this.PP_REPORT_PROMPT_CONTEXT]["prompt"]["id"];
}
}else{
if(_cf7[this.PP_REPORT_DRILL_CONTEXT]){
_cfa="drill";
if(!id&&_cf7[this.PP_REPORT_DRILL_CONTEXT]["DrillUp"]&&_cf7[this.PP_REPORT_DRILL_CONTEXT]["DrillUp"]["id"]){
id=_cf7[this.PP_REPORT_DRILL_CONTEXT]["DrillUp"]["id"];
}
}else{
if(_cf7[this.PP_REPORT_DRILL_CONTEXT]){
_cfa="drill";
if(!id&&_cf7[this.PP_REPORT_DRILL_CONTEXT]["DrillDown"]&&_cf7[this.PP_REPORT_DRILL_CONTEXT]["DrillDown"]["id"]){
id=_cf7[this.PP_REPORT_DRILL_CONTEXT]["DrillDown"]["id"];
}
}
}
}
}
}
if(!id){
id="unknown";
}
if(!_cfa){
_cfa="unknown";
}
if(typeof _cf8=="string"){
_cfa=_cf8;
}
return id+"_"+_cfa;
},isWidgetContextEmpty:function(_cfb){
return (this.isEmptyObject(_cfb[this.PP_WIDGET_CONTEXT])||(this.isEmptyObject(_cfb[this.PP_WIDGET_CONTEXT][this.PP_VALUES])&&this.isEmptyObject(_cfb[this.PP_WIDGET_CONTEXT][this.PP_RANGES])));
},isEmptyObject:function(obj){
var _cfd=true;
if(obj){
for(var _cfe in obj){
_cfd=false;
break;
}
}
return _cfd;
},updateContextCollection:function(_cff){
if(!this.isEmptyObject(_cff)){
var _d00=this.getSourceUniqueId(_cff);
if(this.isWidgetContextEmpty(_cff)){
if(this.m_oContextCollection[_d00]){
this.setEmptyArrayToWidgetContextValues(this.m_oContextCollection[_d00]);
}else{
var _d01=this.getSourceUniqueId(_cff,"unknown");
if(this.m_oContextCollection[_d01]){
this.setEmptyArrayToWidgetContextValues(this.m_oContextCollection[_d01]);
}
}
}else{
if(_cff[this.PP_WIDGET_CONTEXT][this.PP_VALUES]){
for(var name in _cff[this.PP_WIDGET_CONTEXT][this.PP_VALUES]){
for(var key in this.m_oContextCollection){
var _d04=this.m_oContextCollection[key];
if(_d04[this.PP_WIDGET_CONTEXT][this.PP_VALUES]&&_d04[this.PP_WIDGET_CONTEXT][this.PP_VALUES][name]){
delete _d04[this.PP_WIDGET_CONTEXT][this.PP_VALUES][name];
}
}
}
}
this.m_oContextCollection[_d00]=dojo.clone(_cff);
}
return this.m_oContextCollection;
}
},setEmptyArrayToWidgetContextValues:function(_d05){
if(_d05&&_d05[this.PP_WIDGET_CONTEXT]&&_d05[this.PP_WIDGET_CONTEXT][this.PP_VALUES]){
var _d06=_d05[this.PP_WIDGET_CONTEXT][this.PP_VALUES];
for(var name in _d06){
_d06[name]=[];
}
}
}});
dojo.provide("viewer.AnnotationHelper");
dojo.declare("viewer.AnnotationHelper",null,{m_loadAnnotationsDfd:null,m_bCallGetAnnotations:true,m_bAnnotationsEnabled:null,constructor:function(_d08){
this.m_viewerIWidget=_d08;
this.m_bCallGetAnnotations=true;
this.m_bAnnotationsEnabled=null;
},getAnnotationStore:function(){
return this.m_viewerIWidget.getAnnotationStore();
},setCallGetAnnotations:function(flag){
this.m_bCallGetAnnotations=flag;
},isEnabled:function(){
if(this.m_bAnnotationsEnabled===null){
this.m_bAnnotationsEnabled=this.m_viewerIWidget.getViewerObject().bBuxAnnotationsAvailable;
}
return this.m_bAnnotationsEnabled;
},refreshAnnotationData:function(){
if(this.m_loadAnnotationsDfd){
return null;
}
this.m_loadAnnotationsDfd=new dojo.Deferred();
this.fetchAnnotationData();
return this.m_loadAnnotationsDfd;
},fetchAnnotationData:function(){
var _d0a=this.m_viewerIWidget;
if(!this.m_bCallGetAnnotations||!this.isEnabled()){
return;
}
dojo.when(_d0a.getWidgetStoreID(),dojo.hitch(this,function(_d0b){
if(!_d0b){
return;
}
this.m_viewerIWidget.getLoadManager().runWhenHasViewer(dojo.hitch(this,this._fetchAnnotationData,_d0b));
}));
},_fetchAnnotationData:function(_d0c){
var _d0d=this.m_viewerIWidget.getViewerObject();
var _d0e=_d0d.getSelectionController();
var _d0f=_d0e.getCCDManager().m_md;
if(!_d0f){
_d0f={};
}
_d0f=dojo.toJson(_d0f);
var _d10=_d0e.getCCDManager().m_cd;
if(!_d10){
_d10={};
}
_d10=dojo.toJson(_d10);
var _d11={"complete":{},"fault":{}};
_d11.complete["object"]=this;
_d11.complete["method"]=this.fetchAnnotationDataResponse;
_d11.fault["object"]=this;
_d11.fault["method"]=this.fetchAnnotationDataResponseFault;
var _d12=new AsynchJSONDispatcherEntry(_d0d);
_d12.setCallbacks(_d11);
_d12.addFormField("widgetStoreID",_d0c);
_d12.addFormField("ui.action","getAnnotations");
_d12.addFormField("cv.metatdata",_d0f);
_d12.addFormField("cv.context",_d10);
_d12.sendRequest();
},fetchAnnotationDataResponseFault:function(_d13){
this.m_bCallGetAnnotations=false;
var _d14=new FaultDialog(this.m_viewerIWidget.getViewerObject());
var _d15=_d13.getSoapFault();
var _d16=null;
var _d17=XMLHelper_FindChildByTagName(_d15,"exception",true);
if(_d17){
var _d18=XMLHelper_FindChildByTagName(_d17,"errorCode",false);
if(_d18){
_d16=XMLHelper_GetText(_d18);
}
}
if(_d16==="0"){
var _d19=null;
var _d1a=XMLHelper_FindChildByTagName(_d17,"message",false);
if(_d1a){
var _d1b=XMLHelper_FindChildByTagName(_d1a,"messageString",true);
if(_d1b){
_d19=XMLHelper_GetText(_d1b,false);
}
}
if(_d19){
var _d1c=/ANS-GEN-(\d{2,4})/;
var _d1d=_d1c.exec(_d19);
if(_d1d&&_d1d.length&&_d1d.length>1){
var _d1e=_d1d[1];
if(_d1e==="0075"){
_d14.setErrorMessage(RV_RES.IDS_ANNOTATION_WIDGET_DELETED_ERROR);
}
}
}
}
this._cleanupPreviousAnnotations();
this.getAnnotationStore().clear();
_d14.show(_d15);
if(this.m_loadAnnotationsDfd){
this.m_loadAnnotationsDfd.errback();
this.m_loadAnnotationsDfd=null;
}
},fetchAnnotationDataResponse:function(_d1f){
var _d20=window["CVEditContentActionInstance"];
var _d21=_d1f.getResult();
this.m_bCallGetAnnotations=this.m_bCallGetAnnotations&&_d21!==null;
if(_d21===null){
_d21=[];
}
var _d22=this.m_viewerIWidget.getViewerObject();
_d22.envParams["cv.annotationData"]=_d21;
this._cleanupPreviousAnnotations();
if(_d21.length>0){
if(this.getAnnotationStore()){
var _d23=this._generateMatchedAnnotationsFromViewerObject();
this.getAnnotationStore().load(_d23);
this.displayCommentIndicators();
}
}
if(this.m_loadAnnotationsDfd){
this.m_loadAnnotationsDfd.callback();
this.m_loadAnnotationsDfd=null;
}
},_cleanupPreviousAnnotations:function(){
var _d24=this.getAnnotationStore();
if(_d24){
var _d25=_d24.getAll();
for(var _d26 in _d25){
var _d27=this.m_viewerIWidget.getWidgetId()+"_"+_d26+"_comment";
var _d28=dijit.byId(_d27);
if(typeof _d28!="undefined"&&_d28!=null){
_d28.destroy();
delete _d28;
}
_d24.clear(_d26);
}
}
},_generateMatchedAnnotationsFromViewerObject:function(){
var _d29=this.m_viewerIWidget.getViewerObject();
var _d2a=[];
if(_d29&&_d29.envParams&&_d29.envParams["cv.annotationData"]){
_d2a=eval(_d29.envParams["cv.annotationData"]);
}
var _d2b=this._generateAnnotationListWithoutORoperator(_d2a);
return this._updateAnnotationCtxWithMatchedCellCtx(_d2b,_d29);
},_generateAnnotationListWithoutORoperator:function(_d2c){
var _d2d=[];
for(var i=0,len=_d2c.length;i<len;i++){
var anno=_d2c[i];
if(anno.ctx){
var _d31=bux.AnnotationHelper.generateCTXList(anno.ctx);
for(var j=0,jLen=_d31.length;j<jLen;j++){
var _d34={ann:anno.ann,lmt:anno.lmt,lmtf:anno.lmtf,ctx:anno.ctx,desc:anno.desc,fd:anno.fd,layoutElementId:anno.layoutElementId,owner:anno.owner,ownerSearchPath:anno.ownerSearchPath,pv:anno.pv,rdi:anno.rdi,sd:anno.sd,version:anno.version||1};
_d34.ctx=_d31[j];
_d2d.splice(0,0,_d34);
}
}else{
_d2d.splice(0,0,anno);
}
}
return _d2d;
},_updateAnnotationCtxWithMatchedCellCtx:function(_d35,_d36){
var _d37=[];
var _d38=new AnnotationCTXLookup(this.m_viewerIWidget.getViewerObject().getSelectionController().getCCDManager());
_d38.populateCtxDetailsForAllAnnotations(_d35);
var _d39=[];
for(var i=0,len=_d35.length;i<len;i++){
var anno=_d35[i];
if(anno.ctx){
if(_d39.length===0){
_d39=dojo.query("[ctx]",this.m_viewerIWidget.iContext.getRootElement());
}
for(var j=0,jLen=_d39.length;j<jLen;j++){
var _d3f=_d39[j].getAttribute("ctx");
if(_d38.isAnnotatedCell(anno,_d3f)){
anno.ctx=_d3f;
_d37.splice(0,0,anno);
break;
}
}
}else{
_d37.splice(0,0,anno);
}
}
return _d37;
},displayCommentIndicators:function(){
var _d40=this.getAnnotationStore();
var _d41=_d40.getAll();
for(var cell in _d41){
var _d43=new bux.AnnotationIndicator({annotationStore:_d40,context:cell,iWidgetContainer:this.m_viewerIWidget,dir:this.m_viewerIWidget.getViewerObject().getDirection()});
_d43.addExistingCommentToCell();
}
},repositionCommentIndicators:function(){
var _d44=this.getAnnotationStore();
var _d45=_d44.getAll();
for(var id in _d45){
var _d47=_d45[id];
var ctx=_d47[0].getContext();
var _d49=_d44.getIndicatorWidgetId(ctx);
if(_d49!==null){
var _d4a=dijit.byId(_d49);
_d4a.addToPage();
}
}
},promptForSave:function(_d4b){
dojo["require"]("bux.dialogs.InformationDialog");
var _d4c=new bux.dialogs.InformationDialog({title:RV_RES.IDS_JS_COMMENT_DLG_TITLE,sMainMessage:RV_RES.IDS_JS_COMMENT_DLG_MESSAGE,sDescription:RV_RES.IDS_JS_COMMENT_DLG_DETAILS,sInfoIconClass:"bux-informationDialog-warning-icon",buttons:["YES","NO"],yesOKHandler:_d4b});
_d4c.startup();
_d4c.show();
},addComment:function(_d4d,_d4e){
if(this.m_viewerIWidget.isSaveNecessary()){
this.promptForSave(dojo.hitch(this,this.onCommentSaveAcknowledge,_d4d,_d4e));
}else{
this.addNewComment(_d4d,_d4e);
}
},editComment:function(_d4f){
var _d50=bux.getComment(this.m_viewerIWidget.iContext,this.getAnnotationStore().getEffectiveIds(_d4f));
if(_d50&&_d50.edit){
_d50.edit();
}
},deleteComment:function(_d51){
this.getAnnotationStore().deleteOneComment(_d51);
},addNewComment:function(_d52,_d53){
this.addAsNewComment(_d52,(_d53==null)?"":(_d53+" - "));
},addAsNewComment:function(_d54,text){
var _d56=null;
var _d57=(_d54===null)?this.getAnnotationStore().WIDGET_CONTEXT:_d54;
var _d58=this.getAnnotationStore().getIndicatorWidgetId(_d57);
if(_d58!=null){
_d56=dijit.byId(_d58);
}
if(_d56==null){
dojo["require"]("bux.AnnotationIndicator");
_d56=new bux.AnnotationIndicator({annotationStore:this.getAnnotationStore(),context:_d57,iWidgetContainer:this.m_viewerIWidget,dir:this.m_viewerIWidget.getViewerObject().getDirection()});
window.setTimeout(function(){
_d56.addNewCommentToCell(text);
},0);
}else{
window.setTimeout(function(){
_d56.comment.editNewComment(_d57,text);
},0);
}
},onCommentSaveAcknowledge:function(_d59,_d5a){
this.m_viewerIWidget._pendingContextId=_d59;
this.m_viewerIWidget._pendingCellValue=_d5a;
this.m_viewerIWidget.fireEvent("com.ibm.bux.widget.action",null,{action:"canvas.save"});
},addWidgetComment:function(){
if(this.m_viewerIWidget.isSaveNecessary()){
this.promptForSave(dojo.hitch(this,this.onCommentSaveAcknowledge,null,this.m_viewerIWidget.getDisplayName()));
}else{
this.addNewComment(null,this.m_viewerIWidget.getDisplayName());
}
},editWidgetComment:function(){
var _d5b=bux.getComment(this.m_viewerIWidget.iContext,[this.getAnnotationStore().WIDGET_CONTEXT]);
if(_d5b&&_d5b.edit){
_d5b.edit();
}
},deleteWidgetComment:function(){
this.deleteComment(this.getAnnotationStore().WIDGET_CONTEXT);
},commitComment:function(_d5c){
if(_d5c.getContext()!==this.getAnnotationStore().WIDGET_CONTEXT){
return this.commitCellComment(_d5c);
}else{
return this.commitWidgetComment(_d5c,this.getAnnotationStore());
}
},commitCellComment:function(_d5d){
var _d5e=new dojo.Deferred();
var _d5f=this.m_viewerIWidget.getViewerObject();
var _d60={customArguments:[_d5d,_d5e],"complete":{"object":this,"method":this.handleCellCommentSaveResponse},"fault":{"object":this,"method":this.handleCellCommentSaveErrorResponse},"error":{"object":this,"method":this.handleCellCommentSaveServerErrorResponse}};
var _d61=new AsynchJSONDispatcherEntry(_d5f);
_d61.setCallbacks(_d60);
this.preparePostForCommitCellComment(_d61,_d5d).then(function(){
_d5f.dispatchRequest(_d61);
});
return _d5e;
},preparePostForCommitCellComment:function(_d62,_d63){
var dfd=new dojo.Deferred();
dojo.when(this.m_viewerIWidget.getWidgetStoreID(),dojo.hitch(this,function(_d65){
var _d66=this.m_viewerIWidget.getViewerObject();
var _d67=_d66.getSelectionController();
_d62.addFormField("widgetStoreID",_d65);
_d62.addFormField("ui.action","commentSave");
_d62.addFormField("cv.metatdata",dojo.toJson(_d67.getCCDManager().m_md));
_d62.addFormField("cv.context",dojo.toJson(_d67.getCCDManager().m_cd));
_d62.addFormField("cv.commentId",_d63.getContext());
_d62.addFormField("cv.commentDesc",xml_encode(_d63.getDescription()));
var lid=_d67.getAllSelectedObjects()[0].getLayoutElementId();
if(lid){
lid=lid.replace(this.m_viewerIWidget.getViewerId(),"");
_d63.setParentId(lid);
_d62.addFormField("cv.commentLayoutId",_d63.getParentId());
var _d69=new AnnotationInfoBar(_d66,lid);
var _d6a=_d69.createFilterContext();
if(_d6a!=null){
_d63.setFilterContext(_d6a);
if(_d6a.getPromptsJSON()){
_d62.addFormField("cv.filterContext_prompts",dojo.toJson(_d6a.getPromptsJSON()));
}
if(_d6a.getFilterJSON()){
_d62.addFormField("cv.filterContext_filter",dojo.toJson(_d6a.getFilterJSON()));
}
if(_d6a.getSlidersJSON()){
_d62.addFormField("cv.filterContext_sliders",dojo.toJson(_d6a.getSlidersJSON()));
}
}
}
dfd.callback();
}));
return dfd;
},commitWidgetComment:function(_d6b){
dojo["require"]("bux.Services");
var _d6c=bux.Services.getGateway()+"/annotationService/creation";
var _d6d={};
_d6d["annotationName"]=_d6b.getName();
if(_d6d["annotationName"]==null){
_d6d["annotationName"]="";
}
_d6d["annotationDescription"]=_d6b.getDescription();
var dfd=new dojo.Deferred();
dojo.when(this.m_viewerIWidget.getWidgetStoreID(),dojo.hitch(this,function(_d6f){
_d6d["annotationParentID"]=_d6f;
bux.xhrPost({url:_d6c,sync:true,content:_d6d}).then(dojo.hitch(this,function(_d70){
this.handleCommentSaveDone(_d70,_d6b,this.getAnnotationStore(),this.m_viewerIWidget);
_d6b.loadDetails();
dfd.callback();
}));
}));
return dfd;
},handleCellCommentSaveResponse:function(_d71,_d72,_d73){
var _d74=_d71.getJSONResponseObject();
if(_d74){
var _d75=_d74.json;
if(_d75){
var _d76=this.handleCommentSaveDone(_d75,_d72,this.getAnnotationStore(),this.m_viewerIWidget);
if(typeof _d76!="Error"){
_d72.loadDetails();
}
}
}
_d73.callback(_d71);
},handleCellCommentSaveErrorResponse:function(_d77,_d78,_d79){
_d79.errback(new Error(_d77.getSoapFaultDetailMessageString()));
},handleCellCommentSaveServerErrorResponse:function(_d7a,_d7b,_d7c){
var _d7d=new Error(_d7a.xmlHttp.statusText);
_d7d.xhr=_d7a.xmlHttp;
_d7c.errback(_d7d);
},handleCommentSaveDone:function(_d7e,_d7f,_d80,_d81){
var _d82=XMLBuilderLoadXMLFromString(_d7e);
if(_d82){
var _d83=_d82.firstChild;
var _d84=XMLHelper_FindChildByTagName(_d83,"annotation",false);
if(_d84){
var _d85=XMLHelper_FindChildByTagName(_d84,"id",false);
if(_d85){
var _d86=XMLHelper_GetText(_d85);
_d7f.setServiceId(_d86);
_d7f.setIWidgetContainer(_d81);
_d80.setWidgetContainer(_d81);
this.setCallGetAnnotations(true);
return _d7e;
}
}
}
return new Error(_d7e.toString());
}});
dojo.provide("bux.reportViewer");
dojo.require("dojo.buxViewer");
dojo.require("bux.AnnotationHelper");
dojo.require("bux.AnnotationIndicator");
dojo.require("viewer.AnnotationHelper");
dojo.require("bux.data.AnnotationStore");
dojo.require("bux.iwidget.common.MultilingualWidgetBase");
dojo.require("InfoBarBase");
dojo.require("WidgetContextManager");
var globalViewerIdentifier=1;
dojo.declare("bux.reportViewer",bux.iwidget.common.MultilingualWidgetBase,{annotationStore:null,annotationHelper:null,savedOutput:null,undoRedoQueue:null,dojoConnections:null,properties:null,promptParametersRetrieved:false,viewerId:null,xNodeId:null,namespacePrefix:"x",timer:null,timerInterval:20,GODASHBOARD_REPORT_VERSION:"1.0.0.0",BUX_REPORT_VERSION:"4.0.0.0.0",BUX_REPORT_CASPIAN_RP1_VERSION:"3.0.0.0.0",RAP_REPORT_INFO_VERSION:"1.0.0.0",viewerWidgetLastAction:null,sliderState:null,sViewerIWidgetId:null,bToolbarInitialized:false,m_oWidgetContextManager:null,m_oInfoBarRenderedState:{},m_bRunReportOption:null,m_oLoadManager:null,m_visible:null,m_debugDelayedViewerLoadingMode:0,m_delayedLoadingContext:null,m_doGetParametersOnLoad:null,widgetSize:null,copyPasteResource:null,_pastedWidget:false,ciPublishedReportPath:null,touchStartX:-1,touchPaging:false,_BUXDBInfoArray:null,m_bSelectionFilterSwitch:false,savedToolbarButtons:null,constructor:function(){
this.onUnloadInProgress=false;
this.annotationHelper=new viewer.AnnotationHelper(this);
this.savedOutput=new CIWidgetSavedOutput(this);
this.undoRedoQueue=new UndoRedoQueue(this);
this.viewerIdentifier=(globalViewerIdentifier++).toString();
this.m_oCV=null;
this.m_oLoadManager=new ViewerLoadManager(this);
this.m_doGetParametersOnLoad=false;
this._isMobile=false;
this.m_bSelectionFilterSwitch=false;
this.m_oWidgetContextManager=new WidgetContextManager(this);
this.addWindowEventListeners();
this.m_bReportDropped=false;
this.sliderState={};
this.savedToolbarButtons={};
},getWidgetId:function(){
return this.sViewerIWidgetId;
},getAnnotationHelper:function(){
return this.annotationHelper;
},getUndoRedoQueue:function(){
return this.undoRedoQueue;
},getDisplayName:function(){
var _d87=this.iContext.getItemSet("buxrtstate",false);
if(_d87){
var _d88=_d87.getItemValue("displayTitle");
return _d88?_d88:"";
}
return "";
},getSavedOutput:function(){
return this.savedOutput;
},getAttributeValue:function(name){
return this.iContext.getiWidgetAttributes().getItemValue(name);
},setAttributeValue:function(name,_d8b){
this.iContext.getiWidgetAttributes().setItemValue(name,_d8b);
},removeAttributeValue:function(name){
this.iContext.getiWidgetAttributes().removeItem(name);
},getViewerObject:function(){
if(!this.m_oCV){
try{
this.m_oCV=window["oCV"+this.getViewerId()];
}
catch(ex){
return null;
}
if(!this.m_oCV){
var _d8d=this.getWidgetId();
for(var _d8e=0;_d8e<window.gaRV_INSTANCES.length;_d8e++){
if(window.gaRV_INSTANCES[_d8e].widgetId==_d8d){
this.m_oCV=window.gaRV_INSTANCES[_d8e];
var _d8f=this.getViewerId();
var _d90=this.m_oCV.getId();
this.setViewerId(_d90);
var _d91=document.getElementsByTagName("head").item(0).childNodes;
for(var i=0;i<_d91.length;i++){
var node=_d91[i];
if(node.getAttribute&&node.getAttribute("namespaceId")==_d8f){
node.setAttribute("namespaceId",_d90);
}
}
break;
}
}
}
}
return this.m_oCV;
},setViewerId:function(id){
this.viewerId=id;
},getViewerId:function(){
if(!this.viewerId){
this.viewerId=this.namespacePrefix+this.viewerIdentifier;
}
return this.viewerId;
},getLoadManager:function(){
return this.m_oLoadManager;
},getReportBlocker:function(){
if(!this.m_reportBlocker){
this.m_reportBlocker=new Blocker(this.m_oCV.getId());
}
return this.m_reportBlocker;
},placeTabControlInView:function(){
var oCV=this.getViewerObject();
if(oCV&&oCV.getTabController()){
if(oCV.getTabController().getSelectedTab()&&oCV.getTabController().getSelectedTab().getFocusableDiv()){
oCV.setKeepFocus(oCV.getTabController().getSelectedTab().getFocusableDiv());
}
dojo.window.scrollIntoView(oCV.getTabController().getWrapperDiv());
}
},setReportBlocker:function(_d96){
this.m_reportBlocker=_d96;
},isSavedOutput:function(){
var _d97=this.getViewerObject();
if(typeof _d97!=="undefined"&&_d97!==null){
var _d98=(_d97.envParams["ui.action"]);
return (_d98==="view"||_d98==="buxView");
}
return false;
},isMobile:function(){
return this._isMobile;
},getEmbeddedMobileItem:function(){
var _d99=false;
var _d9a=this.iContext.getItemSet("buxrtstate",false);
if(_d9a){
_d99=_d9a.getItemValue("embeddedMobile")=="true"?true:false;
}
return _d99;
},getBUXRTStateInfoMap:function(_d9b){
if(!window.icdConfig||!window.icdConfig.ZIPIMode||window.icdConfig.ZIPIMode==="0"){
return "";
}
var _d9c=["<RTStateInfo>"];
if(_d9b&&_d9b.length>0){
_d9c.push(_d9b);
}
var _d9d=this.getDisplayName();
if(_d9d&&_d9d.length>0){
_d9c.push("<widgetTitle>",xml_encode(_d9d),"</widgetTitle>");
}
if(this._BUXDBInfoArray&&this._BUXDBInfoArray.length>0){
_d9c=_d9c.concat(this._BUXDBInfoArray);
}
_d9c.push("</RTStateInfo>");
return _d9c.length>2?_d9c.join(""):"";
},getBUXDBInfoArray:function(_d9e){
var _d9f=null;
var _da0=null;
if(_d9e){
_d9f=_d9e.dbTitle;
_da0=_d9e.dbSearchPath;
}else{
var _da1=this.iContext.getItemSet("buxrtstate",false);
if(_da1){
_d9f=_da1.getItemValue("dbTitle");
_da0=_da1.getItemValue("dbSearchPath");
}
}
var _da2=[];
if(_d9f&&_da0&&_da0.length>0){
_da2.push("<dbTitle>",xml_encode(_d9f),"</dbTitle><dbSearchPath>",xml_encode(_da0),"</dbSearchPath>");
}
return _da2;
},loadExtraJavascriptFiles:function(_da3){
if(typeof CSelectionContext=="undefined"){
this._loadFile("/drill/CSelectionContextBuilder.js",_da3);
}
this._loadFile("/mdsrv/lineage.js",_da3);
if(window.cognosViewerDebug){
this._loadFile("/rv/viewer.extra.debug.js",_da3);
}else{
this._loadFile("/rv/viewer.extra.js",_da3);
}
},_loadFile:function(_da4,_da5){
if(dojo.isIE||dojo.isTrident||_da5.indexOf("..")==0){
var _da6=window.gScriptLoader.loadFile(_da5+_da4,"","GET");
var _da7=document.createElement("script");
_da7.type="text/javascript";
_da7.text=_da6;
document.getElementsByTagName("head")[0].appendChild(_da7);
}else{
dojo._loadPath(_da5+_da4,null);
}
},_getCWALaunchInformation:function(){
var args={url:this.buildPostUrl(),sync:false,handleAs:"json",preventCache:true,content:{"b_action":"cognosViewer","ui.action":"noOp","cv.responseFormat":"getCWALaunchParameters"},error:dojo.hitch(this,function(_da9){
this.fireEvent("com.ibm.bux.widget.render.done",null,{noAutoResize:true});
this.fireEvent("com.ibm.bux.widget.notification",null,{type:"error",message:_da9.message,description:_da9.description});
}),load:dojo.hitch(this,function(_daa,_dab){
var _dac=_dab.xhr.getResponseHeader("Content-Type");
if(_dac&&_dac.indexOf("text/html")!=-1&&_daa&&_daa.match(/<ERROR_CODE>CAM_PASSPORT_ERROR<\/ERROR_CODE>/)){
this.handlePassportErrorFromDispatcher();
}else{
this._launchCWA(_daa);
}
})};
dojo.xhrPost(args);
},_launchCWA:function(_dad){
if(_dad){
if(typeof NewReportAction=="undefined"){
this.loadExtraJavascriptFiles(_dad.webContentRoot);
if(_dad.productLocale!="en"){
this._loadFile("rv/res/viewer_"+_dad.productLocale+".js",_dad.webContentRoot);
}
}
var _dae=new NewReportAction();
_dae.setRequestParms({"packageSearchPath":this.getAttributeValue("packageSearchPath"),"viewerIWidget":this,"webContentRoot":_dad.webContentRoot,"gateway":_dad.gateway,"capabilitiesXml":_dad.capabilitiesXML,"cafContextId":_dad.cafContextId});
this.removeAttributeValue("packageSearchPath");
_dae.execute();
}
},setNewReportInfo:function(info){
this._newReportInfo=info;
},_handleFileDialogCancel:function(){
this.fireEvent("com.ibm.bux.widget.action",null,{action:"deleteWidget"});
},_handleFileDialogOk:function(_db0){
this.removeAttributeValue("newReport");
this.setAttributeValue("packageSearchPath","storeID(\""+_db0+"\")");
this.onLoad();
},onLoad:function(){
this.sViewerIWidgetId=this.iContext.getRootElement().id;
if(this.getAttributeValue("packageSearchPath")){
this._getCWALaunchInformation();
return;
}else{
if(this.getAttributeValue("newReport")==="true"){
dojo["require"]("bux.dialogs.FileDialog");
var oDlg=new bux.dialogs.PackageDialog({onCancelHandler:dojo.hitch(this,this._handleFileDialogCancel),selectPackageHandler:dojo.hitch(this,this._handleFileDialogOk)});
oDlg.startup();
oDlg.show();
return;
}
}
var _db2=this.getAttributeValue("ViewerConcurrentRequestLimit");
if(_db2){
this.removeAttributeValue("ViewerConcurrentRequestLimit");
if(!window["gReportWidgetLoadQueue"]){
window["gReportWidgetLoadQueue"]=new ReportWidgetLoadQueue(_db2);
}
}
this._isMobile=this.getEmbeddedMobileItem();
this._BUXDBInfoArray=this.getBUXDBInfoArray();
var _db3=this.getAttributeValue("viewerProperties");
var _db4=this.getAttributeValue("promptParametersRetrieved");
if(_db4!==null&&_db4=="true"){
this.promptParametersRetrieved=true;
}
this.properties=this.createProperties(_db3);
this.savedOutput.setPagedOutput(!this.properties.getRetrieveAll());
this.setWidgetCopyPasteParameters();
this.m_bSelectionFilterSwitch=this.getAttributeValue("selectionFilterEnabled")=="true"?true:false;
if(this.isOpeningSavedDashboard()&&this.copyPasteResource==null){
this.disableListenToIfFullReportUpgraded();
this.enableFlashChartsToIfReportPartUpgraded();
this.disableListenToIfReportPartUpgraded();
if(this.isVisible()){
if(window["gReportWidgetLoadQueue"]){
window["gReportWidgetLoadQueue"].add(this);
}else{
this.postReport(null);
}
}
}else{
var _db5={action:"canvas.filters"};
this.fireEvent("com.ibm.bux.widget.action",null,_db5);
this.getLoadManager().viewerLoadInitiated();
this.m_visible=true;
}
this.addWidgetEventListeners();
this.iContext.iEvents.svc.addWire(this.iContext.widgetId,"com.ibm.widget.contextChanged","widgetBuxCanvasTabs","com.ibm.widget.contextChanged");
this.iContext.iEvents.svc.addWire(this.iContext.widgetId,"com.ibm.bux.data.filterCache.init","widgetBuxCanvasTabs","com.ibm.bux.data.filterCache.init");
this.fireEvent("com.ibm.bux.widget.updateStoreID",null,{});
},addWindowEventListeners:function(){
if(!this.dojoConnections){
this.dojoConnections=[];
}
this.dojoConnections.push(dojo.connect(window,"onresize",this,this.onBrowserResize));
this.dojoConnections.push(dojo.connect(window,"onbeforeunload",this,this.possibleUnloadEvent));
},addWidgetEventListeners:function(){
if(this.isMobile()){
this.dojoConnections.push(dojo.connect(this.iContext.getRootElement(),"touchstart",this,this.onTouchStart));
this.dojoConnections.push(dojo.connect(this.iContext.getRootElement(),"touchmove",this,this.onTouchMove));
}
},addChromeWhitespaceHandler:function(_db6){
if(isIE()){
var _db7=document.getElementById("mainViewerTR"+_db6);
if(_db7){
this.dojoConnections.push(dojo.connect(_db7,"onmousedown",this,this.onMouseDownOnChromeDiv));
}
}
},onMouseDownOnChromeDiv:function(evt){
if(evt.srcElement.id.indexOf("PRMT",0)===0){
return;
}
var oCV=this.getViewerObject();
if(oCV){
var _dba=oCV.getReportDiv();
if(_dba){
var _dbb=_dba.getBoundingClientRect();
var _dbc=_dbb.top+_dba.offsetHeight;
if(evt.clientY>_dbc&&evt.button!==2){
if(oCV.getSelectionController()){
oCV.getSelectionController().clearSelectedObjects();
this.onSelectionChange();
stopEventBubble(evt);
}
}
}
}
},removeWindowEventListeners:function(){
if(this.dojoConnections){
for(var i=0;i<this.dojoConnections.length;++i){
dojo.disconnect(this.dojoConnections[i]);
}
delete this.dojoConnections;
}
},onBrowserResize:function(){
var oCV=this.getViewerObject();
if(oCV&&oCV.getPinFreezeManager()){
oCV.getPinFreezeManager().onResizeCanvas(this.isVisible());
}
},onTouchStart:function(e){
this.touchPaging=false;
if(this.m_oCV&&e&&e.changedTouches&&e.touches&&e.touches.length==1){
var _dc0=e.changedTouches[0];
if(_dc0&&_dc0.clientX){
this.touchStartX=parseInt(_dc0.clientX);
}
}
},onTouchMove:function(e){
if(!this.touchPaging&&this.touchStartX!=-1&&this.m_oCV&&e&&e.changedTouches&&e.touches&&e.touches.length==1){
var _dc2=e.changedTouches[0];
if(_dc2&&_dc2.clientX){
var _dc3=parseInt(_dc2.clientX);
if(this.m_oCV.hasNextPage()&&this.touchStartX-_dc3>10){
this.touchPaging=true;
this.m_oCV.pageAction("nextPage");
this.m_oCV.setKeepFocus(false);
}else{
if(this.m_oCV.hasPrevPage()&&_dc3-this.touchStartX>10){
this.touchPaging=true;
this.m_oCV.pageAction("previousPage");
this.m_oCV.setKeepFocus(false);
}else{
this.touchPaging=false;
this.touchStartX=-1;
}
}
}
}
if(this.touchStartX>0){
stopEventBubble(e);
}
},isLiveReport:function(){
return this.isSavedOutput()===false&&!this.isLimitedInteractiveMode();
},createProperties:function(_dc4){
return new bux.reportViewer.Properties(this,_dc4);
},disableListenToIfFullReportUpgraded:function(){
if(this.isGoDashboardReportUpgrade()){
if(this.getAttributeValue("flexParam_properties")==null){
var _dc5={};
_dc5["*"]={blockedEvents:["com.ibm.bux.data.filter","com.ibm.bux.filter.values.get","com.ibm.bux.filter.items.get"]};
this.fireEvent("com.ibm.bux.widget.updateEventFilter",null,_dc5);
}
}
},enableFlashChartsToIfReportPartUpgraded:function(){
if(this.isGoDashboardReportUpgrade()){
var _dc6=this.getAttributeValue("originalReportPart");
if(typeof _dc6!=="undefined"&&_dc6!==null){
this.properties.setProperty("flashCharts","true");
}
}
},disableListenToIfReportPartUpgraded:function(){
if(this.isGoDashboardReportUpgrade()){
var _dc7=this.getAttributeValue("originalReportPart");
if(typeof _dc7!=="undefined"&&_dc7!==null){
var _dc8={};
_dc8["*"]={blockedEvents:["com.ibm.bux.viewer.drill","com.ibm.bux.viewer.prompt"]};
this.fireEvent("com.ibm.bux.widget.updateEventFilter",null,_dc8);
}
}
},possibleUnloadEvent:function(){
var oCV=this.getViewerObject();
if(oCV){
oCV.getViewerDispatcher().possibleUnloadEvent();
}
},onUnload:function(){
this.onUnloadInProgress=true;
this.destroy();
this.iContext=null;
},onGetFiltersDone:function(evt){
if(typeof this.filterRequiredAction!="undefined"&&this.filterRequiredAction!=null){
var _dcb=this.buildDataFiltersParam(evt.payload.filters);
var _dcc=new ActionFactory(this.getViewerObject());
var _dcd=_dcc.load(this.filterRequiredAction);
_dcd.dispatchRequest(_dcb,this.filterRequiredAction);
this.filterRequiredAction=null;
}else{
this.postReport(evt.payload.filters);
this.postSetWidgetCopyPasteParameters();
}
},getOriginalFormFields:function(){
return this.m_originalFormFields;
},setOriginalFormFields:function(_dce){
this.m_originalFormFields=_dce;
},getXNodeId:function(){
return this.xNodeId;
},setXNodeId:function(_dcf){
this.xNodeId=_dcf;
},postReport:function(_dd0){
this.getLoadManager().viewerLoadInitiated();
this.viewerWidgetLastAction={"functionName":"postReport","param":[_dd0]};
if(this.getRunReportOption()!==false){
this.m_oLoadManager.runningReport();
}
var _dd1=this.buildPostContent(_dd0);
if(_dd1["ui.reportDrop"]=="true"){
this.m_bReportDropped=true;
}
this.m_originalFormFields=new CDictionary();
for(var _dd2 in _dd1){
if(_dd2!="cv.outputKey"){
this.m_originalFormFields.add(_dd2,_dd1[_dd2]);
}
}
var _dd3={};
if(this.getAttributeValue("X-Node-ID")){
this.setXNodeId(this.getAttributeValue("X-Node-ID"));
_dd3["X-Node-ID"]=this.getAttributeValue("X-Node-ID");
this.removeAttributeValue("X-Node-ID");
}
var args={url:this.buildPostUrl(),sync:false,preventCache:true,content:_dd1,headers:_dd3,error:dojo.hitch(this,function(_dd5){
this.fireEvent("com.ibm.bux.widget.render.done",null,{noAutoResize:true});
this.fireEvent("com.ibm.bux.widget.notification",null,{type:"error",message:_dd5.message,description:_dd5.description});
})};
if(typeof xhrMultiPart!=="undefined"&&xhrMultiPart.active){
args.load=dojo.hitch(this,function(_dd6){
this.loadContent(_dd6.responseText);
});
xhrMultiPart.Post(args);
}else{
args.load=dojo.hitch(this,function(_dd7,_dd8){
var _dd9=_dd8.xhr.getResponseHeader("Content-Type");
if(_dd9&&_dd9.indexOf("text/html")!=-1&&_dd7&&_dd7.match(/<ERROR_CODE>CAM_PASSPORT_ERROR<\/ERROR_CODE>/)){
this.handlePassportErrorFromDispatcher();
}else{
this.loadContent(_dd7);
}
});
dojo.xhrPost(args);
}
},isDropped:function(){
return this.m_bReportDropped;
},cleanupStyles:function(){
this._cssLimitReached=true;
if(!this.isVisible()){
if(!this._styles){
this._styles=[];
}
var id=this.getViewerId();
var _ddb=document.getElementsByTagName("head").item(0).getElementsByTagName("style");
for(var i=0;i<_ddb.length;i++){
var _ddd=_ddb[i];
if(_ddd.getAttribute&&_ddd.getAttribute("namespaceId")==id){
_ddd.parentNode.removeChild(_ddd);
this._styles.push(_ddd);
i--;
}
}
}
},reloadStyles:function(){
if(this._styles){
while(this._styles.length>0){
var _dde=this._styles.pop();
document.getElementsByTagName("head").item(0).appendChild(_dde);
}
}
},loadStylesAndScripts:function(_ddf,_de0,_de1){
window.gScriptLoader.m_bIgnoreAjaxWarnings=true;
window.gScriptLoader.setHandlerStylesheetLimit(true);
var _de2=this.iContext.getRootElement();
if(!_de2){
return;
}
_ddf=window.gScriptLoader.loadCSS(_ddf,_de0,true,this.getViewerId());
if(dojo.isIE||dojo.isTrident){
_ddf="<span style='display:none'>&nbsp;</span>"+_ddf;
}
_de0.innerHTML=_ddf;
if(this.isSelectionFilterEnabled()){
this.updateDrillThroughLinks();
}
var _de3=GUtil.generateCallback(this.fireResizeEvent,[],this);
this.m_sScriptLoaderNamespace=this.getViewerId();
window.gScriptLoader.loadAll(_de0,_de3,this.m_sScriptLoaderNamespace,_de1);
},fireResizeEvent:function(){
var _de4=this.getViewerObject();
if(_de4==null){
this.fireEvent("com.ibm.bux.widget.render.done",null,{});
}else{
var _de5=_de4.getViewerWidget();
if(_de5){
_de4.m_resizeReady=true;
_de4.doneLoading();
}else{
var _de6=this;
setTimeout(function(){
_de6.fireResizeEvent();
},100);
}
}
},getSavedReportSearchPath:function(_de7){
var _de8=this.getAttributeValue("savedReportPath");
if(_de8){
return _de8;
}
var _de9=this.getAttributeValue("dashboardID");
_de9=_de9.substr("$$dbid$$".length);
var _dea="storeID(\""+_de9+"\")/*[@name="+xpath_attr_encode(_de7)+"]";
return _dea;
},isSavedReport:function(_deb,_dec){
return (typeof _dec!=="undefined"&&_dec!==null&&_dec.length>0&&_deb!==_dec);
},getGlobalPromptsInfo:function(){
var _ded=null;
var oCV=null;
var _def=[];
var _df0=null;
if(window.gaRV_INSTANCES){
for(var _df1=0;_df1<window.gaRV_INSTANCES.length;_df1++){
oCV=window.gaRV_INSTANCES[_df1];
_df0=oCV.getPromptParametersInfo();
if(_df0!=null){
_def.push(_df0);
}
}
}
if(_def.length>0){
_ded="<globalPromptInfo>"+_def.join("")+"</globalPromptInfo>";
}
return _ded;
},buildPostUrl:function(){
return this.getAttributeValue("gateway");
},getSavedItem:function(){
var _df2=this.getAttributeValue("savedReportPath");
if(!_df2){
_df2=this.getAttributeValue("savedReportName");
}
return _df2;
},setRunReportOption:function(_df3){
this.m_bRunReportOption=_df3;
},getRunReportOption:function(){
return this.m_bRunReportOption;
},resetRunReportOption:function(){
this.m_bRunReportOption=null;
},buildPostContent:function(_df4){
var _df5=this.getAttributeValue("originalReport");
var _df6=this.getSavedItem();
var _df7=this.getAttributeValue("originalReportPart");
var _df8=this.getAttributeValue("flexParam_properties");
var _df9=this.getAttributeValue("flexParam_promptData");
var _dfa=this.isSavedReport(_df5,_df6);
var _dfb=this.getPromptRunOption(_df9,_dfa);
var _dfc=this.getAttributeValue("cv.outputKey")?"cvx.high":"cognosViewer";
var _dfd={"b_action":_dfc,"run.outputFormat":"HTML","bux":"true","cv.responseFormat":"iWidget","cv.id":this.getViewerId()};
if(this.isMobile()){
_dfd["container"]="mobile";
}
if(this.getAttributeValue("cv.outputKey")){
_dfd["cv.outputKey"]=this.getAttributeValue("cv.outputKey");
this.removeAttributeValue("cv.outputKey");
_dfd["widget.id"]=this.getWidgetId();
}
if(this.getAttributeValue("gateway")){
_dfd["cv.gateway"]=this.getAttributeValue("gateway");
}
if(this.getAttributeValue("webcontent")){
_dfd["cv.webcontent"]=this.getAttributeValue("webcontent");
}
this.sInitialSpec=this.getAttributeValue("specification");
if(_dfa){
this.addUserParamsToContent(_dfd);
}
if(!this.sInitialSpec||this.copyPasteResource){
if(_dfa){
_dfd["ui.object"]=this.getSavedReportSearchPath(_df6);
if(!this.getAttributeValue("savedReportPath")&&this.getAttributeValue("savedReportName")){
_dfd["savedReportName"]=_df6;
}
_dfd["widget.isSavedReport"]="true";
_dfd["ui.reRunObj"]=this.getSavedReportSearchPath(_df6);
}else{
_dfd["ui.object"]=_df5;
if(_df8&&_df8.length>0){
_dfd["flexParamProperties"]=_df8;
}
if(_df9&&_df9.length>0){
_dfd["gdPromptAnswers"]=_df9;
}
}
_dfd["originalReport"]=_df5;
}
if(this.getAttributeValue("savedOutputSearchPath")!=null){
this.setSavedOutputSearchPath(this.getAttributeValue("savedOutputSearchPath"));
_dfd["ui.savedOutputSearchPath"]=this.getAttributeValue("savedOutputSearchPath");
_dfd["ui.action"]="buxView";
}else{
if(this.getAttributeValue("mostRecentSavedOutput")=="true"){
_dfd["ui.action"]="buxView";
}else{
if(_dfa){
if(this.getAttributeValue("limitedInteractiveMode")==="true"){
_dfd["limitedInteractiveMode"]="true";
_dfd["ui.action"]="run";
_dfd["run.xslURL"]="bux.xsl";
}else{
_dfd["ui.action"]="bux";
}
if(this.getRunReportOption()!==null){
_dfd["widget.runReport"]=(this.getRunReportOption())?"true":"false";
if(this.getDoGetParametersOnLoad()){
_dfd["widget.globalPromptInfo"]="<globalPromptInfo></globalPromptInfo>";
}
this.resetRunReportOption();
}
}else{
if(_df7&&_df7.length>0&&this.copyPasteResource==null){
_dfd["ui.reportDrop"]="true";
_dfd["ui.action"]="bux";
_dfd["reportpart_id"]=_df7;
}else{
if(this.copyPasteResource){
if(this.ciPublishedReportPath!=null){
_dfd["ui.object"]=this.ciPublishedReportPath;
}
var _dfe=dojo.fromJson(this.copyPasteResource);
if(_dfe[0]&&_dfe[0].body){
var _dff=this.getAttributeValue("copy.conversation");
if(_dff){
_dfd["ui.conversation"]=_dff;
}
if(_dfe[0].body.specification){
_dfd["ui.spec"]=_dfe[0].body.specification;
_dfd["ui.action"]="buxCopyPaste";
if(this.getAttributeValue("reportCreatedInCW")==="true"){
_dfd["cv.objectPermissions"]="read write execute setPolicy traverse";
}
}else{
_dfd["ui.reportDrop"]="true";
_dfd["ui.action"]="buxDropReportOnCanvas";
}
}
}else{
if(this.sInitialSpec){
_dfd["ui.spec"]=this.sInitialSpec;
_dfd["ui.action"]="buxRunSpecification";
_dfd["cv.objectPermissions"]="read write execute setPolicy traverse";
}else{
if(this._newReportInfo){
for(prop in this._newReportInfo){
_dfd[prop]=this._newReportInfo[prop];
}
_dfd["ui.reportDrop"]="true";
_dfd["ui.action"]="bux";
_dfd["cv.objectPermissions"]="read write execute setPolicy traverse";
_dfd["ui.objectClass"]="report";
_dfd["openReportFromClipboard"]="true";
}else{
_dfd["ui.reportDrop"]="true";
_dfd["ui.action"]="buxDropReportOnCanvas";
}
}
}
}
}
}
}
if(_dfb!==null){
_dfd["run.prompt"]=(_dfb?"true":"false");
}
if(this.getAttributeValue("lastLocaleSaved")!=null){
_dfd["lastLocaleSaved"]=this.getAttributeValue("lastLocaleSaved");
}
var _e00="";
if(this.copyPasteResource){
_e00=this.updateCopyPasteFilters(_df4);
}else{
_e00=this.buildDataFiltersParam(_df4);
if(typeof _df4=="undefined"||_df4==null){
_e00=this.buildFiltersParamFromLoadedSliderState();
}
}
if(_e00!=""){
_dfd["cv.updateDataFilters"]=_e00;
}
if(this.properties&&this.properties.getFlashCharts()!==null){
_dfd["savedFlashChartOption"]=(this.properties.getFlashCharts()?"true":"false");
var _e01=this.getAttributeValue("hasAVSChart");
if(_e01=="true"){
_dfd["hasAVSChart"]="true";
}else{
_dfd["hasAVSChart"]="false";
}
}
if(this.properties.getRowsPerPage()!=null){
_dfd["run.verticalElements"]=this.properties.getRowsPerPage();
}
var _e02=this.getAttributeValue("syncNewWidgets");
if(_e02===null||_e02==="true"){
_e02=true;
}else{
_e02=false;
}
if(!_dfa&&_e02){
var _e03=this.getGlobalPromptsInfo();
if(_e03!==null){
_dfd["widget.globalPromptInfo"]=_e03;
}
}
if(this.isOpeningSavedDashboard()){
_dfd["ui.preserveRapTags"]="true";
}
if(_dfa===true&&this.getAttributeValue("limitedInteractiveMode")!=="true"){
this.getUserId();
}
if(window.cognosViewerDebug){
_dfd.debug=true;
}
_dfd["cv.buxCurrentUserRole"]=this.getUserRole();
if(this.shouldUseSavedReportInfo()){
_dfd["rap.getReportInfo"]="false";
}
if(window.icdConfig&&window.icdConfig.ZIPIMode!="0"){
this.addBUXRTStateInfoToContent(_dfd);
}
this.addBUXWidgetTitleToContent(_dfd);
return _dfd;
},addBUXRTStateInfoToContent:function(_e04){
if(_e04!=null){
var _e05=this.getBUXRTStateInfoMap();
if(_e05&&_e05.length>0){
_e04["cv.buxRTStateInfo"]=_e05;
}
}
},addBUXWidgetTitleToContent:function(_e06){
if(_e06!=null){
var _e07=this.getAttributeValue("widgetTitle");
if(_e07&&_e07.length>0){
_e06["widgetTitle"]=_e07;
}
var _e08=this.getDisplayName();
if(_e08&&_e08.length>0){
_e06["displayTitle"]=_e08;
}
}
},addUserParamsToContent:function(_e09){
var _e0a=this.getAttributeValue("userParams");
if(!_e0a){
return;
}
var doc=XMLBuilderLoadXMLFromString(_e0a);
if(!doc){
return;
}
var _e0c=XMLHelper_FindChildrenByTagName(doc.documentElement,"item",false);
var _e0d=_e0c.length;
for(var i=0;i<_e0d;i++){
if(!_e0c[i]){
continue;
}
var _e0f=XMLHelper_FindChildByTagName(_e0c[i],"name",false);
if(!_e0f){
continue;
}
var _e10=XMLHelper_FindChildByTagName(_e0c[i],"value",false);
_e09[XMLHelper_GetText(_e0f)]=(!_e10?"":XMLHelper_GetText(_e10));
}
if(_e0d>0){
_e09["widget.userParameters"]="true";
if(this.getAttributeValue("viewerReportPrompts")){
_e09["viewerReportPrompts"]=this.getAttributeValue("viewerReportPrompts");
}
}
this.removeAttributeValue("userParams");
},shouldUseSavedReportInfo:function(){
return this.getAttributeValue("rapReportInfoVersion")===this.RAP_REPORT_INFO_VERSION&&this.getAttributeValue("rapReportInfo")!=null;
},isConsumeUser:function(){
return this.getUserRole()==="consume";
},getUserRole:function(){
var _e11=null;
var _e12=this.iContext.getItemSet("buxuserprofile",false);
if(_e12){
_e11=_e12.getItemValue("currentUserRole");
}
return _e11==null?"assemble":_e11;
},getUserId:function(){
dojo["require"]("bux.UserAccount");
return bux.UserAccount.getUserAccount().then(dojo.hitch(this,function(_e13){
this.m_sUserId=_e13.cm$searchPath;
return this.m_sUserId;
}));
},_genMobileFormFieldPayload:function(form){
var _e15={};
var _e16=form.getElementsByTagName("input");
if(_e16){
for(var i=0;i<_e16.length;i++){
var name=_e16[i].getAttribute("name");
var _e19=_e16[i].getAttribute("value");
if(name&&_e19){
_e15[name]=_e19;
}
}
}
return _e15;
},launchGotoPageForIWidgetMobile:function(form){
var _e1b={"action":"goto","payload":this._genMobileFormFieldPayload(form)};
if(typeof console!="undefined"&&console&&console.log){
console.log(_e1b);
}
this.fireEvent("com.ibm.bux.widget.openView",null,_e1b);
},executeDrillThroughForIWidgetMobile:function(form){
var _e1d=getChildElementsByAttribute(form,"input","name","ui.action");
if(_e1d&&_e1d.length>0){
_e1d[0].setAttribute("value","authoredDrillThroughMobile");
}
var _e1e={"action":"drillThrough","payload":this._genMobileFormFieldPayload(form)};
if(typeof console!="undefined"&&console&&console.log){
console.log(_e1e);
}
this.fireEvent("com.ibm.bux.widget.openView",null,_e1e);
},isBuxAvailable:function(){
return (this.bux&&this.bux._base?true:false);
},getDrillOptions:function(){
return this.properties.getDrillOptions();
},getPromptRunOption:function(_e1f,_e20){
if(!_e20&&_e1f&&_e1f.length>0){
return false;
}else{
if(_e20){
return this.properties.getPromptUserOnLoad();
}else{
return null;
}
}
},buildDataFiltersParam:function(_e21){
var _e22="";
if(_e21&&_e21.length>0){
this.sliderState={};
_e22="<UpdateDataFilters>";
for(var _e23=0;_e23<_e21.length;++_e23){
var _e24=_e21[_e23];
var _e25=dojo.fromJson(_e24);
if(_e25.clientId==this.getWidgetId()){
continue;
}
if(!(_e25["com.ibm.widget.context.bux.selectValueControl"])){
this.m_oWidgetContextManager.convertSelectionToSelectValueControlPayload(_e25);
this.m_oWidgetContextManager.convertGenericToSelectValueControlPayload(_e25);
_e24=dojo.toJson(_e25);
}
_e22+="<filter>"+xml_encode(_e24)+"</filter>";
this.sliderState[_e25.clientId]=_e24;
}
_e22+="</UpdateDataFilters>";
}
return _e22;
},updateCopyPasteFilters:function(_e26){
this.loadSliderState();
if(this.sliderState){
for(var _e27 in this.sliderState){
this.sliderState[_e27]="{'clientId':'"+_e27+"',\t'com.ibm.widget.context':{},'com.ibm.widget.context.bux.selectValueControl':"+"{'selectValueControl':{'id':'"+_e27+"','controlType':'slider','type':'discrete','valueType':'string'}}}";
}
}
if(_e26&&_e26.length>0){
for(var _e28=0;_e28<_e26.length;++_e28){
var _e29=_e26[_e28];
var _e2a=dojo.fromJson(_e29);
if(_e2a["com.ibm.widget.context.bux.selection"]){
this.m_oWidgetContextManager.convertSelectionToSelectValueControlPayload(_e2a);
this.m_oWidgetContextManager.convertGenericToSelectValueControlPayload(_e2a);
_e29=dojo.toJson(_e2a);
}
this.sliderState[_e2a.clientId]=_e29;
}
}
return this.buildDataFiltersParam_fromState();
},buildFiltersParamFromLoadedSliderState:function(){
var _e2b="";
this.loadSliderState();
_e2b=this.buildDataFiltersParam_fromState();
return _e2b;
},loadSliderState:function(){
this.sliderState={};
var _e2c=dojo.fromJson(this.getAttributeValue("sliderIDs"));
if(_e2c){
for(var i=0;i<_e2c.length;++i){
var _e2e=_e2c[i];
var _e2f=this.getItemValue("sliderState_"+_e2e);
if(_e2f!=null&&_e2f!=""){
this.sliderState[_e2e]=_e2f;
}
}
}
},buildDataFiltersParam_fromState:function(){
var _e30="";
if(this.sliderState){
for(var _e31 in this.sliderState){
_e30+="<filter>"+xml_encode(this.sliderState[_e31])+"</filter>";
}
if(_e30!==""){
return ("<UpdateDataFilters>"+_e30+"</UpdateDataFilters>");
}
}
return _e30;
},loadContent:function(_e32){
var _e33=dojo.byId("_"+this.iContext.widgetId+"_cv");
this.loadStylesAndScripts(_e32,_e33,true);
if(!window.gScriptLoader.hasCompletedExecution()){
var obj=this;
this.timer=setInterval(function(){
window.gInitializeViewer(obj);
},this.timerInterval);
}else{
window.gInitializeViewer(this);
}
this.viewerWidgetLastAction=null;
},executeAction:function(evt,_e36){
var _e37=this.getViewerObject();
if(evt&&_e37){
var _e38=_e36?_e36:evt.payload.name;
var _e39=evt.payload;
if(_e38&&typeof _e39!="undefined"&&_e39!=null){
if(evt.payload.payload){
_e39=evt.payload.payload;
}
_e37.executeAction(_e38,_e39);
}
}
},onContextMenuAction:function(evt){
this.executeAction(evt);
},onToolbarAction:function(evt){
this.executeAction(evt);
},updateToolbar:function(){
var _e3c=this.getViewerObject();
if(!_e3c||(!this.bToolbarInitialized&&typeof CognosViewerAction!="function")){
return;
}
if(_e3c.getStatus()==="prompting"){
return;
}
var _e3d=_e3c.getToolbar();
CCognosViewerToolbarHelper.updateToolbarForCurrentSelection(_e3c,_e3d);
this.fireEvent("com.ibm.bux.widgetchrome.toolbar.init",null,_e3c.getToolbar());
},onSelect:function(){
if(!this.bToolbarInitialized){
this.bToolbarInitialized=true;
var _e3e=this.getViewerObject();
if(_e3e){
var _e3f=_e3e.getStatus();
if(_e3f!=="prompting"&&_e3f!=="working"&&_e3f!="stillWorking"){
this.updateToolbar();
}
}
}
this.fireEvent("com.ibm.bux.widget.select.done",null,{});
},hideToolbarAndContextMenu:function(){
this.fireEvent("com.ibm.bux.widget.contextMenu.update");
this.fireEvent("com.ibm.bux.widgetchrome.toolbar.init");
},updateSavedAttributes:function(_e40){
this.setAttributeValue("version",this.BUX_REPORT_VERSION);
this.setAttributeValue("viewerProperties",this.properties.toString());
if(this.m_oWidgetContextManager.getSelectionFilterObjects()){
this.setAttributeValue("selectionObjects",this.m_oWidgetContextManager.toStringSelectionFilterObjects());
}
if(_e40==="live"){
var oCV=this.getViewerObject();
var _e42=this.getEnvParam("reportPrompts");
if(this.promptParametersRetrieved==true&&_e42&&_e42.length>0){
this.setAttributeValue("viewerReportPrompts",this.getEnvParam("reportPrompts"));
}
this.setAttributeValue("promptParametersRetrieved",(this.promptParametersRetrieved?"true":"false"));
this.setAttributeValue("selectionFilterEnabled",this.m_bSelectionFilterSwitch?"true":"false");
if(this.getEnvParam("reportpart_id")&&this.getEnvParam("reportpart_id").length>0){
this.setAttributeValue("fromReportPart","true");
}
if(this.isLimitedInteractiveMode()){
this.setAttributeValue("limitedInteractiveMode","true");
}else{
this.setAttributeValue("baseReportModificationTime",oCV.envParams["baseReportModificationTime"]);
}
var _e43=oCV.envParams["contentLocale"];
if(_e43!=null){
this.saveSliderState();
this.setAttributeValue("lastLocaleSaved",_e43);
}
this.setAttributeValue("originalReportLocation",oCV.envParams["originalReportLocation"]);
this.setAttributeValue("hasAVSChart",oCV.hasAVSChart()?"true":"false");
this.setAttributeValue("displayTypes",this.getDisplayTypes());
this.setSavedOutputsCMResponse(null);
if(oCV.getPinFreezeManager()){
var _e44=oCV.getPinFreezeManager().toJSONString();
this.setAttributeValue("PinFreezeInfo",_e44);
}
if(oCV.envParams["rapReportInfo"]){
this.setAttributeValue("rapReportInfoVersion",this.RAP_REPORT_INFO_VERSION);
this.setAttributeValue("rapReportInfo",oCV.envParams["rapReportInfo"]);
}
}
if(_e40==="savedOutput"){
if(this.getSavedOutputSearchPath()==null){
this.setAttributeValue("mostRecentSavedOutput","true");
}else{
this.setAttributeValue("savedOutputSearchPath",this.getSavedOutputSearchPath());
}
this.setAttributeValue("selectionFilterEnabled",this.m_bSelectionFilterSwitch?"true":"false");
}
},onItemSetChanged:function(_e45){
if(this.getViewerObject()){
var _e46=_e45.payload.changes;
for(var i in _e46){
if(_e46[i].id==="savedReportPath"&&_e46[i].newVal){
this.updateCVEnvParam();
}
}
}
},updateCVEnvParam:function(){
var oCV=this.getViewerObject();
oCV.envParams["ui.objectClass"]=this.isSavedOutput()?"reportView":"report";
oCV.envParams["widget.isSavedReport"]="true";
var _e49=this.getAttributeValue("savedReportName");
if(_e49){
oCV.envParams["ui.object"]=_e49;
oCV.envParams["savedReportName"]=_e49;
}else{
oCV.envParams["ui.object"]=this.getAttributeValue("savedReportPath");
}
},onWidgetSave:function(evt){
var _e4b=this.getViewerObject();
var _e4c={"status":false};
if(evt&&evt.payload&&evt.payload.isCopy===true){
this.setAttributeValue("copy.conversation",_e4b.getConversation());
}else{
this.removeItem("copy.conversation");
this.removeItem("copy.ciPublishedReportPath");
}
var _e4d=evt&&evt.payload&&evt.payload.operation=="saveAs"?true:false;
if(!_e4b&&!_e4d){
this.fireEvent("com.ibm.bux.widget.save.done",null,_e4c);
return;
}
this.getLoadManager().runWhenHasViewer(dojo.hitch(this,function(){
var _e4e=this.getViewerObject();
_e4e.loadExtra();
if(this.isSavedOutput()){
this.cleanSavedAttributes();
this.updateSavedAttributes("savedOutput");
_e4c.status=true;
this.fireEvent("com.ibm.bux.widget.save.done",null,_e4c);
}else{
if(this.sInitialSpec){
_e4c.status=true;
this.fireEvent("com.ibm.bux.widget.save.done",null,_e4c);
}else{
var _e4f=this.getEnvParam("cv.objectPermissions");
var _e50=new ViewerIWidgetSave(this,evt.payload);
if(!_e50.canSave(_e4f)){
this.showErrorMessage(RV_RES.IDS_CANNOT_SAVE_CONTENT_ERROR);
this.fireEvent("com.ibm.bux.widget.save.done",null,_e4c);
return;
}
if(this.isLimitedInteractiveMode()||(_e4e.envParams["ui.spec"]&&_e4e.envParams["ui.spec"].length>0)){
this.cleanSavedAttributes();
this.updateSavedAttributes("live");
if(_e50.doGetSavePropertiesFromServer()){
_e50.getSavePropertiesFromServer();
}else{
this.doWidgetSaveDone(_e50);
}
}else{
if(!_e4e.envParams["ui.spec"]){
_e50.setDoCWCopy(true);
this.doWidgetSaveDone(_e50);
}else{
this.fireEvent("com.ibm.bux.widget.save.done",null,_e4c);
}
}
}
}
}),evt);
},doWidgetSaveDone:function(_e51){
var _e52=_e51.getPayload();
_e52.status=true;
if(window.icdConfig&&window.icdConfig.ZIPIMode!="0"){
var _e53=_e51.m_payload.dashboard;
if(_e53){
this._BUXDBInfoArray=this.getBUXDBInfoArray({dbTitle:_e53.title._text,dbSearchPath:_e53.cm$searchPath});
}
}
this.fireEvent("com.ibm.bux.widget.save.done",null,_e52);
},handleGetSavePropertiesFromServerResponse:function(_e54,_e55){
var _e56=new ViewerIWidgetSave(this,_e55);
if(_e54&&_e54.getJSONResponseObject()){
applyJSONProperties(this.getViewerObject(),_e54.getJSONResponseObject());
}
this.doWidgetSaveDone(_e56);
},isPreCaspianRP1BUXReport:function(){
var _e57=this.getAttributeValue("version");
if(!_e57||_e57<this.BUX_REPORT_CASPIAN_RP1_VERSION){
return true;
}
return false;
},isGoDashboardReportUpgrade:function(){
var _e58=this.getAttributeValue("version");
if(_e58==this.GODASHBOARD_REPORT_VERSION){
return true;
}
return false;
},isOpeningSavedDashboard:function(){
var _e59=this.getAttributeValue("viewerProperties");
if((_e59&&_e59.indexOf("{")===0)||this.isGoDashboardReportUpgrade()){
return true;
}
return false;
},cleanSavedAttributes:function(){
this.removeAttributeValue("savedOutputSearchPath");
this.removeAttributeValue("mostRecentSavedOutput");
this.removeAttributeValue("savedReportName");
this.removeAttributeValue("dashboardID");
this.removeAttributeValue("savedReportId");
this.removeAttributeValue("baseReportModificationTime");
this.removeAttributeValue("viewerReportPrompts");
this.removeAttributeValue("promptParametersRetrieved");
this.removeAttributeValue("selectionFilterEnabled");
this.removeAttributeValue("PinFreezeInfo");
this.removeAttributeValue("rapReportInfoVersion");
this.removeAttributeValue("rapReportInfo");
this.removeAttributeValue("selectionObjects");
if(this.isSavedOutput()){
this.removeAttributeValue("savedReportPath");
}
},handleWidgetSaveDone:function(_e5a){
var oCV=this.getViewerObject();
var _e5c=_e5a.getResult();
if(_e5c===null){
_e5c={};
}
this.cleanSavedAttributes();
this.updateSavedAttributes("live");
var _e5d=_e5c.reportName;
var _e5e=_e5c.dashboard_id;
this.setAttributeValue("savedReportName",_e5d);
this.setAttributeValue("dashboardID","$$dbid$$"+_e5e);
if(_e5c.permissions){
oCV.envParams["cv.objectPermissions"]=_e5c.permissions;
}
if(_e5c.objectClass){
oCV.envParams["ui.objectClass"]=_e5c.objectClass;
}
if(this.getEnvParam("reportpart_id")&&this.getEnvParam("reportpart_id").length>0){
this.setAttributeValue("fromReportPart","true");
}
if(this.isLimitedInteractiveMode()){
this.setAttributeValue("limitedInteractiveMode","true");
}else{
this.setAttributeValue("baseReportModificationTime",oCV.envParams["baseReportModificationTime"]);
}
var _e5f=oCV.envParams["contentLocale"];
if(_e5f!=null){
this.saveSliderState();
this.setAttributeValue("lastLocaleSaved",_e5f);
}
this.setAttributeValue("originalReportLocation",oCV.envParams["originalReportLocation"]);
oCV.envParams["ui.object"]=this.getSavedReportSearchPath(_e5d);
oCV.envParams["savedReportName"]=_e5d;
this.setAttributeValue("hasAVSChart",oCV.hasAVSChart()?"true":"false");
this.setAttributeValue("displayTypes",this.getDisplayTypes());
this.setSavedOutputsCMResponse(null);
var _e60={"status":true};
this.fireEvent("com.ibm.bux.widget.save.done",null,_e60);
},getDisplayTypes:function(){
var oCV=this.getViewerObject();
if(oCV.getRAPReportInfo()){
return oCV.getRAPReportInfo().getDisplayTypes();
}
},saveSliderState:function(){
var _e62=this.getViewerObject();
var _e63=_e62.getRAPReportInfo();
var _e64={};
if(_e63){
_e64=_e63.collectSliderSetFromReportInfo();
}
var i=0;
var _e66=[];
for(var _e67 in this.sliderState){
if(typeof _e64[_e67]!="undefined"){
this.setItemValue("sliderState_"+_e67,this.sliderState[_e67]);
_e66[i++]=_e67;
}else{
this.removeItem("sliderState_"+_e67);
}
}
this.setAttributeValue("sliderIDs",dojo.toJson(_e66));
},onWidgetRefresh:function(evt){
var _e69={};
var _e6a=this.getViewerObject();
if(evt&&_e6a){
if(_e6a.envParams["ui.action"]=="view"||_e6a.envParams["ui.action"]=="buxView"){
_e6a.executeAction("RefreshViewEvent");
}else{
if(evt.payload&&evt.payload.refreshType=="preferencesChanged"){
this.clearRAPCache();
_e6a.executeAction("EditContent",{"preferencesChanged":true});
_e6a.executeAction("Reprompt",{"preferencesChanged":true});
}else{
if(!this.isVisible()){
this.getDelayedLoadingContext().setForceRunReport(true);
}else{
_e6a.executeAction("Refresh");
}
}
}
this.fireEvent("com.ibm.bux.widget.refresh.done",null,_e69);
}
},invokeDisplayTypeDialog:function(_e6b,_e6c){
if(!this.m_chart){
this.m_chart=new bux.reportViewer.chart();
}
var _e6d=this.m_chart.getDisplayTypeDialogDefinition(_e6b);
var _e6e={"supportedChartTypes":_e6d,"suggestedDisplayTypes":_e6c};
this.fireEvent("com.ibm.bux.widget.invokeDisplayTypeDialog",null,_e6e);
},onChangeDisplayType:function(evt){
var _e70=this.getViewerObject();
if(evt&&_e70){
_e70.executeAction("ChangeDisplayType",evt.payload);
}
},onDisplayTypeDialogVariations:function(evt){
var _e72=this.getViewerObject();
if(evt&&_e72){
_e72.executeAction("ChangeDisplayVariations",evt.payload);
}
},updateDisplayTypeDialogVariations:function(_e73,_e74){
if(!this.m_chart){
this.m_chart=new bux.reportViewer.chart();
}
var _e75=this.m_chart.getDisplayTypeDialogDefinition(_e73);
var _e76={"supportedChartTypes":_e75,"variationGroups":_e74};
this.fireEvent("com.ibm.bux.widget.updateDisplayTypeDialogVariations",null,_e76);
},onGetDisplayTitleDone:function(evt){
if(evt&&evt.payload&&evt.payload.callback){
evt.payload.callback(evt.payload.title);
}
},getWidgetStoreID:function(){
if(typeof this.widgetStoreId==="undefined"){
if(!this.widgetStoreIdDfd){
this.widgetStoreIdDfd=new dojo.Deferred();
}
return this.widgetStoreIdDfd;
}
return this.widgetStoreId;
},setWidgetStoreID:function(_e78){
this.widgetStoreId=_e78;
if(this.widgetStoreIdDfd){
this.widgetStoreIdDfd.callback(this.widgetStoreId);
this.widgetStoreIdDfd=null;
}
},onUpdateWidgetStoreIDDone:function(evt){
var _e7a=evt.payload.storeID;
var _e7b="storeID(\"";
if(_e7a&&(_e7a.indexOf(_e7b)>-1)){
_e7a=_e7a.substr(_e7b.length,_e7a.length-_e7b.length-1);
}
dojo.when(this.getWidgetStoreID(),dojo.hitch(this,function(_e7c){
if(_e7c&&_e7c!=_e7a){
this._copyComments(_e7c,_e7a);
}
}));
this.setWidgetStoreID(_e7a);
},_copyComments:function(_e7d,_e7e){
var _e7f=this.buildPostUrl();
if(_e7f){
var _e80=new XmlHttpObject();
_e80.addFormField("b_action","cognosViewer");
_e80.addFormField("widgetOldStoreID",_e7d);
_e80.addFormField("widgetStoreID",_e7e);
_e80.addFormField("ui.action","cloneAnnotations");
_e80.addFormField("cv.responseFormat","json");
_e80.sendHtmlRequest("POST",_e7f,"",true);
}
},onRemoveDone:function(evt){
this.destroy();
},onGetProperties:function(evt){
this.initializeProperties();
this.fireEvent("com.ibm.bux.widget.properties.get.done",null,this.properties.onGet());
},onSetProperties:function(evt){
if(evt&&evt.payload&&evt.payload.properties){
this.properties.onSet(evt.payload);
}
this.fireEvent("com.ibm.bux.widget.properties.set.done");
var _e84={"modified":true};
this.fireEvent("com.ibm.bux.widget.modified",null,_e84);
},getProperties:function(){
return this.properties;
},clearPropertiesDialog:function(){
if(this.properties){
this.properties.clearDialogSpec();
}
},onGenericSelectValueControl:function(evt,_e86){
if(evt){
this.getLoadManager().runWhenHasViewer(dojo.hitch(this,function(){
var _e87=false;
var _e88=this._getFilterPayload(evt);
var _e89=(this.m_oWidgetContextManager)?this.m_oWidgetContextManager.getSelectValueControlTypeFromPayload(_e88):null;
if(_e89&&_e89!=="facet"){
var _e8a=dojo.clone(evt);
this.preProcessFilterValues(_e8a);
this.m_oWidgetContextManager.updateFilterContext(_e8a.payload);
_e87=this.onFilter(_e8a,_e86);
}else{
this.m_oWidgetContextManager.updateFilterContext(_e88);
_e87=this.onFilter(evt,_e86);
}
return _e87;
}),evt.source);
}
},onFilter:function(evt,_e8c){
if(evt){
this.getLoadManager().runWhenHasViewer(dojo.hitch(this,function(){
var _e8d=false;
if(this.isLiveReport()===false){
return _e8d;
}
var _e8e=this._getFilterPayload(evt);
var _e8f=(this.m_oWidgetContextManager)?this.m_oWidgetContextManager.getSelectValueControlTypeFromPayload(_e8e):null;
var _e90=null;
var _e91=this.m_oWidgetContextManager.getItemNames(_e8e);
var _e92=false;
for(var i=0;!_e92&&i<_e91.length;i++){
_e90=_e91[i];
_e92=this.canFilter(_e8e,_e90,_e8f,evt);
}
if(_e90==null&&!_e92){
_e92=this.canFilter(_e8e,_e90,_e8f,evt);
}
if(_e92){
var _e94={};
var _e95=this._getDrillResetHUNForFacet(_e90,_e8f);
if(_e95&&_e95.length>0){
_e94.drillResetHUN=_e95;
}
var _e96=(evt.type=="string")?evt.payload:dojo.toJson(evt.payload);
this.sliderState[evt.source]=_e96;
_e94.filterPayload=_e96;
_e94.isFacet=("facet"===_e8f);
if(_e8c){
_e94.forceCleanup=this.m_oWidgetContextManager.genRemoveDiscreteFilterPayload(this.getWidgetId());
}
this.getViewerObject().executeAction("UpdateDataFilter",_e94);
if(!this.shouldReportBeRunOnAction()){
this.getLoadManager().getDelayedLoadingContext().setForceRunReport(true);
}
_e8d=true;
}
return _e8d;
}),evt.source);
}
},clearSelectionFilter:function(){
if(this.m_oWidgetContextManager){
var _e97=this.m_oWidgetContextManager.genEmptySelectionPayload(this.getViewerObject(),this.getWidgetId());
this._fireContextChangedEvent(_e97,false);
}
},broadcastSelectionFilter:function(){
this.onSelectionChange();
},onSelectionChange:function(){
if(this.isSelectionFilterEnabled()){
var _e98=(this.getContainerTypeForSelection()==="list");
var _e99=this.m_oWidgetContextManager.genSelectionPayload(this.getViewerObject(),this.getWidgetId(),_e98);
this._fireContextChangedEvent(_e99,!this.m_oWidgetContextManager.isSelectionPayloadForReset(_e99));
}
},_fireContextChangedEvent:function(_e9a,_e9b){
this.setSelectionFilterSent(_e9b);
this.fireEvent("com.ibm.widget.contextChanged",null,_e9a);
},somethingSelected:function(){
var oCV=this.getViewerObject();
return (oCV&&oCV.getSelectionController()&&oCV.getSelectionController().getAllSelectedObjects().length>0);
},selectionFilterSent:function(){
return this.m_bSelectionFilterSent;
},setSelectionFilterSent:function(flag){
this.m_bSelectionFilterSent=flag;
},reselectSelectionFilterObjects:function(){
if(this.isSelectionFilterEnabled()){
var oCV=this.getViewerObject();
var _e9f=oCV.getSelectionController();
var _ea0=this.m_oWidgetContextManager.getSelectionFilterObjects();
if(!_ea0){
var str=this.getAttributeValue("selectionObjects");
if(str&&str.length>0){
_ea0=eval(str);
this.m_oWidgetContextManager.setSelectionFilterObjects(_ea0);
this.removeAttributeValue("selectionObjects");
}
}
if(_ea0&&_ea0.length>0){
var _ea2=new ReselectAction(oCV,_ea0);
_ea2.executeAction();
}
}
},_getFilterPayload:function(evt){
return (evt.type=="string"?dojo.fromJson(evt.payload):evt.payload);
},_getFilterPayloadItemName:function(_ea4){
var _ea5=_ea4.name;
if(!_ea4.name){
_ea5=this.m_oWidgetContextManager.getFilterFirstItemName();
}
return _ea5;
},canFilter:function(_ea6,_ea7,_ea8,evt){
var _eaa;
var _eab=this.getRAPCachedItem("filterableItems");
if(_ea8!=="facet"&&typeof _ea7!="undefined"&&_ea7!=null&&_eab!=null){
for(var type in _eab){
for(_eaa=0;_eaa<_eab[type].length;++_eaa){
if(_eab[type][_eaa].name==_ea7||_eab[type][_eaa].label==_ea7){
return true;
}
}
}
}else{
var _ead=this.getViewerObject();
var _eae=_ead.getRAPReportInfo();
if(_eae){
var _eaf=(this.m_oWidgetContextManager)?this.m_oWidgetContextManager.getSelectValuePropertyFromPayload(_ea6,"dimension"):null;
var _eb0=_eae.getContainers();
for(var lid in _eb0){
var _eb2=_eb0[lid];
var _eb3=_eb2.sliders;
if(_eb3&&_eb3.length){
for(var _eb4=0;_eb4<_eb3.length;++_eb4){
var _eb5=_eb3[_eb4];
if(_eb5.clientId==_ea6.clientId||(_eb5.clientId==evt.source)||(_eb5.clientId==_eb5.name&&_eb5.name==_ea7)){
return true;
}
}
}
var _eb6=_eb2.itemInfo;
if(_eb6&&_eb6.length){
for(var _eb7=0;_eb7<_eb6.length;++_eb7){
if(_eb6[_eb7].item==_ea7){
return true;
}
if(_ea8==="facet"&&_eb6[_eb7].dimensionName==_ea7){
return true;
}
if(_ea8==="facet"&&_eb6[_eb7].dimensionName===_eaf){
return true;
}
}
}
if(_ea8==="facet"){
var _eb8=(this.m_oWidgetContextManager)?this.m_oWidgetContextManager.getSelectValuePropertyFromPayload(_ea6,"filterType"):null;
if(_ea8==="facet"&&_eb8==="attribute"){
return true;
}
var _eb9=_eb2.filter;
if(_eb9&&_eb9.length){
for(var _eba=0;_eba<_eb9.length;++_eba){
if(_eb9[_eba].hierarchyName===_ea7){
return true;
}
}
}
}else{
if(_eae.getFilterObjectFromContainer(lid,_ea7,false)){
return true;
}
}
}
if(_eae.isReportLevel_nonVisibleFilterItem(_ea7)){
return true;
}
}
}
return false;
},_getDrillResetHUNForFacet:function(_ebb,_ebc){
if(_ebc!=="facet"){
return null;
}
var _ebd=null;
var _ebe=this.getViewerObject();
if(_ebe.getRAPReportInfo()){
_ebd=_ebe.getRAPReportInfo().getDrilledOnHUNs();
}
if(!_ebd){
return null;
}
var _ebf=[];
for(var i=0;i<_ebd.length;i++){
if(_ebd[i].indexOf(_ebb)!==-1){
_ebf.push(_ebd[i]);
break;
}
}
return _ebf;
},preProcessFilterValues:function(evt){
var _ec2=evt.payload["com.ibm.widget.context"]["values"];
_ec2=(_ec2)?_ec2:evt.payload["com.ibm.widget.context"]["ranges"];
var _ec3=this.m_oWidgetContextManager.getItemsInItemSpecification(evt.payload);
var _ec4=(_ec2)?false:true;
if(_ec4){
_ec2=evt.payload["com.ibm.widget.context"];
}
var _ec5=this.getViewerObject();
if(_ec5){
var _ec6=_ec5.getRAPReportInfo();
for(var _ec7 in _ec2){
if(!_ec6.isReferenced(_ec7)||_ec4){
delete _ec2[_ec7];
if(_ec3&&_ec3[_ec7]){
delete _ec3[_ec7];
}
}
}
}
if(isObjectEmpty(_ec2)){
evt.payload["com.ibm.widget.context"]={};
}
},isLimitedInteractiveMode:function(){
var _ec8=this.getViewerObject();
if(_ec8){
return _ec8.isLimitedInteractiveMode();
}
return false;
},onMouseOver:function(evt){
if(DragDropAction_isDragging(evt)==false&&this.getViewerObject().getStatus()=="complete"){
var _eca=ActionFactory_loadActionHandler(evt,this.getViewerObject());
if(_eca){
return _eca.onMouseOver(evt);
}
}
return true;
},onMouseOut:function(evt){
var _ecc=ActionFactory_loadActionHandler(evt,this.getViewerObject());
if(_ecc&&this.getViewerObject().getStatus()=="complete"){
return _ecc.onMouseOut(evt);
}
return true;
},onMouseOverRenamedItem:function(evt){
var node=getNodeFromEvent(evt);
if(node.getAttribute){
var _ecf=node.getAttribute("rp_name");
if(_ecf!=null){
var _ed0=this.getViewerObject().getSelectionController().getTextValue(node.childNodes);
if(_ecf!=_ed0){
var id=node.getAttribute("id");
node.m_tooltip=new bux.reportViewer.ReportInfo({connectId:[id],position:["above","below"],title:RV_RES.IDS_JS_RENAMED_ITEM,text:RV_RES.IDS_JS_RENAMED_ITEM_ORIGINAL_LABEL+" "+node.getAttribute("rp_name")});
node.m_tooltip.open();
}
}
}
},onMouseOutRenamedItem:function(evt){
var node=getNodeFromEvent(evt);
node.m_tooltip=null;
},onDoubleClick:function(evt){
var _ed5=ActionFactory_loadActionHandler(evt,this.getViewerObject());
if(_ed5&&this.getViewerObject().getStatus()=="complete"){
return _ed5.onDoubleClick(evt);
}
return true;
},onMouseDown:function(evt){
var oCV=this.getViewerObject();
var _ed8=oCV.getActionFactory();
this._selectionAction=_ed8.load("Selection");
if(this.isMobile()){
var _ed9=oCV.getSelectionController();
var _eda=_ed9.pageClickedForMobile(evt);
if(this.isSelectionFilterEnabled()){
this.onSelectionChange();
}else{
if(_eda){
this.onContextMenu(evt);
}
}
}else{
if(oCV.envParams["ui.action"]=="view"){
this._selectionAction.onMouseDown(evt);
}else{
if(oCV.getStatus()=="complete"){
if((evt.button==1||evt.button==0)){
if(!this._selectionAction.onMouseDown(evt)&&!_ed8.load("RenameDataItem").onMouseDown(evt)){
this.initDragAndDrop();
_ed8.load("DragDrop").onMouseDown(evt);
}
}else{
this._selectionAction.onMouseDown(evt);
}
}
}
}
},onMouseUp:function(evt){
if(this.isMobile()){
return;
}
var _edc=getCrossBrowserNode(evt);
try{
var _edd=_edc.nodeName.toLowerCase();
if(_edd=="input"||_edd=="textarea"){
evt.cancelBubble=true;
return false;
}
}
catch(ex){
}
var _ede=false;
if(this.getViewerObject().envParams["ui.action"]=="view"){
setNodeFocus(evt);
}else{
if(this.getViewerObject().getStatus()=="complete"){
_ede|=DragDropAction_isDragging(evt);
DragDropAction_onmouseup(evt);
this.removeDragAndDrop();
setNodeFocus(evt);
}
}
if(!this._selectionAction){
var oCV=this.getViewerObject();
var _ee0=oCV.getActionFactory();
this._selectionAction=_ee0.load("Selection");
}
this._selectionAction.onMouseUp(evt,_ede);
clearTextSelection();
},getContainerTypeForSelection:function(){
var _ee1=this.getViewerObject();
if(_ee1){
var _ee2=_ee1.getSelectionController();
return _ee2.getDataContainerType();
}
return null;
},onContextMenu:function(evt){
var _ee4=this.getViewerObject();
if(_ee4.getStatus()=="complete"||this.isSavedOutput()){
var _ee5=_ee4.getContextMenu();
var _ee6=CCognosViewerToolbarHelper.updateContextMenuForCurrentSelection(_ee4,_ee5);
if(this.isMobile()){
var _ee7=_ee4.getSelectionController();
var _ee8=_ee7.getContainerType();
var _ee9=_ee8==="chart"?_ee7.getChartTooltip():null;
if(this.getAnnotationStore()&&this.getAnnotationStore().hasAnnotation()){
var _eea=this._genMobileCommentMenuItem(_ee7);
if(_eea){
_ee6.push(_eea);
}
var _eeb=this._genMobileCommentMenuItem();
if(_eeb){
var _eec=_ee4.findBlueDotMenu(_ee6);
if(_eec){
_eec.push(_eeb);
}
}
}
var _eed={"context":{"event":evt,"viewerContext":{"displayValues":_ee7.getDisplayValues(),"chartTooltip":_ee9,"containerType":_ee8}},"menuItems":_ee6};
if(typeof console!="undefined"&&console&&console.log){
console.log(_eed);
}
this.fireEvent("com.ibm.bux.widget.contextMenu.update",null,_eed);
}else{
this.fireEvent("com.ibm.bux.widget.contextMenu.update",null,_ee6);
}
}
},_genMobileCommentMenuItem:function(_eee){
var ctx=null;
if(_eee){
if(_eee.getSelections().length==1){
ctx=_eee.getSelections()[0].getCtxAttributeString();
}
if(!ctx){
return null;
}
}
var _ef0=this.getAnnotationStore().getAsJSON(ctx);
if(_ef0.length>0){
return {"name":RV_RES.IDS_JS_ANNOTATIONS,"label":RV_RES.IDS_JS_ANNOTATIONS,"flatten":false,"comments":_ef0};
}
return null;
},initDragAndDrop:function(){
if(window.attachEvent){
document.attachEvent("onmouseup",DragDropAction_onmouseup);
document.attachEvent("onmousemove",DragDropAction_onmousemove);
}else{
if(document.addEventListener){
document.addEventListener("mouseup",DragDropAction_onmouseup,false);
document.addEventListener("mousemove",DragDropAction_onmousemove,false);
}
}
},removeDragAndDrop:function(){
if(window.detachEvent){
document.detachEvent("onmouseup",DragDropAction_onmouseup);
document.detachEvent("onmousemove",DragDropAction_onmousemove);
}else{
if(document.removeEventListener){
document.removeEventListener("mouseup",DragDropAction_onmouseup,false);
document.removeEventListener("mousemove",DragDropAction_onmousemove,false);
}
}
},onWidgetResize:function(evt){
var _ef2=evt.payload.resize;
if(_ef2){
if(!this.m_visible||(this.widgetSize&&this.widgetSize.h===_ef2.h&&this.widgetSize.w===_ef2.w)){
return;
}
var _ef3=!this.widgetSize;
this.widgetSize={h:_ef2.h,w:_ef2.w};
if(_ef3){
return;
}
if(!_ef2.autoResize){
this.executeAction(evt,"ResizeChart");
}
var oCV=this.getViewerObject();
if(oCV&&oCV.getPinFreezeManager()){
if(_ef2.autoResize){
oCV.getPinFreezeManager().processAutoResize(_ef2.w,_ef2.h);
}
setTimeout(function(){
oCV.getPinFreezeManager().refresh();
},100);
}
if(oCV.getTabController()){
oCV.getTabController().onResize(evt);
}
}
},getWidgetSize:function(){
return this.widgetSize;
},refreshAnnotationData:function(){
return this.getAnnotationHelper().refreshAnnotationData();
},fetchAnnotationData:function(){
this.getAnnotationHelper().fetchAnnotationData();
},reportContainsDijits:function(){
var _ef5=this.getAnnotationStore();
var _ef6=_ef5.getAll();
for(var key in _ef6){
if(typeof _ef6[key]!=="function"){
return true;
}
}
return false;
},isSaveNecessary:function(){
var _ef8=false;
if(this.isSavedOutput()){
var _ef9=this.getAttributeValue("mostRecentSavedOutput");
var _efa=_ef9==="true"||_ef9===true;
var _efb=this.getAttributeValue("savedOutputSearchPath");
_ef8=!_efa&&_efb==null;
}else{
var _efc=this.getAttributeValue("originalReport");
var _efd=this.getAttributeValue("savedReportName")||this.getAttributeValue("savedReportPath");
if(!this.isSavedReport(_efc,_efd)){
_ef8=true;
}
}
return _ef8;
},addAsNewComment:function(_efe,text){
this.getAnnotationHelper().addAsNewComment(_efe,text);
},onWidgetActionDone:function(_f00){
if(_f00&&_f00.payload&&_f00.payload.status===true){
this.getAnnotationHelper().addNewComment(this._pendingContextId,this._pendingCellValue);
}
this._pendingContextId=null;
this._pendingCellValue=null;
},commitComment:function(_f01){
if(!_f01.isNew){
return null;
}
if(!_f01.isLoaded){
return this.getAnnotationHelper().commitComment(_f01);
}
return null;
},getAnnotationStore:function(){
if(!this.annotationStore){
dojo["require"]("bux.data.AnnotationStore");
this.annotationStore=new bux.data.AnnotationStore(this,this.commitComment,this);
}
return this.annotationStore;
},fireEvent:function(_f02,arg,_f04){
if(window.gViewerLogger){
var id=this.getViewerObject()?this.getViewerObject().getId()+" ":"";
window.gViewerLogger.log(id+_f02,_f04,"json");
}
this.iContext.iEvents.fireEvent(_f02,arg,_f04);
},onGetFilterableItems:function(evt){
this.getLoadManager().runWhenHasViewer(dojo.hitch(this,function(){
var _f07=false;
var _f08=this.getRAPCachedItem("filterableItems");
if(_f08==null&&this.isLiveReport()&&(this.getViewerObject().getStatus()=="complete"||this.isFaultStatusWithSpec())){
this.executeAction(evt,"GetFilterableItems");
_f07=true;
}else{
if(!_f08){
_f08={visible:[],hidden:[]};
}
if(this.isLiveReport()){
this.fireEvent("com.ibm.bux.filter.items.get.done",null,_f08);
}else{
this.savedOutputResponseHandler("com.ibm.bux.filter.items.get.done",_f08);
}
}
return _f07;
}));
},isFaultStatusWithSpec:function(){
var oVO=this.getViewerObject();
if(oVO.getStatus()==="fault"){
if(oVO.envParams["ui.spec"]){
return true;
}
}
return false;
},onGetFilterValues:function(oEvt){
this.getLoadManager().runWhenHasViewer(dojo.hitch(this,function(){
var _f0b=oEvt.payload;
if(typeof oEvt.source!="undefined"&&typeof _f0b!="undefined"){
if(typeof _f0b.payload!="undefined"){
_f0b=_f0b.payload;
}
if(typeof _f0b.source=="undefined"){
_f0b.source=oEvt.source;
}
}
var _f0c=false;
var _f0d=this.isLiveReport();
var _f0e=this.getViewerObject().getStatus();
var _f0f=this.isFaultStatusWithSpec();
if(_f0d&&(_f0e==="complete"||_f0f)){
var _f10=null;
if(!_f0b.forceRefresh&&_f0b.name){
_f10=this.getRAPCachedItem("filterValues."+_f0b.name);
}
if(_f10){
this.fireEvent("com.ibm.bux.filter.values.get.done",null,_f10);
}else{
this.executeAction(oEvt,"GetFilterValues");
_f0c=true;
}
}else{
if(this.getViewerObject().isWorking(_f0e)){
var self=this;
var _f12=function(){
self.onGetFilterValues(oEvt);
};
setTimeout(_f12,10);
}else{
var _f13={};
if(_f0b.name){
_f13.name=_f0b.name;
}
this.fireEvent("com.ibm.bux.filter.values.get.done",null,_f13);
}
}
return _f0c;
}));
},onGetFilterValuesCancel:function(evt){
if(evt&&evt.payload){
var oCV=this.getViewerObject();
var _f16=oCV.getAction("GetFilterValues");
_f16.setRequestParms(evt);
var _f17=_f16.getActionKey();
if(_f17){
oCV.getViewerDispatcher().cancelRequest(_f17);
}
}
},savedOutputResponseHandler:function(_f18,_f19){
var oCV=this.getViewerObject();
var _f1b=dojo.toJson(_f19);
var _f1c="window[\"oCV"+oCV.getId()+"\"].getViewerWidget().fireEvent(\""+_f18+"\", null, "+_f1b+");";
if(oCV){
var _f1d=window["oCV"+oCV.getId()];
if(typeof _f1d=="object"){
setTimeout(_f1c,1);
}
}
return _f1c;
},handleGetFilterableItemsResponse:function(_f1e){
var _f1f={};
var json=this.getJsonFromResponse(_f1e);
if(json){
_f1f=json.filterableItems;
if(!_f1f){
_f1f={"visible":[],"invisible":[]};
}
this.addToRAPCache("filterableItems",_f1f);
}
this.fireEvent("com.ibm.bux.filter.items.get.done",null,_f1f);
},handleGetFilterValuesResponse:function(_f21,_f22){
var _f23={};
var json=this.getJsonFromResponse(_f21);
if(json&&json.filterValues){
_f23=json.filterValues;
if(_f23&&_f23.name){
this.addToRAPCache("filterValues."+_f23.name,_f23);
}
}
if(_f22&&_f22.name&&!_f23.name){
_f23.name=_f22.name;
}
_f23=dojo.clone(_f23);
this.fireEvent("com.ibm.bux.filter.values.get.done",null,_f23);
},getJsonFromResponse:function(_f25){
var json=null;
if(_f25&&_f25.m_jsonResponse&&_f25.m_jsonResponse.json){
json=dojo.eval("("+_f25.m_jsonResponse.json+")");
}else{
if(_f25&&_f25.responseText){
json=dojo.eval("["+_f25.responseText+"]");
if(json&&json[0]){
json=json[0];
}
}
}
return json;
},onContextChanged:function(evt){
if(evt){
this.getLoadManager().runWhenHasViewer(dojo.hitch(this,function(){
var _f28=false;
var _f29=dojo.clone(evt);
var _f2a=this._getFilterPayload(_f29);
this.m_oWidgetContextManager.convertSelectionToSelectValueControlPayload(_f2a);
this.m_oWidgetContextManager.convertGenericToSelectValueControlPayload(_f2a);
var _f2b=this.getViewerObject();
var _f2c=_f2b.getRAPReportInfo();
if(_f2c&&(_f2c.containsFilters()||_f2c.hasSlider())){
var _f2d=_f2a["com.ibm.widget.context"].values;
var _f2e=this.m_oWidgetContextManager.getItemsInItemSpecification(_f2a);
var _f2f=dojo.clone(_f2e);
for(var _f30 in _f2f){
if(!_f2c.isReferenced(_f30)&&_f2e[_f30].values){
var mun=_f2e[_f30].values[0].mun;
var _f32=_f2c.hunHasFilterOrSlider(mun);
if(_f32&&!_f2e[_f32]){
_f2e[_f32]=_f2e[_f30];
delete _f2e[_f30];
_f2d[_f32]=_f2d[_f30];
delete _f2d[_f30];
}
}
}
}
_f29.payload=_f2a;
_f28=this.onGenericSelectValueControl(_f29,true);
return _f28;
}),evt.source);
}
},broadcastParameterChange:function(_f33){
var _f34={"clientId":this.getWidgetId(),"com.ibm.widget.context":_f33};
this.fireEvent("com.ibm.widget.contextChanged.prompt",null,_f34);
},broadcastContextChange:function(_f35){
if(this.isSelectionFilterEnabled()){
var _f36={"clientId":this.getWidgetId(),"com.ibm.widget.context":_f35,"com.ibm.widget.context.bux.selection":{"selection":{"id":this.getWidgetId(),"valueType":"string"}}};
this.m_oWidgetContextManager.updateFilterContext(_f36);
this.m_oWidgetContextManager.setSelectionFilterObjects(null);
this._fireContextChangedEvent(_f36,true);
}
},onGenericDrill:function(evt){
this.m_handleDrill=false;
this.getLoadManager().runWhenHasViewer(dojo.hitch(this,function(){
var _f38=false;
if(!(evt&&evt.payload)||this.isLimitedInteractiveMode()){
return _f38;
}
if(evt.payload.cv_id===this.iContext.widgetId){
return _f38;
}
var _f39=this.m_oWidgetContextManager.getDrillActionType(evt.payload);
var _f3a=this.m_oWidgetContextManager.genDrillSpecObjects(evt.payload);
var _f3b=null;
if(_f39==="DrillDown"){
_f3b=this.getViewerObject().getAction("DrillDown");
}else{
if(_f39==="DrillUp"){
_f3b=this.getViewerObject().getAction("DrillUp");
}else{
return _f38;
}
}
_f3b.setKeepFocusOnWidget(false);
if(this.getViewerObject().isMetadataEmpty()||!this.shouldReportBeRunOnAction()){
_f3b.setUseReportInfoSelection(true);
}
if(_f3b.parseDrillSpecObjects(_f3a)){
if(!this.shouldReportBeRunOnAction()){
this.getLoadManager().getDelayedLoadingContext().setForceRunReport(true);
}
_f3b.execute();
_f38=true;
}
this.m_handleDrill=true;
return _f38;
}));
},setDoGetParametersOnLoad:function(_f3c){
this.m_doGetParametersOnLoad=_f3c;
},getDoGetParametersOnLoad:function(){
return this.m_doGetParametersOnLoad;
},onPromptLegacyPayload:function(evt){
try{
if(evt.payload.cv_id===this.iContext.widgetId){
return false;
}
var _f3e=null;
this.getLoadManager().runWhenHasViewer(dojo.hitch(this,function(_f3f){
_f3e=false;
if(this.isSavedOutput()){
return _f3e;
}
if(this.promptParametersRetrieved===false){
var _f40=this.getViewerObject().getAction("GetParameters");
_f40.setRequestParms(evt.payload);
_f40.execute();
_f3e=true;
}else{
_f3e=this.sharePrompts(evt.payload);
}
return _f3e;
}));
return _f3e;
}
catch(e){
return false;
}
},sharePrompts:function(_f41){
var _f42=this.getViewerObject().getAction("SharePrompt");
_f42.setRequestParms(_f41);
if(this.shouldReportBeRunOnAction()){
var _f43=this.getViewerObject().getDrillResetHUNs(_f41);
if(!_f43||_f43.length===0){
return _f42.executePrompt();
}else{
var _f44={"drilledResetHUNs":_f43,"promptValues":_f42.getPromptValues()};
this.getViewerObject().executeAction("DrillReset",_f44);
}
return true;
}
var _f45=this.getLoadManager().getDelayedLoadingContext();
_f45.setPromptValues(_f42.getPromptValues());
_f45.setCascadingPromptParamsToClear(_f41.clearCascadePromptParams);
return false;
},onGenericPrompt:function(evt){
this.clearRAPCacheFilterValues();
this.m_oWidgetContextManager.handleIncomingPromptEvent(evt);
},setPromptParametersRetrieved:function(_f47){
this.promptParametersRetrieved=_f47;
},getEnvParam:function(_f48){
return this.getViewerObject().envParams[_f48];
},destroy:function(){
var _f49=this.getViewerObject();
if(_f49){
if(this.isSelectionFilterEnabled()){
if(this.selectionFilterSent()){
this.clearSelectionFilter();
}
}
if(this.onUnloadInProgress){
_f49.destroy(false);
}else{
_f49.destroy(true);
}
var _f4a=function(_f4b){
if(_f4b&&_f4b.parentNode&&_f4b.parentNode.removeChild){
_f4b.parentNode.removeChild(_f4b);
}
};
var _f4c=dojo.query("[namespaceId='"+this.getViewerId()+"'],[namespaceId='"+this.m_sScriptLoaderNamespace+"']",document.getElementsByTagName("head").item(0));
if(_f4c&&_f4c.length>0){
_f4c.forEach(_f4a);
}
_f4c=dojo.query("> [namespaceId=\""+this.getViewerId()+"\"]",document.getElementsByTagName("body").item(0));
if(typeof _f4c!="undefined"&&_f4c&&_f4c.length>0){
_f4c.forEach(_f4a);
}
if(this.getAnnotationHelper()){
this.getAnnotationHelper()._cleanupPreviousAnnotations();
}
}
if(this.annotationHelper){
this.annotationHelper.m_viewerIWidget=null;
}
this.annotationHelper=null;
if(this.savedOutput){
this.savedOutput.iWidget=null;
}
this.savedOutput=null;
if(this.m_oLoadManager){
this.m_oLoadManager.m_oWidget=null;
}
this.m_oLoadManager=null;
if(this.m_oWidgetContextManager){
this.m_oWidgetContextManager.m_widget=null;
}
this.m_oWidgetContextManager=null;
this.removeWindowEventListeners();
if(this.undoRedoQueue){
GUtil.destroyProperties(this.undoRedoQueue);
delete this.undoRedoQueue;
}
GUtil.destroyProperties(this.getAnnotationStore());
delete this.getAnnotationStore();
GUtil.destroyProperties(this.savedOutput);
delete this.savedOutput;
delete this.m_oCV;
_f49=null;
},setSavedOutputsCMResponse:function(_f4d){
this.savedOutputsCMResponse=_f4d;
if(_f4d==null){
var _f4e=this.getViewerObject().getActionFactory();
var _f4f=_f4e.load("Snapshots");
_f4f.resetMenu();
}
},getSavedOutputsCMResponse:function(){
if(typeof this.savedOutputsCMResponse=="undefined"||this.savedOutputsCMResponse==null){
return null;
}
return this.savedOutputsCMResponse;
},setSavedOutputSearchPath:function(_f50){
this.m_savedOutputSearchPath=_f50;
},getSavedOutputSearchPath:function(){
if(typeof this.m_savedOutputSearchPath=="undefined"){
return null;
}
return this.m_savedOutputSearchPath;
},initializeProperties:function(){
if(this.properties){
var _f51=this.getViewerObject();
this.properties.initialize(_f51.envParams);
}
},addToRAPCache:function(name,_f53){
if(!this.m_RAPCache){
this.m_RAPCache={};
}
this.m_RAPCache[name]=_f53;
},getRAPCachedItem:function(name){
if(this.m_RAPCache&&typeof this.m_RAPCache[name]!="undefined"){
return this.m_RAPCache[name];
}
return null;
},clearRAPCacheFilterValues:function(){
for(var key in this.m_RAPCache){
if(key.indexOf("filterValues.")===0){
delete this.m_RAPCache[key];
}
}
},clearRAPCache:function(){
this.m_RAPCache=null;
},reset:function(){
this.m_bCallGetAnnotations=true;
this.promptParametersRetrieved=false;
this.getViewerObject().envParams["reportPrompts"]="";
this.setSavedOutputsCMResponse(null);
this.getUndoRedoQueue().clearQueue();
if(this.isSelectionFilterEnabled){
this.clearSelectionFilter();
}
this.m_bSelectionFilterSwitch=false;
},handleFault:function(){
if(typeof console!="undefined"&&console&&console.log){
console.log("ViewrIWidget:handle fault is deprecated and should not be used anymore.");
}
var _f56=this.getViewerObject();
var _f57=new RequestHandler(_f56);
_f57.onFault();
},disableListenToForGlobalPrompt:function(){
this.fireEvent("com.ibm.bux.widget.updateEventFilter",null,{"*":{blockedEvents:["com.ibm.widget.contextChanged.prompt"]}});
var _f58=this.getViewerObject();
if(window.gaRV_INSTANCES){
var _f59={};
_f59[this.iContext.widgetId]={blockedEvents:["com.ibm.widget.contextChanged.prompt"]};
for(var _f5a=0;_f5a<window.gaRV_INSTANCES.length;_f5a++){
if(window.gaRV_INSTANCES[_f5a].getId()!=_f58.getId()){
var _f5b=window.gaRV_INSTANCES[_f5a].getViewerWidget();
if(_f5b){
_f5b.iContext.iEvents.fireEvent("com.ibm.bux.widget.updateEventFilter",null,_f59);
}
}
}
}
},disableListenToForEvent:function(_f5c){
this.fireEvent("com.ibm.bux.widget.updateEventFilter",null,{"*":{blockedEvents:_f5c}});
var _f5d=this.getViewerObject();
if(window.gaRV_INSTANCES){
var _f5e={};
_f5e[this.iContext.widgetId]={blockedEvents:_f5c};
for(var _f5f=0;_f5f<window.gaRV_INSTANCES.length;_f5f++){
if(window.gaRV_INSTANCES[_f5f].getId()!=_f5d.getId()){
var _f60=window.gaRV_INSTANCES[_f5f].getViewerWidget();
if(_f60){
_f60.iContext.iEvents.fireEvent("com.ibm.bux.widget.updateEventFilter",null,_f5e);
}
}
}
}
},handlePassportErrorFromDispatcher:function(){
if(this.viewerWidgetLastAction){
var _f61=GUtil.generateCallback(this[this.viewerWidgetLastAction.functionName],this.viewerWidgetLastAction.param,this);
dojo["require"]("bux.dialogs.IFrameDialog");
var _f62=new bux.dialogs.LogonDialog({okHandler:_f61,cancelHandler:dojo.hitch(this,function(){
this.fireEvent("com.ibm.bux.widget.action",null,{action:"deleteWidget"});
})});
_f62.startup();
_f62.show();
}
},showErrorMessage:function(_f63){
var _f64=this.getViewerObject();
if(_f64){
this.m_widgetErrorDlg=new FaultMessageDialog(_f64,_f63);
this.m_widgetErrorDlg.renderInlineDialog();
}
},getErrorDlg:function(){
if(this.m_widgetErrorDlg){
return this.m_widgetErrorDlg;
}
return null;
},setErrorDlg:function(dlg){
this.m_widgetErrorDlg=dlg;
},clearErrorDlg:function(dlg){
if(this.getErrorDlg()!==null){
this.m_widgetErrorDlg.ok();
}
},onOpen:function(evt){
if(evt&&evt.payload&&evt.payload.author){
this.m_sDashboardOwnerId=evt.payload.author.cm$searchPath;
}
},onNotifyPreviousEventsAreDone:function(evt){
this.m_resizeReady=true;
},isDashboardOwner:function(){
if(typeof this.m_sDashboardOwnerId!=="undefined"&&typeof this.m_sUserId!=="undefined"){
return this.m_sDashboardOwnerId===this.m_sUserId;
}
},isCurrentUser:function(user){
return this.m_sUserId===user;
},findContainerDiv:function(){
var _f6a=dojo.byId("RVContent"+this.getViewerObject().getId());
var _f6b=_f6a;
while(_f6b){
if(_f6b.style&&_f6b.style.height&&_f6b.style.height.indexOf("px")!=-1){
return _f6b;
}
_f6b=_f6b.parentNode;
}
if(typeof console!="undefined"&&console&&console.log){
console.log("ViewrIWidget: Could not find the container div.");
}
return _f6a;
},getPaneOnRight:function(){
return this.getAttributeValue("paneOnRight");
},getWidgetContextManager:function(){
return this.m_oWidgetContextManager;
},getInfoBarRenderedState:function(){
return this.m_oInfoBarRenderedState;
},refreshInfoBarRenderedState:function(_f6c){
var len=_f6c.length;
var _f6e={};
for(var idx=0;idx<len;idx++){
var sId=_f6c[idx];
if(this.m_oInfoBarRenderedState[sId]){
_f6e[sId]=this.m_oInfoBarRenderedState[sId];
}
}
this.m_oInfoBarRenderedState=_f6e;
},onGetWidgetContext:function(_f71){
var _f72=this.getWidgetContextManager().getWidgetContextObject();
if(!_f72){
_f72={};
}
this.fireEvent("com.ibm.widget.context.get.done",null,_f72);
},onGetCanvasContextDone:function(evt){
},onSetVisible:function(evt){
if(this.m_debugDelayedViewerLoadingMode===2){
return;
}
if(evt&&evt.payload){
this.m_visible=evt.payload.isVisible?true:false;
if(!this.m_visible){
if(this._cssLimitReached){
this.cleanupStyles();
}
return;
}
if(!this.getLoadManager().isViewerLoadInitiated()){
this.postReport(null);
}else{
this._updateOnVisible();
}
}
},_updateOnVisible:function(){
var _f75=this.getLoadManager();
if(_f75.isViewerReady()){
var oCV=this.getViewerObject();
if(this._cssLimitReached){
this.reloadStyles();
}
if(this.isSavedOutput()){
_f75.getDelayedLoadingContext().setForceRunReport(false);
return;
}
if(!_f75.getDelayedLoadingContext().isEmpty()){
_f75.runWhenHasViewer(function(){
_f75.runningReport();
var _f77=oCV.getActionFactory();
var _f78=_f77.load("BuxRunReport");
var _f79=_f75.getDelayedLoadingContext();
var _f7a={promptValues:_f79.getPromptValues(),clearCascadeParamsList:_f79.getCascadingPromptParamsToClear()};
_f78.setRequestParams(_f7a);
if(!oCV.getConversation()){
_f78.setSendParameterValues(true);
}
var _f7b=_f78.execute();
_f75.getDelayedLoadingContext().reset();
return _f7b;
});
}else{
if(oCV.getPinFreezeManager()){
oCV.getPinFreezeManager().onSetVisible();
}
}
}else{
_f75.setOnEmptyCallback(dojo.hitch(this,function(){
if(this.isVisible()){
this._updateOnVisible();
}
}));
}
},shouldReportBeRunOnAction:function(){
return (this.isVisible()&&this.getLoadManager().isViewerLoaded()&&this.getLoadManager().canRunReports());
},isVisible:function(){
if(this.m_debugDelayedViewerLoadingMode===2){
return true;
}
if(this.m_visible===null){
var _f7c=this.iContext.getItemSet("buxdelayedload",false);
if(_f7c){
this.m_visible=(_f7c.getItemValue("widgetVisible")==="true");
}else{
this.m_visible=true;
}
}
return this.m_visible;
},isPastedWidget:function(){
return this._pastedWidget;
},setWidgetCopyPasteParameters:function(){
this.copyPasteResource=this.getAttributeValue("resource");
if(this.copyPasteResource){
this._pastedWidget=true;
if(this.getAttributeValue("copy.ciPublishedReportPath")&&this.getAttributeValue("originalReport")==null&&this.getSavedItem()==null){
this.ciPublishedReportPath=this.getAttributeValue("copy.ciPublishedReportPath");
}else{
if(this.getAttributeValue("originalReport")==null){
this.ciPublishedReportPath=this.getSavedItem();
this.setAttributeValue("copy.ciPublishedReportPath",this.ciPublishedReportPath);
}
}
this.removeAttributeValue("savedReportPath");
this.removeAttributeValue("savedReportPath.resource");
this.removeAttributeValue("resource");
}
},postSetWidgetCopyPasteParameters:function(){
if(this.copyPasteResource){
this.removeAttributeValue("copy.conversation");
this.copyPasteResource=null;
}
},isSelectionFilterEnabled:function(){
return this.m_bSelectionFilterSwitch;
},toggleSelectionFilterSwitch:function(){
this.m_bSelectionFilterSwitch=!this.isSelectionFilterEnabled();
var _f7d=this.getViewerObject().getSelectionController();
if(_f7d){
if(this.isSelectionFilterEnabled()){
_f7d.setSelectionStyles(_f7d.FILTER_SELECTION_STYLE);
_f7d.repaintSelections();
}else{
_f7d.resetAll();
}
}
},preprocessPageClicked:function(_f7e,evt){
if(!this.isSelectionFilterEnabled()){
return;
}
var _f80=this.getViewerObject().getSelectionController();
_f80.setAllowHorizontalDataValueSelection(true);
if(_f7e){
if(!_f80.hasSavedSelections()){
_f80.saveSelections();
}
_f80.setSelectionStyles(_f80.FILTER_SELECTION_CONTEXT_MENU_STYLE);
}else{
_f80.setSelectionStyles(_f80.FILTER_SELECTION_STYLE);
_f80.clearSavedSelections();
}
},ignoreEvent:function(evt){
stopEventBubble(evt);
},updateDrillThroughLinks:function(){
var oCV=this.getViewerObject();
if(!oCV){
return;
}
var _f83=this.isSelectionFilterEnabled();
var _f84=oCV.envParams["ui.action"]=="view"||oCV.envParams["ui.action"]=="buxView";
var _f85=_f83?"":"_temp";
var _f86=_f83?"_temp":"";
var _f87=["onclick","onkeypress","style"];
var _f88=_f84?"onclick"+_f85:"dttargets";
var _f89=document.getElementById("RVContent"+oCV.getId());
var _f8a=getElementsByAttribute(_f89,"*",_f88);
if(!_f8a){
return;
}
for(var i=0;i<_f8a.length;i++){
var node=_f8a[i];
if(node.nodeName.toLowerCase()!=="area"){
if(_f84){
var _f8d=node.getAttribute("onclick"+_f85);
if(!_f8d||(_f8d.indexOf("doSingleDrillThrough")==-1&&_f8d.indexOf("doMultipleDrillThrough"))){
continue;
}
for(var ii=0;ii<_f87.length;ii++){
var _f8f=_f87[ii];
if(node.getAttribute(_f8f+_f85)){
this._renameAttribute(node,_f8f+_f85,_f8f+_f86);
}
}
}
this._updateCellStyle(node,_f83);
}
}
},_updateCellStyle:function(node,_f91){
if(node.nodeType==3){
return;
}
if(_f91&&node.className==="hy"){
this._renameAttribute(node,"class","class_temp");
}else{
if(!_f91&&node.getAttribute("class_temp")){
this._renameAttribute(node,"class_temp","class");
}
}
if(node.childNodes){
for(i=0;i<node.childNodes.length;i++){
this._updateCellStyle(node.childNodes[i],_f91);
}
}
},_renameAttribute:function(node,_f93,_f94){
node.setAttribute(_f94,node.getAttribute(_f93));
node.removeAttribute(_f93);
},addButtonToSavedToolbarButtons:function(name,_f96,_f97){
if(typeof name!="undefined"&&name!=null){
this.savedToolbarButtons[name]={};
this.savedToolbarButtons[name]["button"]=_f96;
this.savedToolbarButtons[name]["position"]=_f97;
}
},getButtonFromSavedToolbarButtons:function(name){
return this.savedToolbarButtons[name];
},removeFromSavedToolbarButtons:function(name){
if(typeof this.savedToolbarButtons[name]!="undefined"&&this.savedToolbarButtons[name]!=null){
delete this.savedToolbarButtons[name];
}
}});
function UndoRedoQueue(_f9a){
this.m_queue=[];
this.m_queueLimit=20;
this.m_iCurrentPos=0;
this.m_widget=_f9a;
this.m_bUndoRedoCalled=false;
this.m_lastAction=null;
this.currentUndoObj=null;
this.beenUsed=false;
this.m_originalSpec=null;
};
UndoRedoQueue.prototype.setOriginalSpec=function(spec){
if(this.m_queue.length==0){
this.m_originalSpec=spec;
}
};
UndoRedoQueue.prototype.clearQueue=function(){
while(this.m_queue.length>0){
this.m_queue.pop();
}
this.m_iCurrentPos=0;
};
UndoRedoQueue.prototype.getPosition=function(){
return this.m_iCurrentPos;
};
UndoRedoQueue.prototype.hasBeenUsed=function(){
return this.beenUsed;
};
UndoRedoQueue.prototype.getLength=function(){
return this.m_queue.length;
};
UndoRedoQueue.prototype.initUndoObj=function(obj){
if(this.m_queue.length==0){
var oCV=this.m_widget.getViewerObject();
var spec=this.m_originalSpec==null?oCV.envParams["ui.spec"]:this.m_originalSpec;
this.m_originalSpec=null;
this.m_queue.push({"spec":spec,"parameters":oCV.getExecutionParameters(),"tooltip":obj.tooltip,"infoBar":oCV.envParams["rapReportInfo"],"widgetProperties":this.m_widget.getProperties().getOldProperties(),"hasAVSChart":oCV.hasAVSChart(),"undoType":"server"});
this.m_iCurrentPos=this.m_queue.length-1;
this.beenUsed=true;
}
this.currentUndoObj=obj;
};
UndoRedoQueue.prototype.add=function(obj){
if(this.m_bUndoRedoCalled){
this.m_bUndoRedoCalled=false;
return;
}else{
if(this.currentUndoObj==null){
return;
}else{
if(obj.reportUpdated==true){
while(this.m_queue.length>this.m_queueLimit){
this.m_queue.shift();
}
this.clearEnd();
var _fa0=this.m_widget.getViewerObject();
if(this.currentUndoObj.saveSpec==true||_fa0.envParams["ui.doNotUseConversationForUndo"]==="true"){
this.currentUndoObj.spec=_fa0.envParams["ui.spec"];
this.currentUndoObj.parameters=_fa0.getExecutionParameters();
}else{
this.currentUndoObj.conversation=_fa0.getConversation();
}
if(_fa0.envParams["rapReportInfo"]){
this.currentUndoObj.infoBar=_fa0.envParams["rapReportInfo"];
}
this.currentUndoObj.widgetProperties=this.m_widget.getProperties().getUndoInfo();
this.currentUndoObj.palette=_fa0.m_sPalette;
if(this.m_widget.getProperties().getFlashCharts()){
this.currentUndoObj.hasAVSChart=_fa0.hasAVSChart();
}
this.currentUndoObj.undoType="server";
this.finalizeAdd();
}
}
}
};
UndoRedoQueue.prototype.addClientSideUndo=function(obj){
if(this.m_bUndoRedoCalled){
this.m_bUndoRedoCalled=false;
return;
}
if(obj.undoCallback&&obj.redoCallback){
this.initUndoObj(obj);
this.currentUndoObj.undoType="client";
this.finalizeAdd();
}
};
UndoRedoQueue.prototype.finalizeAdd=function(){
this.m_queue.push(this.currentUndoObj);
this.m_iCurrentPos=this.m_queue.length-1;
this.m_bUndoRedoCalled=false;
this.m_lastAction="";
this.currentUndoObj=null;
this.beenUsed=true;
};
UndoRedoQueue.prototype.moveBack=function(){
if(this.m_iCurrentPos<=0){
return null;
}
var _fa2=this.m_queue[this.m_iCurrentPos].undoType;
this.m_bUndoRedoCalled=true;
this.m_lastAction="undo";
this.m_iCurrentPos--;
this.m_viewerState={"parameters":this.m_widget.getViewerObject().getExecutionParameters(),"spec":this.m_widget.getViewerObject().envParams["ui.spec"]};
if(typeof this.m_queue[this.m_iCurrentPos]!="undefined"){
this.m_widget.getViewerObject().m_sPalette=this.m_queue[this.m_iCurrentPos].palette;
if(_fa2=="client"){
return this.m_queue[this.m_iCurrentPos+1];
}
var _fa3=this.m_iCurrentPos;
while(_fa3>0&&this.m_queue[_fa3]&&this.m_queue[_fa3].undoType!="server"){
_fa3--;
}
return this.m_queue[_fa3];
}
return null;
};
UndoRedoQueue.prototype.moveForward=function(){
if(this.m_iCurrentPos>=this.m_queue.length){
return null;
}
this.m_bUndoRedoCalled=true;
this.m_iCurrentPos++;
this.m_lastAction="redo";
this.m_viewerState={"parameters":this.m_widget.getViewerObject().getExecutionParameters(),"spec":this.m_widget.getViewerObject().envParams["ui.spec"]};
if(typeof this.m_queue[this.m_iCurrentPos]!="undefined"){
this.m_widget.getViewerObject().m_sPalette=this.m_queue[this.m_iCurrentPos].palette;
return this.m_queue[this.m_iCurrentPos];
}
return null;
};
UndoRedoQueue.prototype.clearEnd=function(){
while(this.m_queue.length-1>this.m_iCurrentPos){
this.m_queue.pop();
}
};
UndoRedoQueue.prototype.handleCancel=function(){
if(this.m_lastAction=="undo"){
this.m_iCurrentPos++;
}else{
if(this.m_lastAction=="redo"){
this.m_iCurrentPos--;
}
}
if(this.m_lastAction=="redo"||this.m_lastAction=="undo"){
var _fa4=this.m_widget.getProperties();
var _fa5=this.m_queue[this.m_iCurrentPos];
if(_fa4&&_fa5&&_fa5.widgetProperties){
_fa4.doUndo(_fa5.widgetProperties);
}
}
this.m_lastAction="";
this.m_bUndoRedoCalled=false;
this.currentUndoObj=null;
};
UndoRedoQueue.prototype.handleFault=function(){
this.currentUndoObj=null;
this.m_bUndoRedoCalled=false;
};
UndoRedoQueue.prototype.getUndoTooltip=function(){
if(this.m_iCurrentPos>0){
return RV_RES.IDS_JS_UNDO+" "+this.m_queue[this.m_iCurrentPos].tooltip;
}
return RV_RES.IDS_JS_UNDO;
};
UndoRedoQueue.prototype.getRedoTooltip=function(){
if(this.m_iCurrentPos<(this.m_queue.length-1)){
return RV_RES.IDS_JS_REDO+" "+this.m_queue[this.m_iCurrentPos+1].tooltip;
}
return RV_RES.IDS_JS_REDO;
};
function CIWidgetSavedOutput(_fa6){
this.iWidget=_fa6;
this.bContainsChart=false;
this.bContainsDrillThrough=false;
this.bPagedOutput=true;
};
CIWidgetSavedOutput.prototype.getIWidget=function(){
return this.iWidget;
};
CIWidgetSavedOutput.prototype.isPagedOutput=function(){
return this.bPagedOutput;
};
CIWidgetSavedOutput.prototype.setPagedOutput=function(_fa7){
this.bPagedOutput=_fa7;
};
CIWidgetSavedOutput.prototype.getCognosViewer=function(){
return this.getIWidget().getViewerObject();
};
CIWidgetSavedOutput.prototype.getIframeWindow=function(){
return this.savedOutputWindow;
};
CIWidgetSavedOutput.prototype.getSavedOutputDiv=function(){
return this.savedOutputDiv;
};
CIWidgetSavedOutput.prototype.render=function(){
if(this.isPagedOutput()&&this.getFirstPage()){
this.currentPageIndex=0;
this._showPages([this.getFirstPage()]);
}else{
if(this.tabbedSavedOutput&&this.currentPageIndex&&this.pageNodes){
var _fa8=this.pageNodes[this.currentPageIndex].getAttribute("tabid");
this.switchSavedOutputTab(_fa8);
}else{
if(this.getCognosViewer()&&this.getCognosViewer().getCurrentlySelectedTab()){
this.switchSavedOutputTab(this.getCognosViewer().getCurrentlySelectedTab());
}else{
this.showHTMLFragment(this.getIframeWindow().document.body.innerHTML);
}
}
}
};
CIWidgetSavedOutput.prototype.outputDoneLoading=function(){
if(window["gReportWidgetLoadQueue"]){
window["gReportWidgetLoadQueue"].widgetDoneLoading(this.getIWidget());
}
this.getIWidget().setOriginalFormFields(null);
var _fa9=this.getCognosViewer();
var _faa=_fa9.getId();
this.savedOutputWindow=dojo.byId("CVHiddenIFrame"+_faa).contentWindow;
this.savedOutputDiv=dojo.byId("CVSavedOutputDiv"+_faa);
var sc=_fa9.getSelectionController();
if(!sc.hasContextData()&&this.savedOutputWindow.onLoadEvent){
this.savedOutputWindow.onLoadEvent();
}
this._populatePageNode();
var _fac=dojo.byId("_"+this.iWidget.iContext.widgetId+"_cv");
this.loadStyleInfoFromIframe(_fac);
this.bContainsChart=typeof this.savedOutputWindow.displayChart=="function"?true:false;
this.bContainsDrillThrough=typeof this.savedOutputWindow.drillThroughTarget!="undefined"?true:false;
this.render();
this.getMetaDataFromIFrame();
if(this.bContainsDrillThrough){
window[_faa+"drillTargets"]=this.getIframeWindow().drillTargets;
}
_fa9.fillInContextData();
_fa9.updateBorderCollapse();
this.getIWidget().updateToolbar();
_fa9.setReportRenderingDone(true);
var _fad=GUtil.generateCallback(this.getIWidget().fetchAnnotationData,[],this.getIWidget());
var _fae=this.getPageContextData(_fad);
if(_fae==0){
this.getIWidget().fetchAnnotationData();
}
this.fixDuplicateFormFields();
this.getIWidget().getLoadManager().processQueue();
delete _fa9.envParams["cv.outputKey"];
this.getIWidget().setXNodeId(null);
var _faf=this.getIWidget();
var _fb0=function(){
_faf.iContext.iEvents.fireEvent("com.ibm.bux.widget.render.done",null,{});
_fa9.renderTabs();
if(_fa9.getCurrentlySelectedTab()!=null){
_faf.getSavedOutput().tabbedSavedOutput=true;
_faf.getSavedOutput().switchSavedOutputTab(_fa9.getCurrentlySelectedTab());
}
};
setTimeout(_fb0,100);
};
CIWidgetSavedOutput.prototype._populatePageNode=function(){
this.pageNodes=[];
var node=this.getIframeWindow().document.body.firstChild;
while(node){
if(node.nodeName.toLowerCase()=="table"){
this.pageNodes.push(node);
}
node=node.nextSibling;
}
};
CIWidgetSavedOutput.prototype.switchSavedOutputTab=function(_fb2,_fb3){
if(!this.pageNodes){
return;
}
if(_fb3){
if(!this.lastVisitedPage){
this.lastVisitedPage={};
}
if(this.isPagedOutput()){
var _fb4=this.pageNodes[this.currentPageIndex].getAttribute("tabid");
this.lastVisitedPage[_fb4]=this.currentPageIndex;
if(this.lastVisitedPage[_fb2]){
this.currentPageIndex=this.lastVisitedPage[_fb2];
this._showPages([this.pageNodes[this.currentPageIndex]]);
return;
}
}
}
var _fb5=[];
for(var i=0;i<this.pageNodes.length;i++){
var node=this.pageNodes[i];
if(node&&node.getAttribute&&node.getAttribute("tabid")==_fb2){
_fb5.push(node);
this.currentPageIndex=i;
if(this.isPagedOutput()){
break;
}
}
}
this._showPages(_fb5);
};
CIWidgetSavedOutput.prototype.fixDuplicateFormFields=function(){
var _fb8=document.getElementById("formWarpRequest"+this.getCognosViewer().getId());
if(_fb8){
for(var _fb9=0;_fb9<_fb8.elements.length;_fb9++){
var name=_fb8.elements[_fb9].name;
if(name&&name.length>0){
if(_fb8[name].length>1){
var _fbb=_fb8[name][_fb8[name].length-1].value;
while(_fb8[name].length>1){
_fb8[name][1].parentNode.removeChild(_fb8[name][1]);
}
if(_fb8[name][0]){
_fb8[name][0].value=_fbb;
}
_fb8[name].value=_fbb;
}
}
}
}
};
CIWidgetSavedOutput.prototype.getPageContextData=function(_fbc){
var _fbd={};
dojo.query("[ctx]",this.getSavedOutputDiv()).forEach(function(item){
var ctx=item.getAttribute("ctx");
var _fc0=ctx.split(":");
for(var i=0;i<_fc0.length;i++){
var _fc2=_fc0[i];
if(_fc2&&_fc2.length>0){
_fbd[_fc2]=true;
}
}
});
var _fc3=[];
for(var item in _fbd){
_fc3.push(item);
}
return this.getCognosViewer().getSelectionController().fetchContextData(_fc3,_fbc);
};
CIWidgetSavedOutput.prototype.loadStyleInfoFromIframe=function(_fc5){
var _fc6=null;
var _fc7=this.savedOutputWindow.document;
for(var _fc8=0;_fc8<_fc7.childNodes.length;_fc8++){
if(_fc7.childNodes[_fc8].childNodes&&_fc7.childNodes[_fc8].childNodes.length>0){
_fc6=_fc7.childNodes[_fc8];
break;
}
}
window.gScriptLoader.loadStyles(_fc6.firstChild,this.iWidget.getViewerId());
var _fc9=dojo.query("link",_fc6);
var _fca="";
for(i=0;i<_fc9.length;i++){
var href=_fc9[i].getAttribute("href");
if(href){
_fca+="<link href=\""+href+"\" />";
}
}
window.gScriptLoader.loadCSS(_fca,_fc5,true,this.iWidget.getViewerId());
};
CIWidgetSavedOutput.prototype.getFirstPage=function(){
return this.pageNodes[0];
};
CIWidgetSavedOutput.prototype.getLastPage=function(){
return this.pageNodes?this.pageNodes[this.pageNodes.length-1]:null;
};
CIWidgetSavedOutput.prototype.writeNavLinks=function(){
var _fcc="";
if(this.isPagedOutput()){
if(this.tabbedSavedOutput&&!isNaN(this.currentPageIndex)){
var _fcd=this.pageNodes[this.currentPageIndex].getAttribute("tabid");
if(this.currentPageIndex>0&&this.pageNodes[this.currentPageIndex-1].getAttribute("tabid")==_fcd){
_fcc+=" firstPage previousPage ";
}
if(this.currentPageIndex<(this.pageNodes.length-1)&&this.pageNodes[this.currentPageIndex+1].getAttribute("tabid")==_fcd){
_fcc+=" nextPage lastPage ";
}
}else{
if(this.currentPageIndex>0){
_fcc+=" firstPage previousPage ";
}
if(this.currentPageIndex<(this.pageNodes.length-1)){
_fcc+=" nextPage lastPage ";
}
}
}
this.getCognosViewer().writeNavLinks(_fcc,true);
};
CIWidgetSavedOutput.prototype.pageAction=function(_fce){
switch(_fce){
case "firstPage":
if(this.tabbedSavedOutput){
var _fcf=this.pageNodes[this.currentPageIndex].getAttribute("tabid");
for(var i=0;i<this.pageNodes.length;i++){
var node=this.pageNodes[i];
if(node&&node.getAttribute&&node.getAttribute("tabid")==_fcf){
this.currentPageIndex=i;
break;
}
}
}else{
this.currentPageIndex=0;
}
break;
case "previousPage":
this.currentPageIndex=this.currentPageIndex-1;
break;
case "nextPage":
this.currentPageIndex=this.currentPageIndex+1;
break;
case "lastPage":
if(this.tabbedSavedOutput){
var _fcf=this.pageNodes[this.currentPageIndex].getAttribute("tabid");
var _fd2=false;
for(var i=0;i<this.pageNodes.length;i++){
var node=this.pageNodes[i];
if(node&&node.getAttribute&&node.getAttribute("tabid")==_fcf){
_fd2=true;
}else{
if(_fd2){
this.currentPageIndex=i-1;
break;
}
}
}
}else{
this.currentPageIndex=this.pageNodes.length-1;
}
break;
}
this._showPages([this.pageNodes[this.currentPageIndex]]);
};
CIWidgetSavedOutput.prototype._showPages=function(_fd3){
var oCV=this.getCognosViewer();
oCV.getSelectionController().clearSelectedObjects();
if(_fd3.length==1){
this.showHTMLFragment(_fd3[0].innerHTML);
}else{
var _fd5="";
for(var i=0;i<_fd3.length;i++){
_fd5+=_fd3[i].innerHTML;
}
this.showHTMLFragment(_fd5);
}
this.writeNavLinks();
if(this.tabbedSavedOutput&&this.lastVisitedPage){
this.getIWidget().placeTabControlInView();
}else{
oCV.setKeepFocus(true);
}
oCV.doneLoadingUpdateA11Y("complete");
var _fd7=GUtil.generateCallback(this.getIWidget().fetchAnnotationData,[],this.getIWidget());
var _fd8=this.getPageContextData(_fd7);
if(_fd8==0){
this.getIWidget().fetchAnnotationData();
}
};
CIWidgetSavedOutput.prototype.getMetaDataFromIFrame=function(){
if(typeof this.getIframeWindow().getSelectionController=="function"){
var _fd9=this.getIframeWindow().getSelectionController();
if(_fd9){
var _fda=this.getCognosViewer().getSelectionController();
_fda.addMetaData(_fd9.getCCDManager().m_md);
_fda.addContextData(_fd9.getCCDManager().m_cd);
_fda.setSelectionBasedFeaturesEnabled(true);
}
}
};
CIWidgetSavedOutput.prototype.processDrillThrough=function(_fdb){
if(this.bContainsDrillThrough&&(typeof this.bOldOutput=="undefined"||this.bOldOutput==true)){
var _fdc=new RegExp("onclick=\"doSingleDrillThrough[^\"]*\"|onclick='doMultipleDrillThrough[^']*'","gim");
var aM=_fdb.match(_fdc);
if(aM){
if(typeof this.bOldOutput=="undefined"&&aM.length>0&&aM[0].indexOf("'_THIS_'")>0){
this.bOldOutput=false;
}else{
this.bOldOutput=true;
var _fde="";
var quot="'";
if(aM.length>0){
_fde=aM[0].charAt(aM[0].length-1);
}
if(_fde=="'"){
quot="\"";
}
for(var i=0;i<aM.length;i++){
_fdb=_fdb.replace(aM[i],aM[i].substring(0,aM[i].length-3)+","+quot+this.getCognosViewer().getId()+quot+");"+_fde);
}
}
}
}
return _fdb;
};
CIWidgetSavedOutput.prototype.processChart=function(_fe1){
if(isIE()){
_fe1=_fe1.replace(/preSelectNode\(event\);/g,getCognosViewerObjectRefAsString(this.getCognosViewer().getId())+".pcc(event);");
}else{
_fe1=_fe1.replace(/preSelectNode\(event\);/g,"");
}
var _fe2=this.getCognosViewer().getId();
var _fe3=document.getElementById("CVHiddenIFrame"+_fe2);
var _fe4=_fe3.src;
if(_fe4.indexOf("repository")>=0){
var _fe5=_fe4.indexOf("content");
var _fe6=_fe4.substring(0,_fe5);
_fe1=_fe1.replace(/src\=\"images\//g,"src=\""+_fe6+"images/");
}
_fe1=this.fixupChartUseMapValue(_fe1);
return _fe1.replace(/displayChart[^;].*;|var graphicSrc[^;].*;|var graphicName[^;].*;/g,"");
};
CIWidgetSavedOutput.prototype.fixupChartUseMapValue=function(_fe7){
var re=/usemap\s*=\s*"*#(\w+)"*/gi;
var _fe9,_fea=[];
while((_fe9=re.exec(_fe7))){
_fea.push(_fe9[1]);
}
for(var i=0;i<_fea.length;i++){
var _fec=new RegExp(_fea[i],"g");
_fe7=_fe7.replace(_fec,_fea[i]+this.getCognosViewer().getId());
}
return _fe7;
};
CIWidgetSavedOutput.prototype.showHTMLFragment=function(_fed){
if(this.bContainsChart){
_fed=this.processChart(_fed);
}
_fed=this.processDrillThrough(_fed);
_fed=_fed.replace(/_THIS_/g,this.getCognosViewer().getId());
this.getIWidget().loadStylesAndScripts(_fed,this.getSavedOutputDiv(),false);
this.getIWidget().reselectSelectionFilterObjects();
this.getIWidget().addChromeWhitespaceHandler(this.getCognosViewer().getId());
};
function gInitializeViewer(obj){
if(window.gScriptLoader.hasCompletedExecution()){
var _fef=obj.getViewerObject();
if(_fef&&_fef.inlineScriptsDoneExecuting==true){
clearInterval(obj.timer);
if(typeof _fef.errorOccured!="undefined"){
obj.fireEvent("com.ibm.bux.widget.render.done",null,{});
}else{
if(typeof _fef.getToolbar()!="undefined"){
_fef.setViewerWidget(obj);
if(obj.isSelectionFilterEnabled()){
obj.updateDrillThroughLinks();
}
if(obj.isDashboardOwner()){
_fef.addReportInfo();
}
if(obj.promptParametersRetrieved==true){
var _ff0=obj.getAttributeValue("viewerReportPrompts");
_fef.envParams["reportPrompts"]=_ff0;
}else{
if(_fef.envParams&&_fef.envParams["widget.promptParametersRetrievedOnDrop"]=="true"){
obj.promptParametersRetrieved=true;
}
}
var _ff1=obj.getAttributeValue("syncNewWidgets");
if(_ff1===null||_ff1==="true"){
_ff1=true;
}else{
_ff1=false;
}
if(!_ff1&&(obj.isPastedWidget()||obj.isOpeningSavedDashboard()==false)){
obj.disableListenToForEvent(["com.ibm.widget.contextChanged.drill","com.ibm.widget.contextChanged.prompt","com.ibm.widget.contextChanged"]);
}
obj.fireEvent("com.ibm.bux.widget.setShowBordersWhenInnactive",null,(_fef.m_flashChartsObjectIds.length!==0));
}
}
}
}
};
function gVWEvent(sId,evt,_ff4){
var oCV=window["oCV"+sId];
if(oCV){
oCV.loadExtra();
var _ff6=oCV.getViewerWidget();
if(_ff6){
_ff6[_ff4](evt);
}
}
};
function ReportWidgetLoadQueue(_ff7){
this._concurrentLoadSetting=_ff7;
this._widgetsRunning=[];
this._queue=[];
};
ReportWidgetLoadQueue.prototype.add=function(_ff8){
this._queue.push(_ff8);
this.loadNextWidget();
};
ReportWidgetLoadQueue.prototype.widgetDoneLoading=function(_ff9){
for(var i=0;i<this._widgetsRunning.length;++i){
var _ffb=this._widgetsRunning[i];
if(_ffb==_ff9){
this._widgetsRunning.splice(i,1);
break;
}
}
this.loadNextWidget();
};
ReportWidgetLoadQueue.prototype.loadNextWidget=function(){
if(this._widgetsRunning.length<this._concurrentLoadSetting){
var _ffc=this._queue.shift();
if(typeof _ffc!="undefined"){
this._widgetsRunning.push(_ffc);
_ffc.postReport(null);
}
}
};
function CognosViewerAnnotation(){
this.m_oCV=null;
};
CognosViewerAnnotation.prototype.setCognosViewer=function(oCV){
this.m_oCV=oCV;
};
CognosViewerAnnotation.prototype.getCognosViewer=function(){
return this.m_oCV;
};
CognosViewerAnnotation.prototype.isEnabled=function(_ffe){
};
CognosViewerAnnotation.prototype.areAnnotationsEnabled=function(){
var _fff=this.m_oCV.getViewerWidget();
return _fff.getAnnotationHelper().isEnabled();
};
CognosViewerAnnotation.prototype.getMenuItemBaseString=function(){
};
CognosViewerAnnotation.prototype.getMenuItemIconClass=function(){
};
CognosViewerAnnotation.prototype.getSelections=function(){
var _1000=[];
var _1001=this.getCognosViewer();
if(_1001){
var _1002=_1001.getSelectionController();
if(_1002){
_1000=_1002.getSelections();
}
}
return _1000;
};
CognosViewerAnnotation.prototype.hasAnnotation=function(){
var has=false;
var _1004=this.getCognosViewer();
if(_1004){
var _1005=_1004.getViewerWidget();
if(_1005){
var store=_1005.getAnnotationStore();
if(store){
has=store.hasAnnotation();
}
}
}
return has;
};
function CognosViewerCellAnnotation(){
};
CognosViewerCellAnnotation.prototype=new CognosViewerAnnotation();
CognosViewerCellAnnotation.prototype.getMenuItemString=function(_1007){
var _1008=_1007;
var _1009=this.getSelections();
if(_1009&&_1009.length==1){
var sel=_1009[0];
_1008=sel.getDisplayValues()[0];
}
var text=this.getMenuItemBaseString();
if(_1008&&_1008.length>0){
text+=" - "+enforceTextDir(_1008);
}
return text;
};
CognosViewerCellAnnotation.prototype.hasAnnotaionsOnSelectedCell=function(){
var _100c=this.getSelections();
if(_100c&&_100c.length==1){
var _100d=_100c[0].getCellRef();
var ctxId=this.getCognosViewer().findCtx(_100d);
var _100f=this.getCognosViewer().getViewerWidget();
if(_100f){
var _1010=_100f.getAnnotationStore();
if(_1010){
var _1011=_1010.get(ctxId);
if(_1011&&_1011.length>0){
return true;
}
}
}
}
return false;
};
CognosViewerCellAnnotation.prototype.getChangeableAnnotation=function(){
var _1012=this.getSelections();
if(_1012&&_1012.length==1){
var _1013=_1012[0].getCellRef();
var ctxId=this.getCognosViewer().findCtx(_1013);
var _1015=this.getCognosViewer().getViewerWidget();
if(_1015){
var _1016=_1015.getAnnotationStore();
if(_1016){
return _1016.getChangeableAnnotation(ctxId);
}
}
}
return null;
};
CognosViewerCellAnnotation.prototype.hasValidContextOnSelectedCell=function(){
var _1017=this.getSelections();
if(_1017&&_1017.length==1){
var _1018=_1017[0].getCellRef();
var ctxId=this.getCognosViewer().findCtx(_1018);
if(ctxId){
var ids=AnnotationCTXLookup.generateIDArrayFromCellCtxValue(ctxId);
for(var i=0;i<ids.length;i++){
var id=ids[i];
if(id!=="*"&&!(/^\d+$/).test(id)){
return false;
}
}
return true;
}
}
return false;
};
function NewAnnotation(){
};
NewAnnotation.prototype=new CognosViewerCellAnnotation();
NewAnnotation.prototype.isEnabled=function(_101d){
return this.areAnnotationsEnabled()&&(_101d!=="widgetActions")&&this.hasValidContextOnSelectedCell();
};
NewAnnotation.prototype.getMenuItemBaseString=function(){
return RV_RES.IDS_JS_ANNOTATION_NEW;
};
NewAnnotation.prototype.getMenuItemIconClass=function(){
return "NewAnnotation";
};
function EditAnnotation(){
};
EditAnnotation.prototype=new CognosViewerCellAnnotation();
EditAnnotation.prototype.isEnabled=function(_101e){
return this.areAnnotationsEnabled()&&(_101e!=="widgetActions")&&this.getChangeableAnnotation()!==null;
};
EditAnnotation.prototype.getMenuItemBaseString=function(){
return RV_RES.IDS_JS_ANNOTATION_EDIT;
};
EditAnnotation.prototype.getMenuItemIconClass=function(){
return "EditAnnotation";
};
function DeleteAnnotation(){
};
DeleteAnnotation.prototype=new CognosViewerCellAnnotation();
DeleteAnnotation.prototype.isEnabled=function(_101f){
return this.areAnnotationsEnabled()&&(_101f!=="widgetActions")&&this.getChangeableAnnotation()!==null;
};
DeleteAnnotation.prototype.getMenuItemString=function(_1020){
return this.getMenuItemBaseString();
};
DeleteAnnotation.prototype.getMenuItemBaseString=function(){
return RV_RES.IDS_JS_ANNOTATION_DELETE;
};
DeleteAnnotation.prototype.getMenuItemIconClass=function(){
return "DeleteAnnotation";
};
function CognosViewerWidgetAnnotation(){
};
CognosViewerWidgetAnnotation.prototype=new CognosViewerAnnotation();
CognosViewerWidgetAnnotation.prototype.getMenuItemString=function(){
var _1021=this.getCognosViewer().getViewerWidget().getDisplayName();
var text=this.getMenuItemBaseString();
if(_1021&&_1021.length>0){
_1021=enforceTextDir(_1021);
text+=" - "+_1021;
}
return text;
};
CognosViewerWidgetAnnotation.prototype.hasWidgetLevelAnnotations=function(){
var _1023=false;
var _1024=this.getCognosViewer().getViewerWidget();
if(_1024){
var _1025=_1024.getAnnotationStore();
var _1026=_1025.get(_1025.WIDGET_CONTEXT);
if(_1026&&_1026.length>0){
_1023=true;
}
}
return _1023;
};
CognosViewerWidgetAnnotation.prototype.getWidgetLevelChangeableAnnotation=function(){
var _1027=this.getCognosViewer().getViewerWidget();
if(_1027){
var _1028=_1027.getAnnotationStore();
if(_1028){
return _1028.getChangeableAnnotation(_1028.WIDGET_CONTEXT);
}
}
return null;
};
CognosViewerWidgetAnnotation.prototype.hasValidSelection=function(_1029){
var _102a=this.m_oCV.getSelectionController();
var _102b=_102a.getSelections();
var _102c=false;
if(_102a.hasSelectedChartNodes()){
_102c=(_102a.getSelectedChartNodes()[0].m_contextIds.length>0);
}
return (_1029==="widgetActions")||(_102b.length!=1&&!_102c);
};
function NewWidgetAnnotation(){
};
NewWidgetAnnotation.prototype=new CognosViewerWidgetAnnotation();
NewWidgetAnnotation.prototype.isEnabled=function(_102d){
return this.areAnnotationsEnabled()&&(_102d!=="contextMenu")&&this.hasValidSelection(_102d);
};
NewWidgetAnnotation.prototype.getMenuItemBaseString=function(){
return RV_RES.IDS_JS_WIDGET_ANNOTATION_NEW;
};
NewWidgetAnnotation.prototype.getMenuItemIconClass=function(){
return "NewWidgetAnnotation";
};
function EditWidgetAnnotation(){
};
EditWidgetAnnotation.prototype=new CognosViewerWidgetAnnotation();
EditWidgetAnnotation.prototype.isEnabled=function(_102e){
return (this.areAnnotationsEnabled()&&(_102e!=="contextMenu")&&this.hasValidSelection(_102e)&&this.getWidgetLevelChangeableAnnotation())?true:false;
};
EditWidgetAnnotation.prototype.getMenuItemBaseString=function(){
return RV_RES.IDS_JS_WIDGET_ANNOTATION_EDIT;
};
EditWidgetAnnotation.prototype.getMenuItemIconClass=function(){
return "EditWidgetAnnotation";
};
function DeleteWidgetAnnotation(){
};
DeleteWidgetAnnotation.prototype=new CognosViewerWidgetAnnotation();
DeleteWidgetAnnotation.prototype.isEnabled=function(_102f){
return (this.areAnnotationsEnabled()&&(_102f!=="contextMenu")&&this.hasValidSelection(_102f)&&this.getWidgetLevelChangeableAnnotation())?true:false;
};
DeleteWidgetAnnotation.prototype.getMenuItemBaseString=function(){
return RV_RES.IDS_JS_WIDGET_ANNOTATION_DELETE;
};
DeleteWidgetAnnotation.prototype.getMenuItemIconClass=function(){
return "DeleteWidgetAnnotation";
};
function AnnotationCTXLookup(_1030){
this.m_ccdManager=_1030;
this.m_md=this.m_ccdManager.m_md;
this.m_cd=this.m_ccdManager.m_cd;
this.m_RDIVALUE_KEY="annotationHook";
this.m_oContextDetailsMap={};
};
AnnotationCTXLookup.prototype.populateCtxDetailsForAllAnnotations=function(_1031){
for(var i=0,len=_1031.length;i<len;i++){
var anno=_1031[i];
var ctx=anno.ctx;
if(ctx){
this._populateCtxDetailsForOneCtxValue(ctx);
}
}
};
AnnotationCTXLookup.prototype._populateCtxDetailsForOneCtxValue=function(_1036){
if(_1036){
var _1037=this.generateIDArrayFromCellCtxValue(_1036);
for(var i=0,len=_1037.length;i<len;i++){
var id=_1037[i];
this._populateCtxDetailsForOneId(id);
}
}
};
AnnotationCTXLookup.generateIDArrayFromCellCtxValue=function(_103b){
if(_103b){
return _103b.replace(/::/g,":").split(":");
}
return null;
};
AnnotationCTXLookup.prototype.generateIDArrayFromCellCtxValue=AnnotationCTXLookup.generateIDArrayFromCellCtxValue;
AnnotationCTXLookup.prototype._populateCtxDetailsForOneId=function(id){
if(id.match(/\*/)){
return;
}
var _103d=this.m_oContextDetailsMap[id];
if(_103d){
return;
}else{
_103d={};
var _103e=this.m_cd[id];
if(_103e){
if(_103e.u){
_103d["u"]=_103e.u;
}
if(_103e.r){
_103d["r"]=_103e.r;
var _103f=this.m_md[_103e.r];
if(_103f){
if(_103f.usage!=="undefined"){
_103d["usage"]=_103f.usage;
}
if(_103f.dtype){
_103d.dtype=_103f.dtype;
}
}
}
this._populateRdiValueInDetail(_103d,id);
this.m_oContextDetailsMap[id]=_103d;
}
}
};
AnnotationCTXLookup.prototype._getMDValue=function(item,key1,key2){
if(typeof key2=="undefined"){
key2=key1;
}
if(typeof item[key1]!="undefined"&&typeof this.m_md[item[key1]][key2]!="undefined"){
return this.m_md[item[key1]][key2];
}
return null;
};
AnnotationCTXLookup.prototype._findMDValue=function(item,aKeys){
for(var i=0;i<aKeys.length;i++){
var value=this._getMDValue(item,aKeys[i]);
if(value!==null){
return value;
}
}
return null;
};
AnnotationCTXLookup.prototype._populateRdiValueInDetail=function(_1047,id){
var item=this.m_cd[id];
var aKeys=[];
var oRdi={};
oRdi[1]=this._findMDValue(item,["l","h","i","r"]);
if(this._getMDValue(item,"r","usage")==2){
oRdi[2]=this._findMDValue(item,["i","m","r"]);
}
_1047[this.m_RDIVALUE_KEY]=oRdi;
};
AnnotationCTXLookup.prototype.getDetail=function(id){
if(!id){
return null;
}
return this.m_oContextDetailsMap[id];
};
AnnotationCTXLookup.prototype.isAnnotatedId=function(_104d,_104e,id){
if(!_104d||!id){
return false;
}
if(_104d.match(/\*/)){
var _1050=this.getDetail(id);
if(_1050&&_1050[this.m_RDIVALUE_KEY]){
var rdi=_1050[this.m_RDIVALUE_KEY][1];
if(_104e.version>=2&&_1050[this.m_RDIVALUE_KEY][2]){
rdi=_1050[this.m_RDIVALUE_KEY][2];
}
return this._compareWithoutNS(_104e.rdi,rdi);
}else{
return false;
}
}else{
return _104d===id;
}
};
AnnotationCTXLookup.prototype._compareWithoutNS=function(rdi1,rdi2){
if(!rdi1||!rdi2){
return false;
}
if(rdi1!==rdi2){
var _1054=rdi2.indexOf("].[");
if(_1054>0){
return rdi1.lastIndexOf(rdi2.substr(_1054))>0;
}
return false;
}
return true;
};
AnnotationCTXLookup.prototype.isAnnotatedCell=function(_1055,_1056){
if(!_1055||!_1055.ctx||!_1056){
return false;
}
this._populateCtxDetailsForOneCtxValue(_1056);
var _1057=this.generateIDArrayFromCellCtxValue(_1055.ctx);
var _1058=this.generateIDArrayFromCellCtxValue(_1056);
if(!this.isAnnotatedId(_1057[0],_1055,_1058[0])){
return false;
}
var _1059=this._generateDataItemIDArrayFromAnnotationIDs(_1057);
var _105a=this._generateDataItemIDArrayFromCellIDs(_1058);
if(_1059.length>_105a.length){
return false;
}
for(var i=0,len=_1059.length;i<len;i++){
for(var j=0,jLen=_105a.length;j<jLen;j++){
if(_1059[i]===_105a[j]){
_1059[i]=true;
_105a[j]=true;
break;
}
}
}
for(i=0,len=_1059.length;i<len;i++){
if(_1059[i]!==true){
return false;
}
}
for(i=0,len=_105a.length;i<len;i++){
if(_105a[i]!==true){
return false;
}
}
return true;
};
AnnotationCTXLookup.prototype._generateDataItemIDArrayFromCellIDs=function(_105f){
var _1060=[];
for(var i=1,len=_105f.length;i<len;i++){
var id=_105f[i];
var _1064=this.getDetail(id);
if(this._isDataItem(_1064)){
_1060.splice(0,0,id);
}
}
return _1060;
};
AnnotationCTXLookup.dtypeLookup={"1":true,"25":true,"26":true,"27":true,"28":true,"29":true,"30":true,"31":true,"32":true,"34":true,"35":true,"36":true,"43":true,"45":true,"55":true,"56":true};
AnnotationCTXLookup.prototype._isDataItem=function(_1065){
if(_1065){
var usage=_1065.usage;
var dtype=_1065.dtype;
if(usage===0||usage===1||(usage===3&&AnnotationCTXLookup.dtypeLookup[dtype]===true)){
return true;
}
}
return false;
};
AnnotationCTXLookup.prototype._generateDataItemIDArrayFromAnnotationIDs=function(_1068){
var _1069=[];
for(var i=1,len=_1068.length;i<len;i++){
var id=_1068[i];
if(id.match(/\*/)===null){
_1069.splice(0,0,id);
}
}
return _1069;
};
dojo.provide("bux.reportViewer.ReportInfo");
dojo.require("bux.Tooltip");
dojo.declare("bux.reportViewer.ReportInfo",bux.TooltipBase,{templateString:"<div class=\"dijitTooltip dijitTooltipLeft\" id=\"dojoTooltip\">\n\t<div class=\"dijitTooltipContainer dijitTooltipContents\" dojoAttachPoint=\"containerNode\" waiRole='alert'></div>\n\t<div class=\"dijitTooltipConnector\"></div>\n</div>\n",title:"",text:"",linkText:null,linkScript:null,constructor:function(args){
if(args.focusElement){
dojo.connect(args.focusElement,"onfocus",this,"_onHover");
dojo.connect(args.focusElement,"onblur",this,"_onUnHover");
}
},createMarkup:function(){
var _106e=this.connectId+"_linkId";
var _106f=dojo.isIE||dojo.isTrident?"\"#\"":"\"javascript:void(0);\"";
var _1070="";
_1070+="<table role=\"presentation\" class=\"bux-tooltip-table\" cellspacing=\"0\" cellpadding=\"0\">";
_1070+="<tr>";
_1070+="<td class=\"bux-tooltip-title\">";
_1070+=html_encode(this.title);
_1070+="</td>";
_1070+="</tr>";
_1070+="<tr>";
_1070+="<td class=\"bux-tooltip-text\">";
_1070+=html_encode(this.text);
_1070+="</td>";
_1070+="</tr>";
_1070+="<tr>";
if(this.linkScript){
_1070+="<td class=\"bux-tooltip-text\">";
_1070+="<a role=\"link\" id=\""+_106e+"\" href="+_106f+" onmousedown=\""+this.linkScript+"\">"+html_encode(this.linkText)+"</a>";
_1070+="</td>";
}else{
_1070+="<td></td>";
}
_1070+="</tr>";
_1070+="</table>";
return _1070;
}});
dojo.provide("ViewerIWidgetInlineDialog");
dojo.require("dijit._base.focus");
dojo.declare("ViewerIWidgetInlineDialog",null,{constructor:function(oCV,sHTML,_1073,_1074){
this.initialize(oCV,sHTML);
this.m_aButtons=_1073;
this.m_sButtonContainerId=_1074;
},initialize:function(oCV,sHTML){
this.m_oCV=oCV;
this.m_html=sHTML;
this.m_viewerDiv=dojo.byId("RVContent"+this.m_oCV.getId());
this.positionOptions={horizontal:"center",vertical:"center"};
this.onScrollHandle=null;
this.m_dialogDiv=null;
if(this.m_oCV.getViewerWidget){
this.m_background=this.m_oCV.getViewerWidget().getReportBlocker();
}
},setVerticalPositionOption:function(_1077){
this.positionOptions.vertical=_1077;
},getDialogDiv:function(){
return this.m_dialogDiv;
},initializeDialog:function(){
this.m_dialogDiv=document.createElement("div");
dojo.addClass(this.m_dialogDiv,"inlineDialog");
this.m_dialogDiv.style.display="none";
this.m_dialogDiv.innerHTML=this.m_html;
dojo.place(this.m_dialogDiv,this.m_background.getNode().nextSibling,"before");
var _1078=dojo.byId(this.m_sButtonContainerId);
if(_1078&&this.m_aButtons&&this.m_aButtons.length>0){
dojo.forEach(this.m_aButtons,function(_1079){
var span=document.createElement("span");
_1078.appendChild(span);
var _107b=new dijit.form.Button(_1079,span);
});
}
},createBackgroundTabCatchDiv:function(){
if(this.m_tabCatch==null){
this.m_tabCatch=dojo.byId("BACKGROUND_TABCATCH"+this.m_oCV.getId());
if(!this.m_tabCatch){
this.m_tabCatch=document.createElement("div");
this.m_tabCatch.id="BACKGROUND_TABCATCH"+this.m_oCV.getId();
this.m_tabCatch.style.display="none";
this.m_tabCatch.style.position="absolute";
this.m_tabCatch.style.left="0";
this.m_tabCatch.style.top="0";
this.m_tabCatch.style.height="0px";
this.m_tabCatch.style.width="0px";
this.m_tabCatch.setAttribute("tabIndex","0");
if(this.m_viewerDiv.firstChild){
dojo.place(this.m_tabCatch,this.m_viewerDiv.firstChild,"before");
}else{
this.m_viewerDiv.appendChild(this.m_tabCatch);
}
}
}
},initializeBackground:function(){
this.createBackgroundTabCatchDiv();
},initializeKeyboardSupport:function(){
var _107c=dijit._getTabNavigable(this.m_dialogDiv);
var _107d=_107c.lowest||_107c.first;
var _107e=_107c.last||_107c.highest||_107d;
if(_107d){
this.m_tabCatch.onfocus=function(){
dijit.focus(_107d);
};
this.m_background.getNode().onfocus=function(){
dijit.focus(_107d);
};
}
if(_107e&&_107d){
_107e.onblur=function(){
dijit.focus(_107d);
};
}else{
if(_107d){
_107d.onblur=function(){
dijit.focus(_107d);
};
}
}
if(this.m_oCV.getKeepFocus()!=false&&_107d&&_107d.focus){
_107d.focus();
}
},show:function(){
this.m_oCV.setVisibleDialog(this);
if(this.m_tabCatch==null){
this.initializeBackground();
}
if(this.m_dialogDiv==null){
this.initializeDialog();
}
this.m_background.setClassNameOverride("inlineDialog-background-error");
this.m_background.show();
this.m_tabCatch.style.display="block";
this.m_dialogDiv.style.display="block";
this.initializeKeyboardSupport();
},hide:function(){
this.m_oCV.setVisibleDialog(null);
if(this.onScrollHandle!=null){
dojo.disconnect(this.onScrollHandle);
this.onScrollHandle=null;
}
if(this.m_background!=null){
this.m_background.hide();
}
if(this.m_tabCatch!=null){
this.m_tabCatch.style.display="none";
}
if(this.m_dialogDiv!=null){
this.m_dialogDiv.style.display="none";
}
},destroy:function(){
this.hide();
if(this.m_dialogDiv!=null){
this.m_dialogDiv.parentNode.removeChild(this.m_dialogDiv);
this.m_dialogDiv=null;
}
if(this.m_tabCatch!=null){
this.m_tabCatch.parentNode.removeChild(this.m_tabCatch);
this.m_tabCatch=null;
}
if(this.m_background!=null){
this.m_background.destroy();
this.m_background=null;
}
},setDebugHelper:function(_107f){
var _1080=document.createElement("div");
_1080.style.zIndex="100";
_1080.style.display="block";
_1080.style.position="relative";
_1080.style.backgroundColor="#FFFFFF";
_1080.innerHTML="<table><tr><td>"+"<a href=\"#\" onclick=\""+_107f+".show();\">show</a>"+"     "+"<a href=\"#\" onclick=\""+_107f+".hide();\">hide</a></td></tr></table>";
document.body.insertBefore(_1080,document.body.firstChild);
}});
dojo.provide("bux.reportViewer.Properties");
dojo.declare("bux.reportViewer.Properties",null,{iWidget:null,masterDialogSpec:null,masterDialogSpecProperties:null,flashChartSpec:null,isFlashChartOptionEnabled:true,oldProperties:null,dialogDisplayValues:null,constructor:function(_1081,_1082){
this.isInitialized=false;
this.initializeDialogDisplayValues();
this.oldProperties={};
this.iWidget=_1081;
if(_1082==="<empty>"){
return;
}
var json=dojo.eval("["+_1082+"]");
if(json&&json[0]){
this.initializeWithSavedPropertyValues(json[0]);
}
},initializeDialogDisplayValues:function(){
this.dialogDisplayValues={flashCharts:{value:null,canUndo:true,runReport:true},rowsPerPage:{value:null,canUndo:true,runReport:true},promptUserOnLoad:{value:false},retrieveAll:{value:false,refreshSavedOutput:true},showExpandCollapseIcon:{value:null}};
},clearDialogSpec:function(){
this.masterDialogSpec=null;
this.masterDialogSpecProperties=null;
},initializeWithSavedPropertyValues:function(_1084){
for(var prop in _1084){
if(typeof prop!="undefined"&&prop!=null){
if(this.dialogDisplayValues[prop]){
this.dialogDisplayValues[prop].value=_1084[prop];
}else{
this.dialogDisplayValues[prop]={value:_1084[prop],canUndo:false};
}
}
}
},setProperty:function(_1086,value){
this.dialogDisplayValues[_1086].value=value;
},getProperty:function(_1088){
if(this.dialogDisplayValues[_1088]){
return this.dialogDisplayValues[_1088].value;
}
return null;
},getOldProperty:function(_1089){
if(this.oldProperties&&this.oldProperties[_1089]){
return this.oldProperties[_1089].value;
}
return null;
},getOldProperties:function(){
var _108a={};
for(var prop in this.oldProperties){
if(this.dialogDisplayValues[prop].canUndo===true){
_108a[prop]={};
_108a[prop].value=this.oldProperties[prop].value;
}
}
return _108a;
},onGet:function(){
this.copyPropertyValues(this.dialogDisplayValues,this.oldProperties);
if(!this.masterDialogSpec){
this.initializeDialogSpec();
}else{
this.updateDialogSpec();
}
var _108c={tabTitle:this._getReportWidgetTabTitle(),properties:this.dialogDisplayValues,propertiesDialogSpec:this.masterDialogSpec};
return _108c;
},_getReportWidgetTabTitle:function(){
var _108d;
if(this.iWidget&&this.iWidget.getViewerObject()){
_108d=RV_RES.IDS_REPORT_WIDGET_PROPERTY_TAB_TITLE;
}
return _108d;
},onSet:function(_108e){
if(this.isSavedOutput()){
this.updateSavedOutput();
}else{
if(!this.runReportWithNewOptions()){
this._updateReport();
}
}
},_updateReport:function(){
var _108f=this.getProperty("showExpandCollapseIcon");
if(this.getOldProperty("showExpandCollapseIcon")!=_108f){
var oCV=this.iWidget.getViewerObject();
if(_108f===true){
oCV.insertExpandIconsForAllCrosstabs();
}else{
oCV.removeExpandIconsForAllCrosstabs();
}
}
},copyPropertyValues:function(from,to){
for(var prop in from){
if(!to[prop]){
to[prop]={};
}
to[prop].value=from[prop].value;
}
},doUndo:function(_1094){
this.copyPropertyValues(_1094,this.dialogDisplayValues);
},getUndoInfo:function(){
if(!this.isInitialized){
var oCV=this.iWidget.getViewerObject();
this.initialize(oCV.envParams);
}
var _1096={};
for(var prop in this.dialogDisplayValues){
if(this.dialogDisplayValues[prop].canUndo===true){
_1096[prop]={value:this.getProperty(prop)};
}
}
return _1096;
},shouldUpdateReport:function(_1098){
for(var prop in this.dialogDisplayValues){
if(this.dialogDisplayValues[prop][_1098]==true&&this.getOldProperty(prop)!=this.getProperty(prop)){
return true;
}
}
return false;
},runReportWithNewOptions:function(){
if(this.shouldUpdateReport("runReport")){
var oCV=this.iWidget.getViewerObject();
var _109b=oCV.getAction("RunReport");
_109b.setReuseQuery(true);
_109b.execute();
this.iWidget.getUndoRedoQueue().initUndoObj({"tooltip":this.getUndoHint(),"saveSpec":this.saveSpecForUndo()});
return true;
}
return false;
},updateSavedOutput:function(){
if(this.shouldUpdateReport("refreshSavedOutput")){
var _109c=this.iWidget.getSavedOutput();
_109c.setPagedOutput(!this.getRetrieveAll());
_109c.render();
}
},toString:function(){
var str="{";
for(var prop in this.dialogDisplayValues){
var _109f=this.getProperty(prop);
if(_109f!=null&&typeof _109f!=="undefined"){
if(str!="{"){
str+=", ";
}
str+="\""+prop+"\": ";
str+=(typeof (_109f)=="string")?_109f.toString():dojo.toJson(_109f);
}
}
str+="}";
return str;
},isSavedOutput:function(){
return this.iWidget.getViewerObject().envParams["ui.action"]==="view";
},getUndoHint:function(){
return RV_RES.IDS_JS_WIDGET_PROPERTIES;
},saveSpecForUndo:function(){
return false;
},getRetrieveAll:function(){
return this.getProperty("retrieveAll");
},getPromptUserOnLoad:function(){
return this.getProperty("promptUserOnLoad");
},getFlashCharts:function(){
return this.getProperty("flashCharts");
},getRowsPerPage:function(){
return this.getProperty("rowsPerPage");
},getOriginalReportLocation:function(_10a0){
if(_10a0.getAttributeValue&&!_10a0.getAttributeValue("originalReport")){
return RV_RES.IDS_JS_PROPERTY_ORIGINAL_REPORT_LOCATION+" "+RV_RES.IDS_JS_PROPERTY_ORIGINAL_REPORT_LOCATION_UNAVAILABLE;
}
var _10a1=_10a0.getViewerObject().envParams["originalReportLocation"];
if(typeof _10a1=="undefined"||_10a1==null||_10a1=="Unavailable"){
return RV_RES.IDS_JS_PROPERTY_ORIGINAL_REPORT_LOCATION+" "+RV_RES.IDS_JS_PROPERTY_ORIGINAL_REPORT_LOCATION_UNAVAILABLE;
}
return (RV_RES.IDS_JS_PROPERTY_ORIGINAL_REPORT_LOCATION+" "+_10a1);
},getShowExpandCollapseIconFlag:function(){
return this.getProperty("showExpandCollapseIcon");
},getAdvancedServerProperty:function(_10a2){
if(!this.iWidget&&!this.iWidget.getViewerObject()){
return null;
}
return this.iWidget.getViewerObject().getAdvancedServerProperty(_10a2);
},initializeShowExpandCollapseIconFlag:function(){
var _10a3=this.getAdvancedServerProperty("VIEWER_JS_EXPAND_COLLAPSE_CONTROLS_DEFAULT");
this.bHideExpandCollapseOption=(!_10a3);
if(this.bHideExpandCollapseOption){
return;
}
if(this.getShowExpandCollapseIconFlag()===null){
this.setProperty("showExpandCollapseIcon",_10a3.toLowerCase()==="on");
}
},initialize:function(_10a4){
if(this.isInitialized){
return;
}
this.isInitialized=true;
this.initializeFlashChartSettings(_10a4.flashChartOption);
this.initializeShowExpandCollapseIconFlag();
if(this.getRowsPerPage()==null){
if(_10a4["run.verticalElements"]!=null){
this.setProperty("rowsPerPage",_10a4["run.verticalElements"]);
}else{
this.setProperty("rowsPerPage",20);
}
}
this.initializeDialogSpec();
},createViewReportSpecLink:function(){
var oCV=this.iWidget.getViewerObject();
var _10a6=oCV.envParams["ui.spec"];
if(oCV.bCanUseReportStudio&&_10a6&&_10a6.length>0&&oCV.envParams["ui.action"]!="view"){
return {columns:[{propertyName:"viewReportSpecification",uiElementType:"link",label:RV_RES.IDS_JS_SHOW_REPORT_SPEC,eventHandler:this,onClickAction:dojo.hitch(this,this.onClickViewReportSpecification)}]};
}else{
return {};
}
},isBlackListedOption:function(_10a7){
return this.iWidget.getViewerObject().isBlacklisted(_10a7);
},createFlashChartOption:function(){
var _10a8=[{columns:[{propertyName:"flashCharts",uiElementType:"checkBox",label:RV_RES.IDS_JS_PROPERTY_FLASHCHARTS}]},{columns:[{uiElementType:"hSpacer"}]}];
return _10a8;
},getShowExpandCollapseIconOptionSpec:function(){
var spec=[{columns:[{propertyName:"showExpandCollapseIcon",uiElementType:"checkBox",label:RV_RES.IDS_JS_PROPERTY_SHOW_EXPAND_COLLAPSE_ICON}]},{columns:[{uiElementType:"hspacer"}]}];
return spec;
},generateDialogSpec:function(role){
var _10ab;
if(role=="consume"){
_10ab=[{columns:[{propertyName:"rowsPerPage",uiElementType:"textBox",type:"number",label:RV_RES.IDS_JS_PROPERTY_ROWS_PER_PAGE}]}];
this.masterDialogSpec={rows:_10ab};
}else{
var _10ac=this.createViewReportSpecLink();
_10ab=[{columns:[{propertyName:"rowsPerPage",uiElementType:"textBox",type:"number",label:RV_RES.IDS_JS_PROPERTY_ROWS_PER_PAGE,constraints:{min:1,max:1000},required:true,invalidMessage:RV_RES.IDS_JS_PROPERTY_ROWS_PER_PAGE_ERROR}]},{columns:[{uiElementType:"hspacer"}]},{columns:[{propertyName:"promptUserOnLoad",uiElementType:"checkBox",label:RV_RES.IDS_JS_PROPERTY_PROMPT_ON_LOAD}]},{columns:[{propertyName:"retrieveAll",uiElementType:"checkBox",label:RV_RES.IDS_JS_PROPERTY_RETRIEVE_ENTIRE_REPORT}]},_10ac,{columns:[{propertyName:"originalReportLocation",uiElementType:"text",label:this.getOriginalReportLocation(this.iWidget),allowWrapping:true}]}];
if(this.isFlashChartOptionEnabled&&!this.hasAVSChart()&&role!=="consume"){
var _10ad=this.createFlashChartOption();
_10ab=_10ad.concat(_10ab);
}
if(!this.bHideExpandCollapseOption&&!this.isBlackListedOption("ExpandMember")){
_10ab=this.getShowExpandCollapseIconOptionSpec().concat(_10ab);
}
this.masterDialogSpec={rows:_10ab};
}
if(this.masterDialogSpec&&this.masterDialogSpec.rows){
this.masterDialogSpecProperties={};
for(var r in this.masterDialogSpec.rows){
var row=this.masterDialogSpec.rows[r];
if(row.columns){
for(var c in row.columns){
var col=row.columns[c];
if(col.propertyName){
this.masterDialogSpecProperties[col.propertyName]=col;
}
}
}
}
}
},updateDialogSpec:function(){
if(this.masterDialogSpecProperties){
if(this.masterDialogSpecProperties.originalReportLocation){
this.masterDialogSpecProperties.originalReportLocation.label=this.getOriginalReportLocation(this.iWidget);
}
}
},initializeDialogSpec:function(){
var _10b2=this.iWidget.getUserRole();
this.generateDialogSpec(_10b2);
},hasAVSChart:function(){
if(this.iWidget==null||typeof this.iWidget.getViewerObject()=="undefined"){
return false;
}
var oCV=this.iWidget.getViewerObject();
if(typeof oCV=="undefined"){
return false;
}
return oCV.hasAVSChart();
},initializeFlashChartSettings:function(value){
if(!value){
return;
}
var json=(typeof value==="string")?(eval(value)):value;
var _10b6=json[0];
this.setProperty("flashCharts",_10b6.defaultValue);
this.isFlashChartOptionEnabled=!_10b6.isOptionDisabled;
},onClickViewReportSpecification:function(){
var _10b7=this.iWidget.getViewerObject().envParams["ui.spec"];
this._viewSpecInWindow(_10b7);
},_getWindowOptions:function(w,h){
var _10ba="resizable=yes,scrollbars=yes,menubar=no,directories=no,location=no,status=no,toolbar=no,titlebar=no";
var left=(screen.width-w)/2;
var top=(screen.height-h)/2;
_10ba+=",top="+top;
_10ba+=",left="+left;
_10ba+=",width="+w;
_10ba+=",height="+h;
return _10ba;
},_viewSpecInWindow:function(_10bd){
var _10be=dijit.getViewport();
var _10bf="debugWindow"+this.iWidget.getViewerObject().getId();
var _10c0=this._getWindowOptions(_10be.w,_10be.h);
var _10c1=window.open("",_10bf,_10c0);
var head="<html><body><table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">"+"<tbody><tr><td>"+"<textarea wrap=\"off\" style=\"font-family:arial; font-size: 10px; overflow: auto; width:100%; height:";
head+=_10be.h*0.95;
head+="px;\">";
var tail="</textarea></td></tr></tbody></table></body></html>";
_10c1.document.write(head+html_encode(_10bd)+tail);
}});
dojo.require("bux.reportViewer.Properties");
dojo.provide("ActiveReportIWidgetProperties");
dojo.declare("ActiveReportIWidgetProperties",[bux.reportViewer.Properties],{initializeDialogDisplayValues:function(){
this.dialogDisplayValues={activeReportState:{value:null,canUndo:false,runReport:false}};
},getActiveReportState:function(){
return this.getProperty("activeReportState");
},setActiveReportState:function(_10c4){
this.setProperty("activeReportState",_10c4);
},initialize:function(_10c5){
if(this.isInitialized){
return;
}
this.isInitialized=true;
this.initializeDialogSpec();
},initializeDialogSpec:function(){
var _10c6=[{columns:[{propertyName:"originalReportLocation",uiElementType:"text",label:this.getOriginalReportLocation(this.iWidget),allowWrapping:true}]},{columns:[{propertyName:"ActiveReportOutputVersion",uiElementType:"text",label:this._getAcitveReportOutputVersion(this.iWidget),allowWrapping:true}]}];
if(this.iWidget.isDebugMode()){
_10c6.push({columns:[{propertyName:"PublicVariables",uiElementType:"text",label:this._getPublicVariableNames(this.iWidget),allowWrapping:true}]});
}
this.masterDialogSpec={rows:_10c6};
},_getAcitveReportOutputVersion:function(_10c7){
var _10c8=_10c7.getActiveReportOutputVersion();
if(_10c8==null){
_10c8=RV_RES.IDS_JS_PROPERTY_ACTIVEREPORT_OUTPUT_VERSION_UNAVAILABLE;
}
return (RV_RES.IDS_JS_PROPERTY_ACTIVEREPORT_OUTPUT_VERSION+" "+_10c8);
},_getPublicVariableNames:function(_10c9){
var _10ca=_10c9.getPublicVariableNames();
var _10cb="";
for(var name in _10ca){
var sType=_10ca[name];
if(_10cb.length>0){
_10cb+=", ";
}
_10cb+=name;
_10cb+=(sType==="D")?" (Discrete)":"(Range)";
}
if(_10cb.length>0){
_10cb="Public Variables: "+_10cb;
}
return _10cb;
},_getReportWidgetTabTitle:function(){
var _10ce;
if(this.iWidget&&this.iWidget.getViewerObject()){
_10ce=RV_RES.IDS_ACTIVE_REPORT_WIDGET_PROPERTY_TAB_TITLE;
}
return _10ce;
}});
function RAPReportInfo(_10cf,oCV){
this.m_reportInfoJSON=_10cf;
this.m_containerInfoJSON={};
this.m_iContainerCount=0;
this.m_bPromptPart=null;
this.m_bSingleContainer=null;
this.m_bDetailFilteringDisabled=null;
this.m_aDrilledOnHUNs=null;
this.m_bPassTrackingToBUA=null;
this.m_sDisplayTypes=null;
this.m_bContainsInteractiveDataContainer=null;
this.m_bContainsFilters=false;
this.m_bContainsSlider=false;
this.m_referenceInfoObject={};
this.initializeContainerInfo();
this._addNonVisibleReferences(this.m_reportInfoJSON.reportLevelProperties);
this._populateHun(oCV);
};
RAPReportInfo.prototype.initializeContainerInfo=function(){
if(this.m_reportInfoJSON){
var _10d1=this.m_reportInfoJSON.containers;
if(_10d1){
this.m_iContainerCount=_10d1.length;
for(var _10d2=0;_10d2<this.m_iContainerCount;++_10d2){
var _10d3=_10d1[_10d2].container;
this.m_containerInfoJSON[_10d3]=_10d1[_10d2];
this.m_containerInfoJSON[_10d3].m_itemInfoJSON=this._initializeItemInfo(_10d1[_10d2].itemInfo);
this.m_containerInfoJSON[_10d3].m_drillabilityJSON=this._initializeDrillability(_10d1[_10d2].drillability);
this._addFilterReferences(_10d1[_10d2].filter);
this._addSliderReferences(_10d1[_10d2].sliders);
this.m_containerInfoJSON[_10d3].layoutIndex=_10d2;
if(_10d1[_10d2].filter){
this.m_bContainsFilters=true;
}
if(_10d1[_10d2].sliders){
this.m_bContainsSlider=true;
}
}
}
}
};
RAPReportInfo.prototype._initializeItemInfo=function(_10d4){
var _10d5={};
for(var idx in _10d4){
_10d5[_10d4[idx].item]=_10d4[idx];
this.m_referenceInfoObject[_10d4[idx].item]=true;
}
return _10d5;
};
RAPReportInfo.prototype._initializeDrillability=function(_10d7){
var _10d8={};
for(var idx in _10d7){
_10d8[_10d7[idx].item]=_10d7[idx];
this.m_referenceInfoObject[_10d7[idx].item]=true;
}
return _10d8;
};
RAPReportInfo.prototype._addFilterReferences=function(_10da){
for(var idx in _10da){
this.m_referenceInfoObject[_10da[idx].item]=true;
if(_10da[idx].type==="contextSlice"&&_10da[idx].hierarchyName){
this.m_referenceInfoObject[_10da[idx].hierarchyName]=true;
}
}
};
RAPReportInfo.prototype._addSliderReferences=function(_10dc){
for(var idx in _10dc){
this.m_referenceInfoObject[_10dc[idx].name]=true;
}
};
RAPReportInfo.prototype._addNonVisibleReferences=function(_10de){
if(_10de&&_10de.nonVisibleFiltersMemberItemInfo){
for(var i=0;i<_10de.nonVisibleFiltersMemberItemInfo.length;i++){
this.m_referenceInfoObject[_10de.nonVisibleFiltersMemberItemInfo[i]]=true;
}
}
};
RAPReportInfo.prototype.isReferenced=function(item){
return (this.m_referenceInfoObject[item])?true:false;
};
RAPReportInfo.prototype.getDrillability=function(_10e1,_10e2){
if(!_10e2){
return this.m_containerInfoJSON[_10e1].m_drillabilityJSON;
}else{
return this.m_containerInfoJSON[_10e1].m_drillabilityJSON[_10e2];
}
};
RAPReportInfo.prototype.getContainers=function(){
return this.m_containerInfoJSON;
};
RAPReportInfo.prototype.getContainer=function(lid){
return this.m_containerInfoJSON[lid];
};
RAPReportInfo.prototype.getContainerIds=function(_10e4){
var _10e5=[];
for(containerName in this.m_containerInfoJSON){
var _10e6=this.m_containerInfoJSON[containerName];
if(_10e6&&_10e6.displayTypeId==_10e4){
_10e5.push(_10e6.container);
}
}
return _10e5;
};
RAPReportInfo.prototype.getContainerFromPos=function(iPos){
return this.m_reportInfoJSON.containers[iPos];
};
RAPReportInfo.prototype.getReportLevelProperties=function(){
return this.m_reportInfoJSON.reportLevelProperties;
};
RAPReportInfo.prototype.getItemInfo=function(_10e8,_10e9){
if(!_10e9){
return this.m_containerInfoJSON[_10e8].m_itemInfoJSON;
}
if(this.m_containerInfoJSON[_10e8]){
return this.m_containerInfoJSON[_10e8].m_itemInfoJSON[_10e9];
}
return null;
};
RAPReportInfo.prototype.isReportLevel_nonVisibleFilterItem=function(_10ea){
if(_10ea&&_10ea.length>0){
var _10eb=this.m_reportInfoJSON.reportLevelProperties;
if(_10eb){
if(_10eb&&_10eb.nonVisibleFiltersMemberItemInfo){
for(var i=0;i<_10eb.nonVisibleFiltersMemberItemInfo.length;i++){
if(_10ea===_10eb.nonVisibleFiltersMemberItemInfo[i]){
return true;
}
}
}
}
}
return false;
};
RAPReportInfo.prototype.isChildContainer=function(lid){
return ((this.m_containerInfoJSON[lid]&&this.m_containerInfoJSON[lid].parentContainer)?true:false);
};
RAPReportInfo.prototype.getItemDetails=function(_10ee,sHun){
var obj=null;
for(var lid in this.m_containerInfoJSON){
var oItem=this.getItemInfo(lid,_10ee);
if(oItem&&oItem.hun===sHun){
obj={};
obj.item=oItem.item;
if(oItem.hun){
obj.hun=oItem.hun;
}
obj.lid=lid;
obj.queryName=oItem.queryName;
break;
}
}
return (obj)?obj:null;
};
RAPReportInfo.prototype.getItemDetailsByHun=function(sHun){
var _10f4=null;
for(var lid in this.m_containerInfoJSON){
var _10f6=this.getItemInfo(lid);
for(var sName in _10f6){
var oItem=_10f6[sName];
if(oItem.hun===sHun){
_10f4=sName;
break;
}
}
}
return (_10f4?this.getItemDetails(_10f4,sHun):null);
};
RAPReportInfo.prototype._populateHun=function(oCV){
if(oCV){
var _10fa=oCV.getSelectionController().getCCDManager();
var _10fb=oCV.envParams;
var _10fc=oCV.getRAPReportInfo();
var _10fd=false;
for(var lid in this.m_containerInfoJSON){
var _10ff=this.m_containerInfoJSON[lid].m_itemInfoJSON;
for(var _1100 in _10ff){
var oItem=_10ff[_1100];
if(oItem.hun){
continue;
}
var sHun=this.getHUNForItem(oItem,_10fa,lid,_10fc);
if(sHun){
oItem.hun=sHun;
_10fd=true;
}
}
}
if(_10fd&&typeof JSON!="undefined"&&JSON!=null&&JSON.stringify){
_10fb["rapReportInfo"]=JSON.stringify(this.m_reportInfoJSON);
}
}
};
RAPReportInfo.prototype.getHUNForItem=function(oItem,_1104,lid,_1106){
var sHun=this.getHUNFromCCDManager(_1104,oItem);
var _1108=null;
if(!sHun&&_1106){
_1108=_1106.getItemInfo(lid,oItem.item);
if(_1108){
sHun=_1108.hun;
}
}
return sHun;
};
RAPReportInfo.prototype.getHUNFromCCDManager=function(_1109,oItem){
var _110b={};
var sHUN=null;
var _110d=this._findQueryMetadataId(_1109,_110b,oItem.queryName);
if(_110d){
sHUN=_1109.GetHUNForRDI(oItem.item,_110d);
}
return sHUN;
};
RAPReportInfo.prototype._findQueryMetadataId=function(_110e,oMap,_1110){
if(oMap[_1110]){
return oMap[_1110];
}
var ctxId=_110e.GetMetadataIdForQueryName(_1110);
if(ctxId){
oMap[_1110]=ctxId;
return ctxId;
}
return null;
};
RAPReportInfo.prototype.isPromptPart=function(){
if(this.m_bPromptPart===null){
if(this.m_reportInfoJSON.reportLevelProperties&&this.m_reportInfoJSON.reportLevelProperties.promptWidget===true){
this.m_bPromptPart=true;
}else{
this.m_bPromptPart=false;
}
}
return this.m_bPromptPart;
};
RAPReportInfo.prototype.getContainerCount=function(){
return this.m_iContainerCount;
};
RAPReportInfo.prototype.isSingleContainer=function(){
if(this.m_bSingleContainer===null){
if(this.m_iContainerCount===1&&this.m_reportInfoJSON.reportLevelProperties&&this.m_reportInfoJSON.reportLevelProperties.singleContainerReport===true){
this.m_bSingleContainer=true;
}else{
this.m_bSingleContainer=false;
}
}
return this.m_bSingleContainer;
};
RAPReportInfo.prototype.isDetailFilteringDisabled=function(){
if(this.m_bDetailFilteringDisabled===null){
if(this.m_reportInfoJSON.reportLevelProperties&&this.m_reportInfoJSON.reportLevelProperties.detailFilteringDisabled===true){
this.m_bDetailFilteringDisabled=true;
}else{
this.m_bDetailFilteringDisabled=false;
}
}
return this.m_bDetailFilteringDisabled;
};
RAPReportInfo.prototype.getPassTrackingtoBUA=function(){
if(this.m_bPassTrackingToBUA===null){
if(this.m_reportInfoJSON.reportLevelProperties&&this.m_reportInfoJSON.reportLevelProperties.shouldNotPassTrackingtoBUA===true){
this.m_bPassTrackingToBUA=false;
}else{
this.m_bPassTrackingToBUA=true;
}
}
return this.m_bPassTrackingToBUA;
};
RAPReportInfo.prototype.getDrilledOnHUNs=function(){
if(!this.m_aDrilledOnHUNs&&this.m_reportInfoJSON.reportLevelProperties&&this.m_reportInfoJSON.reportLevelProperties.drilledOnHUNs){
this.m_aDrilledOnHUNs=this.m_reportInfoJSON.reportLevelProperties.drilledOnHUNs;
}
return this.m_aDrilledOnHUNs;
};
RAPReportInfo.prototype.getDisplayTypes=function(_1112){
if(this.m_sDisplayTypes===null||_1112){
var _1113="";
var _1114=[];
for(var lid in this.m_containerInfoJSON){
if(!_1112||lid!=_1112){
_1114.push(this.m_containerInfoJSON[lid].displayTypeId);
}
}
_1113=_1114.join(",");
if(_1113==""&&this.isPromptPart()){
_1113="promptWidget";
}
if(!_1112){
this.m_sDisplayTypes=_1113;
}
return _1113;
}
return this.m_sDisplayTypes;
};
RAPReportInfo.prototype.isChart=function(lid){
var id=lid.toLowerCase();
return id!="mapchart"&&id.match("chart$")=="chart";
};
RAPReportInfo.prototype.isViz=function(lid){
if(this.m_containerInfoJSON[lid]){
var _1119=this.m_containerInfoJSON[lid].displayTypeId;
if(_1119){
return (_1119.toLowerCase()=="viz");
}
}
return false;
};
RAPReportInfo.prototype.isInteractiveDataContainer=function(lid){
var _111b=false;
if(this.m_containerInfoJSON[lid]){
var _111c=this.m_containerInfoJSON[lid].displayTypeId;
if(_111c){
var id=_111c.toLowerCase();
_111b=id=="crosstab"||id=="list"||id=="viz"||this.isChart(id);
}
}
return _111b;
};
RAPReportInfo.prototype.containsInteractiveDataContainer=function(){
if(this.m_bContainsInteractiveDataContainer==null){
this.m_bContainsInteractiveDataContainer=false;
for(var lid in this.m_containerInfoJSON){
if(this.isInteractiveDataContainer(lid)){
this.m_bContainsInteractiveDataContainer=true;
break;
}
}
}
return this.m_bContainsInteractiveDataContainer;
};
RAPReportInfo.prototype.containsFilters=function(){
return this.m_bContainsFilters;
};
RAPReportInfo.prototype.getFilterObject=function(_111f,_1120){
for(var lid in this.m_containerInfoJSON){
var _1122=this.getFilterObjectFromContainer(lid,_111f,_1120);
if(_1122){
return _1122;
}
}
return null;
};
RAPReportInfo.prototype.getFilterObjectFromContainer=function(lid,_1124,_1125){
var _1126=this.m_containerInfoJSON[lid];
if(_1126&&_1126.filter){
var _1127=_1126.filter.length;
for(var i=0;i<_1127;++i){
var _1129=_1126.filter[i];
if(_1124==_1129.item){
if(!_1125||(_1129.itemLabel&&_1129.itemLabel.length>0)){
return _1129;
}
}
}
}
return null;
};
RAPReportInfo.prototype.hunHasFilterOrSlider=function(_112a){
if(!_112a){
return null;
}
for(var lid in this.m_containerInfoJSON){
var _112c=this.m_containerInfoJSON[lid];
if(_112c&&_112c.filter){
var _112d=_112c.filter.length;
for(var i=0;i<_112d;++i){
var _112f=_112c.filter[i];
if(_112f.HUN&&_112a.indexOf(_112f.HUN)==0){
return _112f.item;
}
}
}
if(_112c&&_112c.sliders){
var _112d=_112c.sliders.length;
for(var i=0;i<_112d;++i){
var _1130=_112c.sliders[i];
if(_1130.hun&&_112a.indexOf(_1130.hun)==0){
return _1130.name;
}
}
}
}
return null;
};
RAPReportInfo.prototype.hasSlider=function(){
return this.m_bContainsSlider;
};
RAPReportInfo.prototype.collectSliderSetFromReportInfo=function(){
var _1131={};
for(var lid in this.m_containerInfoJSON){
var _1133=this.m_containerInfoJSON[lid].sliders;
if(_1133){
for(var _1134=0;_1134<_1133.length;++_1134){
var _1135=_1133[_1134].clientId;
_1131[_1135]=_1133[_1134];
}
}
}
return _1131;
};
RAPReportInfo.prototype._getEventTimings=function(){
return (this.m_reportInfoJSON&&this.m_reportInfoJSON.reportLevelProperties&&this.m_reportInfoJSON.reportLevelProperties.eventTimings)?this.m_reportInfoJSON.reportLevelProperties.eventTimings:null;
};
RAPReportInfo.prototype.destroy=function(){
GUtil.destroyProperties(this);
};
function DelayedLoadingContext(id){
this.widgetid=id;
this.m_promptValues=null;
};
DelayedLoadingContext.prototype.setPromptValues=function(_1137){
if(_1137===null){
this.m_promptValues=null;
return;
}
if(!this.m_promptValues){
this.m_promptValues={};
}
applyJSONProperties(this.m_promptValues,_1137);
};
DelayedLoadingContext.prototype.getPromptValues=function(){
return this.m_promptValues;
};
DelayedLoadingContext.prototype.setForceRunReport=function(_1138){
this.m_forceRunReport=_1138;
};
DelayedLoadingContext.prototype.getForceRunReport=function(){
return this.m_forceRunReport;
};
DelayedLoadingContext.prototype.isEmpty=function(){
return !(this.m_promptValues||this.m_forceRunReport);
};
DelayedLoadingContext.prototype.reset=function(){
delete (this.m_promptValues);
this.m_promptValues=null;
this.m_forceRunReport=false;
delete (this._cascadingPromptParamsToClear);
};
DelayedLoadingContext.prototype.setCascadingPromptParamsToClear=function(_1139){
this._cascadingPromptParamsToClear=_1139;
};
DelayedLoadingContext.prototype.getCascadingPromptParamsToClear=function(){
return this._cascadingPromptParamsToClear;
};
function ViewerLoadManager(_113a){
this.m_oWidget=_113a;
this.m_oDelayedLoadingContext=new DelayedLoadingContext();
this.m_aQueue=[];
this.m_fOnEmptyCallback=null;
this.m_bPendingRequest=false;
this.m_bViewerLoadInitiated=false;
this.m_bCanRunReports=false;
};
ViewerLoadManager.prototype.viewerLoadInitiated=function(){
this.m_bViewerLoadInitiated=true;
};
ViewerLoadManager.prototype.isViewerLoadInitiated=function(){
return this.m_bViewerLoadInitiated;
};
ViewerLoadManager.prototype.canRunReports=function(){
return this.m_bCanRunReports;
};
ViewerLoadManager.prototype.runningReport=function(){
if(!this.m_bCanRunReports){
this._queue({fCallback:dojo.hitch(this,function(){
this.m_bCanRunReports=true;
return false;
})});
}
};
ViewerLoadManager.prototype.isViewerReady=function(){
if(!this.isViewerLoaded()){
return false;
}
if(!this._isEmpty()||this.m_fOnEmptyCallback||this.m_bPendingRequest){
return false;
}
return true;
};
ViewerLoadManager.prototype.isViewerLoaded=function(){
var oCV=this.m_oWidget.getViewerObject();
if(!oCV){
return false;
}
if(this.m_oWidget.isLiveReport()){
var _113c=oCV.getStatus();
return _113c==="complete"||_113c==="prompting"||_113c==="fault";
}
return true;
};
ViewerLoadManager.prototype.runWhenHasViewer=function(f,_113e){
if(this.isViewerReady()){
this._run(f);
return true;
}else{
var _113f={fCallback:f};
if(_113e){
_113f.sGroupId=_113e;
}
this._queue(_113f);
if(!this.m_bViewerLoadInitiated){
this.getDelayedLoadingContext().setForceRunReport(true);
this.m_oWidget.setRunReportOption(false);
this.m_oWidget.postReport(null);
}
return false;
}
};
ViewerLoadManager.prototype.processQueue=function(){
this.m_bPendingRequest=false;
var _1140=false;
while(!_1140&&!this._isEmpty()){
var _1141=this.m_aQueue.shift();
while(_1141.sGroupId&&!this._isEmpty()&&this.m_aQueue[0].sGroupId===_1141.sGroupId){
_1141=this.m_aQueue.shift();
}
_1140=this._run(_1141.fCallback);
}
if(this._isEmpty()&&!_1140&&this.m_fOnEmptyCallback){
var _1142=this.m_fOnEmptyCallback;
this.m_fOnEmptyCallback=null;
_1142();
}
};
ViewerLoadManager.prototype._run=function(f){
var _1144=f.call();
if(_1144){
this.m_bPendingRequest=true;
}
return _1144;
};
ViewerLoadManager.prototype._isEmpty=function(){
return !this.m_aQueue.length;
};
ViewerLoadManager.prototype._queue=function(_1145){
this.m_aQueue.push(_1145);
};
ViewerLoadManager.prototype.setOnEmptyCallback=function(_1146){
this.m_fOnEmptyCallback=_1146;
};
ViewerLoadManager.prototype.getDelayedLoadingContext=function(){
return this.m_oDelayedLoadingContext;
};
function XmlHttpObject(){
this.m_formFields=new CDictionary();
this.xmlHttp=XmlHttpObject.createRequestObject();
this.m_requestIndicator=null;
this.m_httpCallbacks={};
this.m_asynch=true;
this.m_headers=null;
};
XmlHttpObject.prototype.setHeaders=function(_1147){
this.m_headers=_1147;
};
XmlHttpObject.prototype.getHeaders=function(){
return this.m_headers;
};
XmlHttpObject.prototype.newRequest=function(){
var _1148=new XmlHttpObject();
_1148.init(this.m_action,this.m_gateway,this.m_url,this.m_asynch);
this.executeHttpCallback("newRequest");
return _1148;
};
XmlHttpObject.prototype.abortHttpRequest=function(){
if(this.xmlHttp!=null){
this.xmlHttp.abort();
this.xmlHttp=null;
this.executeHttpCallback("cancel");
this.m_httpCallbacks={};
}
};
XmlHttpObject.prototype.cancel=function(){
this.abortHttpRequest();
};
XmlHttpObject.prototype.executeHttpCallback=function(_1149){
if(this.m_httpCallbacks&&this.m_httpCallbacks[_1149]){
var _114a=this.concatResponseArguments(this.m_httpCallbacks.customArguments);
var _114b=GUtil.generateCallback(this.m_httpCallbacks[_1149].method,_114a,this.m_httpCallbacks[_1149].object);
_114b();
return true;
}
return false;
};
XmlHttpObject.prototype.setCallbacks=function(_114c){
if(!this.m_httpCallbacks){
this.m_httpCallbacks={};
}
for(callback in _114c){
this.m_httpCallbacks[callback]=_114c[callback];
}
};
XmlHttpObject.prototype.getCallbacks=function(){
return this.m_httpCallbacks;
};
XmlHttpObject.createRequestObject=function(){
var _114d=null;
if(window.XMLHttpRequest){
_114d=new XMLHttpRequest();
}else{
if(window.ActiveXObject){
_114d=new ActiveXObject("Msxml2.XMLHTTP");
}else{
}
}
return _114d;
};
XmlHttpObject.prototype.waitForXmlHttpResponse=function(){
var _114e=this.xmlHttp;
if(_114e&&_114e.readyState===4){
if(_114e.status===200){
this.httpSuccess();
}else{
this.httpError();
}
}else{
}
};
XmlHttpObject.prototype.init=function(_114f,_1150,url,_1152){
this.m_action=_114f;
this.m_gateway=_1150;
this.m_url=url;
this.m_asynch=_1152;
};
XmlHttpObject.prototype.httpSuccess=function(){
this.executeHttpCallback("postHttpRequest");
this.executeHttpCallback("entryComplete");
this.executeHttpCallback("complete");
this.m_httpCallbacks=null;
};
XmlHttpObject.prototype.httpError=function(){
this.executeHttpCallback("entryFault");
this.executeHttpCallback("fault");
this.m_httpCallbacks=null;
};
XmlHttpObject.prototype.forceSynchronous=function(){
this.m_asynch=false;
};
XmlHttpObject.prototype.sendRequest=function(){
this.sendHtmlRequest(this.m_action,this.m_gateway,this.m_url,this.m_asynch);
};
XmlHttpObject.prototype.sendHtmlRequest=function(_1153,_1154,url,async){
var _1157=this.xmlHttp;
if(_1157){
_1157.open(_1153,_1154,async);
if(async){
_1157.onreadystatechange=GUtil.generateCallback(this.waitForXmlHttpResponse,[],this);
}else{
_1157.onreadystatechange=GUtil.generateCallback(this.waitForXmlHttpResponse,[],this);
if(!isIE()){
_1157.onload=GUtil.generateCallback(this.httpSuccess,[],this);
_1157.onerror=GUtil.generateCallback(this.httpError,[],this);
}
}
_1157.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
if(this.m_headers){
for(header in this.m_headers){
_1157.setRequestHeader(header,this.m_headers[header]);
}
}
this.executeHttpCallback("preHttpRequest");
var _1158=this.convertFormFieldsToUrl();
if(url){
_1158+=url;
}
_1157.send(_1158);
}
};
XmlHttpObject.prototype.getResponseXml=function(){
return (this.xmlHttp)?this.xmlHttp.responseXML:null;
};
XmlHttpObject.prototype.getResponseText=function(){
return (this.xmlHttp)?this.xmlHttp.responseText:"";
};
XmlHttpObject.prototype.getResponseHeader=function(item){
return (this.xmlHttp)?this.xmlHttp.getResponseHeader(item):null;
};
XmlHttpObject.prototype.getStatus=function(){
return this.xmlHttp.status;
};
XmlHttpObject.prototype.addFormField=function(name,value){
this.m_formFields.add(name,value);
};
XmlHttpObject.prototype.getFormFields=function(){
return this.m_formFields;
};
XmlHttpObject.prototype.getFormField=function(_115c){
return this.m_formFields.get(_115c);
};
XmlHttpObject.prototype.clearFormFields=function(){
this.m_formFields=new CDictionary();
};
XmlHttpObject.prototype.convertFormFieldsToUrl=function(){
var url="";
var _115e=this.m_formFields.keys();
for(var index=0;index<_115e.length;index++){
if(index>0){
url+="&";
}
url+=encodeURIComponent(_115e[index])+"="+encodeURIComponent(this.m_formFields.get(_115e[index]));
}
return url;
};
XmlHttpObject.prototype.concatResponseArguments=function(_1160){
var _1161=[this];
if(_1160){
_1161=_1161.concat(_1160);
}
return _1161;
};
function AsynchRequest(_1162,_1163){
AsynchRequest.baseConstructor.call(this);
this.m_gateway=_1162;
this.m_webContentRoot=_1163;
this.m_callbacks={};
this.m_soapFault=null;
this.m_faultDialog=null;
this.m_promptDialog=null;
this.m_logonDialog=null;
};
AsynchRequest.prototype=new XmlHttpObject();
AsynchRequest.baseConstructor=XmlHttpObject;
AsynchRequest.prototype.parent=XmlHttpObject.prototype;
AsynchRequest.prototype.getTracking=function(){
return "";
};
AsynchRequest.prototype.getConversation=function(){
return "";
};
AsynchRequest.prototype.getPrimaryAction=function(){
return "";
};
AsynchRequest.prototype.getActionState=function(){
return "";
};
AsynchRequest.prototype.getAsynchStatus=function(){
return "";
};
AsynchRequest.prototype.getResult=function(){
return null;
};
AsynchRequest.prototype.getSoapFault=function(){
return this.m_soapFault;
};
AsynchRequest.prototype.constructFaultEnvelope=function(){
return null;
};
AsynchRequest.prototype.getPromptHTMLFragment=function(){
return "";
};
AsynchRequest.prototype.isRAPWaitTrue=function(){
return false;
};
AsynchRequest.prototype.getRAPRequestCache=function(){
return null;
};
AsynchRequest.prototype.getMainConversation=function(){
return null;
};
AsynchRequest.prototype.getMainTracking=function(){
return null;
};
AsynchRequest.prototype.construct=function(){
};
AsynchRequest.prototype.executeCallback=function(_1164){
if(this.m_callbacks[_1164]){
var _1165=this.concatResponseArguments(this.m_callbacks.customArguments);
var _1166=GUtil.generateCallback(this.m_callbacks[_1164].method,_1165,this.m_callbacks[_1164].object);
_1166();
return true;
}
return false;
};
AsynchRequest.prototype.setCallbacks=function(_1167){
if(!this.m_callbacks){
this.m_callbacks={};
}
for(callback in _1167){
this.m_callbacks[callback]=_1167[callback];
}
};
AsynchRequest.prototype.getCallbacks=function(){
return this.m_callbacks;
};
AsynchRequest.prototype.newRequest=function(){
var _1168=this.construct();
_1168.setHeaders(this.getHeaders());
if(this.getFormFields().exists("b_action")){
_1168.addFormField("b_action",this.getFormField("b_action"));
}
if(this.getFormFields().exists("cv.catchLogOnFault")){
_1168.addFormField("cv.catchLogOnFault",this.getFormField("cv.catchLogOnFault"));
}
_1168.setPromptDialog(this.m_promptDialog);
_1168.setFaultDialog(this.m_faultDialog);
_1168.setLogonDialog(this.m_logonDialog);
_1168.m_asynch=this.m_asynch;
if(this.m_callbacks.newRequest){
var _1169=GUtil.generateCallback(this.m_callbacks.newRequest.method,[_1168],this.m_callbacks.newRequest.object);
_1169();
}
return _1168;
};
AsynchRequest.prototype.success=function(){
var _116a=this.getAsynchStatus();
switch(_116a){
case "stillWorking":
case "working":
this.working();
break;
case "prompting":
this.prompting();
break;
case "fault":
case "complete":
case "conversationComplete":
this.complete();
break;
default:
this.complete();
break;
}
};
AsynchRequest.prototype.setFaultDialog=function(_116b){
if(_116b instanceof IFaultDialog){
if(typeof console!="undefined"){
console.log("AsynchRequest.prototype.setFaultDialog is deprecated");
}
this.m_faultDialog=_116b;
}else{
if(_116b&&typeof console!="undefined"){
console.log("The parameter faultDialog must be an instance of IFaultDialog");
}
}
};
AsynchRequest.prototype.setPromptDialog=function(_116c){
if(_116c instanceof IPromptDialog){
if(typeof console!="undefined"){
console.log("AsynchRequest.prototype.setPromptDialog is deprecated");
}
this.m_promptDialog=_116c;
}else{
if(_116c&&typeof console!="undefined"){
console.log("The parameter promptDialog must be an instance of IPromptDialog");
}
}
};
AsynchRequest.prototype.setLogonDialog=function(_116d){
if(_116d instanceof ILogOnDialog){
if(typeof console!="undefined"){
console.log("AsynchRequest.prototype.setLogonDialog is deprecated");
}
this.m_logonDialog=_116d;
}else{
if(_116d&&typeof console!="undefined"){
console.log("The parameter logOnDialog must be an instance of ILogOnDialog");
}
}
};
AsynchRequest.prototype.resubmitRequest=function(){
var _116e=this.newRequest();
_116e.m_formFields=this.m_formFields;
_116e.sendRequest();
return _116e;
};
AsynchRequest.prototype.sendRequest=function(){
var _116f=this;
var _1170={"complete":{"object":_116f,"method":_116f.successHandler},"fault":{"object":_116f,"method":_116f.errorHandler}};
this.init("POST",this.m_gateway,"",this.m_asynch);
this.executeCallback("preHttpRequest");
this.parent.setCallbacks.call(this,_1170);
this.parent.sendRequest.call(this);
};
AsynchRequest.prototype.errorHandler=function(){
this.executeCallback("postHttpRequest");
this.executeCallback("entryFault");
this.executeCallback("error");
};
AsynchRequest.prototype.successHandler=function(){
this.executeCallback("postHttpRequest");
if(typeof window["AsynchRequestPromptDialog"]!="undefined"&&window["AsynchRequestPromptDialog"]!=null){
window["AsynchRequestPromptDialog"].hide();
window["AsynchRequestPromptDialog"]=null;
}
if(this.getResponseHeader("Content-type").indexOf("text/html")!=-1){
var _1171=this.getResponseText();
if(_1171.indexOf("<ERROR_CODE>CAM_PASSPORT_ERROR</ERROR_CODE>")!=-1){
this.passportTimeout();
}else{
if((_1171.indexOf("http-equiv=\"refresh\"")!=-1)||(_1171.indexOf("http-equiv='refresh'")!=-1)){
this.passportTimeout();
}else{
this.executeCallback("entryFault");
if(!this.executeCallback("fault")){
var _1172=window.open("","","height=400,width=500");
if(_1172!=null){
_1172.document.write(_1171);
}
}
}
}
}else{
this.m_soapFault=this.constructFaultEnvelope();
if(this.m_soapFault!=null){
var _1173=XMLHelper_FindChildByTagName(this.m_soapFault,"CAM",true);
if(_1173!=null&&XMLHelper_FindChildByTagName(_1173,"promptInfo",true)){
this.passportTimeout();
}else{
this.fault();
}
}else{
this.success();
}
}
};
AsynchRequest.prototype.cancel=function(){
this.parent.cancel.call(this);
var _1174=this.getFormField("m_tracking");
if(_1174){
var _1175=new XmlHttpObject();
_1175.init("POST",this.m_gateway,"",false);
if(this.getFormField("cv.outputKey")){
_1175.addFormField("b_action","cvx.high");
_1175.addFormField("cv.outputKey",this.getFormField("cv.outputKey"));
_1175.setHeaders(this.getHeaders());
}else{
_1175.addFormField("b_action","cognosViewer");
}
_1175.addFormField("cv.responseFormat","successfulRequest");
_1175.addFormField("ui.action","cancel");
_1175.addFormField("m_tracking",_1174);
if(this.getFormField("cv.debugDirectory")){
_1175.addFormField("cv.debugDirectory",this.getFormField("cv.debugDirectory"));
}
_1175.sendRequest();
this.executeCallback("cancel");
}
};
AsynchRequest.prototype.working=function(){
this.executeCallback("working");
var _1176=this.newRequest();
_1176.addFormField("m_tracking",this.getTracking());
if(this.getFormField("cv.outputKey")){
_1176.addFormField("cv.outputKey",this.getFormField("cv.outputKey"));
_1176.addFormField("b_action","cvx.high");
}
if(this.isRAPWaitTrue()){
_1176.m_formFields=this.m_formFields;
_1176.addFormField("m_tracking",this.getTracking());
_1176.addFormField("rapWait","true");
var _1177=this.getRAPRequestCache();
if(_1177!==null&&typeof _1177!="undefined"){
_1176.addFormField("rapRequestCache",_1177);
}
var _1178=this.getMainConversation();
if(_1178){
_1176.addFormField("mainConversation",_1178);
}
var _1179=this.getMainTracking();
if(_1179){
_1176.addFormField("mainTracking",_1179);
}
}else{
_1176.addFormField("ui.action","wait");
_1176.addFormField("ui.primaryAction",this.getPrimaryAction());
_1176.addFormField("cv.actionState",this.getActionState());
if(this.getFormField("ui.preserveRapTags")){
_1176.addFormField("ui.preserveRapTags",this.getFormField("ui.preserveRapTags"));
}
if(this.getFormField("ui.backURL")){
_1176.addFormField("ui.backURL",this.getFormField("ui.backURL"));
}
if(this.getFormField("errURL")){
_1176.addFormField("errURL",this.getFormField("errURL"));
}
if(this.getFormField("cv.showFaultPage")){
_1176.addFormField("cv.showFaultPage",this.getFormField("cv.showFaultPage"));
}
if(this.getFormField("cv.catchLogOnFault")){
_1176.addFormField("cv.catchLogOnFault",this.getFormField("cv.catchLogOnFault"));
}
}
if(this.getFormField("bux")){
_1176.addFormField("bux",this.getFormField("bux"));
}
if(this.getFormField("cv.debugDirectory")){
_1176.addFormField("cv.debugDirectory",this.getFormField("cv.debugDirectory"));
}
_1176.sendRequest();
};
AsynchRequest.prototype.prompting=function(){
this.executeCallback("entryComplete");
if(!this.executeCallback("prompting")){
if(this.m_promptDialog!=null){
this.showPromptPage();
}else{
if(typeof console!="undefined"){
console.log("An unhandled prompt response was returned: %o",this.xmlHttp);
}
}
}
this.executeCallback("postEntryComplete");
};
AsynchRequest.prototype.promptPageOkCallback=function(_117a){
var _117b=this.newRequest();
_117b.addFormField("ui.action","forward");
_117b.addFormField("m_tracking",this.getTracking());
_117b.addFormField("ui.conversation",this.getConversation());
_117b.addFormField("ui.primaryAction",this.getPrimaryAction());
_117b.addFormField("cv.actionState",this.getActionState());
for(var _117c in _117a){
_117b.addFormField(_117c,_117a[_117c]);
}
_117b.sendRequest();
window["AsynchRequestObject"]=null;
};
AsynchRequest.prototype.promptPageCancelCallback=function(){
window["AsynchRequestPromptDialog"].hide();
this.complete();
};
AsynchRequest.prototype.showPromptPage=function(){
window["AsynchRequestObject"]=this;
window["AsynchRequestPromptDialog"]=this.m_promptDialog;
var _117d=this.m_promptDialog.getViewerId()==null?"":"?cv.id="+this.m_promptDialog.getViewerId();
window["AsynchRequestPromptDialog"].initialize(this.m_webContentRoot+"/rv/showStandalonePrompts.html"+_117d,400,400);
window["AsynchRequestPromptDialog"].show();
};
AsynchRequest.prototype.passportTimeout=function(){
this.executeCallback("entryFault");
if(!this.executeCallback("passportTimeout")){
if(this.m_logonDialog!=null){
this.m_logonDialog.show(response.getSoapFault());
}else{
if(typeof console!="undefined"){
console.log("An unhandled passport timeout fault was returned: %o",this.getSoapFault());
}
}
}
};
AsynchRequest.prototype.fault=function(){
this.executeCallback("entryFault");
if(!this.executeCallback("fault")){
if(this.m_faultDialog!=null){
this.m_faultDialog.show(this.getSoapFault());
}else{
if(typeof console!="undefined"){
console.log("An unhandled soap fault was returned: %o",this.getSoapFault());
}
}
}
};
AsynchRequest.prototype.complete=function(){
this.executeCallback("entryComplete");
this.executeCallback("complete");
this.executeCallback("postEntryComplete");
};
AsynchRequest.prototype.getSoapFaultCode=function(){
var _117e=this.constructFaultEnvelope();
if(_117e){
var _117f=XMLHelper_FindChildByTagName(_117e,"faultcode",true);
if(_117f!=null){
return XMLHelper_GetText(_117f);
}
}
return null;
};
AsynchRequest.prototype.getSoapFaultDetailMessageString=function(){
var _1180=this.constructFaultEnvelope();
if(_1180){
var entry=XMLHelper_FindChildByTagName(_1180,"messageString",true);
if(entry!=null){
return XMLHelper_GetText(entry);
}
}
return null;
};
function AsynchDATARequest(_1182,_1183){
AsynchDATARequest.baseConstructor.call(this,_1182,_1183);
this.m_oResponseState=null;
this.m_sResponseState=null;
this.m_endOfStateIdx=-1;
this.cStatePrefix="<xml><state>";
this.cStateSuffix="</state></xml>";
};
AsynchDATARequest.prototype=new AsynchRequest();
AsynchDATARequest.baseConstructor=AsynchRequest;
AsynchDATARequest.prototype.getEndOfStateIdx=function(){
if(this.m_endOfStateIdx==-1){
var _1184=this.getResponseText().substring(0,12);
if(_1184==this.cStatePrefix){
this.m_endOfStateIdx=this.getResponseText().indexOf(this.cStateSuffix);
if(this.m_endOfStateIdx!=-1){
this.m_endOfStateIdx+=this.cStateSuffix.length;
}
}
}
return this.m_endOfStateIdx;
};
AsynchDATARequest.prototype.getResponseStateText=function(){
if(!this.m_sResponseState){
this.getResponseState();
}
return this.m_sResponseState;
};
AsynchDATARequest.prototype.getResponseState=function(){
if(this.m_oResponseState==null&&this.getEndOfStateIdx()!=-1){
this.m_sResponseState=this.getResponseText().substring(this.cStatePrefix.length,this.getEndOfStateIdx()-this.cStateSuffix.length);
if(this.m_sResponseState!=null){
this.m_sResponseState=xml_decode(this.m_sResponseState);
this.m_oResponseState=eval("("+this.m_sResponseState+")");
}
}
return this.m_oResponseState;
};
AsynchDATARequest.prototype.getAsynchStatus=function(){
if(this.getResponseState()!=null&&typeof this.getResponseState().m_sStatus!="undefined"){
return this.getResponseState().m_sStatus;
}
return "unknown";
};
AsynchDATARequest.prototype.getTracking=function(){
if(this.getResponseState()!=null&&typeof this.getResponseState().m_sTracking!="undefined"){
return this.getResponseState().m_sTracking;
}
return "";
};
AsynchDATARequest.prototype.getConversation=function(){
if(this.getResponseState()!=null&&typeof this.getResponseState().m_sConversation!="undefined"){
return this.getResponseState().m_sConversation;
}
return "";
};
AsynchDATARequest.prototype.getPrimaryAction=function(){
if(this.getResponseState()!=null&&typeof this.getResponseState().envParams!="undefined"&&this.getResponseState().envParams["ui.primaryAction"]!="undefined"){
return this.getResponseState().envParams["ui.primaryAction"];
}
return "";
};
AsynchDATARequest.prototype.getActionState=function(){
if(this.getResponseState()!=null&&typeof this.getResponseState().m_sActionState!="undefined"){
return this.getResponseState().m_sActionState;
}
return "";
};
AsynchDATARequest.prototype.getResult=function(){
if(this.getEndOfStateIdx()!=-1){
return this.getResponseText().substring(this.getEndOfStateIdx(),this.getResponseText().length);
}
return "";
};
AsynchDATARequest.prototype.getDebugLogs=function(){
if(this.getResponseState()!=null&&typeof this.getResponseState().debugLogs!="undefined"){
return this.getResponseState().debugLogs;
}
return "";
};
AsynchDATARequest.prototype.getPromptHTMLFragment=function(){
return this.getResult();
};
AsynchDATARequest.prototype.constructFaultEnvelope=function(){
if(this.m_soapFault==null){
var state=this.getResponseState();
if(state!=null){
if(state.m_sSoapFault){
var _1186=state.m_sSoapFault;
this.m_soapFault=XMLBuilderLoadXMLFromString(_1186);
}
}
}
return this.m_soapFault;
};
AsynchDATARequest.prototype.construct=function(){
var _1187=new AsynchDATARequest(this.m_gateway,this.m_webContentRoot);
_1187.setCallbacks(this.m_callbacks);
if(this.getFormFields().exists("cv.responseFormat")){
_1187.addFormField("cv.responseFormat",this.getFormField("cv.responseFormat"));
}else{
_1187.addFormField("cv.responseFormat","data");
}
return _1187;
};
AsynchDATARequest.prototype.getEnvParam=function(param){
var _1189=this.getResponseState();
if(_1189&&typeof _1189.envParams!="undefined"&&typeof _1189.envParams[param]!="undefined"){
return _1189.envParams[param];
}
return null;
};
AsynchDATARequest.prototype.isRAPWaitTrue=function(){
var _118a=this.getEnvParam("rapWait");
if(_118a!=null){
return _118a=="true"?true:false;
}
return false;
};
AsynchDATARequest.prototype.getRAPRequestCache=function(){
return this.getEnvParam("rapRequestCache");
};
AsynchDATARequest.prototype.getMainConversation=function(){
return this.getEnvParam("mainConversation");
};
AsynchDATARequest.prototype.getMainTracking=function(){
return this.getEnvParam("mainTracking");
};
function AsynchJSONRequest(_118b,_118c){
AsynchJSONRequest.baseConstructor.call(this,_118b,_118c);
this.m_jsonResponse=null;
};
AsynchJSONRequest.prototype=new AsynchRequest();
AsynchJSONRequest.baseConstructor=AsynchRequest;
AsynchJSONRequest.prototype.getJSONResponseObject=function(){
if(this.m_jsonResponse==null){
if(this.getResponseHeader("Content-type").indexOf("application/json")!=-1){
var text=this.getResponseText();
if(text!=null){
var _118e=this.removeInvalidCharacters(text);
this.m_jsonResponse=eval("("+_118e+")");
}
}
}
return this.m_jsonResponse;
};
AsynchJSONRequest.prototype.getTracking=function(){
var _118f=this.getJSONResponseObject();
if(_118f){
return _118f.tracking;
}
return "";
};
AsynchJSONRequest.prototype.getConversation=function(){
var _1190=this.getJSONResponseObject();
if(_1190){
return _1190.conversation;
}
return "";
};
AsynchJSONRequest.prototype.getAsynchStatus=function(){
var _1191=this.getJSONResponseObject();
if(_1191){
return _1191.status;
}
return "unknown";
};
AsynchJSONRequest.prototype.getPrimaryAction=function(){
var _1192=this.getJSONResponseObject();
if(_1192){
return _1192.primaryAction;
}
return "";
};
AsynchJSONRequest.prototype.getActionState=function(){
var _1193=this.getJSONResponseObject();
if(_1193){
return _1193.actionState;
}
return "";
};
AsynchJSONRequest.prototype.getDebugLogs=function(){
var _1194=this.getJSONResponseObject();
if(_1194){
return _1194.debugLogs;
}
return "";
};
AsynchJSONRequest.prototype.isRAPWaitTrue=function(){
var _1195=this.getJSONResponseObject();
if(_1195){
return (_1195.rapWait==="true");
}
return false;
};
AsynchJSONRequest.prototype.getRAPRequestCache=function(){
var _1196=this.getJSONResponseObject();
if(_1196){
var _1197=_1196.rapRequestCache;
if(_1197!==null&&typeof _1197!="undefined"){
return _1197;
}
}
return null;
};
AsynchJSONRequest.prototype.getMainConversation=function(){
var _1198=this.getJSONResponseObject();
if(_1198){
return _1198.mainConversation;
}
return null;
};
AsynchJSONRequest.prototype.getMainTracking=function(){
var _1199=this.getJSONResponseObject();
if(_1199){
return _1199.mainTracking;
}
return null;
};
AsynchJSONRequest.prototype.getResult=function(){
var _119a=this.getJSONResponseObject();
if(_119a&&_119a.json){
var _119b=this.removeInvalidCharacters(_119a.json);
return eval("("+_119b+")");
}
return null;
};
AsynchJSONRequest.prototype.removeInvalidCharacters=function(text){
if(text){
text=text.replace(/(\n|\r|\t)+/g,"");
}
return text;
};
AsynchJSONRequest.prototype.getPromptHTMLFragment=function(){
var _119d=this.getJSONResponseObject();
if(_119d&&_119d.promptHTMLFragment){
return _119d.promptHTMLFragment;
}
return "";
};
AsynchJSONRequest.prototype.constructFaultEnvelope=function(){
if(this.m_soapFault==null){
var _119e=this.getJSONResponseObject();
if(_119e.status=="fault"){
this.m_soapFault=XMLBuilderLoadXMLFromString(_119e.fault);
}
}
return this.m_soapFault;
};
AsynchJSONRequest.prototype.construct=function(){
var _119f=new AsynchJSONRequest(this.m_gateway,this.m_webContentRoot);
_119f.setCallbacks(this.m_callbacks);
if(this.getFormFields().exists("cv.responseFormat")){
_119f.addFormField("cv.responseFormat",this.getFormField("cv.responseFormat"));
}else{
_119f.addFormField("cv.responseFormat","asynchJSON");
}
return _119f;
};
function IFaultDialog(){
};
IFaultDialog.prototype.show=function(){
if(typeof console!="undefined"){
console.log("Required method IFaultDialog:show not implemented.");
}
};
IFaultDialog.prototype.handleUnknownHTMLResponse=function(){
if(typeof console!="undefined"){
console.log("Required method IFaultDialog:handlerUnknownHTMLResponse not implemented.");
}
};
function ILogOnDialog(){
};
ILogOnDialog.prototype.show=function(_11a0){
if(typeof console!="undefined"){
console.log("Required method ILogOnDialog:show not implemented.");
}
};
ILogOnDialog.prototype.handleUnknownHTMLResponse=function(_11a1){
if(typeof console!="undefined"){
console.log("Required method ILogOnDialog:handleUnknownHTMLResponse not implemented.");
}
};
function IPromptDialog(){
};
IPromptDialog.prototype.initialize=function(url,width,_11a4){
if(typeof console!="undefined"){
console.log("Required method IModalDialog:initialize not implemented.");
}
};
IPromptDialog.prototype.show=function(){
if(typeof console!="undefined"){
console.log("Required method IModalDialog:show not implemented.");
}
};
IPromptDialog.prototype.hide=function(){
if(typeof console!="undefined"){
console.log("Required method IModalDialog:hide not implemented.");
}
};
function IRequestHandler(){
};
IRequestHandler.prototype.preHttpRequest=function(_11a5){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:preHttpRequest not implemented.");
}
};
IRequestHandler.prototype.postHttpRequest=function(_11a6){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:postHttpRequest not implemented.");
}
};
IRequestHandler.prototype.postComplete=function(_11a7){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:postComplete not implemented.");
}
};
IRequestHandler.prototype.onComplete=function(_11a8){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:onComplete not implemented.");
}
};
IRequestHandler.prototype.onPostEntryComplete=function(_11a9){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:onPostEntryComplete not implemented.");
}
};
IRequestHandler.prototype.onFault=function(_11aa){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:onFault not implemented.");
}
};
IRequestHandler.prototype.onPrompting=function(_11ab){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:onPrompting not implemented.");
}
};
IRequestHandler.prototype.onWorking=function(_11ac){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:onWorking not implemented.");
}
};
IRequestHandler.prototype.setWorkingDialog=function(_11ad){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:setWorkingDialog not implemented.");
}
};
IRequestHandler.prototype.setRequestIndicator=function(_11ae){
if(typeof console!="undefined"){
console.log("Required method IRequestHandler:setExecutionCursor not implemented.");
}
};
function IRequestIndicator(){
};
IRequestIndicator.prototype.show=function(){
if(typeof console!="undefined"){
console.log("Required method IRequestIndicator:show not implemented.");
}
};
IRequestIndicator.prototype.hide=function(){
if(typeof console!="undefined"){
console.log("Required method IRequestIndicator:hide not implemented.");
}
};
function BaseRequestHandler(oCV){
if(oCV){
this.m_oCV=oCV;
this.m_workingDialog=null;
this.m_requestIndicator=null;
this.m_faultDialog=null;
this.m_logOnDialog=null;
this.m_promptDialog=null;
this.m_httpRequestConfig=this.m_oCV.getConfig()&&this.m_oCV.getConfig().getHttpRequestConfig()?this.m_oCV.getConfig().getHttpRequestConfig():null;
}
};
BaseRequestHandler.prototype=new IRequestHandler();
BaseRequestHandler.prototype.onError=function(_11b0){
};
BaseRequestHandler.prototype.onComplete=function(){
};
BaseRequestHandler.prototype.onPrompting=function(){
};
BaseRequestHandler.prototype.resubmitInSafeMode=function(){
};
BaseRequestHandler.prototype.massageHtmlBeforeDisplayed=function(){
};
BaseRequestHandler.prototype.onPostEntryComplete=function(){
this._processDelayedLoadingQueue();
};
BaseRequestHandler.prototype.getViewer=function(){
return this.m_oCV;
};
BaseRequestHandler.prototype.setDispatcherEntry=function(_11b1){
this.m_oDispatcherEntry=_11b1;
};
BaseRequestHandler.prototype.getDispatcherEntry=function(){
return this.m_oDispatcherEntry;
};
BaseRequestHandler.prototype.processInitialResponse=function(_11b2){
this.updateViewerState(_11b2);
};
BaseRequestHandler.prototype.setLogOnDialog=function(_11b3){
if(_11b3==null){
this.m_logOnDialog=null;
}else{
if(_11b3 instanceof ILogOnDialog){
this.m_logOnDialog=_11b3;
}else{
if(_11b3&&typeof console!="undefined"){
console.log("The parameter logOnDialog must be an instance of ILogOnDialog");
}
}
}
};
BaseRequestHandler.prototype.setWorkingDialog=function(_11b4){
if(_11b4==null){
this.m_workingDialog=null;
}else{
if(this.m_httpRequestConfig&&this.m_httpRequestConfig.getWorkingDialog()){
this.m_workingDialog=this.m_httpRequestConfig.getWorkingDialog();
}else{
if(_11b4 instanceof IRequestIndicator){
this.m_workingDialog=_11b4;
}else{
if(_11b4&&typeof console!="undefined"){
console.log("The parameter workingDialog must be an instance of IRequestIndicator");
}
}
}
}
};
BaseRequestHandler.prototype.getWorkingDialog=function(){
return this.m_workingDialog;
};
BaseRequestHandler.prototype.setRequestIndicator=function(_11b5){
if(_11b5==null){
this.m_requestIndicator=null;
}else{
if(this.m_httpRequestConfig&&this.m_httpRequestConfig.getRequestIndicator()){
this.m_requestIndicator=this.m_httpRequestConfig.getRequestIndicator();
}else{
if(_11b5 instanceof IRequestIndicator){
this.m_requestIndicator=_11b5;
}else{
if(_11b5&&typeof console!="undefined"){
console.log("The parameter requestIndicator must be an instance of IRequestIndicator");
}
}
}
}
};
BaseRequestHandler.prototype.getRequestIndicator=function(){
return this.m_requestIndicator;
};
BaseRequestHandler.prototype.setFaultDialog=function(_11b6){
if(_11b6==null){
this.m_faultDialog=null;
}else{
if(_11b6 instanceof IFaultDialog){
this.m_faultDialog=_11b6;
}else{
if(_11b6&&typeof console!="undefined"){
console.log("The parameter faultDialog must be an instance of IFaultDialog");
}
}
}
};
BaseRequestHandler.prototype.setPromptDialog=function(_11b7){
if(_11b7==null){
this.m_promptDialog=null;
}else{
if(_11b7 instanceof IPromptDialog){
this.m_promptDialog=_11b7;
}else{
if(_11b7&&typeof console!="undefined"){
console.log("The parameter promptDialog must be an instance of IPromptDialog");
}
}
}
};
BaseRequestHandler.prototype.preHttpRequest=function(_11b8){
if(_11b8&&typeof _11b8.getFormField=="function"){
if(_11b8.getFormField("ui.action")!="wait"&&_11b8.getFormField("rapWait")!="true"){
if(this.m_requestIndicator){
this.m_requestIndicator.show();
}
}
}
};
BaseRequestHandler.prototype.postHttpRequest=function(_11b9){
if(_11b9&&typeof _11b9.getAsynchStatus=="function"){
var _11ba=_11b9.getAsynchStatus();
if(_11ba!="working"&&_11ba!="stillWorking"){
if(this.m_workingDialog){
this.m_workingDialog.hide();
}
if(this.m_requestIndicator){
this.m_requestIndicator.hide();
}
}
}else{
if(this.m_workingDialog){
this.m_workingDialog.hide();
}
if(this.m_requestIndicator){
this.m_requestIndicator.hide();
}
}
};
BaseRequestHandler.prototype.onFault=function(_11bb){
var oCV=this.getViewer();
if(this.m_workingDialog){
this.m_workingDialog.hide();
}
if(this.m_requestIndicator){
this.m_requestIndicator.hide();
}
if(typeof FaultDialog=="undefined"){
if(typeof console!="undefined"){
console.log("An unhandled fault was returned: %o",_11bb);
}
return;
}
if(!this.m_faultDialog){
this.m_faultDialog=new FaultDialog(this.getViewer());
}
if(_11bb&&_11bb.getResponseHeader&&_11bb.getResponseHeader("Content-type").indexOf("text/html")!=-1){
this.m_faultDialog.handleUnknownHTMLResponse(_11bb.getResponseText());
}else{
if(_11bb&&_11bb.getSoapFault){
this.m_faultDialog.show(_11bb.getSoapFault());
}else{
if(oCV.getSoapFault()){
var _11bd=XMLBuilderLoadXMLFromString(oCV.getSoapFault());
this.m_faultDialog.show(_11bd);
oCV.setSoapFault("");
}else{
if(typeof console!="undefined"){
console.log("An unhandled fault was returned: %o",_11bb);
}
}
}
}
};
BaseRequestHandler.prototype.isAuthenticationFault=function(_11be){
var oCV=this.getViewer();
var _11c0=null;
if(_11be&&_11be.getSoapFault){
_11c0=_11be.getSoapFault();
}else{
if(oCV.getSoapFault()){
_11c0=XMLBuilderLoadXMLFromString(oCV.getSoapFault());
}
}
if(_11c0!=null){
var _11c1=XMLHelper_FindChildByTagName(_11c0,"CAM",true);
return (_11c1!=null&&XMLHelper_FindChildByTagName(_11c1,"promptInfo",true)!=null);
}
return false;
};
BaseRequestHandler.prototype.onPassportTimeout=function(_11c2){
var oCV=this.getViewer();
if(this.m_workingDialog){
this.m_workingDialog.hide();
}
if(this.m_requestIndicator){
this.m_requestIndicator.hide();
}
if(!this.m_logOnDialog){
this.m_logOnDialog=new LogOnDialog(this.getViewer());
}
if(_11c2&&_11c2.getResponseHeader&&_11c2.getResponseHeader("Content-type").indexOf("text/html")!=-1){
var _11c4="";
if(_11c2.getResponseText){
_11c4=_11c2.getResponseText();
}
if((_11c4.indexOf("http-equiv=\"refresh\"")!=-1)||(_11c4.indexOf("http-equiv='refresh'")!=-1)){
this.m_logOnDialog.show(null);
}else{
this.m_logOnDialog.handleUnknownHTMLResponse(_11c4);
}
}else{
if(_11c2&&_11c2.getSoapFault){
this.m_logOnDialog.show(_11c2.getSoapFault());
}else{
if(oCV.getSoapFault()){
var _11c5=XMLBuilderLoadXMLFromString(oCV.getSoapFault());
this.m_logOnDialog.show(_11c5);
oCV.setSoapFault("");
}else{
if(typeof console!="undefined"){
console.log("BaseRequestHandler.prototype.onPassportTimeout: An unhandled authentication fault was returned: %o",_11c2);
}
}
}
}
};
BaseRequestHandler.prototype.onWorking=function(_11c6){
if(this.m_workingDialog){
var _11c7=_11c6&&typeof _11c6.getAsynchStatus=="function"&&_11c6.getAsynchStatus()=="stillWorking"?true:false;
if(!_11c7){
if(this.m_requestIndicator){
this.m_requestIndicator.hide();
}
this.m_workingDialog.show();
}
}
};
BaseRequestHandler.prototype.onCancel=function(){
if(this.m_workingDialog){
this.m_workingDialog.hide();
}
if(this.m_requestIndicator){
this.m_requestIndicator.hide();
}
var oCV=this.getViewer();
oCV.gbPromptRequestSubmitted=false;
this._processDelayedLoadingQueue();
};
BaseRequestHandler.prototype._processDelayedLoadingQueue=function(){
var oCV=this.getViewer();
if(oCV&&oCV.getViewerWidget()){
var _11ca=oCV.getViewerWidget();
if(_11ca.getLoadManager()){
_11ca.getLoadManager().processQueue();
}
}
};
BaseRequestHandler.prototype.onPrompting=function(_11cb){
var oCV=this.getViewer();
if(this.m_workingDialog){
this.m_workingDialog.hide();
}
if(this.m_requestIndicator){
this.m_requestIndicator.hide();
}
if(!this.m_promptDialog){
this.m_promptDialog=new PromptDialog(this.getViewer());
}
window["AsynchRequestObject"]=_11cb;
window["AsynchRequestPromptDialog"]=this.m_promptDialog;
var _11cd="?cv.id="+oCV.getId();
window["AsynchRequestPromptDialog"].initialize(oCV.getWebContentRoot()+"/rv/showStandalonePrompts.html"+_11cd,400,400);
window["AsynchRequestPromptDialog"].show();
};
BaseRequestHandler.prototype.processDATAReportResponse=function(_11ce){
var oCV=this.getViewer();
if(!oCV||oCV.m_destroyed){
if(console){
console.warn("Tried to process a data response on an invalid CCognosViewer",oCV);
}
return;
}
var _11d0=_11ce.getResponseState();
if(!_11d0){
this.resubmitInSafeMode();
}
if(this.loadReportHTML(_11ce.getResult())===false){
this.resubmitInSafeMode();
}
this.updateViewerState(_11d0);
};
BaseRequestHandler.prototype.updateViewerState=function(_11d1){
var oCV=this.getViewer();
applyJSONProperties(oCV,_11d1);
var _11d3=oCV.getStatus();
if(typeof oCV.envParams["ui.spec"]!="undefined"&&oCV.envParams["ui.spec"].indexOf("&lt;")===0){
oCV.envParams["ui.spec"]=xml_decode(oCV.envParams["ui.spec"]);
}
if(_11d3!="fault"){
if(oCV.envParams["rapReportInfo"]){
this._processRapReportInfo(oCV);
}
if(typeof _11d1.clientunencodedexecutionparameters!="undefined"){
var _11d4=document.getElementById("formWarpRequest"+oCV.getId());
if(_11d4!=null&&typeof _11d4["clientunencodedexecutionparameters"]!="undefined"){
_11d4["clientunencodedexecutionparameters"].value=_11d1.clientunencodedexecutionparameters;
}
if(typeof document.forms["formWarpRequest"]!="undefined"&&typeof document.forms["formWarpRequest"]["clientunencodedexecutionparameters"]!="undefined"){
document.forms["formWarpRequest"]["clientunencodedexecutionparameters"].value=_11d1.clientunencodedexecutionparameters;
}
}
}else{
oCV.setTracking("");
}
};
BaseRequestHandler.prototype._processRapReportInfo=function(oCV){
if(oCV.envParams["rapReportInfo"]){
var _11d6=eval("("+oCV.envParams["rapReportInfo"]+")");
if(typeof RAPReportInfo!="undefined"){
var _11d7=new RAPReportInfo(_11d6,oCV);
oCV.setRAPReportInfo(_11d7);
}
}
};
BaseRequestHandler.prototype.loadReportHTML=function(_11d8){
if(!_11d8){
return true;
}
var oCV=this.getViewer();
if(window.IBM&&window.IBM.perf){
window.IBM.perf.log("viewer_gotHtml",oCV);
}
if(oCV.m_undoStack.length>0){
oCV.m_undoStack[oCV.m_undoStack.length-1].m_bRefreshPage=true;
}
oCV.pageNavigationObserverArray=[];
oCV.m_flashChartsObjectIds=[];
var sHTML=_11d8.replace(/<form[^>]*>/gi,"").replace(/<\/form[^>]*>/gi,"");
oCV.m_sHTML=sHTML;
oCV.setHasPrompts(false);
var id=oCV.getId();
var _11dc=document.getElementById("RVContent"+id);
var _11dd=document.getElementById("CVReport"+id);
if(window.gScriptLoader){
var _11de=oCV.getViewerWidget()?true:false;
var _11df=oCV.getViewerWidget()?document.getElementById("_"+oCV.getViewerWidget().iContext.widgetId+"_cv"):_11dd;
sHTML=window.gScriptLoader.loadCSS(sHTML,_11df,_11de,id);
}
if(oCV.sBrowser=="ie"){
sHTML="<span style='display:none'>&nbsp;</span>"+sHTML;
}
_11dd.innerHTML=sHTML;
this.massageHtmlBeforeDisplayed();
if(window.gScriptLoader){
var _11e0=GUtil.generateCallback(oCV.showLoadedContent,[_11dc],oCV);
oCV.m_resizeReady=false;
if(!window.gScriptLoader.loadAll(_11dd,_11e0,id,true)){
if(window.gScriptLoader.containsAjaxWarnings()){
return false;
}
}
}else{
_11dc.style.display="block";
}
var _11e1=document.querySelectorAll("button");
var _11e2=_11e1.length;
for(var k=0;k<_11e2;k++){
var _11e4=_11e1[k];
var id=_11e4.id;
var _11e5=id.match(/reprompt/);
if(_11e5){
var _11e6=_11e4.outerHTML;
var _11e7=_11e6.match(/layoutname="\w+"/);
if(_11e7!==null){
var _11e8=_11e7[0];
var _11e9=/".*"/;
var _11ea=_11e9.exec(_11e8);
if(oCV.getCurrentPromptControlFocus()==_11ea){
_11e4.focus();
oCV.setCurrentPromptControlFocus(null);
_11e4=null;
}
}else{
oCV.setCurrentPromptControlFocus(null);
_11e4=null;
}
}
}
oCV.updateOutputForA11ySupport();
this._clearFindState();
return true;
};
BaseRequestHandler.prototype._clearFindState=function(){
var oCV=this.getViewer();
var _11ec=oCV.getState()&&oCV.getState().getFindState()?oCV.getState().getFindState():null;
if(_11ec&&!_11ec.findOnServerInProgress()){
oCV.getState().clearFindState();
}
};
BaseRequestHandler.prototype.showReport=function(){
var oCV=this.getViewer();
var _11ee=document.getElementById("CVReport"+oCV.getId());
if(_11ee){
_11ee.style.display="";
}
};
BaseRequestHandler.prototype.postComplete=function(){
var oCV=this.getViewer();
if(oCV.shouldWriteNavLinks()){
oCV.writeNavLinks(oCV.getSecondaryRequests().join(" "));
}
if(oCV.getStatus()==="complete"){
oCV.m_undoStack=[new CognosViewerSession(oCV)];
}
};
BaseRequestHandler.prototype.onAsynchStatusUpdate=function(_11f0){
if(this.m_httpRequestConfig){
var _11f1=this.m_httpRequestConfig.getReportStatusCallback(_11f0);
if(_11f1){
_11f1();
}
}
};
BaseRequestHandler.prototype.addCallbackHooks=function(){
if(!this.m_httpRequestConfig){
return;
}
this._addCallback("complete","onComplete");
this._addCallback("working","onWorking");
this._addCallback("prompting","onPrompting");
};
BaseRequestHandler.prototype._addCallback=function(_11f2,_11f3){
var _11f4=_11f2;
var _11f5=this[_11f3];
this[_11f3]=function(_11f6){
_11f5.apply(this,arguments);
var _11f7=null;
if(_11f6&&typeof _11f6.getAsynchStatus=="function"){
_11f7=_11f6.getAsynchStatus();
}else{
_11f7=_11f4=="complete"?this.getViewer().getStatus():_11f4;
}
if(_11f7=="stillWorking"){
return;
}
var _11f8=this.m_httpRequestConfig.getReportStatusCallback(_11f7);
if(typeof _11f8=="function"){
setTimeout(_11f8,10);
}
};
};
dojo.provide("FaultDialog");
dojo.declare("FaultDialog",IFaultDialog,{m_soapFault:null,m_errorMessage:null,m_oCV:null,constructor:function(oCV){
this.m_oCV=oCV;
},show:function(_11fa){
this.m_soapFault=_11fa;
this.m_oCV.m_resizeReady=true;
this.renderInlineDialog();
this.m_oCV.getViewerWidget().setErrorDlg(this);
},handleUnknownHTMLResponse:function(_11fb){
if(_11fb){
var _11fc=window.open("","","height=400,width=500");
if(_11fc!=null){
_11fc.document.write(_11fb);
}
}
},canRetryRequest:function(){
var _11fd=true;
var _11fe=XMLHelper_FindChildrenByTagName(this.m_soapFault,"allowRetry",true);
if(_11fe.length>0){
_11fd=(XMLHelper_GetText(_11fe[0],false)==="true");
}
return _11fd;
},isWarningMessage:function(){
return false;
},getButtons:function(){
var _11ff=[{label:RV_RES.IDS_JS_OK,action:dojo.hitch(this,this.ok)}];
if(this.canRetryRequest()){
_11ff.push({label:RV_RES.IDS_JS_RETRY,action:dojo.hitch(this,this.retry)});
}
return _11ff;
},renderInlineDialog:function(){
var _1200={"type":this.isWarningMessage()?"warning":"error","message":this.getErrorMessage(),"buttons":this.getButtons()};
var _1201=this.getDetails();
if(_1201&&_1201.length>0){
_1200.details=_1201;
}
this.m_oCV.getViewerWidget().fireEvent("com.ibm.bux.widget.notification",null,_1200);
},setErrorMessage:function(_1202){
this.m_errorMessage=_1202;
},getErrorMessage:function(){
if(this.m_errorMessage==null){
var _1203=XMLHelper_FindChildrenByTagName(this.m_soapFault,"message",true);
if(_1203.length>0){
var _1204=XMLHelper_FindChildByTagName(_1203[0],"messageString",false);
this.checkAndSetErrorMessage(XMLHelper_GetText(_1204,false));
}
}
return this.m_errorMessage;
},checkAndSetErrorMessage:function(_1205){
this.m_detailMessageStartIndex=1;
if(_1205.indexOf("RSV-BBP-0038")==0){
_1205=RV_RES.IDS_CONV_CANCELED_ERROR;
this.m_detailMessageStartIndex=0;
}
this.m_errorMessage=_1205;
},getDetails:function(){
var _1206="";
var _1207=XMLHelper_FindChildrenByTagName(this.m_soapFault,"message",true);
if(_1207.length>0){
if(typeof this.m_detailMessageStartIndex==="undefined"||this.m_detailMessageStartIndex===null){
this.m_detailMessageStartIndex=1;
}
for(var _1208=this.m_detailMessageStartIndex;_1208<_1207.length;++_1208){
var _1209=XMLHelper_FindChildByTagName(_1207[_1208],"messageString",false);
_1206+=XMLHelper_GetText(_1209,false)+"\n";
}
}
return _1206;
},retry:function(){
var _120a=this.m_oCV.getRetryDispatcherEntry();
this.hide();
if(_120a){
_120a.retryRequest();
}else{
var _120b=this.m_oCV.getViewerWidget().getOriginalFormFields();
if(_120b&&(_120b.get("b_action")=="cvx"||_120b.get("b_action")=="cvx.high")){
_120b.add("b_action","cognosViewer");
}
this.m_oCV.executeAction("RetryRequest",_120b);
}
},ok:function(){
var _120c=this.m_oCV.getRetryDispatcherEntry();
this.hide();
if(_120c){
_120c.onCloseErrorDlg();
}
},hide:function(){
this.m_oCV.getViewerWidget().fireEvent("com.ibm.bux.widget.notification",null,{remove:1});
this.m_oCV.getViewerWidget().setErrorDlg(null);
this.m_oCV.setRetryDispatcherEntry(null);
}});
function buxErrorPage_toggleErrorDetails(event,cvId,_120f){
if((event.button==0&&(event.keyCode=="0"||typeof event.keyCode=="undefined"))||event.keyCode=="32"||event.keyCode=="13"){
var _1210=document.getElementById("buxErrorPageDetailContentOuter"+cvId);
var _1211=document.getElementById("buxErrorPageDetails"+cvId);
var _1212=document.getElementById("titlePaneTitle"+cvId);
var _1213=(_1211.style.display=="none");
dojo.removeClass(_1210,_1213?"dijitTitlePaneContentOuterClosed":"dijitTitlePaneContentOuterOpen");
dojo.addClass(_1210,_1213?"dijitTitlePaneContentOuterOpen":"dijitTitlePaneContentOuterClosed");
dojo.removeClass(_1212,_1213?"dijitClose":"dijitOpen");
dojo.addClass(_1212,_1213?"dijitOpen":"dijitClose");
_1211.style.display=_1213?"":"none";
}
};
function ModalFaultDialog(){
};
ModalFaultDialog.prototype=new FaultDialog();
ModalFaultDialog.prototype.show=function(_1214){
var _1215="";
var _1216="",_1217="";
var _1218=XMLHelper_FindChildrenByTagName(_1214,"message",true);
if(_1218.length>0){
for(var _1219=1;_1219<_1218.length;++_1219){
_1217=XMLHelper_FindChildByTagName(_1218[_1219],"messageString",false);
_1215+=XMLHelper_GetText(_1217,false)+"\n";
}
_1217=XMLHelper_FindChildByTagName(_1218[0],"messageString",false);
_1216=XMLHelper_GetText(_1217,false);
}
bux.messageBox(bux.MB_ERROR,_1216,"",_1215);
};
dojo.provide("GlobalPromptFaultDialog");
dojo.require("FaultDialog");
dojo.declare("GlobalPromptFaultDialog",FaultDialog,{m_sendRequestOnOK:false,setSendRequestOnOK:function(_121a){
this.m_sendRequestOnOK=_121a;
},ok:function(){
this.hide();
this.m_oCV.getViewerWidget().disableListenToForGlobalPrompt();
if(this.m_sendRequestOnOK){
var _121b=this.m_oCV.getRetryDispatcherEntry();
var _121c=null;
if(_121b){
_121c=_121b.getOriginalFormFields();
}else{
_121c=this.m_oCV.getViewerWidget().getOriginalFormFields();
}
if(_121c&&_121c.exists("widget.globalPromptInfo")){
_121c.remove("widget.globalPromptInfo");
}
this.retry();
}
}});
dojo.provide("FaultMessageDialog");
dojo.declare("FaultMessageDialog",FaultDialog,{m_oCV:null,m_errorMessage:"",constructor:function(oCV,_121e){
this.m_errorMessage=_121e;
},getErrorMessage:function(){
return this.m_errorMessage;
},getDetails:function(){
return "";
},canRetryRequest:function(){
return false;
}});
dojo.provide("WarningMessageDialog");
dojo.declare("WarningMessageDialog",FaultMessageDialog,{constructor:function(oCV,_1220){
},isWarningMessage:function(){
return true;
}});
function LogOnDialog(oCV){
if(oCV){
this.m_oCV=oCV;
}
};
LogOnDialog.prototype=new ILogOnDialog();
LogOnDialog.prototype.getViewer=function(){
return this.m_oCV;
};
LogOnDialog.prototype.handleUnknownHTMLResponse=function(_1222){
this.show(null);
};
LogOnDialog.prototype.show=function(_1223){
var _1224=this.getPromptInfoNamespacesFromAuthenticationFault(_1223);
if(window["CVEditContentActionInstance"]){
window["CVEditContentActionInstance"].transitionFromBUA();
}
IWidgetLogonhandler.handleLogon(this.getViewer().getId(),_1224);
};
LogOnDialog.prototype.getPromptInfoNamespacesFromAuthenticationFault=function(_1225){
if(!_1225){
return null;
}
var _1226=XMLHelper_FindChildByTagName(_1225,"CAM",true);
if(_1226==null){
return null;
}
var _1227=XMLHelper_FindChildByTagName(_1226,"promptInfo",true);
if(_1227==null){
return null;
}
var _1228=XMLHelper_FindChildByTagName(_1226,"displayObjects",true);
if(_1228==null){
return null;
}
var items=XMLHelper_FindChildrenByTagName(_1228,"item",true);
if(items==null||items.length!=1){
return null;
}
var _122a=items[0];
if(_122a==null){
return null;
}
var _122b=XMLHelper_FindChildByTagName(_122a,"name",true);
var name=XMLHelper_GetText(_122b,false);
if(name==="CAMNamespace"){
var _122d=XMLHelper_FindChildByTagName(_122a,"value",true);
var value=XMLHelper_GetText(_122d,false);
if(value!=null){
return value;
}
}
return null;
};
dojo.provide("LogOnHandler");
dojo.declare("LogOnHandler",null,{constructor:function(){
this.m_cvIdList=[];
},handleLogon:function(cvId,_1230){
this.m_cvIdList.push(cvId);
if(this.m_cvIdList.length==1){
dojo["require"]("bux.dialogs.IFrameDialog");
var _1231=(_1230==null||_1230.length==0)?new bux.dialogs.LogonDialog({okHandler:GUtil.generateCallback(this.okHandler,[],this),cancelHandler:GUtil.generateCallback(this.cancelHandler,[],this)}):new bux.dialogs.LogonDialog({okHandler:GUtil.generateCallback(this.okHandler,[],this),cancelHandler:GUtil.generateCallback(this.cancelHandler,[],this),params:{"h_CAM_action":"logonAs","CAMNamespace":_1230}});
_1231.startup();
_1231.show();
}
},okHandler:function(){
for(var index=0;index<this.m_cvIdList.length;++index){
var cvId=this.m_cvIdList[index];
var oCV=window["oCV"+cvId];
if(index===0&&oCV.getViewerWidget){
oCV.getViewerWidget().fireEvent("com.ibm.bux.widget.action",null,{action:"refreshAfterLogon"});
}
if(oCV.getRetryDispatcherEntry()){
oCV.getRetryDispatcherEntry().retryRequest();
}else{
var _1235=oCV.getViewerWidget().getOriginalFormFields();
if(_1235){
oCV.executeAction("RetryRequest",_1235);
}
}
}
this.m_cvIdList=[];
},cancelHandler:function(){
for(var index=0;index<this.m_cvIdList.length;++index){
var cvId=this.m_cvIdList[index];
var oCV=window["oCV"+cvId];
if(oCV.getRetryDispatcherEntry()){
oCV.getRetryDispatcherEntry().onCloseErrorDlg();
}
}
this.m_cvIdList=[];
}});
IWidgetLogonhandler=new LogOnHandler();
function PromptDialog(oCV){
this.m_oCV=oCV;
this.m_url="";
this.m_width=0;
this.m_height=0;
this.m_dialogImpl=null;
};
PromptDialog.prototype=new IPromptDialog();
PromptDialog.prototype.initialize=function(url,width,_123c){
this.m_url=url;
this.m_width=width;
this.m_height=_123c;
};
PromptDialog.prototype.show=function(){
this.m_dialogImpl=new bux.dialogs.IFrameDialog();
this.m_dialogImpl.src=this.m_url;
this.m_dialogImpl.width=this.m_width;
this.m_dialogImpl.height=this.m_height;
this.m_dialogImpl.startup();
this.m_dialogImpl.show();
};
PromptDialog.prototype.hide=function(){
this.m_dialogImpl.hide();
this.m_dialogImpl.destroy();
delete this.m_dialogImpl;
this.m_dialogImpl=null;
};
function RequestHandler(oCV){
if(oCV){
RequestHandler.baseConstructor.call(this,oCV);
this.m_originalFormFields=null;
this.m_forceRaiseSharePrompt=false;
}
};
RequestHandler.prototype=new BaseRequestHandler();
RequestHandler.baseConstructor=BaseRequestHandler;
RequestHandler.prototype.parent=BaseRequestHandler.prototype;
RequestHandler.prototype.postHttpRequest=function(_123e){
var oCV=this.getViewer();
this.parent.postHttpRequest.call(this,_123e);
};
RequestHandler.prototype.setForceRaiseSharePrompt=function(bFlag){
this.m_forceRaiseSharePrompt=bFlag;
};
RequestHandler.prototype.preHttpRequest=function(_1241){
var oCV=this.getViewer();
var _1243=oCV.getViewerWidget();
oCV.setCurrentNodeFocus(null);
if(this.doRaiseSharePromptEvent(_1241)){
if(oCV.widgetHasPromptParameters()){
this.setRequestIndicator(new BaseRequestExecutedIndicator(oCV));
var _1244=this.getListOfCascadingPromptParametersToReset(oCV,_1241);
oCV.raisePromptEvent(oCV.envParams["reportPrompts"],_1241.getFormFields(),_1244);
}else{
if(!(_1243&&_1243.promptParametersRetrieved==true)){
var _1245=oCV.getAction("GetParameters");
_1245.isPrimaryPromptWidget=true;
_1245.execute();
}
}
}
oCV.resetRaiseSharePromptEventFlag();
this.parent.preHttpRequest.call(this,_1241);
};
RequestHandler.prototype.getListOfChangedPromptParameters=function(oCV,_1247){
var _1248=oCV.getOldParameters();
if(!_1248){
return null;
}
var _1249=[];
for(var _124a in _1248){
oldParmValueItems=_1248[_124a].m_parmValueItems;
var _124b=_1247.getFormFields().get("p_"+_124a);
if(!_124b){
continue;
}
for(var j=0;j<oldParmValueItems.length;++j){
var _124d=sXmlEncode(oldParmValueItems[j].m_useValue);
if(_124b.indexOf(_124d)<0){
_1249.push("p_"+_124a);
}
}
}
return _1249;
};
RequestHandler.prototype.getListOfCascadingPromptParametersToReset=function(oCV,_124f){
if(!oCV.preProcessControlArray){
return null;
}
var _1250=this.getListOfChangedPromptParameters(oCV,_124f);
if(!_1250||!_1250.length){
return null;
}
var _1251=[];
var _1252=oCV.preProcessControlArray.length;
var _1253=_1250.slice();
for(var k=0;k<_1252;k++){
var _1255=(oCV.preProcessControlArray[k]);
if(!_1255.getCascadeOnParameter){
return;
}
var _1256=_1255.getCascadeOnParameter();
if(!_1256){
continue;
}
var _1257=_1255.getParameterName();
var _1258=_1256.getName();
if(this.contains(_1253,_1258)&&!this.contains(_1253,_1257)){
_1253.push(_1257);
_1251.push(_1257);
}
}
return _1251;
};
RequestHandler.prototype.contains=function(a,obj){
var i=a.length;
while(i--){
if(a[i]===obj){
return true;
}
}
return false;
};
RequestHandler.prototype.doRaiseSharePromptEvent=function(_125c){
var oCV=this.getViewer();
var _125e=false;
var _125f=_125c.getFormField("ui.action");
if(((typeof _125f!=="undefined"&&(_125f==="forward"||_125f==="back"))&&oCV.m_raiseSharePromptEvent)||this.m_forceRaiseSharePrompt){
_125e=true;
var _1260=null;
var _1261=false;
var _1262=0;
var _1263=_125c.getFormFields();
var keys=_1263.keys();
for(_1260 in keys){
_1260=keys[_1260];
if(_1260=="_promptControl"&&_1263.get(_1260)=="search"){
_125e=false;
break;
}else{
if(_1260.indexOf("p_")===0){
if(_1260.indexOf("p_credential:")===0){
_1261=true;
}else{
_1262+=1;
}
}
}
}
if(_125e&&_1261&&_1262===0){
_125e=false;
}
}
return _125e;
};
RequestHandler.prototype.onComplete=function(_1265){
var oCV=this.getViewer();
if(oCV&&!oCV.m_destroyed){
this.parent.onComplete.call(this,_1265);
this.processDATAReportResponse(_1265);
this.postComplete();
}else{
if(console){
console.warn("Tried to complete a request on an invalid CCognosViewer",oCV);
}
}
};
RequestHandler.prototype.onPrompting=function(_1267){
var oCV=this.getViewer();
if(oCV&&!oCV.m_destroyed){
var _1269=oCV.getViewerWidget();
_1269.hideToolbarAndContextMenu();
this.onComplete(_1267);
}else{
if(console){
console.warn("Tried to prompt on an invalid CCognosViewer",oCV);
}
}
};
RequestHandler.prototype.onError=function(_126a){
var oCV=this.getViewer();
if(_126a&&oCV){
var _126c=oCV.getViewerWidget();
if(typeof console!="undefined"&&console&&console.log){
console.log("Viewer http error: "+_126a.getResponseText()+" "+_126a.getStatus());
}
_126c.fireEvent("com.ibm.bux.widget.action",null,{action:"httpError",responseText:_126a.getResponseText(),status:_126a.getStatus()});
}
};
RequestHandler.prototype.onFault=function(_126d){
var oCV=this.getViewer();
var _126f=oCV.getViewerWidget();
var _1270=oCV.getRetryDispatcherEntry();
if(_1270&&_1270.getOriginalFormFields()){
this.m_originalFormFields=_1270.getOriginalFormFields();
}else{
this.m_originalFormFields=_126f.getOriginalFormFields();
}
if(window["gReportWidgetLoadQueue"]){
window["gReportWidgetLoadQueue"].widgetDoneLoading(_126f);
}
if(this.isGlobalPromptException()){
this.handleGlobalPromptException();
}
if(this.isMissingMemberException(oCV,_126d)){
this.handleMissingMemberException(oCV);
}
if(oCV.envParams&&oCV.envParams["updateToolbar"]==="true"){
_126f.savedOutputMenuUpdated=false;
_126f.updateToolbar();
}
if(oCV.envParams&&oCV.envParams["ui.action"]==="buxView"){
_126f.setSavedOutputsCMResponse(null);
}
if(typeof _126f.postOnFault=="function"){
_126f.postOnFault();
}
this.parent.onFault.call(this,_126d);
if(_1270&&_126d&&_126d.getResponseState){
var _1271=_126d.getResponseState();
if(_1271){
this.updateViewerState(_1271);
}
this.onPostEntryComplete();
}
};
RequestHandler.prototype.handleGlobalPromptException=function(){
var oCV=this.getViewer();
var _1273=new GlobalPromptFaultDialog(oCV);
oCV.disableRaiseSharePromptEvent();
if(this.m_originalFormFields&&!this.m_originalFormFields.exists("sharedPromptRequest")){
_1273.setSendRequestOnOK(true);
}
_1273.setErrorMessage(RV_RES.IDS_JS_GLOBAL_PROMPTS_NOT_RESPONDING_WARNING);
this.setFaultDialog(_1273);
};
RequestHandler.prototype.isGlobalPromptException=function(){
var oCV=this.getViewer();
if(this.m_originalFormFields){
if(this.m_originalFormFields.exists("sharedPromptRequest")||(this.m_originalFormFields.get("ui.reportDrop")==="true"&&this.m_originalFormFields.exists("widget.globalPromptInfo"))){
return true;
}
}
return false;
};
RequestHandler.prototype.postComplete=function(){
var oCV=this.getViewer();
if(oCV.getStatus()=="complete"&&!oCV.inlineScriptsDoneExecuting){
var _1276=this;
setTimeout(function(){
_1276.postComplete();
},10);
return;
}
this.parent.postComplete.call(this);
if(oCV&&oCV.m_destroyed){
if(console){
console.warn("Tried to postComplete on an invalid CCognosViewer",oCV);
}
return;
}
var _1277=oCV.getViewerWidget();
if(window["gReportWidgetLoadQueue"]){
window["gReportWidgetLoadQueue"].widgetDoneLoading(_1277);
}
this.showReport();
oCV.getSelectionController().clearSelectionData();
oCV.addPageAdornments();
_1277.savedOutputMenuUpdated=false;
if(oCV.getStatus()!="prompting"){
_1277.fetchAnnotationData();
_1277.getUndoRedoQueue().add({"reportUpdated":true});
}
_1277.updateToolbar();
oCV.m_stateSet=true;
oCV.doneLoading();
if(typeof _1277.postComplete=="function"){
_1277.postComplete();
}
};
RequestHandler.prototype.updateViewerState=function(_1278){
var oCV=this.getViewer();
if(oCV&&oCV.m_destroyed){
if(console){
console.warn("Tried to update state on an invalid CCognosViewer",oCV);
}
return;
}
this.parent.updateViewerState.call(this,_1278);
var _127a=oCV.getStatus();
if(_127a!="fault"){
if(oCV.envParams["buxToolbarPayload"]){
oCV.setToolbar(eval(oCV.envParams["buxToolbarPayload"]));
delete oCV.envParams["buxToolbarPayload"];
}
if(oCV.envParams["buxContextMenuPayload"]){
oCV.setContextMenu(eval(oCV.envParams["buxContextMenuPayload"]));
delete oCV.envParams["buxContextMenuPayload"];
}
if(oCV.envParams.reportPrompts){
oCV.getViewerWidget().setPromptParametersRetrieved(true);
}
if(oCV.envParams.reRunObject){
var _127b=document.getElementById("formWarpRequest"+oCV.getId());
if(_127b["reRunObj"]){
_127b["reRunObj"].value=oCV.envParams.reRunObject;
}else{
_127b.appendChild(createHiddenFormField("reRunObj",oCV.envParams.reRunObject));
}
}
}
};
RequestHandler.prototype.processInitialResponse=function(_127c){
var oCV=this.getViewer();
var _127e=oCV.getViewerWidget();
if(_127e!=null){
if(_127e.shouldUseSavedReportInfo()){
oCV.envParams["rapReportInfo"]=_127e.getAttributeValue("rapReportInfo");
}
this.parent.processInitialResponse.call(this,_127c);
_127e.fireEvent("com.ibm.bux.widget.render.done",null,{noAutoResize:true});
this.getViewer().renderTabs();
oCV.getPinFreezeManager().fromJSONString(_127e.getAttributeValue("PinFreezeInfo"));
var _127f=oCV.getStatus();
if(_127f!="working"&&_127f!="stillWorking"){
delete oCV.envParams["cv.outputKey"];
_127e.setXNodeId(null);
}
switch(_127f){
case "complete":
_127e.setOriginalFormFields(null);
this.postComplete();
break;
case "working":
case "stillWorking":
oCV.getWorkingDialog().show();
setTimeout(getCognosViewerObjectRefAsString(oCV.getId())+".executeCallback(\"wait\");",10);
break;
case "prompting":
_127e.hideToolbarAndContextMenu();
break;
case "fault":
if(this.isAuthenticationFault()){
this.onPassportTimeout();
}else{
this.onFault();
}
}
this.showReport();
this.onPostEntryComplete();
oCV.m_stateSet=true;
this.onAsynchStatusUpdate(_127f);
}else{
var _1280=this;
setTimeout(function(){
_1280.processInitialResponse(_127c);
},100);
}
};
RequestHandler.prototype.onPostEntryComplete=function(){
var oCV=this.getViewer();
if(oCV&&oCV.getViewerWidget()){
var _1282=oCV.getViewerWidget();
_1282.getLoadManager().processQueue();
}
};
RequestHandler.prototype.isMissingMemberException=function(oCV,_1284){
if(oCV.bMissingMemberException){
return true;
}
if(_1284&&_1284.getResponseState){
var _1285=_1284.getResponseState();
if(_1285&&_1285.envParams&&_1285.envParams.bMissingMemberException){
this._populateMissingMemberDetails(oCV,_1285);
return true;
}
}
return false;
};
RequestHandler.prototype._populateMissingMemberDetails=function(oCV,_1287){
if(!oCV||!_1287||!_1287.envParams){
return;
}
oCV.bCanEditContent=_1287.envParams.bCanEditContent;
oCV.bHasParameters=_1287.envParams.bHasParameters;
if(_1287.envParams["ui.spec"]){
if(oCV.envParams){
if(!oCV.envParams["ui.spec"]){
oCV.envParams["ui.spec"]=xml_decode(_1287.envParams["ui.spec"]);
}
}
}
};
RequestHandler.prototype.handleMissingMemberException=function(oCV){
var _1289=null;
_1289=(oCV.bCanEditContent)?RV_RES.IDS_JS_MISSING_MEMBER_ERROR_MSG_FOR_SPEC_PARAM:RV_RES.IDS_JS_MISSING_MEMBER_ERROR_MSG_WITH_NO_BUA;
var _128a=new MissingMemberFaultDialog(oCV,_1289,oCV.bCanEditContent,oCV.bHasParameters);
this.setFaultDialog(_128a);
};
RequestHandler.prototype.massageHtmlBeforeDisplayed=function(){
var oCV=this.getViewer();
if(!oCV){
return;
}
var _128c=oCV.getViewerWidget();
if(!_128c){
return;
}
_128c.updateDrillThroughLinks();
};
function BaseRequestExecutedIndicator(oCV){
this.m_oCV=oCV;
if(oCV){
this.m_oCVId=oCV.getId();
if(oCV.getViewerWidget()){
this.m_background=oCV.getViewerWidget().getReportBlocker();
}
}
};
BaseRequestExecutedIndicator.prototype=new IRequestIndicator();
BaseRequestExecutedIndicator.prototype.getViewer=function(){
return this.m_oCV;
};
BaseRequestExecutedIndicator.prototype.show=function(){
this.m_background.setClassNameOverride("report-blocker");
this.m_background.show();
};
BaseRequestExecutedIndicator.prototype.hide=function(){
if(this.m_background){
this.m_background.hide();
}
};
function RequestExecutedIndicator(oCV){
RequestExecutedIndicator.baseConstructor.call(this,oCV);
};
RequestExecutedIndicator.prototype=new BaseRequestExecutedIndicator();
RequestExecutedIndicator.baseConstructor=BaseRequestExecutedIndicator;
RequestExecutedIndicator.prototype.parent=BaseRequestExecutedIndicator.prototype;
RequestExecutedIndicator.prototype.show=function(){
var oCV=this.getViewer();
var cvid=oCV.getId();
var _1291=document.getElementById("executionCursor"+cvid);
var _1292=document.getElementById("formWarpRequest"+cvid);
if(!_1291&&_1292){
_1291=document.createElement("span");
_1291.className="executionCursor";
_1291.setAttribute("id","executionCursor"+cvid);
var _1293="<img alt=\"\" src=\""+oCV.getWebContentRoot()+"/rv/images/action_busy_32x32.gif"+"\"/>";
_1291.innerHTML=_1293;
_1292.appendChild(_1291);
}
this.parent.show.call(this);
};
RequestExecutedIndicator.prototype.hide=function(){
var _1294=document.getElementById("executionCursor"+this.getViewer().getId());
if(_1294!=null){
_1294.parentNode.removeChild(_1294);
}
this.parent.hide.call(this);
};
dojo.provide("WorkingDialog");
dojo.declare("WorkingDialog",IRequestIndicator,{constructor:function(oCV){
this.m_oCV=oCV;
this.m_sNamespace=oCV.getId();
this.m_sGateway=oCV.getGateway();
try{
var _1296=[];
if(oCV.getAdvancedServerProperty("VIEWER_JS_HIDE_CANCEL_BUTTON")!="true"){
_1296.push({"class":"icdDialogButton",label:RV_RES.CANCEL,onClick:dojo.hitch(this,this.doCancel)});
}
this.m_waitPageDialog=new ViewerIWidgetInlineDialog(this.getCognosViewer(),this.getWaitPageHTML(),_1296,"waitButtonContainer_"+this.getCognosViewer().getId());
}
catch(e){
if(console&&console.log){
console.log(e);
}
}
},setSimpleWorkingDialogFlag:function(flag){
},getCognosViewer:function(){
return this.m_oCV;
},show:function(){
this.m_waitPageDialog.show();
},getWaitPageHTML:function(){
var id=this.getCognosViewer().getId();
return "<table cellspacing=\"4\" cellpadding=\"0\" border=\"0\" wairole=\"presentation\" role=\"presentation\" style=\"width:100%;height:100%\">"+"<tbody><tr><td align=\"center\">"+"<div class=\"dijitInline widget_load_background\" role=\"presentation\" tabindex=\"0\">"+"<div id=\"working"+id+"\" class=\"widget_load\" aria-labelledby=\"working"+id+"\">"+RV_RES.IDS_JS_WAIT_PAGE_LOADING+"</div>"+"<div id=\"waitButtonContainer_"+id+"\" class=\"icdDialogButtonBar\" style=\"text-align:center;padding-left:12px;padding-right:12px;\"></div>"+"</div>"+"</td></tr></tbody>"+"</table>";
},hide:function(){
this.m_waitPageDialog.hide();
this.m_cancelCallback=null;
},setCancelCallback:function(_1299){
this.m_cancelCallback=_1299;
},doCancel:function(){
var oCV=this.getCognosViewer();
if(this.m_cancelCallback){
this.m_cancelCallback();
this.m_cancelCallback=null;
}else{
var _129b=oCV.cancel();
if(_129b){
var _129c=oCV.getViewerWidget().getUndoRedoQueue();
if(_129c){
_129c.handleCancel();
}
}
}
if(oCV.isReportRenderingDone()){
this.hide();
}else{
var _129d={action:"deleteWidget"};
oCV.getViewerWidget().iContext.iEvents.fireEvent("com.ibm.bux.widget.action",null,_129d);
}
}});
dojo.provide("ModalFaultMessageDialog");
dojo.declare("ModalFaultMessageDialog",IFaultDialog,{m_errorMessage:"",m_errorDetails:"",constructor:function(_129e,_129f){
this.m_errorMessage=_129e;
this.m_errorDetails=_129f;
},getErrorMessage:function(){
return this.m_errorMessage;
},getDetails:function(){
return this.m_errorDetails;
},show:function(){
bux.messageBox(bux.MB_ERROR,this.getErrorMessage(),"",this.getDetails());
}});
dojo.provide("MissingMemberFaultDialog");
dojo.declare("MissingMemberFaultDialog",FaultDialog,{m_oCV:null,m_errorMessage:null,m_bHasBUACapability:false,m_bHasParameters:false,constructor:function(oCV,_12a1,_12a2,_12a3){
this.m_errorMessage=_12a1;
this.m_bHasBUACapability=_12a2;
this.m_bHasParameters=_12a3;
},getErrorMessage:function(){
return this.m_errorMessage;
},canRetryRequest:function(){
return false;
},getButtons:function(){
var _12a4=[];
if(this.m_bHasBUACapability){
_12a4.push({label:RV_RES.IDS_JS_EDIT,action:dojo.hitch(this,this.invokeEditContentAction)});
}
_12a4.push({label:RV_RES.IDS_JS_CLOSE,action:dojo.hitch(this,this.ok)});
return _12a4;
},invokeEditContentAction:function(){
var _12a5={};
_12a5.oFaultDialog=this;
_12a5.bHasParameters=this.m_bHasParameters;
this.m_oCV.executeAction("EditContent",{"MissingMemberRecoveryMode":_12a5});
}});
function ViewerDispatcher(){
this.m_activeRequest=null;
this.m_requestQueue=[];
this.m_bUsePageRequest=false;
};
ViewerDispatcher.prototype.getActiveRequest=function(){
return this.m_activeRequest;
};
ViewerDispatcher.prototype.setUsePageRequest=function(_12a6){
this.m_bUsePageRequest=_12a6;
};
ViewerDispatcher.prototype.getUsePageRequest=function(){
return this.m_bUsePageRequest;
};
ViewerDispatcher.prototype.dispatchRequest=function(_12a7){
if(this.m_activeRequest==null){
this.startRequest(_12a7);
}else{
if(_12a7.canBeQueued()==true){
this.m_requestQueue.push(_12a7);
}else{
if(window.cognosViewerDebug&&console&&console.warn){
console.warn("Warning! Dropped a dispatcher entry!");
}
}
}
};
ViewerDispatcher.prototype.startRequest=function(_12a8){
this.m_activeRequest=_12a8;
if(_12a8!=null){
_12a8.setUsePageRequest(this.m_bUsePageRequest);
_12a8.sendRequest();
}
};
ViewerDispatcher.prototype.cancelRequest=function(key){
for(var i=0;i<this.m_requestQueue.length;i++){
var _12ab=this.m_requestQueue[i];
if(_12ab.getKey()===key){
_12ab.setCallbacks({"onEntryComplete":null});
_12ab.cancelRequest(false);
this.m_requestQueue.splice(i,1);
i--;
}
}
if(this.m_activeRequest&&this.m_activeRequest.getKey()===key){
this.m_activeRequest.setCallbacks({"onEntryComplete":null});
this.m_activeRequest.cancelRequest(false);
this.requestComplete();
}
};
ViewerDispatcher.prototype.possibleUnloadEvent=function(){
if(this.m_activeRequest){
this.m_activeRequest.possibleUnloadEvent();
}
};
ViewerDispatcher.prototype.requestComplete=function(_12ac){
this.startRequest(this.nextRequest());
};
ViewerDispatcher.prototype.nextRequest=function(){
var _12ad=null;
if(this.m_requestQueue.length>0){
_12ad=this.m_requestQueue.shift();
if(_12ad.getKey()!=null){
while(this.m_requestQueue.length>0&&this.m_requestQueue[0].getKey()==_12ad.getKey()){
_12ad=this.m_requestQueue.shift();
}
}
}
return _12ad;
};
ViewerDispatcher.prototype.queueIsEmpty=function(){
return (this.m_requestQueue.length==0);
};
function DispatcherEntry(oCV){
this.m_oCV=oCV;
this.m_requestKey=null;
this.m_canBeQueued=false;
this.m_originalFormFields=null;
this.m_bUsePageRequest=false;
if(oCV){
if(!this.m_request){
this.m_request=new XmlHttpObject();
this.m_request.init("POST",this.m_oCV.getGateway(),"",true);
}
if(!this.m_requestHandler){
this.setRequestHandler(new BaseRequestHandler(oCV));
}
DispatcherEntry.prototype.setDefaultFormFields.call(this);
this.setCallbacks({"entryComplete":{"object":this,"method":this.onEntryComplete},"entryFault":{"object":this,"method":this.onEntryFault},"newRequest":{"object":this,"method":this.onNewRequest},"fault":{"object":this,"method":this.onFault},"error":{"object":this,"method":this.onError},"passportTimeout":{"object":this,"method":this.onPassportTimeout},"working":{"object":this,"method":this.onWorking},"prompting":{"object":this,"method":this.onPrompting},"preHttpRequest":{"object":this,"method":this.onPreHttpRequest},"postHttpRequest":{"object":this,"method":this.onPostHttpRequest},"postEntryComplete":{"object":this,"method":this.onPostEntryComplete}});
}
};
DispatcherEntry.prototype.setHeaders=function(_12af){
this.m_request.setHeaders(_12af);
};
DispatcherEntry.prototype.getHeaders=function(){
return this.m_request.getHeaders();
};
DispatcherEntry.prototype.setOriginalFormFields=function(_12b0){
this.m_originalFormFields=_12b0;
};
DispatcherEntry.prototype.getOriginalFormFields=function(){
return this.m_originalFormFields;
};
DispatcherEntry.prototype.setRequestHandler=function(_12b1){
_12b1.addCallbackHooks();
this.m_requestHandler=_12b1;
};
DispatcherEntry.prototype.getRequestHandler=function(){
return this.m_requestHandler;
};
DispatcherEntry.prototype.setWorkingDialog=function(_12b2){
if(this.getRequestHandler()){
this.m_requestHandler.setWorkingDialog(_12b2);
}
};
DispatcherEntry.prototype.setRequestIndicator=function(_12b3){
if(this.getRequestHandler()){
this.getRequestHandler().setRequestIndicator(_12b3);
}
};
DispatcherEntry.prototype.forceSynchronous=function(){
this.getRequest().forceSynchronous();
};
DispatcherEntry.prototype.setUsePageRequest=function(_12b4){
this.m_bUsePageRequest=_12b4;
};
DispatcherEntry.prototype.getUsePageRequest=function(){
return this.m_bUsePageRequest;
};
DispatcherEntry.prototype.setDefaultFormFields=function(){
var _12b5=this.getViewer().envParams;
this.addFormField("b_action","cognosViewer");
this.addFormField("cv.catchLogOnFault","true");
this.addDefinedNonNullFormField("protectParameters",_12b5["protectParameters"]);
this.addDefinedNonNullFormField("ui.routingServerGroup",_12b5["ui.routingServerGroup"]);
this.addDefinedNonNullFormField("cv.debugDirectory",_12b5["cv.debugDirectory"]);
this.addDefinedNonNullFormField("cv.showFaultPage",_12b5["cv.showFaultPage"]);
this.addDefinedNonNullFormField("cv.useRAPDrill",_12b5["cv.useRAPDrill"]);
this.addDefinedNonNullFormField("container",_12b5["container"]);
this.addNonEmptyStringFormField("cv.objectPermissions",_12b5["cv.objectPermissions"]);
};
DispatcherEntry.prototype.getViewer=function(){
return this.m_oCV;
};
DispatcherEntry.prototype.prepareRequest=function(){
};
DispatcherEntry.addWidgetInfoToFormFields=function(_12b6,_12b7){
if(_12b6){
var _12b8=_12b6.getBUXRTStateInfoMap();
if(_12b8){
_12b7.addFormField("cv.buxRTStateInfo",_12b8);
}
var _12b9=_12b6.getDisplayName();
if(_12b9&&_12b9.length>0){
_12b7.addFormField("displayTitle",_12b9);
}
}
};
DispatcherEntry.prototype.canBeQueued=function(){
return this.m_canBeQueued;
};
DispatcherEntry.prototype.setCanBeQueued=function(_12ba){
this.m_canBeQueued=_12ba;
};
DispatcherEntry.prototype.getKey=function(){
return this.m_requestKey;
};
DispatcherEntry.prototype.setKey=function(key){
this.m_requestKey=key;
};
DispatcherEntry.prototype.setRequest=function(_12bc){
this.m_request=_12bc;
};
DispatcherEntry.prototype.getRequest=function(){
return this.m_request;
};
DispatcherEntry.prototype.setCallbacks=function(_12bd){
this.getRequest().setCallbacks(_12bd);
};
DispatcherEntry.prototype.getCallbacks=function(){
return this.getRequest().getCallbacks();
};
DispatcherEntry.prototype.sendRequest=function(){
this.prepareRequest();
var _12be=this.getRequest().getFormFields();
var _12bf=_12be.keys();
if(!this.m_originalFormFields){
this.m_originalFormFields=new CDictionary();
for(var index=0;index<_12bf.length;index++){
this.m_originalFormFields.add(_12bf[index],_12be.get(_12bf[index]));
}
}
this.getRequest().sendRequest();
};
DispatcherEntry.prototype.onNewRequest=function(_12c1){
this.setRequest(_12c1);
};
DispatcherEntry.prototype.retryRequest=function(){
var oCV=this.getViewer();
oCV.setRetryDispatcherEntry(null);
var _12c3=this.getRequest().newRequest();
_12c3.setHeaders(null);
this.setRequest(_12c3);
var _12c4=this.m_originalFormFields.keys();
for(var index=0;index<_12c4.length;index++){
var _12c6=_12c4[index];
var _12c7=this.m_originalFormFields.get(_12c6);
if(_12c6=="cv.responseFormat"&&_12c7=="iWidget"){
this.addFormField("cv.responseFormat","data");
}else{
if(_12c6=="ui.action"&&_12c7=="wait"){
this.addFormField("ui.action",this.m_originalFormFields.get("ui.primaryAction"));
}else{
if(_12c6!="m_tracking"&&_12c6!="cv.outputKey"){
this.addFormField(_12c6,_12c7);
}
}
}
}
this.addFormField("widget.reloadToolbar","true");
if(this.m_oCV.getViewerWidget()){
this.addFormField("cv.buxCurrentUserRole",this.m_oCV.getViewerWidget().getUserRole());
}
this.addNonEmptyStringFormField("cv.objectPermissions",oCV.envParams["cv.objectPermissions"]);
this.addNonEmptyStringFormField("limitedInteractiveMode",oCV.envParams["limitedInteractiveMode"]);
this.m_oCV.getViewerDispatcher().dispatchRequest(this);
};
DispatcherEntry.prototype.abortHttpRequest=function(){
if(!this.m_bCancelCalled){
if(this.getRequestHandler()){
this.getRequestHandler().onCancel();
}
this.m_bCancelCalled=true;
this.getRequest().abortHttpRequest();
this.onEntryComplete();
}
};
DispatcherEntry.prototype.cancelRequest=function(_12c8){
if(!this.m_bCancelCalled){
this.m_bCancelCalled=true;
if(this.getRequestHandler()){
this.getRequestHandler().onCancel();
}
if(_12c8){
this.getRequest().forceSynchronous();
}
this.getRequest().cancel();
this.onEntryComplete();
}
};
DispatcherEntry.prototype.getFormFields=function(){
return this.m_request.getFormFields();
};
DispatcherEntry.prototype.getFormField=function(name){
if(this.m_request){
return this.m_request.getFormField(name);
}else{
return "";
}
};
DispatcherEntry.prototype.clearFormFields=function(){
this.m_request.clearFormFields();
};
DispatcherEntry.prototype.formFieldExists=function(name){
if(this.m_request){
return this.m_request.getFormFields().exists(name);
}
return false;
};
DispatcherEntry.prototype.removeFormField=function(name){
if(this.formFieldExists(name)){
this.m_request.getFormFields().remove(name);
}
};
DispatcherEntry.prototype.addFormField=function(name,value){
this.m_request.addFormField(name,value);
};
DispatcherEntry.prototype.addDefinedNonNullFormField=function(name,value){
if(typeof value!="undefined"&&value!=null){
this.addFormField(name,value);
}
};
DispatcherEntry.prototype.addDefinedFormField=function(name,value){
if(typeof value!="undefined"){
this.addFormField(name,value);
}
};
DispatcherEntry.prototype.addNonNullFormField=function(name,value){
if(value!=null){
this.addFormField(name,value);
}
};
DispatcherEntry.prototype.addNonEmptyStringFormField=function(name,value){
if(typeof value!="undefined"&&value!=null&&value!=""){
this.addFormField(name,value);
}
};
DispatcherEntry.prototype.onWorking=function(_12d6,arg1){
if(this.getRequestHandler()){
this.getRequestHandler().onWorking(_12d6);
}
};
DispatcherEntry.prototype.onFault=function(_12d8){
if(this.getRequestHandler()){
this.getRequestHandler().onFault(_12d8);
}
};
DispatcherEntry.prototype.onError=function(_12d9){
if(this.m_bCancelCalled){
return;
}
if(this.getRequestHandler()){
this.getRequestHandler().onError(_12d9);
}
};
DispatcherEntry.prototype.possibleUnloadEvent=function(){
this.setCallbacks({"error":{}});
};
DispatcherEntry.prototype.onPreHttpRequest=function(_12da){
if(this.getRequestHandler()){
this.getRequestHandler().preHttpRequest(_12da);
}
};
DispatcherEntry.prototype.onPostHttpRequest=function(_12db){
if(this.getRequestHandler()){
this.getRequestHandler().postHttpRequest(_12db);
}
};
DispatcherEntry.prototype.onPassportTimeout=function(_12dc){
if(this.getRequestHandler()){
this.getRequestHandler().onPassportTimeout(_12dc);
}
};
DispatcherEntry.prototype.onPrompting=function(_12dd){
if(this.getRequestHandler()){
this.getRequestHandler().onPrompting(_12dd);
}
};
DispatcherEntry.prototype.onEntryComplete=function(_12de){
if(!this.m_oCV._beingDestroyed){
this.m_oCV.getViewerDispatcher().requestComplete(this);
}
};
DispatcherEntry.prototype.onEntryFault=function(_12df){
this.m_oCV.setFaultDispatcherEntry(this);
this.m_oCV.resetViewerDispatcher();
if(!this.m_bCancelCalled){
this.m_oCV.setRetryDispatcherEntry(this);
}
};
DispatcherEntry.prototype.onCloseErrorDlg=function(){
var _12e0=this.getCallbacks();
if(_12e0["closeErrorDlg"]){
var _12e1=GUtil.generateCallback(_12e0["closeErrorDlg"].method,[],_12e0["closeErrorDlg"].object);
_12e1();
}
};
DispatcherEntry.prototype.onPostEntryComplete=function(){
if(this.getRequestHandler()){
this.getRequestHandler().onPostEntryComplete();
}
this.executeCallback("postComplete");
};
DispatcherEntry.prototype.executeCallback=function(_12e2){
var _12e3=this.getCallbacks();
if(_12e3[_12e2]){
var _12e4=(_12e3.customArguments)?[this,_12e3.customArguments]:[this];
var _12e5=GUtil.generateCallback(_12e3[_12e2].method,_12e4,_12e3[_12e2].object);
_12e5();
return true;
}
return false;
};
function DataDispatcherEntry(oCV){
if(oCV){
this.setRequest(new AsynchDATARequest(oCV.getGateway(),oCV.getWebContentRoot()));
}
DataDispatcherEntry.baseConstructor.call(this,oCV);
};
DataDispatcherEntry.prototype=new DispatcherEntry();
DataDispatcherEntry.baseConstructor=DispatcherEntry;
function JSONDispatcherEntry(oCV){
if(oCV){
this.setRequest(new AsynchJSONRequest(oCV.getGateway(),oCV.getWebContentRoot()));
}
JSONDispatcherEntry.prototype.setDefaultFormFields.call(this);
JSONDispatcherEntry.baseConstructor.call(this,oCV);
};
JSONDispatcherEntry.prototype=new DispatcherEntry();
JSONDispatcherEntry.baseConstructor=DispatcherEntry;
JSONDispatcherEntry.prototype.setDefaultFormFields=function(){
this.addFormField("cv.responseFormat","JSON");
};
function AsynchDataDispatcherEntry(oCV){
if(oCV){
var _12e9=new AsynchDATARequest(oCV.getGateway(),oCV.getWebContentRoot());
this.setRequest(_12e9);
AsynchDataDispatcherEntry.baseConstructor.call(this,oCV);
AsynchDataDispatcherEntry.prototype.setDefaultFormFields.call(this);
}
};
AsynchDataDispatcherEntry.prototype=new DispatcherEntry();
AsynchDataDispatcherEntry.baseConstructor=DispatcherEntry;
AsynchDataDispatcherEntry.prototype.setDefaultFormFields=function(){
this.addFormField("cv.responseFormat","data");
};
function AsynchJSONDispatcherEntry(oCV){
if(oCV){
var _12eb=new AsynchJSONRequest(oCV.getGateway(),oCV.getWebContentRoot());
this.setRequest(_12eb);
AsynchJSONDispatcherEntry.baseConstructor.call(this,oCV);
AsynchJSONDispatcherEntry.prototype.setDefaultFormFields.call(this);
}
};
AsynchJSONDispatcherEntry.prototype=new DispatcherEntry();
AsynchJSONDispatcherEntry.baseConstructor=DispatcherEntry;
AsynchJSONDispatcherEntry.prototype.setDefaultFormFields=function(){
this.addFormField("cv.responseFormat","asynchJSON");
};
function ReportDispatcherEntry(oCV){
ReportDispatcherEntry.baseConstructor.call(this,oCV);
if(oCV){
ReportDispatcherEntry.prototype.setDefaultFormFields.call(this);
this.setRequestHandler(new RequestHandler(oCV));
this.setWorkingDialog(oCV.getWorkingDialog());
this.setRequestIndicator(oCV.getRequestIndicator());
this.setCallbacks({"complete":{"object":this,"method":this.onComplete},"prompting":{"object":this,"method":this.onComplete}});
}
};
ReportDispatcherEntry.prototype=new AsynchDataDispatcherEntry();
ReportDispatcherEntry.baseConstructor=AsynchDataDispatcherEntry;
ReportDispatcherEntry.prototype.parent=AsynchDataDispatcherEntry.prototype;
ReportDispatcherEntry.prototype.prepareRequest=function(){
var _12ed=this.getFormField("ui.action");
var _12ee=this.getViewer().getActionState();
if(_12ee!==""&&(_12ed=="wait"||_12ed=="forward"||_12ed=="back")){
this.addFormField("cv.actionState",_12ee);
}
var _12ef=["nextPage","previousPage","firstPage","lastPage","reportAction","cancel","wait"];
var _12f0=true;
for(var i=0;i<_12ef.length;i++){
if(_12ef[i]==_12ed){
_12f0=false;
break;
}
}
if(_12f0){
this.getViewer().clearTabs();
}
if(this.getViewer().getCurrentlySelectedTab()&&!this.formFieldExists("generic.anyURI.http://developer.cognos.com/ceba/constants/runOptionEnum#pageGroup")&&this.getViewer().getStatus()!="prompting"){
this.addFormField("generic.anyURI.http://developer.cognos.com/ceba/constants/runOptionEnum#pageGroup",this.getViewer().getCurrentlySelectedTab());
}
};
ReportDispatcherEntry.prototype.setDefaultFormFields=function(){
var oCV=this.getViewer();
var _12f3=oCV.envParams;
this.addFormField("cv.id",oCV.getId());
if(_12f3["cv.showFaultPage"]){
this.addFormField("cv.showFaultPage",_12f3["cv.showFaultPage"]);
}else{
this.addFormField("cv.showFaultPage","false");
}
this.addDefinedNonNullFormField("ui.object",_12f3["ui.object"]);
this.addDefinedNonNullFormField("ui.primaryAction",_12f3["ui.primaryAction"]);
this.addDefinedNonNullFormField("ui.objectClass",_12f3["ui.objectClass"]);
this.addNonEmptyStringFormField("specificationType",_12f3["specificationType"]);
this.addNonEmptyStringFormField("cv.promptForDownload",_12f3["cv.promptForDownload"]);
this.addNonEmptyStringFormField("ui.conversation",oCV.getConversation());
this.addNonEmptyStringFormField("m_tracking",oCV.getTracking());
var _12f4=oCV.getExecutionParameters();
this.addNonEmptyStringFormField("executionParameters",_12f4);
var sCAF=oCV.getCAFContext();
this.addDefinedNonNullFormField("ui.cafcontextid",sCAF);
};
ReportDispatcherEntry.prototype.onWorking=function(_12f6,arg1){
var _12f8=_12f6.getResponseState();
var _12f9=this.getRequestHandler();
if(_12f9){
var _12fa=_12f9.getWorkingDialog();
if(_12fa&&_12fa.setSecondaryRequests&&_12f8.m_aSecRequests){
_12fa.setSecondaryRequests(_12f8.m_aSecRequests);
}
}
DispatcherEntry.prototype.onWorking.call(this,_12f6,arg1);
if(_12f9){
this.getRequestHandler().updateViewerState(_12f8);
}
};
ReportDispatcherEntry.prototype.onComplete=function(_12fb,arg1){
if(this.getRequestHandler()){
this.getRequestHandler().onComplete(_12fb);
}
};
function ViewerDispatcherEntry(oCV){
ViewerDispatcherEntry.baseConstructor.call(this,oCV);
if(oCV){
ViewerDispatcherEntry.prototype.setDefaultFormFields.call(this);
this.setCallbacks({"prompting":{"object":this,"method":this.onPrompting}});
var _12fe=oCV.getViewerWidget();
if(_12fe.m_originalFormFields){
this.setOriginalFormFields(_12fe.m_originalFormFields);
_12fe.m_originalFormFields=null;
}
}
};
ViewerDispatcherEntry.prototype=new ReportDispatcherEntry();
ViewerDispatcherEntry.baseConstructor=ReportDispatcherEntry;
ViewerDispatcherEntry.prototype.parent=ReportDispatcherEntry.prototype;
ViewerDispatcherEntry.prototype.prepareRequest=function(){
this.parent.prepareRequest.call(this);
var _12ff=this.getViewer().getViewerWidget();
if(this.getFormField("widget.reloadToolbar")){
this.addFormField("cv.buxCurrentUserRole",_12ff.getUserRole());
}
if(_12ff){
DispatcherEntry.addWidgetInfoToFormFields(_12ff,this);
}
this.getViewer().inlineScriptsDoneExecuting=false;
};
ViewerDispatcherEntry.prototype.setDefaultFormFields=function(){
var oCV=this.getViewer();
var _1301=oCV.getViewerWidget();
var _1302=oCV.envParams;
this.addFormField("bux","true");
this.addFormField("cv.showFaultPage","false");
this.addDefinedNonNullFormField("baseReportModificationTime",_1302["baseReportModificationTime"]);
this.addDefinedNonNullFormField("originalReport",_1302["originalReport"]);
this.addDefinedNonNullFormField("ui.reportDrop",_1302["ui.reportDrop"]);
this.addDefinedNonNullFormField("ui.preserveRapTags",_1302["ui.preserveRapTags"]);
if(_1301.getProperties()){
var _1303=_1301.getProperties().getFlashCharts();
if(_1303!=null){
this.addDefinedNonNullFormField("savedFlashChartOption",_1303);
if(_1302.hasAVSChart){
this.addDefinedNonNullFormField("hasAVSChart",_1302.hasAVSChart);
}else{
this.addDefinedNonNullFormField("hasAVSChart",oCV.hasAVSChart());
}
}
}
var _1304=_1301.getAttributeValue("gateway");
if(_1304){
this.addDefinedNonNullFormField("cv.gateway",_1304);
}
var _1305=_1301.getAttributeValue("webcontent");
if(_1305){
this.addDefinedNonNullFormField("cv.webcontent",_1305);
}
if(oCV.envParams["cv.outputKey"]){
this.addFormField("cv.outputKey",oCV.envParams["cv.outputKey"]);
this.addFormField("b_action","cvx.high");
delete oCV.envParams["cv.outputKey"];
}
if(_1301.getXNodeId()){
this.setHeaders({"X-Node-ID":_1301.getXNodeId()});
_1301.setXNodeId(null);
}
};
ViewerDispatcherEntry.prototype.onPrompting=function(_1306){
if(this.getRequestHandler()){
this.getRequestHandler().onPrompting(_1306);
}
};
function Blocker(oCVId){
this.oCV_Id=oCVId;
this.m_viewerDiv=dojo.byId("RVContent"+this.oCV_Id);
this.m_containerDiv=this._findContainerDiv();
this.initialize();
};
Blocker.prototype._findContainerDiv=function(){
var _1308=null;
if(!this.m_containerDiv){
_1308=this.m_viewerDiv;
while(_1308){
if(_1308.style&&_1308.style.height&&_1308.style.height.indexOf("px")!=-1){
return _1308;
}
_1308=_1308.parentNode;
}
}
if(typeof console!="undefined"&&console&&console.log){
console.log("ViewerIWidgetInlineDialog: Could not find the container div for showing the dialog.");
}
return this.m_viewerDiv;
};
Blocker.prototype.setClassNameOverride=function(_1309){
if(!_1309){
return;
}
this.m_classNameOverride=_1309;
this.applyClassNameOverride();
};
Blocker.prototype.applyClassNameOverride=function(){
if(!this.m_classNameOverride||!this.m_background){
return;
}
dojo.removeClass(this.m_background);
dojo.addClass(this.m_background,this.m_classNameOverride);
};
Blocker.prototype.getNode=function(){
return this.m_background;
};
Blocker.prototype.initialize=function(){
if(!this.m_background){
this.m_background=dojo.byId("BACKGROUND"+this.oCV_Id);
if(!this.m_background){
this.m_background=document.createElement("div");
this.m_background.id="BACKGROUND"+this.oCV_Id;
this.m_background.className="report-blocker";
this.m_background.tabIndex="0";
dojo.place(this.m_background,this.m_containerDiv,"before");
}
}
};
Blocker.prototype.show=function(){
if(this.m_background){
this.m_background.style.display="block";
}
};
Blocker.prototype.hide=function(){
if(this.m_background){
this.m_background.style.display="none";
}
};
Blocker.prototype.destroy=function(){
if(this.m_background!=null){
this.m_background.parentNode.removeChild(this.m_background);
this.m_background=null;
}
};
function ReselectAction(oCV,_130b){
this.m_aSelectionFilterObjects=_130b;
this.m_oCV=oCV;
this.m_oSC=oCV.getSelectionController();
this.m_cd=this.m_oSC.getCCDManager().m_cd;
this.m_md=this.m_oSC.getCCDManager().m_md;
this.m_nReportDiv=oCV.getReportDiv();
this.m_oRAPReportContainers=oCV.getRAPReportInfo().getContainers();
};
ReselectAction.prototype.executeAction=function(){
this.mapCdMd();
if(this.show()){
var oVW=this.m_oCV.getViewerWidget();
if(oVW){
var _130d=oVW.m_oWidgetContextManager.genSelectionPayload(this.m_oCV,oVW.getWidgetId());
oVW.setSelectionFilterSent(true);
oVW.fireEvent("com.ibm.bux.data.filterCache.init",null,_130d);
if(oVW.isPastedWidget()&&!oVW.pastedSelectedBroadcasted){
oVW.pastedSelectedBroadcasted=true;
oVW.onSelectionChange();
}
}
}
};
ReselectAction.prototype.mapCdMd=function(){
var _130e=this.m_aSelectionFilterObjects;
for(var i in _130e){
var _1310=_130e[i];
var oItem=_1310.selectedItem;
var aCtx=[];
var _1313=null;
var _1314=this._findMdIndex("q",_1310.query);
_1313=this._setNewCtx(oItem,_1314);
if(_1313){
aCtx.push(_1313);
}else{
continue;
}
for(var j in _1310.context){
var _1316=_1310.context[j];
_1313=this._setNewCtx(_1316,_1314);
if(_1313){
aCtx.push(_1313);
}
}
_1310.ctxArray=aCtx;
}
};
ReselectAction.prototype._setNewCtx=function(oItem,_1318){
var _1319=null;
var ctxId=null;
if(oItem.isMeasure==="true"){
_1319=this._findMdIndex(oItem.mdProperty,oItem.mdValue,_1318);
if(_1319){
oItem.ctxRef={"property":oItem.mdProperty,"mdIndex":_1319};
return oItem.ctxRef;
}
}else{
if(oItem.mun){
_1319=this._findMdIndex("m",oItem.mun,_1318);
ctxId=this._getContextIdForCdProperty(_1318,"m",_1319);
}else{
_1319=this._findMdIndex(oItem.mdProperty,oItem.mdValue,_1318);
ctxId=this._getContextIdForCdPropertyAndMdProperty(_1318,"u",oItem.use,oItem.mdProperty,_1319);
}
if(ctxId){
oItem.ctxId=ctxId;
return oItem.ctxId;
}
}
return null;
};
ReselectAction.prototype._getContextIdForCdProperty=function(_131b,_131c,_131d){
var ctxid=null;
for(var j in this.m_cd){
if(this.m_cd[j].q==_131b&&this.m_cd[j][_131c]==_131d){
ctxid=j;
break;
}
}
return ctxid;
};
ReselectAction.prototype._getContextIdForCdPropertyAndMdProperty=function(_1320,_1321,_1322,_1323,_1324){
var ctxid=null;
for(var j in this.m_cd){
if(this.m_cd[j].q==_1320&&this.m_cd[j][_1323]==_1324&&this.m_cd[j][_1321]==_1322){
ctxid=j;
break;
}
}
return ctxid;
};
ReselectAction.prototype._findMdIndex=function(_1327,value,_1329){
var _132a=null;
for(var j in this.m_md){
if(this.m_md[j][_1327]===value){
if(this.m_md[j]["q"]&&_1329){
if(this.m_md[j]["q"]==_1329){
_132a=j;
break;
}
}else{
_132a=j;
break;
}
}
}
return _132a;
};
ReselectAction.prototype.show=function(){
var _132c=false;
var oCV=this.m_oCV;
var oVW=oCV.getViewerWidget();
var _132f=oCV.getReportDiv();
var _1330=null;
var _1331=null;
var _1332=null;
oVW.preprocessPageClicked(false);
if(oVW&&_132f){
for(var _1333 in this.m_aSelectionFilterObjects){
var _1334=this.m_aSelectionFilterObjects[_1333];
var _1335=(_1334.selectedItem.isMeasure==="true");
var _1336=true;
if(_1335){
var _1337=_1334.context;
for(var idx in _1337){
if(_1337[idx].isMeasure!=="true"){
_1336=false;
break;
}
}
if(_1336){
continue;
}
}
var aCtx=_1334.ctxArray;
if(aCtx&&aCtx.length>0){
_1330=this._getLayoutContainers(_1334.lid);
var _133a=false;
for(var _133b=0;!_133a&&_133b<_1330.length;_133b++){
if(/img|IMG/.test(_1330[_133b].tagName)){
var _133c=_1330[_133b];
for(_1332=null;!_1332&&_133c.parentNode;){
_133c=_133c.parentNode;
var _133d=_133c.getElementsByTagName("map");
if(_133d&&_133d.length>0){
_1332=_133d[0];
}
}
}else{
_1332=_1330[_133b].parentNode;
}
if(_1332){
var _133e=this._buildCtxQueryRegExp(aCtx);
_1331=getElementsByAttribute(_1332,"*","ctx",null,-1,_133e);
var _133f=_1334.selectedItem;
for(var idx in _1331){
if(_1331[idx].getAttribute){
if(_1335&&_133f.isDataValueOrChartElement==="false"&&(_1331[idx].getAttribute("type")==="datavalue"||_1331[idx].getAttribute("type")==="chartElement")){
continue;
}
if(this.isMatchingCell(aCtx,_1331[idx])){
var _1340=_1331[idx];
if(_1340.tagName==="SPAN"||_1340.tagName==="span"){
var _1341=_1340.parentNode.tagName;
if(_1341=="td"||_1341=="TD"||_1341=="TH"||_1341=="th"){
if(_1340.parentNode.getAttribute("ctx")==_1340.getAttribute("ctx")){
continue;
}
}
}
var evt={"target":_1340,"button":1,"ctrlKey":true};
this.m_oSC.pageClicked(evt);
_133a=true;
_132c=true;
}
}
}
}
}
}
}
}
return _132c;
};
ReselectAction.prototype.isMatchingCell=function(aCtx,_1344){
var _1345=_1344.getAttribute("ctx");
if(!_1345||_1345.length==0){
return false;
}
var _1346=_1345.replace(/::/g,":").split(":");
var _1347=0;
var _1348=null;
var _1349=0;
var _134a=null;
var _134b=0;
var _134c=false;
for(;_1347<_1346.length;_1347++){
if(_1346[_1347].length>0){
_1348=_1346[_1347++];
break;
}
}
_134a=aCtx[_1349];
if(typeof _134a=="string"){
if(_134a==_1348){
_134b++;
}
}else{
if(this.m_cd[_1348][_134a.property]==_134a.mdIndex){
_134b++;
}
}
if(_134b!=1){
return false;
}
if(aCtx.length==1){
_134c=true;
}
for(_1349=1;!_134c&&_1349<aCtx.length;_1349++){
_134a=aCtx[_1349];
if(typeof _134a=="string"){
for(_1347=1;_1347<_1346.length;_1347++){
if(_1346[_1347].length>0&&_1346[_1347]!="0"){
_1348=_1346[_1347];
if(_134a==_1348){
_134b++;
_1346[_1347]="0";
break;
}
}
}
}else{
for(_1347=1;_1347<_1346.length;_1347++){
if(_1346[_1347].length>0&&_1346[_1347]!="0"){
_1348=_1346[_1347];
if(this.m_cd[_1348][_134a.property]==_134a.mdIndex){
_134b++;
_1346[_1347]="0";
break;
}
}
}
}
if(aCtx.length==_134b){
_134c=true;
}
}
return _134c;
};
ReselectAction.prototype._buildCtxQueryRegExp=function(aCtx){
var _134e="";
var _134f=false;
var i=0;
if(typeof aCtx[i]=="string"){
_134e+="^"+aCtx[i];
}else{
_134e+="^[\\d:]+";
}
i++;
var _1351="";
for(;!_134f&&i<aCtx.length;i++){
if(typeof aCtx[i]=="string"){
if(_1351.length>0){
_1351+="+";
}
_1351+=aCtx[i];
_134f=true;
}else{
if(i<aCtx.length-1){
if(_1351.length>0){
_1351+="+";
}
_1351+="[\\d:]";
}
}
}
if(_1351.length>0){
_134e+=":{1,}"+_1351;
}
return new RegExp(_134e);
};
ReselectAction.prototype._getLayoutContainers=function(sLid){
var _1353="";
if(this.m_oRAPReportContainers&&this.m_oRAPReportContainers[sLid]){
_1353=sLid+".+";
}else{
for(var name in this.m_oRAPReportContainers){
if(_1353.length>0){
_1353+="|";
}
_1353+=name+".+";
}
}
return getElementsByAttribute(this.m_nReportDiv,"*","lid",null,-1,new RegExp(_1353));
};

